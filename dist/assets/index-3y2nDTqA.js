import{decrypt_data as oo,encrypt_data as ao,change_file_password as Rs,decrypt_file as ks,encrypt_file as Ms,crypt_context_destroy as lo,crypt_context_create as fo,decrypt_stream_init as co,Stream as uo,decrypt_stream as ho}from"simple-web-encryption";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const h of c)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function a(c){const h={};return c.integrity&&(h.integrity=c.integrity),c.referrerPolicy&&(h.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?h.credentials="include":c.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function l(c){if(c.ep)return;c.ep=!0;const h=a(c);fetch(c.href,h)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function yn(e){const n=Object.create(null);for(const a of e.split(","))n[a]=1;return a=>a in n}const ft={},Te=[],Zt=()=>{},po=()=>!1,Fi=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),mn=e=>e.startsWith("onUpdate:"),St=Object.assign,vn=(e,n)=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)},_o=Object.prototype.hasOwnProperty,rt=(e,n)=>_o.call(e,n),$=Array.isArray,Pe=e=>li(e)==="[object Map]",Ds=e=>li(e)==="[object Set]",On=e=>li(e)==="[object Date]",Z=e=>typeof e=="function",gt=e=>typeof e=="string",Jt=e=>typeof e=="symbol",dt=e=>e!==null&&typeof e=="object",Os=e=>(dt(e)||Z(e))&&Z(e.then)&&Z(e.catch),Ns=Object.prototype.toString,li=e=>Ns.call(e),go=e=>li(e).slice(8,-1),Hs=e=>li(e)==="[object Object]",xn=e=>gt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ke=yn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ii=e=>{const n=Object.create(null);return a=>n[a]||(n[a]=e(a))},yo=/-(\w)/g,Nt=Ii(e=>e.replace(yo,(n,a)=>a?a.toUpperCase():"")),mo=/\B([A-Z])/g,Ee=Ii(e=>e.replace(mo,"-$1").toLowerCase()),Li=Ii(e=>e.charAt(0).toUpperCase()+e.slice(1)),Gi=Ii(e=>e?`on${Li(e)}`:""),de=(e,n)=>!Object.is(e,n),_i=(e,...n)=>{for(let a=0;a<e.length;a++)e[a](...n)},Gs=(e,n,a,l=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:l,value:a})},en=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let Nn;const zi=()=>Nn||(Nn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function bn(e){if($(e)){const n={};for(let a=0;a<e.length;a++){const l=e[a],c=gt(l)?So(l):bn(l);if(c)for(const h in c)n[h]=c[h]}return n}else if(gt(e)||dt(e))return e}const vo=/;(?![^(]*\))/g,xo=/:([^]+)/,bo=/\/\*[^]*?\*\//g;function So(e){const n={};return e.replace(bo,"").split(vo).forEach(a=>{if(a){const l=a.split(xo);l.length>1&&(n[l[0].trim()]=l[1].trim())}}),n}function Sn(e){let n="";if(gt(e))n=e;else if($(e))for(let a=0;a<e.length;a++){const l=Sn(e[a]);l&&(n+=l+" ")}else if(dt(e))for(const a in e)e[a]&&(n+=a+" ");return n.trim()}const wo="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Uo=yn(wo);function Vs(e){return!!e||e===""}function Eo(e,n){if(e.length!==n.length)return!1;let a=!0;for(let l=0;a&&l<e.length;l++)a=bi(e[l],n[l]);return a}function bi(e,n){if(e===n)return!0;let a=On(e),l=On(n);if(a||l)return a&&l?e.getTime()===n.getTime():!1;if(a=Jt(e),l=Jt(n),a||l)return e===n;if(a=$(e),l=$(n),a||l)return a&&l?Eo(e,n):!1;if(a=dt(e),l=dt(n),a||l){if(!a||!l)return!1;const c=Object.keys(e).length,h=Object.keys(n).length;if(c!==h)return!1;for(const d in e){const o=e.hasOwnProperty(d),_=n.hasOwnProperty(d);if(o&&!_||!o&&_||!bi(e[d],n[d]))return!1}}return String(e)===String(n)}const Ys=e=>!!(e&&e.__v_isRef===!0),Re=e=>gt(e)?e:e==null?"":$(e)||dt(e)&&(e.toString===Ns||!Z(e.toString))?Ys(e)?Re(e.value):JSON.stringify(e,js,2):String(e),js=(e,n)=>Ys(n)?js(e,n.value):Pe(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((a,[l,c],h)=>(a[Vi(l,h)+" =>"]=c,a),{})}:Ds(n)?{[`Set(${n.size})`]:[...n.values()].map(a=>Vi(a))}:Jt(n)?Vi(n):dt(n)&&!$(n)&&!Hs(n)?String(n):n,Vi=(e,n="")=>{var a;return Jt(e)?`Symbol(${(a=e.description)!=null?a:n})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zt;class Bo{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=zt,!n&&zt&&(this.index=(zt.scopes||(zt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,a;if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].pause();for(n=0,a=this.effects.length;n<a;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,a;if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].resume();for(n=0,a=this.effects.length;n<a;n++)this.effects[n].resume()}}run(n){if(this._active){const a=zt;try{return zt=this,n()}finally{zt=a}}}on(){zt=this}off(){zt=this.parent}stop(n){if(this._active){this._active=!1;let a,l;for(a=0,l=this.effects.length;a<l;a++)this.effects[a].stop();for(this.effects.length=0,a=0,l=this.cleanups.length;a<l;a++)this.cleanups[a]();if(this.cleanups.length=0,this.scopes){for(a=0,l=this.scopes.length;a<l;a++)this.scopes[a].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0}}}function Co(){return zt}let ut;const Yi=new WeakSet;class Ks{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,zt&&zt.active&&zt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Yi.has(this)&&(Yi.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||qs(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Hn(this),$s(this);const n=ut,a=Gt;ut=this,Gt=!0;try{return this.fn()}finally{Xs(this),ut=n,Gt=a,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)En(n);this.deps=this.depsTail=void 0,Hn(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Yi.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){nn(this)&&this.run()}get dirty(){return nn(this)}}let Ws=0,We,qe;function qs(e,n=!1){if(e.flags|=8,n){e.next=qe,qe=e;return}e.next=We,We=e}function wn(){Ws++}function Un(){if(--Ws>0)return;if(qe){let n=qe;for(qe=void 0;n;){const a=n.next;n.next=void 0,n.flags&=-9,n=a}}let e;for(;We;){let n=We;for(We=void 0;n;){const a=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(l){e||(e=l)}n=a}}if(e)throw e}function $s(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function Xs(e){let n,a=e.depsTail,l=a;for(;l;){const c=l.prevDep;l.version===-1?(l===a&&(a=c),En(l),Ao(l)):n=l,l.dep.activeLink=l.prevActiveLink,l.prevActiveLink=void 0,l=c}e.deps=n,e.depsTail=a}function nn(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(Zs(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function Zs(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ei))return;e.globalVersion=ei;const n=e.dep;if(e.flags|=2,n.version>0&&!e.isSSR&&e.deps&&!nn(e)){e.flags&=-3;return}const a=ut,l=Gt;ut=e,Gt=!0;try{$s(e);const c=e.fn(e._value);(n.version===0||de(c,e._value))&&(e._value=c,n.version++)}catch(c){throw n.version++,c}finally{ut=a,Gt=l,Xs(e),e.flags&=-3}}function En(e,n=!1){const{dep:a,prevSub:l,nextSub:c}=e;if(l&&(l.nextSub=c,e.prevSub=void 0),c&&(c.prevSub=l,e.nextSub=void 0),a.subs===e&&(a.subs=l,!l&&a.computed)){a.computed.flags&=-5;for(let h=a.computed.deps;h;h=h.nextDep)En(h,!0)}!n&&!--a.sc&&a.map&&a.map.delete(a.key)}function Ao(e){const{prevDep:n,nextDep:a}=e;n&&(n.nextDep=a,e.prevDep=void 0),a&&(a.prevDep=n,e.nextDep=void 0)}let Gt=!0;const Qs=[];function _e(){Qs.push(Gt),Gt=!1}function ge(){const e=Qs.pop();Gt=e===void 0?!0:e}function Hn(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const a=ut;ut=void 0;try{n()}finally{ut=a}}}let ei=0;class To{constructor(n,a){this.sub=n,this.dep=a,this.version=a.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Bn{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!ut||!Gt||ut===this.computed)return;let a=this.activeLink;if(a===void 0||a.sub!==ut)a=this.activeLink=new To(ut,this),ut.deps?(a.prevDep=ut.depsTail,ut.depsTail.nextDep=a,ut.depsTail=a):ut.deps=ut.depsTail=a,Js(a);else if(a.version===-1&&(a.version=this.version,a.nextDep)){const l=a.nextDep;l.prevDep=a.prevDep,a.prevDep&&(a.prevDep.nextDep=l),a.prevDep=ut.depsTail,a.nextDep=void 0,ut.depsTail.nextDep=a,ut.depsTail=a,ut.deps===a&&(ut.deps=l)}return a}trigger(n){this.version++,ei++,this.notify(n)}notify(n){wn();try{for(let a=this.subs;a;a=a.prevSub)a.sub.notify()&&a.sub.dep.notify()}finally{Un()}}}function Js(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let l=n.deps;l;l=l.nextDep)Js(l)}const a=e.dep.subs;a!==e&&(e.prevSub=a,a&&(a.nextSub=e)),e.dep.subs=e}}const sn=new WeakMap,Se=Symbol(""),rn=Symbol(""),ii=Symbol("");function vt(e,n,a){if(Gt&&ut){let l=sn.get(e);l||sn.set(e,l=new Map);let c=l.get(a);c||(l.set(a,c=new Bn),c.map=l,c.key=a),c.track()}}function re(e,n,a,l,c,h){const d=sn.get(e);if(!d){ei++;return}const o=_=>{_&&_.trigger()};if(wn(),n==="clear")d.forEach(o);else{const _=$(e),b=_&&xn(a);if(_&&a==="length"){const v=Number(l);d.forEach((x,E)=>{(E==="length"||E===ii||!Jt(E)&&E>=v)&&o(x)})}else switch((a!==void 0||d.has(void 0))&&o(d.get(a)),b&&o(d.get(ii)),n){case"add":_?b&&o(d.get("length")):(o(d.get(Se)),Pe(e)&&o(d.get(rn)));break;case"delete":_||(o(d.get(Se)),Pe(e)&&o(d.get(rn)));break;case"set":Pe(e)&&o(d.get(Se));break}}Un()}function Be(e){const n=st(e);return n===e?n:(vt(n,"iterate",ii),Vt(e)?n:n.map(Bt))}function Cn(e){return vt(e=st(e),"iterate",ii),e}const Po={__proto__:null,[Symbol.iterator](){return ji(this,Symbol.iterator,Bt)},concat(...e){return Be(this).concat(...e.map(n=>$(n)?Be(n):n))},entries(){return ji(this,"entries",e=>(e[1]=Bt(e[1]),e))},every(e,n){return ee(this,"every",e,n,void 0,arguments)},filter(e,n){return ee(this,"filter",e,n,a=>a.map(Bt),arguments)},find(e,n){return ee(this,"find",e,n,Bt,arguments)},findIndex(e,n){return ee(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return ee(this,"findLast",e,n,Bt,arguments)},findLastIndex(e,n){return ee(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return ee(this,"forEach",e,n,void 0,arguments)},includes(...e){return Ki(this,"includes",e)},indexOf(...e){return Ki(this,"indexOf",e)},join(e){return Be(this).join(e)},lastIndexOf(...e){return Ki(this,"lastIndexOf",e)},map(e,n){return ee(this,"map",e,n,void 0,arguments)},pop(){return Ne(this,"pop")},push(...e){return Ne(this,"push",e)},reduce(e,...n){return Gn(this,"reduce",e,n)},reduceRight(e,...n){return Gn(this,"reduceRight",e,n)},shift(){return Ne(this,"shift")},some(e,n){return ee(this,"some",e,n,void 0,arguments)},splice(...e){return Ne(this,"splice",e)},toReversed(){return Be(this).toReversed()},toSorted(e){return Be(this).toSorted(e)},toSpliced(...e){return Be(this).toSpliced(...e)},unshift(...e){return Ne(this,"unshift",e)},values(){return ji(this,"values",Bt)}};function ji(e,n,a){const l=Cn(e),c=l[n]();return l!==e&&!Vt(e)&&(c._next=c.next,c.next=()=>{const h=c._next();return h.value&&(h.value=a(h.value)),h}),c}const Fo=Array.prototype;function ee(e,n,a,l,c,h){const d=Cn(e),o=d!==e&&!Vt(e),_=d[n];if(_!==Fo[n]){const x=_.apply(e,h);return o?Bt(x):x}let b=a;d!==e&&(o?b=function(x,E){return a.call(this,Bt(x),E,e)}:a.length>2&&(b=function(x,E){return a.call(this,x,E,e)}));const v=_.call(d,b,l);return o&&c?c(v):v}function Gn(e,n,a,l){const c=Cn(e);let h=a;return c!==e&&(Vt(e)?a.length>3&&(h=function(d,o,_){return a.call(this,d,o,_,e)}):h=function(d,o,_){return a.call(this,d,Bt(o),_,e)}),c[n](h,...l)}function Ki(e,n,a){const l=st(e);vt(l,"iterate",ii);const c=l[n](...a);return(c===-1||c===!1)&&Pn(a[0])?(a[0]=st(a[0]),l[n](...a)):c}function Ne(e,n,a=[]){_e(),wn();const l=st(e)[n].apply(e,a);return Un(),ge(),l}const Io=yn("__proto__,__v_isRef,__isVue"),tr=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Jt));function Lo(e){Jt(e)||(e=String(e));const n=st(this);return vt(n,"has",e),n.hasOwnProperty(e)}class er{constructor(n=!1,a=!1){this._isReadonly=n,this._isShallow=a}get(n,a,l){if(a==="__v_skip")return n.__v_skip;const c=this._isReadonly,h=this._isShallow;if(a==="__v_isReactive")return!c;if(a==="__v_isReadonly")return c;if(a==="__v_isShallow")return h;if(a==="__v_raw")return l===(c?h?Vo:rr:h?sr:nr).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(l)?n:void 0;const d=$(n);if(!c){let _;if(d&&(_=Po[a]))return _;if(a==="hasOwnProperty")return Lo}const o=Reflect.get(n,a,bt(n)?n:l);return(Jt(a)?tr.has(a):Io(a))||(c||vt(n,"get",a),h)?o:bt(o)?d&&xn(a)?o:o.value:dt(o)?c?ar(o):Ri(o):o}}class ir extends er{constructor(n=!1){super(!1,n)}set(n,a,l,c){let h=n[a];if(!this._isShallow){const _=we(h);if(!Vt(l)&&!we(l)&&(h=st(h),l=st(l)),!$(n)&&bt(h)&&!bt(l))return _?!1:(h.value=l,!0)}const d=$(n)&&xn(a)?Number(a)<n.length:rt(n,a),o=Reflect.set(n,a,l,bt(n)?n:c);return n===st(c)&&(d?de(l,h)&&re(n,"set",a,l):re(n,"add",a,l)),o}deleteProperty(n,a){const l=rt(n,a);n[a];const c=Reflect.deleteProperty(n,a);return c&&l&&re(n,"delete",a,void 0),c}has(n,a){const l=Reflect.has(n,a);return(!Jt(a)||!tr.has(a))&&vt(n,"has",a),l}ownKeys(n){return vt(n,"iterate",$(n)?"length":Se),Reflect.ownKeys(n)}}class zo extends er{constructor(n=!1){super(!0,n)}set(n,a){return!0}deleteProperty(n,a){return!0}}const Ro=new ir,ko=new zo,Mo=new ir(!0);const on=e=>e,hi=e=>Reflect.getPrototypeOf(e);function Do(e,n,a){return function(...l){const c=this.__v_raw,h=st(c),d=Pe(h),o=e==="entries"||e===Symbol.iterator&&d,_=e==="keys"&&d,b=c[e](...l),v=a?on:n?an:Bt;return!n&&vt(h,"iterate",_?rn:Se),{next(){const{value:x,done:E}=b.next();return E?{value:x,done:E}:{value:o?[v(x[0]),v(x[1])]:v(x),done:E}},[Symbol.iterator](){return this}}}}function di(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function Oo(e,n){const a={get(c){const h=this.__v_raw,d=st(h),o=st(c);e||(de(c,o)&&vt(d,"get",c),vt(d,"get",o));const{has:_}=hi(d),b=n?on:e?an:Bt;if(_.call(d,c))return b(h.get(c));if(_.call(d,o))return b(h.get(o));h!==d&&h.get(c)},get size(){const c=this.__v_raw;return!e&&vt(st(c),"iterate",Se),Reflect.get(c,"size",c)},has(c){const h=this.__v_raw,d=st(h),o=st(c);return e||(de(c,o)&&vt(d,"has",c),vt(d,"has",o)),c===o?h.has(c):h.has(c)||h.has(o)},forEach(c,h){const d=this,o=d.__v_raw,_=st(o),b=n?on:e?an:Bt;return!e&&vt(_,"iterate",Se),o.forEach((v,x)=>c.call(h,b(v),b(x),d))}};return St(a,e?{add:di("add"),set:di("set"),delete:di("delete"),clear:di("clear")}:{add(c){!n&&!Vt(c)&&!we(c)&&(c=st(c));const h=st(this);return hi(h).has.call(h,c)||(h.add(c),re(h,"add",c,c)),this},set(c,h){!n&&!Vt(h)&&!we(h)&&(h=st(h));const d=st(this),{has:o,get:_}=hi(d);let b=o.call(d,c);b||(c=st(c),b=o.call(d,c));const v=_.call(d,c);return d.set(c,h),b?de(h,v)&&re(d,"set",c,h):re(d,"add",c,h),this},delete(c){const h=st(this),{has:d,get:o}=hi(h);let _=d.call(h,c);_||(c=st(c),_=d.call(h,c)),o&&o.call(h,c);const b=h.delete(c);return _&&re(h,"delete",c,void 0),b},clear(){const c=st(this),h=c.size!==0,d=c.clear();return h&&re(c,"clear",void 0,void 0),d}}),["keys","values","entries",Symbol.iterator].forEach(c=>{a[c]=Do(c,e,n)}),a}function An(e,n){const a=Oo(e,n);return(l,c,h)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?l:Reflect.get(rt(a,c)&&c in l?a:l,c,h)}const No={get:An(!1,!1)},Ho={get:An(!1,!0)},Go={get:An(!0,!1)};const nr=new WeakMap,sr=new WeakMap,rr=new WeakMap,Vo=new WeakMap;function Yo(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function jo(e){return e.__v_skip||!Object.isExtensible(e)?0:Yo(go(e))}function Ri(e){return we(e)?e:Tn(e,!1,Ro,No,nr)}function or(e){return Tn(e,!1,Mo,Ho,sr)}function ar(e){return Tn(e,!0,ko,Go,rr)}function Tn(e,n,a,l,c){if(!dt(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const h=c.get(e);if(h)return h;const d=jo(e);if(d===0)return e;const o=new Proxy(e,d===2?l:a);return c.set(e,o),o}function $e(e){return we(e)?$e(e.__v_raw):!!(e&&e.__v_isReactive)}function we(e){return!!(e&&e.__v_isReadonly)}function Vt(e){return!!(e&&e.__v_isShallow)}function Pn(e){return e?!!e.__v_raw:!1}function st(e){const n=e&&e.__v_raw;return n?st(n):e}function Ko(e){return!rt(e,"__v_skip")&&Object.isExtensible(e)&&Gs(e,"__v_skip",!0),e}const Bt=e=>dt(e)?Ri(e):e,an=e=>dt(e)?ar(e):e;function bt(e){return e?e.__v_isRef===!0:!1}function Wo(e){return lr(e,!1)}function qo(e){return lr(e,!0)}function lr(e,n){return bt(e)?e:new $o(e,n)}class $o{constructor(n,a){this.dep=new Bn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=a?n:st(n),this._value=a?n:Bt(n),this.__v_isShallow=a}get value(){return this.dep.track(),this._value}set value(n){const a=this._rawValue,l=this.__v_isShallow||Vt(n)||we(n);n=l?n:st(n),de(n,a)&&(this._rawValue=n,this._value=l?n:Bt(n),this.dep.trigger())}}function Fe(e){return bt(e)?e.value:e}const Xo={get:(e,n,a)=>n==="__v_raw"?e:Fe(Reflect.get(e,n,a)),set:(e,n,a,l)=>{const c=e[n];return bt(c)&&!bt(a)?(c.value=a,!0):Reflect.set(e,n,a,l)}};function fr(e){return $e(e)?e:new Proxy(e,Xo)}class Zo{constructor(n,a,l){this.fn=n,this.setter=a,this._value=void 0,this.dep=new Bn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ei-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!a,this.isSSR=l}notify(){if(this.flags|=16,!(this.flags&8)&&ut!==this)return qs(this,!0),!0}get value(){const n=this.dep.track();return Zs(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function Qo(e,n,a=!1){let l,c;return Z(e)?l=e:(l=e.get,c=e.set),new Zo(l,c,a)}const pi={},Si=new WeakMap;let ve;function Jo(e,n=!1,a=ve){if(a){let l=Si.get(a);l||Si.set(a,l=[]),l.push(e)}}function ta(e,n,a=ft){const{immediate:l,deep:c,once:h,scheduler:d,augmentJob:o,call:_}=a,b=u=>c?u:Vt(u)||c===!1||c===0?oe(u,1):oe(u);let v,x,E,C,U=!1,H=!1;if(bt(e)?(x=()=>e.value,U=Vt(e)):$e(e)?(x=()=>b(e),U=!0):$(e)?(H=!0,U=e.some(u=>$e(u)||Vt(u)),x=()=>e.map(u=>{if(bt(u))return u.value;if($e(u))return b(u);if(Z(u))return _?_(u,2):u()})):Z(e)?n?x=_?()=>_(e,2):e:x=()=>{if(E){_e();try{E()}finally{ge()}}const u=ve;ve=v;try{return _?_(e,3,[C]):e(C)}finally{ve=u}}:x=Zt,n&&c){const u=x,p=c===!0?1/0:c;x=()=>oe(u(),p)}const t=Co(),s=()=>{v.stop(),t&&t.active&&vn(t.effects,v)};if(h&&n){const u=n;n=(...p)=>{u(...p),s()}}let r=H?new Array(e.length).fill(pi):pi;const f=u=>{if(!(!(v.flags&1)||!v.dirty&&!u))if(n){const p=v.run();if(c||U||(H?p.some((g,S)=>de(g,r[S])):de(p,r))){E&&E();const g=ve;ve=v;try{const S=[p,r===pi?void 0:H&&r[0]===pi?[]:r,C];_?_(n,3,S):n(...S),r=p}finally{ve=g}}}else v.run()};return o&&o(f),v=new Ks(x),v.scheduler=d?()=>d(f,!1):f,C=u=>Jo(u,!1,v),E=v.onStop=()=>{const u=Si.get(v);if(u){if(_)_(u,4);else for(const p of u)p();Si.delete(v)}},n?l?f(!0):r=v.run():d?d(f.bind(null,!0),!0):v.run(),s.pause=v.pause.bind(v),s.resume=v.resume.bind(v),s.stop=s,s}function oe(e,n=1/0,a){if(n<=0||!dt(e)||e.__v_skip||(a=a||new Set,a.has(e)))return e;if(a.add(e),n--,bt(e))oe(e.value,n,a);else if($(e))for(let l=0;l<e.length;l++)oe(e[l],n,a);else if(Ds(e)||Pe(e))e.forEach(l=>{oe(l,n,a)});else if(Hs(e)){for(const l in e)oe(e[l],n,a);for(const l of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,l)&&oe(e[l],n,a)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fi(e,n,a,l){try{return l?e(...l):e()}catch(c){ki(c,n,a)}}function te(e,n,a,l){if(Z(e)){const c=fi(e,n,a,l);return c&&Os(c)&&c.catch(h=>{ki(h,n,a)}),c}if($(e)){const c=[];for(let h=0;h<e.length;h++)c.push(te(e[h],n,a,l));return c}}function ki(e,n,a,l=!0){const c=n?n.vnode:null,{errorHandler:h,throwUnhandledErrorInProduction:d}=n&&n.appContext.config||ft;if(n){let o=n.parent;const _=n.proxy,b=`https://vuejs.org/error-reference/#runtime-${a}`;for(;o;){const v=o.ec;if(v){for(let x=0;x<v.length;x++)if(v[x](e,_,b)===!1)return}o=o.parent}if(h){_e(),fi(h,null,10,[e,_,b]),ge();return}}ea(e,a,c,l,d)}function ea(e,n,a,l=!0,c=!1){if(c)throw e;console.error(e)}const Ct=[];let $t=-1;const Ie=[];let ce=null,Ce=0;const cr=Promise.resolve();let wi=null;function ur(e){const n=wi||cr;return e?n.then(this?e.bind(this):e):n}function ia(e){let n=$t+1,a=Ct.length;for(;n<a;){const l=n+a>>>1,c=Ct[l],h=ni(c);h<e||h===e&&c.flags&2?n=l+1:a=l}return n}function Fn(e){if(!(e.flags&1)){const n=ni(e),a=Ct[Ct.length-1];!a||!(e.flags&2)&&n>=ni(a)?Ct.push(e):Ct.splice(ia(n),0,e),e.flags|=1,hr()}}function hr(){wi||(wi=cr.then(pr))}function na(e){$(e)?Ie.push(...e):ce&&e.id===-1?ce.splice(Ce+1,0,e):e.flags&1||(Ie.push(e),e.flags|=1),hr()}function Vn(e,n,a=$t+1){for(;a<Ct.length;a++){const l=Ct[a];if(l&&l.flags&2){if(e&&l.id!==e.uid)continue;Ct.splice(a,1),a--,l.flags&4&&(l.flags&=-2),l(),l.flags&4||(l.flags&=-2)}}}function dr(e){if(Ie.length){const n=[...new Set(Ie)].sort((a,l)=>ni(a)-ni(l));if(Ie.length=0,ce){ce.push(...n);return}for(ce=n,Ce=0;Ce<ce.length;Ce++){const a=ce[Ce];a.flags&4&&(a.flags&=-2),a.flags&8||a(),a.flags&=-2}ce=null,Ce=0}}const ni=e=>e.id==null?e.flags&2?-1:1/0:e.id;function pr(e){try{for($t=0;$t<Ct.length;$t++){const n=Ct[$t];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),fi(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;$t<Ct.length;$t++){const n=Ct[$t];n&&(n.flags&=-2)}$t=-1,Ct.length=0,dr(),wi=null,(Ct.length||Ie.length)&&pr()}}let Rt=null,_r=null;function Ui(e){const n=Rt;return Rt=e,_r=e&&e.type.__scopeId||null,n}function Ye(e,n=Rt,a){if(!n||e._n)return e;const l=(...c)=>{l._d&&ts(-1);const h=Ui(n);let d;try{d=e(...c)}finally{Ui(h),l._d&&ts(1)}return d};return l._n=!0,l._c=!0,l._d=!0,l}function Tt(e,n){if(Rt===null)return e;const a=Ni(Rt),l=e.dirs||(e.dirs=[]);for(let c=0;c<n.length;c++){let[h,d,o,_=ft]=n[c];h&&(Z(h)&&(h={mounted:h,updated:h}),h.deep&&oe(d),l.push({dir:h,instance:a,value:d,oldValue:void 0,arg:o,modifiers:_}))}return e}function ye(e,n,a,l){const c=e.dirs,h=n&&n.dirs;for(let d=0;d<c.length;d++){const o=c[d];h&&(o.oldValue=h[d].value);let _=o.dir[l];_&&(_e(),te(_,a,8,[e.el,o,e,n]),ge())}}const sa=Symbol("_vte"),ra=e=>e.__isTeleport;function In(e,n){e.shapeFlag&6&&e.component?(e.transition=n,In(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}/*! #__NO_SIDE_EFFECTS__ */function gr(e,n){return Z(e)?St({name:e.name},n,{setup:e}):e}function yr(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Ei(e,n,a,l,c=!1){if($(e)){e.forEach((U,H)=>Ei(U,n&&($(n)?n[H]:n),a,l,c));return}if(Xe(l)&&!c){l.shapeFlag&512&&l.type.__asyncResolved&&l.component.subTree.component&&Ei(e,n,a,l.component.subTree);return}const h=l.shapeFlag&4?Ni(l.component):l.el,d=c?null:h,{i:o,r:_}=e,b=n&&n.r,v=o.refs===ft?o.refs={}:o.refs,x=o.setupState,E=st(x),C=x===ft?()=>!1:U=>rt(E,U);if(b!=null&&b!==_&&(gt(b)?(v[b]=null,C(b)&&(x[b]=null)):bt(b)&&(b.value=null)),Z(_))fi(_,o,12,[d,v]);else{const U=gt(_),H=bt(_);if(U||H){const t=()=>{if(e.f){const s=U?C(_)?x[_]:v[_]:_.value;c?$(s)&&vn(s,h):$(s)?s.includes(h)||s.push(h):U?(v[_]=[h],C(_)&&(x[_]=v[_])):(_.value=[h],e.k&&(v[e.k]=_.value))}else U?(v[_]=d,C(_)&&(x[_]=d)):H&&(_.value=d,e.k&&(v[e.k]=d))};d?(t.id=-1,Lt(t,a)):t()}}}zi().requestIdleCallback;zi().cancelIdleCallback;const Xe=e=>!!e.type.__asyncLoader,mr=e=>e.type.__isKeepAlive;function oa(e,n){vr(e,"a",n)}function aa(e,n){vr(e,"da",n)}function vr(e,n,a=xt){const l=e.__wdc||(e.__wdc=()=>{let c=a;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(Mi(n,l,a),a){let c=a.parent;for(;c&&c.parent;)mr(c.parent.vnode)&&la(l,n,a,c),c=c.parent}}function la(e,n,a,l){const c=Mi(n,e,l,!0);xr(()=>{vn(l[n],c)},a)}function Mi(e,n,a=xt,l=!1){if(a){const c=a[e]||(a[e]=[]),h=n.__weh||(n.__weh=(...d)=>{_e();const o=ci(a),_=te(n,a,e,d);return o(),ge(),_});return l?c.unshift(h):c.push(h),h}}const le=e=>(n,a=xt)=>{(!ri||e==="sp")&&Mi(e,(...l)=>n(...l),a)},fa=le("bm"),ca=le("m"),ua=le("bu"),ha=le("u"),da=le("bum"),xr=le("um"),pa=le("sp"),_a=le("rtg"),ga=le("rtc");function ya(e,n=xt){Mi("ec",e,n)}const ma="components";function Yn(e,n){return xa(ma,e,!0,n)||e}const va=Symbol.for("v-ndc");function xa(e,n,a=!0,l=!1){const c=Rt||xt;if(c){const h=c.type;{const o=al(h,!1);if(o&&(o===n||o===Nt(n)||o===Li(Nt(n))))return h}const d=jn(c[e]||h[e],n)||jn(c.appContext[e],n);return!d&&l?h:d}}function jn(e,n){return e&&(e[n]||e[Nt(n)]||e[Li(Nt(n))])}const ln=e=>e?Gr(e)?Ni(e):ln(e.parent):null,Ze=St(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ln(e.parent),$root:e=>ln(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Sr(e),$forceUpdate:e=>e.f||(e.f=()=>{Fn(e.update)}),$nextTick:e=>e.n||(e.n=ur.bind(e.proxy)),$watch:e=>Ha.bind(e)}),Wi=(e,n)=>e!==ft&&!e.__isScriptSetup&&rt(e,n),ba={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:a,setupState:l,data:c,props:h,accessCache:d,type:o,appContext:_}=e;let b;if(n[0]!=="$"){const C=d[n];if(C!==void 0)switch(C){case 1:return l[n];case 2:return c[n];case 4:return a[n];case 3:return h[n]}else{if(Wi(l,n))return d[n]=1,l[n];if(c!==ft&&rt(c,n))return d[n]=2,c[n];if((b=e.propsOptions[0])&&rt(b,n))return d[n]=3,h[n];if(a!==ft&&rt(a,n))return d[n]=4,a[n];fn&&(d[n]=0)}}const v=Ze[n];let x,E;if(v)return n==="$attrs"&&vt(e.attrs,"get",""),v(e);if((x=o.__cssModules)&&(x=x[n]))return x;if(a!==ft&&rt(a,n))return d[n]=4,a[n];if(E=_.config.globalProperties,rt(E,n))return E[n]},set({_:e},n,a){const{data:l,setupState:c,ctx:h}=e;return Wi(c,n)?(c[n]=a,!0):l!==ft&&rt(l,n)?(l[n]=a,!0):rt(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(h[n]=a,!0)},has({_:{data:e,setupState:n,accessCache:a,ctx:l,appContext:c,propsOptions:h}},d){let o;return!!a[d]||e!==ft&&rt(e,d)||Wi(n,d)||(o=h[0])&&rt(o,d)||rt(l,d)||rt(Ze,d)||rt(c.config.globalProperties,d)},defineProperty(e,n,a){return a.get!=null?e._.accessCache[n]=0:rt(a,"value")&&this.set(e,n,a.value,null),Reflect.defineProperty(e,n,a)}};function Kn(e){return $(e)?e.reduce((n,a)=>(n[a]=null,n),{}):e}let fn=!0;function Sa(e){const n=Sr(e),a=e.proxy,l=e.ctx;fn=!1,n.beforeCreate&&Wn(n.beforeCreate,e,"bc");const{data:c,computed:h,methods:d,watch:o,provide:_,inject:b,created:v,beforeMount:x,mounted:E,beforeUpdate:C,updated:U,activated:H,deactivated:t,beforeDestroy:s,beforeUnmount:r,destroyed:f,unmounted:u,render:p,renderTracked:g,renderTriggered:S,errorCaptured:B,serverPrefetch:A,expose:I,inheritAttrs:R,components:K,directives:D,filters:at}=n;if(b&&wa(b,l,null),d)for(const tt in d){const J=d[tt];Z(J)&&(l[tt]=J.bind(a))}if(c){const tt=c.call(a,a);dt(tt)&&(e.data=Ri(tt))}if(fn=!0,h)for(const tt in h){const J=h[tt],pt=Z(J)?J.bind(a,a):Z(J.get)?J.get.bind(a,a):Zt,mt=!Z(J)&&Z(J.set)?J.set.bind(a):Zt,wt=Ht({get:pt,set:mt});Object.defineProperty(l,tt,{enumerable:!0,configurable:!0,get:()=>wt.value,set:yt=>wt.value=yt})}if(o)for(const tt in o)br(o[tt],l,a,tt);if(_){const tt=Z(_)?_.call(a):_;Reflect.ownKeys(tt).forEach(J=>{gi(J,tt[J])})}v&&Wn(v,e,"c");function ht(tt,J){$(J)?J.forEach(pt=>tt(pt.bind(a))):J&&tt(J.bind(a))}if(ht(fa,x),ht(ca,E),ht(ua,C),ht(ha,U),ht(oa,H),ht(aa,t),ht(ya,B),ht(ga,g),ht(_a,S),ht(da,r),ht(xr,u),ht(pa,A),$(I))if(I.length){const tt=e.exposed||(e.exposed={});I.forEach(J=>{Object.defineProperty(tt,J,{get:()=>a[J],set:pt=>a[J]=pt})})}else e.exposed||(e.exposed={});p&&e.render===Zt&&(e.render=p),R!=null&&(e.inheritAttrs=R),K&&(e.components=K),D&&(e.directives=D),A&&yr(e)}function wa(e,n,a=Zt){$(e)&&(e=cn(e));for(const l in e){const c=e[l];let h;dt(c)?"default"in c?h=ae(c.from||l,c.default,!0):h=ae(c.from||l):h=ae(c),bt(h)?Object.defineProperty(n,l,{enumerable:!0,configurable:!0,get:()=>h.value,set:d=>h.value=d}):n[l]=h}}function Wn(e,n,a){te($(e)?e.map(l=>l.bind(n.proxy)):e.bind(n.proxy),n,a)}function br(e,n,a,l){let c=l.includes(".")?kr(a,l):()=>a[l];if(gt(e)){const h=n[e];Z(h)&&yi(c,h)}else if(Z(e))yi(c,e.bind(a));else if(dt(e))if($(e))e.forEach(h=>br(h,n,a,l));else{const h=Z(e.handler)?e.handler.bind(a):n[e.handler];Z(h)&&yi(c,h,e)}}function Sr(e){const n=e.type,{mixins:a,extends:l}=n,{mixins:c,optionsCache:h,config:{optionMergeStrategies:d}}=e.appContext,o=h.get(n);let _;return o?_=o:!c.length&&!a&&!l?_=n:(_={},c.length&&c.forEach(b=>Bi(_,b,d,!0)),Bi(_,n,d)),dt(n)&&h.set(n,_),_}function Bi(e,n,a,l=!1){const{mixins:c,extends:h}=n;h&&Bi(e,h,a,!0),c&&c.forEach(d=>Bi(e,d,a,!0));for(const d in n)if(!(l&&d==="expose")){const o=Ua[d]||a&&a[d];e[d]=o?o(e[d],n[d]):n[d]}return e}const Ua={data:qn,props:$n,emits:$n,methods:je,computed:je,beforeCreate:Et,created:Et,beforeMount:Et,mounted:Et,beforeUpdate:Et,updated:Et,beforeDestroy:Et,beforeUnmount:Et,destroyed:Et,unmounted:Et,activated:Et,deactivated:Et,errorCaptured:Et,serverPrefetch:Et,components:je,directives:je,watch:Ba,provide:qn,inject:Ea};function qn(e,n){return n?e?function(){return St(Z(e)?e.call(this,this):e,Z(n)?n.call(this,this):n)}:n:e}function Ea(e,n){return je(cn(e),cn(n))}function cn(e){if($(e)){const n={};for(let a=0;a<e.length;a++)n[e[a]]=e[a];return n}return e}function Et(e,n){return e?[...new Set([].concat(e,n))]:n}function je(e,n){return e?St(Object.create(null),e,n):n}function $n(e,n){return e?$(e)&&$(n)?[...new Set([...e,...n])]:St(Object.create(null),Kn(e),Kn(n??{})):n}function Ba(e,n){if(!e)return n;if(!n)return e;const a=St(Object.create(null),e);for(const l in n)a[l]=Et(e[l],n[l]);return a}function wr(){return{app:null,config:{isNativeTag:po,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Ca=0;function Aa(e,n){return function(l,c=null){Z(l)||(l=St({},l)),c!=null&&!dt(c)&&(c=null);const h=wr(),d=new WeakSet,o=[];let _=!1;const b=h.app={_uid:Ca++,_component:l,_props:c,_container:null,_context:h,_instance:null,version:fl,get config(){return h.config},set config(v){},use(v,...x){return d.has(v)||(v&&Z(v.install)?(d.add(v),v.install(b,...x)):Z(v)&&(d.add(v),v(b,...x))),b},mixin(v){return h.mixins.includes(v)||h.mixins.push(v),b},component(v,x){return x?(h.components[v]=x,b):h.components[v]},directive(v,x){return x?(h.directives[v]=x,b):h.directives[v]},mount(v,x,E){if(!_){const C=b._ceVNode||_t(l,c);return C.appContext=h,E===!0?E="svg":E===!1&&(E=void 0),e(C,v,E),_=!0,b._container=v,v.__vue_app__=b,Ni(C.component)}},onUnmount(v){o.push(v)},unmount(){_&&(te(o,b._instance,16),e(null,b._container),delete b._container.__vue_app__)},provide(v,x){return h.provides[v]=x,b},runWithContext(v){const x=Le;Le=b;try{return v()}finally{Le=x}}};return b}}let Le=null;function gi(e,n){if(xt){let a=xt.provides;const l=xt.parent&&xt.parent.provides;l===a&&(a=xt.provides=Object.create(l)),a[e]=n}}function ae(e,n,a=!1){const l=xt||Rt;if(l||Le){const c=Le?Le._context.provides:l?l.parent==null?l.vnode.appContext&&l.vnode.appContext.provides:l.parent.provides:void 0;if(c&&e in c)return c[e];if(arguments.length>1)return a&&Z(n)?n.call(l&&l.proxy):n}}const Ur={},Er=()=>Object.create(Ur),Br=e=>Object.getPrototypeOf(e)===Ur;function Ta(e,n,a,l=!1){const c={},h=Er();e.propsDefaults=Object.create(null),Cr(e,n,c,h);for(const d in e.propsOptions[0])d in c||(c[d]=void 0);a?e.props=l?c:or(c):e.type.props?e.props=c:e.props=h,e.attrs=h}function Pa(e,n,a,l){const{props:c,attrs:h,vnode:{patchFlag:d}}=e,o=st(c),[_]=e.propsOptions;let b=!1;if((l||d>0)&&!(d&16)){if(d&8){const v=e.vnode.dynamicProps;for(let x=0;x<v.length;x++){let E=v[x];if(Di(e.emitsOptions,E))continue;const C=n[E];if(_)if(rt(h,E))C!==h[E]&&(h[E]=C,b=!0);else{const U=Nt(E);c[U]=un(_,o,U,C,e,!1)}else C!==h[E]&&(h[E]=C,b=!0)}}}else{Cr(e,n,c,h)&&(b=!0);let v;for(const x in o)(!n||!rt(n,x)&&((v=Ee(x))===x||!rt(n,v)))&&(_?a&&(a[x]!==void 0||a[v]!==void 0)&&(c[x]=un(_,o,x,void 0,e,!0)):delete c[x]);if(h!==o)for(const x in h)(!n||!rt(n,x))&&(delete h[x],b=!0)}b&&re(e.attrs,"set","")}function Cr(e,n,a,l){const[c,h]=e.propsOptions;let d=!1,o;if(n)for(let _ in n){if(Ke(_))continue;const b=n[_];let v;c&&rt(c,v=Nt(_))?!h||!h.includes(v)?a[v]=b:(o||(o={}))[v]=b:Di(e.emitsOptions,_)||(!(_ in l)||b!==l[_])&&(l[_]=b,d=!0)}if(h){const _=st(a),b=o||ft;for(let v=0;v<h.length;v++){const x=h[v];a[x]=un(c,_,x,b[x],e,!rt(b,x))}}return d}function un(e,n,a,l,c,h){const d=e[a];if(d!=null){const o=rt(d,"default");if(o&&l===void 0){const _=d.default;if(d.type!==Function&&!d.skipFactory&&Z(_)){const{propsDefaults:b}=c;if(a in b)l=b[a];else{const v=ci(c);l=b[a]=_.call(null,n),v()}}else l=_;c.ce&&c.ce._setProp(a,l)}d[0]&&(h&&!o?l=!1:d[1]&&(l===""||l===Ee(a))&&(l=!0))}return l}const Fa=new WeakMap;function Ar(e,n,a=!1){const l=a?Fa:n.propsCache,c=l.get(e);if(c)return c;const h=e.props,d={},o=[];let _=!1;if(!Z(e)){const v=x=>{_=!0;const[E,C]=Ar(x,n,!0);St(d,E),C&&o.push(...C)};!a&&n.mixins.length&&n.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}if(!h&&!_)return dt(e)&&l.set(e,Te),Te;if($(h))for(let v=0;v<h.length;v++){const x=Nt(h[v]);Xn(x)&&(d[x]=ft)}else if(h)for(const v in h){const x=Nt(v);if(Xn(x)){const E=h[v],C=d[x]=$(E)||Z(E)?{type:E}:St({},E),U=C.type;let H=!1,t=!0;if($(U))for(let s=0;s<U.length;++s){const r=U[s],f=Z(r)&&r.name;if(f==="Boolean"){H=!0;break}else f==="String"&&(t=!1)}else H=Z(U)&&U.name==="Boolean";C[0]=H,C[1]=t,(H||rt(C,"default"))&&o.push(x)}}const b=[d,o];return dt(e)&&l.set(e,b),b}function Xn(e){return e[0]!=="$"&&!Ke(e)}const Tr=e=>e[0]==="_"||e==="$stable",Ln=e=>$(e)?e.map(Xt):[Xt(e)],Ia=(e,n,a)=>{if(n._n)return n;const l=Ye((...c)=>Ln(n(...c)),a);return l._c=!1,l},Pr=(e,n,a)=>{const l=e._ctx;for(const c in e){if(Tr(c))continue;const h=e[c];if(Z(h))n[c]=Ia(c,h,l);else if(h!=null){const d=Ln(h);n[c]=()=>d}}},Fr=(e,n)=>{const a=Ln(n);e.slots.default=()=>a},Ir=(e,n,a)=>{for(const l in n)(a||l!=="_")&&(e[l]=n[l])},La=(e,n,a)=>{const l=e.slots=Er();if(e.vnode.shapeFlag&32){const c=n._;c?(Ir(l,n,a),a&&Gs(l,"_",c,!0)):Pr(n,l)}else n&&Fr(e,n)},za=(e,n,a)=>{const{vnode:l,slots:c}=e;let h=!0,d=ft;if(l.shapeFlag&32){const o=n._;o?a&&o===1?h=!1:Ir(c,n,a):(h=!n.$stable,Pr(n,c)),d=n}else n&&(Fr(e,n),d={default:1});if(h)for(const o in c)!Tr(o)&&d[o]==null&&delete c[o]},Lt=qa;function Ra(e){return ka(e)}function ka(e,n){const a=zi();a.__VUE__=!0;const{insert:l,remove:c,patchProp:h,createElement:d,createText:o,createComment:_,setText:b,setElementText:v,parentNode:x,nextSibling:E,setScopeId:C=Zt,insertStaticContent:U}=e,H=(y,m,w,T=null,L=null,F=null,O=void 0,M=null,k=!!m.dynamicChildren)=>{if(y===m)return;y&&!He(y,m)&&(T=P(y),yt(y,L,F,!0),y=null),m.patchFlag===-2&&(k=!1,m.dynamicChildren=null);const{type:z,ref:q,shapeFlag:G}=m;switch(z){case Oi:t(y,m,w,T);break;case Ue:s(y,m,w,T);break;case mi:y==null&&r(m,w,T,O);break;case se:K(y,m,w,T,L,F,O,M,k);break;default:G&1?p(y,m,w,T,L,F,O,M,k):G&6?D(y,m,w,T,L,F,O,M,k):(G&64||G&128)&&z.process(y,m,w,T,L,F,O,M,k,j)}q!=null&&L&&Ei(q,y&&y.ref,F,m||y,!m)},t=(y,m,w,T)=>{if(y==null)l(m.el=o(m.children),w,T);else{const L=m.el=y.el;m.children!==y.children&&b(L,m.children)}},s=(y,m,w,T)=>{y==null?l(m.el=_(m.children||""),w,T):m.el=y.el},r=(y,m,w,T)=>{[y.el,y.anchor]=U(y.children,m,w,T,y.el,y.anchor)},f=({el:y,anchor:m},w,T)=>{let L;for(;y&&y!==m;)L=E(y),l(y,w,T),y=L;l(m,w,T)},u=({el:y,anchor:m})=>{let w;for(;y&&y!==m;)w=E(y),c(y),y=w;c(m)},p=(y,m,w,T,L,F,O,M,k)=>{m.type==="svg"?O="svg":m.type==="math"&&(O="mathml"),y==null?g(m,w,T,L,F,O,M,k):A(y,m,L,F,O,M,k)},g=(y,m,w,T,L,F,O,M)=>{let k,z;const{props:q,shapeFlag:G,transition:W,dirs:X}=y;if(k=y.el=d(y.type,F,q&&q.is,q),G&8?v(k,y.children):G&16&&B(y.children,k,null,T,L,qi(y,F),O,M),X&&ye(y,null,T,"created"),S(k,y,y.scopeId,O,T),q){for(const ct in q)ct!=="value"&&!Ke(ct)&&h(k,ct,null,q[ct],F,T);"value"in q&&h(k,"value",null,q.value,F),(z=q.onVnodeBeforeMount)&&qt(z,T,y)}X&&ye(y,null,T,"beforeMount");const et=Ma(L,W);et&&W.beforeEnter(k),l(k,m,w),((z=q&&q.onVnodeMounted)||et||X)&&Lt(()=>{z&&qt(z,T,y),et&&W.enter(k),X&&ye(y,null,T,"mounted")},L)},S=(y,m,w,T,L)=>{if(w&&C(y,w),T)for(let F=0;F<T.length;F++)C(y,T[F]);if(L){let F=L.subTree;if(m===F||Dr(F.type)&&(F.ssContent===m||F.ssFallback===m)){const O=L.vnode;S(y,O,O.scopeId,O.slotScopeIds,L.parent)}}},B=(y,m,w,T,L,F,O,M,k=0)=>{for(let z=k;z<y.length;z++){const q=y[z]=M?ue(y[z]):Xt(y[z]);H(null,q,m,w,T,L,F,O,M)}},A=(y,m,w,T,L,F,O)=>{const M=m.el=y.el;let{patchFlag:k,dynamicChildren:z,dirs:q}=m;k|=y.patchFlag&16;const G=y.props||ft,W=m.props||ft;let X;if(w&&me(w,!1),(X=W.onVnodeBeforeUpdate)&&qt(X,w,m,y),q&&ye(m,y,w,"beforeUpdate"),w&&me(w,!0),(G.innerHTML&&W.innerHTML==null||G.textContent&&W.textContent==null)&&v(M,""),z?I(y.dynamicChildren,z,M,w,T,qi(m,L),F):O||J(y,m,M,null,w,T,qi(m,L),F,!1),k>0){if(k&16)R(M,G,W,w,L);else if(k&2&&G.class!==W.class&&h(M,"class",null,W.class,L),k&4&&h(M,"style",G.style,W.style,L),k&8){const et=m.dynamicProps;for(let ct=0;ct<et.length;ct++){const ot=et[ct],Ft=G[ot],At=W[ot];(At!==Ft||ot==="value")&&h(M,ot,Ft,At,L,w)}}k&1&&y.children!==m.children&&v(M,m.children)}else!O&&z==null&&R(M,G,W,w,L);((X=W.onVnodeUpdated)||q)&&Lt(()=>{X&&qt(X,w,m,y),q&&ye(m,y,w,"updated")},T)},I=(y,m,w,T,L,F,O)=>{for(let M=0;M<m.length;M++){const k=y[M],z=m[M],q=k.el&&(k.type===se||!He(k,z)||k.shapeFlag&70)?x(k.el):w;H(k,z,q,null,T,L,F,O,!0)}},R=(y,m,w,T,L)=>{if(m!==w){if(m!==ft)for(const F in m)!Ke(F)&&!(F in w)&&h(y,F,m[F],null,L,T);for(const F in w){if(Ke(F))continue;const O=w[F],M=m[F];O!==M&&F!=="value"&&h(y,F,M,O,L,T)}"value"in w&&h(y,"value",m.value,w.value,L)}},K=(y,m,w,T,L,F,O,M,k)=>{const z=m.el=y?y.el:o(""),q=m.anchor=y?y.anchor:o("");let{patchFlag:G,dynamicChildren:W,slotScopeIds:X}=m;X&&(M=M?M.concat(X):X),y==null?(l(z,w,T),l(q,w,T),B(m.children||[],w,q,L,F,O,M,k)):G>0&&G&64&&W&&y.dynamicChildren?(I(y.dynamicChildren,W,w,L,F,O,M),(m.key!=null||L&&m===L.subTree)&&Lr(y,m,!0)):J(y,m,w,q,L,F,O,M,k)},D=(y,m,w,T,L,F,O,M,k)=>{m.slotScopeIds=M,y==null?m.shapeFlag&512?L.ctx.activate(m,w,T,O,k):at(m,w,T,L,F,O,k):it(y,m,k)},at=(y,m,w,T,L,F,O)=>{const M=y.component=il(y,T,L);if(mr(y)&&(M.ctx.renderer=j),nl(M,!1,O),M.asyncDep){if(L&&L.registerDep(M,ht,O),!y.el){const k=M.subTree=_t(Ue);s(null,k,m,w)}}else ht(M,y,m,w,L,F,O)},it=(y,m,w)=>{const T=m.component=y.component;if(Ka(y,m,w))if(T.asyncDep&&!T.asyncResolved){tt(T,m,w);return}else T.next=m,T.update();else m.el=y.el,T.vnode=m},ht=(y,m,w,T,L,F,O)=>{const M=()=>{if(y.isMounted){let{next:G,bu:W,u:X,parent:et,vnode:ct}=y;{const Kt=zr(y);if(Kt){G&&(G.el=ct.el,tt(y,G,O)),Kt.asyncDep.then(()=>{y.isUnmounted||M()});return}}let ot=G,Ft;me(y,!1),G?(G.el=ct.el,tt(y,G,O)):G=ct,W&&_i(W),(Ft=G.props&&G.props.onVnodeBeforeUpdate)&&qt(Ft,et,G,ct),me(y,!0);const At=Qn(y),jt=y.subTree;y.subTree=At,H(jt,At,x(jt.el),P(jt),y,L,F),G.el=At.el,ot===null&&Wa(y,At.el),X&&Lt(X,L),(Ft=G.props&&G.props.onVnodeUpdated)&&Lt(()=>qt(Ft,et,G,ct),L)}else{let G;const{el:W,props:X}=m,{bm:et,m:ct,parent:ot,root:Ft,type:At}=y,jt=Xe(m);me(y,!1),et&&_i(et),!jt&&(G=X&&X.onVnodeBeforeMount)&&qt(G,ot,m),me(y,!0);{Ft.ce&&Ft.ce._injectChildStyle(At);const Kt=y.subTree=Qn(y);H(null,Kt,w,T,y,L,F),m.el=Kt.el}if(ct&&Lt(ct,L),!jt&&(G=X&&X.onVnodeMounted)){const Kt=m;Lt(()=>qt(G,ot,Kt),L)}(m.shapeFlag&256||ot&&Xe(ot.vnode)&&ot.vnode.shapeFlag&256)&&y.a&&Lt(y.a,L),y.isMounted=!0,m=w=T=null}};y.scope.on();const k=y.effect=new Ks(M);y.scope.off();const z=y.update=k.run.bind(k),q=y.job=k.runIfDirty.bind(k);q.i=y,q.id=y.uid,k.scheduler=()=>Fn(q),me(y,!0),z()},tt=(y,m,w)=>{m.component=y;const T=y.vnode.props;y.vnode=m,y.next=null,Pa(y,m.props,T,w),za(y,m.children,w),_e(),Vn(y),ge()},J=(y,m,w,T,L,F,O,M,k=!1)=>{const z=y&&y.children,q=y?y.shapeFlag:0,G=m.children,{patchFlag:W,shapeFlag:X}=m;if(W>0){if(W&128){mt(z,G,w,T,L,F,O,M,k);return}else if(W&256){pt(z,G,w,T,L,F,O,M,k);return}}X&8?(q&16&&Ot(z,L,F),G!==z&&v(w,G)):q&16?X&16?mt(z,G,w,T,L,F,O,M,k):Ot(z,L,F,!0):(q&8&&v(w,""),X&16&&B(G,w,T,L,F,O,M,k))},pt=(y,m,w,T,L,F,O,M,k)=>{y=y||Te,m=m||Te;const z=y.length,q=m.length,G=Math.min(z,q);let W;for(W=0;W<G;W++){const X=m[W]=k?ue(m[W]):Xt(m[W]);H(y[W],X,w,null,L,F,O,M,k)}z>q?Ot(y,L,F,!0,!1,G):B(m,w,T,L,F,O,M,k,G)},mt=(y,m,w,T,L,F,O,M,k)=>{let z=0;const q=m.length;let G=y.length-1,W=q-1;for(;z<=G&&z<=W;){const X=y[z],et=m[z]=k?ue(m[z]):Xt(m[z]);if(He(X,et))H(X,et,w,null,L,F,O,M,k);else break;z++}for(;z<=G&&z<=W;){const X=y[G],et=m[W]=k?ue(m[W]):Xt(m[W]);if(He(X,et))H(X,et,w,null,L,F,O,M,k);else break;G--,W--}if(z>G){if(z<=W){const X=W+1,et=X<q?m[X].el:T;for(;z<=W;)H(null,m[z]=k?ue(m[z]):Xt(m[z]),w,et,L,F,O,M,k),z++}}else if(z>W)for(;z<=G;)yt(y[z],L,F,!0),z++;else{const X=z,et=z,ct=new Map;for(z=et;z<=W;z++){const It=m[z]=k?ue(m[z]):Xt(m[z]);It.key!=null&&ct.set(It.key,z)}let ot,Ft=0;const At=W-et+1;let jt=!1,Kt=0;const Oe=new Array(At);for(z=0;z<At;z++)Oe[z]=0;for(z=X;z<=G;z++){const It=y[z];if(Ft>=At){yt(It,L,F,!0);continue}let Wt;if(It.key!=null)Wt=ct.get(It.key);else for(ot=et;ot<=W;ot++)if(Oe[ot-et]===0&&He(It,m[ot])){Wt=ot;break}Wt===void 0?yt(It,L,F,!0):(Oe[Wt-et]=z+1,Wt>=Kt?Kt=Wt:jt=!0,H(It,m[Wt],w,null,L,F,O,M,k),Ft++)}const Mn=jt?Da(Oe):Te;for(ot=Mn.length-1,z=At-1;z>=0;z--){const It=et+z,Wt=m[It],Dn=It+1<q?m[It+1].el:T;Oe[z]===0?H(null,Wt,w,Dn,L,F,O,M,k):jt&&(ot<0||z!==Mn[ot]?wt(Wt,w,Dn,2):ot--)}}},wt=(y,m,w,T,L=null)=>{const{el:F,type:O,transition:M,children:k,shapeFlag:z}=y;if(z&6){wt(y.component.subTree,m,w,T);return}if(z&128){y.suspense.move(m,w,T);return}if(z&64){O.move(y,m,w,j);return}if(O===se){l(F,m,w);for(let G=0;G<k.length;G++)wt(k[G],m,w,T);l(y.anchor,m,w);return}if(O===mi){f(y,m,w);return}if(T!==2&&z&1&&M)if(T===0)M.beforeEnter(F),l(F,m,w),Lt(()=>M.enter(F),L);else{const{leave:G,delayLeave:W,afterLeave:X}=M,et=()=>l(F,m,w),ct=()=>{G(F,()=>{et(),X&&X()})};W?W(F,et,ct):ct()}else l(F,m,w)},yt=(y,m,w,T=!1,L=!1)=>{const{type:F,props:O,ref:M,children:k,dynamicChildren:z,shapeFlag:q,patchFlag:G,dirs:W,cacheIndex:X}=y;if(G===-2&&(L=!1),M!=null&&Ei(M,null,w,y,!0),X!=null&&(m.renderCache[X]=void 0),q&256){m.ctx.deactivate(y);return}const et=q&1&&W,ct=!Xe(y);let ot;if(ct&&(ot=O&&O.onVnodeBeforeUnmount)&&qt(ot,m,y),q&6)Q(y.component,w,T);else{if(q&128){y.suspense.unmount(w,T);return}et&&ye(y,null,m,"beforeUnmount"),q&64?y.type.remove(y,m,w,j,T):z&&!z.hasOnce&&(F!==se||G>0&&G&64)?Ot(z,m,w,!1,!0):(F===se&&G&384||!L&&q&16)&&Ot(k,m,w),T&&Ut(y)}(ct&&(ot=O&&O.onVnodeUnmounted)||et)&&Lt(()=>{ot&&qt(ot,m,y),et&&ye(y,null,m,"unmounted")},w)},Ut=y=>{const{type:m,el:w,anchor:T,transition:L}=y;if(m===se){Dt(w,T);return}if(m===mi){u(y);return}const F=()=>{c(w),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(y.shapeFlag&1&&L&&!L.persisted){const{leave:O,delayLeave:M}=L,k=()=>O(w,F);M?M(y.el,F,k):k()}else F()},Dt=(y,m)=>{let w;for(;y!==m;)w=E(y),c(y),y=w;c(m)},Q=(y,m,w)=>{const{bum:T,scope:L,job:F,subTree:O,um:M,m:k,a:z}=y;Zn(k),Zn(z),T&&_i(T),L.stop(),F&&(F.flags|=8,yt(O,y,m,w)),M&&Lt(M,m),Lt(()=>{y.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Ot=(y,m,w,T=!1,L=!1,F=0)=>{for(let O=F;O<y.length;O++)yt(y[O],m,w,T,L)},P=y=>{if(y.shapeFlag&6)return P(y.component.subTree);if(y.shapeFlag&128)return y.suspense.next();const m=E(y.anchor||y.el),w=m&&m[sa];return w?E(w):m};let V=!1;const N=(y,m,w)=>{y==null?m._vnode&&yt(m._vnode,null,null,!0):H(m._vnode||null,y,m,null,null,null,w),m._vnode=y,V||(V=!0,Vn(),dr(),V=!1)},j={p:H,um:yt,m:wt,r:Ut,mt:at,mc:B,pc:J,pbc:I,n:P,o:e};return{render:N,hydrate:void 0,createApp:Aa(N)}}function qi({type:e,props:n},a){return a==="svg"&&e==="foreignObject"||a==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:a}function me({effect:e,job:n},a){a?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function Ma(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function Lr(e,n,a=!1){const l=e.children,c=n.children;if($(l)&&$(c))for(let h=0;h<l.length;h++){const d=l[h];let o=c[h];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=c[h]=ue(c[h]),o.el=d.el),!a&&o.patchFlag!==-2&&Lr(d,o)),o.type===Oi&&(o.el=d.el)}}function Da(e){const n=e.slice(),a=[0];let l,c,h,d,o;const _=e.length;for(l=0;l<_;l++){const b=e[l];if(b!==0){if(c=a[a.length-1],e[c]<b){n[l]=c,a.push(l);continue}for(h=0,d=a.length-1;h<d;)o=h+d>>1,e[a[o]]<b?h=o+1:d=o;b<e[a[h]]&&(h>0&&(n[l]=a[h-1]),a[h]=l)}}for(h=a.length,d=a[h-1];h-- >0;)a[h]=d,d=n[d];return a}function zr(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:zr(n)}function Zn(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}const Oa=Symbol.for("v-scx"),Na=()=>ae(Oa);function yi(e,n,a){return Rr(e,n,a)}function Rr(e,n,a=ft){const{immediate:l,deep:c,flush:h,once:d}=a,o=St({},a),_=n&&l||!n&&h!=="post";let b;if(ri){if(h==="sync"){const C=Na();b=C.__watcherHandles||(C.__watcherHandles=[])}else if(!_){const C=()=>{};return C.stop=Zt,C.resume=Zt,C.pause=Zt,C}}const v=xt;o.call=(C,U,H)=>te(C,v,U,H);let x=!1;h==="post"?o.scheduler=C=>{Lt(C,v&&v.suspense)}:h!=="sync"&&(x=!0,o.scheduler=(C,U)=>{U?C():Fn(C)}),o.augmentJob=C=>{n&&(C.flags|=4),x&&(C.flags|=2,v&&(C.id=v.uid,C.i=v))};const E=ta(e,n,o);return ri&&(b?b.push(E):_&&E()),E}function Ha(e,n,a){const l=this.proxy,c=gt(e)?e.includes(".")?kr(l,e):()=>l[e]:e.bind(l,l);let h;Z(n)?h=n:(h=n.handler,a=n);const d=ci(this),o=Rr(c,h.bind(l),a);return d(),o}function kr(e,n){const a=n.split(".");return()=>{let l=e;for(let c=0;c<a.length&&l;c++)l=l[a[c]];return l}}const Ga=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${Nt(n)}Modifiers`]||e[`${Ee(n)}Modifiers`];function Va(e,n,...a){if(e.isUnmounted)return;const l=e.vnode.props||ft;let c=a;const h=n.startsWith("update:"),d=h&&Ga(l,n.slice(7));d&&(d.trim&&(c=a.map(v=>gt(v)?v.trim():v)),d.number&&(c=a.map(en)));let o,_=l[o=Gi(n)]||l[o=Gi(Nt(n))];!_&&h&&(_=l[o=Gi(Ee(n))]),_&&te(_,e,6,c);const b=l[o+"Once"];if(b){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,te(b,e,6,c)}}function Mr(e,n,a=!1){const l=n.emitsCache,c=l.get(e);if(c!==void 0)return c;const h=e.emits;let d={},o=!1;if(!Z(e)){const _=b=>{const v=Mr(b,n,!0);v&&(o=!0,St(d,v))};!a&&n.mixins.length&&n.mixins.forEach(_),e.extends&&_(e.extends),e.mixins&&e.mixins.forEach(_)}return!h&&!o?(dt(e)&&l.set(e,null),null):($(h)?h.forEach(_=>d[_]=null):St(d,h),dt(e)&&l.set(e,d),d)}function Di(e,n){return!e||!Fi(n)?!1:(n=n.slice(2).replace(/Once$/,""),rt(e,n[0].toLowerCase()+n.slice(1))||rt(e,Ee(n))||rt(e,n))}function Qn(e){const{type:n,vnode:a,proxy:l,withProxy:c,propsOptions:[h],slots:d,attrs:o,emit:_,render:b,renderCache:v,props:x,data:E,setupState:C,ctx:U,inheritAttrs:H}=e,t=Ui(e);let s,r;try{if(a.shapeFlag&4){const u=c||l,p=u;s=Xt(b.call(p,u,v,x,C,E,U)),r=o}else{const u=n;s=Xt(u.length>1?u(x,{attrs:o,slots:d,emit:_}):u(x,null)),r=n.props?o:Ya(o)}}catch(u){Qe.length=0,ki(u,e,1),s=_t(Ue)}let f=s;if(r&&H!==!1){const u=Object.keys(r),{shapeFlag:p}=f;u.length&&p&7&&(h&&u.some(mn)&&(r=ja(r,h)),f=ke(f,r,!1,!0))}return a.dirs&&(f=ke(f,null,!1,!0),f.dirs=f.dirs?f.dirs.concat(a.dirs):a.dirs),a.transition&&In(f,a.transition),s=f,Ui(t),s}const Ya=e=>{let n;for(const a in e)(a==="class"||a==="style"||Fi(a))&&((n||(n={}))[a]=e[a]);return n},ja=(e,n)=>{const a={};for(const l in e)(!mn(l)||!(l.slice(9)in n))&&(a[l]=e[l]);return a};function Ka(e,n,a){const{props:l,children:c,component:h}=e,{props:d,children:o,patchFlag:_}=n,b=h.emitsOptions;if(n.dirs||n.transition)return!0;if(a&&_>=0){if(_&1024)return!0;if(_&16)return l?Jn(l,d,b):!!d;if(_&8){const v=n.dynamicProps;for(let x=0;x<v.length;x++){const E=v[x];if(d[E]!==l[E]&&!Di(b,E))return!0}}}else return(c||o)&&(!o||!o.$stable)?!0:l===d?!1:l?d?Jn(l,d,b):!0:!!d;return!1}function Jn(e,n,a){const l=Object.keys(n);if(l.length!==Object.keys(e).length)return!0;for(let c=0;c<l.length;c++){const h=l[c];if(n[h]!==e[h]&&!Di(a,h))return!0}return!1}function Wa({vnode:e,parent:n},a){for(;n;){const l=n.subTree;if(l.suspense&&l.suspense.activeBranch===e&&(l.el=e.el),l===e)(e=n.vnode).el=a,n=n.parent;else break}}const Dr=e=>e.__isSuspense;function qa(e,n){n&&n.pendingBranch?$(e)?n.effects.push(...e):n.effects.push(e):na(e)}const se=Symbol.for("v-fgt"),Oi=Symbol.for("v-txt"),Ue=Symbol.for("v-cmt"),mi=Symbol.for("v-stc"),Qe=[];let kt=null;function Pt(e=!1){Qe.push(kt=e?null:[])}function $a(){Qe.pop(),kt=Qe[Qe.length-1]||null}let si=1;function ts(e,n=!1){si+=e,e<0&&kt&&n&&(kt.hasOnce=!0)}function Or(e){return e.dynamicChildren=si>0?kt||Te:null,$a(),si>0&&kt&&kt.push(e),e}function Mt(e,n,a,l,c,h){return Or(Y(e,n,a,l,c,h,!0))}function Xa(e,n,a,l,c){return Or(_t(e,n,a,l,c,!0))}function Ci(e){return e?e.__v_isVNode===!0:!1}function He(e,n){return e.type===n.type&&e.key===n.key}const Nr=({key:e})=>e??null,vi=({ref:e,ref_key:n,ref_for:a})=>(typeof e=="number"&&(e=""+e),e!=null?gt(e)||bt(e)||Z(e)?{i:Rt,r:e,k:n,f:!!a}:e:null);function Y(e,n=null,a=null,l=0,c=null,h=e===se?0:1,d=!1,o=!1){const _={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&Nr(n),ref:n&&vi(n),scopeId:_r,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:h,patchFlag:l,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Rt};return o?(zn(_,a),h&128&&e.normalize(_)):a&&(_.shapeFlag|=gt(a)?8:16),si>0&&!d&&kt&&(_.patchFlag>0||h&6)&&_.patchFlag!==32&&kt.push(_),_}const _t=Za;function Za(e,n=null,a=null,l=0,c=null,h=!1){if((!e||e===va)&&(e=Ue),Ci(e)){const o=ke(e,n,!0);return a&&zn(o,a),si>0&&!h&&kt&&(o.shapeFlag&6?kt[kt.indexOf(e)]=o:kt.push(o)),o.patchFlag=-2,o}if(ll(e)&&(e=e.__vccOpts),n){n=Qa(n);let{class:o,style:_}=n;o&&!gt(o)&&(n.class=Sn(o)),dt(_)&&(Pn(_)&&!$(_)&&(_=St({},_)),n.style=bn(_))}const d=gt(e)?1:Dr(e)?128:ra(e)?64:dt(e)?4:Z(e)?2:0;return Y(e,n,a,l,c,d,h,!0)}function Qa(e){return e?Pn(e)||Br(e)?St({},e):e:null}function ke(e,n,a=!1,l=!1){const{props:c,ref:h,patchFlag:d,children:o,transition:_}=e,b=n?Ja(c||{},n):c,v={__v_isVNode:!0,__v_skip:!0,type:e.type,props:b,key:b&&Nr(b),ref:n&&n.ref?a&&h?$(h)?h.concat(vi(n)):[h,vi(n)]:vi(n):h,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==se?d===-1?16:d|16:d,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:_,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ke(e.ssContent),ssFallback:e.ssFallback&&ke(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return _&&l&&In(v,_.clone(v)),v}function be(e=" ",n=0){return _t(Oi,null,e,n)}function Hr(e,n){const a=_t(mi,null,e);return a.staticCount=n,a}function pe(e="",n=!1){return n?(Pt(),Xa(Ue,null,e)):_t(Ue,null,e)}function Xt(e){return e==null||typeof e=="boolean"?_t(Ue):$(e)?_t(se,null,e.slice()):Ci(e)?ue(e):_t(Oi,null,String(e))}function ue(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ke(e)}function zn(e,n){let a=0;const{shapeFlag:l}=e;if(n==null)n=null;else if($(n))a=16;else if(typeof n=="object")if(l&65){const c=n.default;c&&(c._c&&(c._d=!1),zn(e,c()),c._c&&(c._d=!0));return}else{a=32;const c=n._;!c&&!Br(n)?n._ctx=Rt:c===3&&Rt&&(Rt.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else Z(n)?(n={default:n,_ctx:Rt},a=32):(n=String(n),l&64?(a=16,n=[be(n)]):a=8);e.children=n,e.shapeFlag|=a}function Ja(...e){const n={};for(let a=0;a<e.length;a++){const l=e[a];for(const c in l)if(c==="class")n.class!==l.class&&(n.class=Sn([n.class,l.class]));else if(c==="style")n.style=bn([n.style,l.style]);else if(Fi(c)){const h=n[c],d=l[c];d&&h!==d&&!($(h)&&h.includes(d))&&(n[c]=h?[].concat(h,d):d)}else c!==""&&(n[c]=l[c])}return n}function qt(e,n,a,l=null){te(e,n,7,[a,l])}const tl=wr();let el=0;function il(e,n,a){const l=e.type,c=(n?n.appContext:e.appContext)||tl,h={uid:el++,vnode:e,type:l,parent:n,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Bo(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(c.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Ar(l,c),emitsOptions:Mr(l,c),emit:null,emitted:null,propsDefaults:ft,inheritAttrs:l.inheritAttrs,ctx:ft,data:ft,props:ft,attrs:ft,slots:ft,refs:ft,setupState:ft,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return h.ctx={_:h},h.root=n?n.root:h,h.emit=Va.bind(null,h),e.ce&&e.ce(h),h}let xt=null,Ai,hn;{const e=zi(),n=(a,l)=>{let c;return(c=e[a])||(c=e[a]=[]),c.push(l),h=>{c.length>1?c.forEach(d=>d(h)):c[0](h)}};Ai=n("__VUE_INSTANCE_SETTERS__",a=>xt=a),hn=n("__VUE_SSR_SETTERS__",a=>ri=a)}const ci=e=>{const n=xt;return Ai(e),e.scope.on(),()=>{e.scope.off(),Ai(n)}},es=()=>{xt&&xt.scope.off(),Ai(null)};function Gr(e){return e.vnode.shapeFlag&4}let ri=!1;function nl(e,n=!1,a=!1){n&&hn(n);const{props:l,children:c}=e.vnode,h=Gr(e);Ta(e,l,h,n),La(e,c,a);const d=h?sl(e,n):void 0;return n&&hn(!1),d}function sl(e,n){const a=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,ba);const{setup:l}=a;if(l){_e();const c=e.setupContext=l.length>1?ol(e):null,h=ci(e),d=fi(l,e,0,[e.props,c]),o=Os(d);if(ge(),h(),(o||e.sp)&&!Xe(e)&&yr(e),o){if(d.then(es,es),n)return d.then(_=>{is(e,_)}).catch(_=>{ki(_,e,0)});e.asyncDep=d}else is(e,d)}else Vr(e)}function is(e,n,a){Z(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:dt(n)&&(e.setupState=fr(n)),Vr(e)}function Vr(e,n,a){const l=e.type;e.render||(e.render=l.render||Zt);{const c=ci(e);_e();try{Sa(e)}finally{ge(),c()}}}const rl={get(e,n){return vt(e,"get",""),e[n]}};function ol(e){const n=a=>{e.exposed=a||{}};return{attrs:new Proxy(e.attrs,rl),slots:e.slots,emit:e.emit,expose:n}}function Ni(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(fr(Ko(e.exposed)),{get(n,a){if(a in n)return n[a];if(a in Ze)return Ze[a](e)},has(n,a){return a in n||a in Ze}})):e.proxy}function al(e,n=!0){return Z(e)?e.displayName||e.name:e.name||n&&e.__name}function ll(e){return Z(e)&&"__vccOpts"in e}const Ht=(e,n)=>Qo(e,n,ri);function Yr(e,n,a){const l=arguments.length;return l===2?dt(n)&&!$(n)?Ci(n)?_t(e,null,[n]):_t(e,n):_t(e,null,n):(l>3?a=Array.prototype.slice.call(arguments,2):l===3&&Ci(a)&&(a=[a]),_t(e,n,a))}const fl="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let dn;const ns=typeof window<"u"&&window.trustedTypes;if(ns)try{dn=ns.createPolicy("vue",{createHTML:e=>e})}catch{}const jr=dn?e=>dn.createHTML(e):e=>e,cl="http://www.w3.org/2000/svg",ul="http://www.w3.org/1998/Math/MathML",ne=typeof document<"u"?document:null,ss=ne&&ne.createElement("template"),hl={insert:(e,n,a)=>{n.insertBefore(e,a||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,a,l)=>{const c=n==="svg"?ne.createElementNS(cl,e):n==="mathml"?ne.createElementNS(ul,e):a?ne.createElement(e,{is:a}):ne.createElement(e);return e==="select"&&l&&l.multiple!=null&&c.setAttribute("multiple",l.multiple),c},createText:e=>ne.createTextNode(e),createComment:e=>ne.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ne.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,a,l,c,h){const d=a?a.previousSibling:n.lastChild;if(c&&(c===h||c.nextSibling))for(;n.insertBefore(c.cloneNode(!0),a),!(c===h||!(c=c.nextSibling)););else{ss.innerHTML=jr(l==="svg"?`<svg>${e}</svg>`:l==="mathml"?`<math>${e}</math>`:e);const o=ss.content;if(l==="svg"||l==="mathml"){const _=o.firstChild;for(;_.firstChild;)o.appendChild(_.firstChild);o.removeChild(_)}n.insertBefore(o,a)}return[d?d.nextSibling:n.firstChild,a?a.previousSibling:n.lastChild]}},dl=Symbol("_vtc");function pl(e,n,a){const l=e[dl];l&&(n=(n?[n,...l]:[...l]).join(" ")),n==null?e.removeAttribute("class"):a?e.setAttribute("class",n):e.className=n}const Ti=Symbol("_vod"),Kr=Symbol("_vsh"),rs={beforeMount(e,{value:n},{transition:a}){e[Ti]=e.style.display==="none"?"":e.style.display,a&&n?a.beforeEnter(e):Ge(e,n)},mounted(e,{value:n},{transition:a}){a&&n&&a.enter(e)},updated(e,{value:n,oldValue:a},{transition:l}){!n!=!a&&(l?n?(l.beforeEnter(e),Ge(e,!0),l.enter(e)):l.leave(e,()=>{Ge(e,!1)}):Ge(e,n))},beforeUnmount(e,{value:n}){Ge(e,n)}};function Ge(e,n){e.style.display=n?e[Ti]:"none",e[Kr]=!n}const _l=Symbol(""),gl=/(^|;)\s*display\s*:/;function yl(e,n,a){const l=e.style,c=gt(a);let h=!1;if(a&&!c){if(n)if(gt(n))for(const d of n.split(";")){const o=d.slice(0,d.indexOf(":")).trim();a[o]==null&&xi(l,o,"")}else for(const d in n)a[d]==null&&xi(l,d,"");for(const d in a)d==="display"&&(h=!0),xi(l,d,a[d])}else if(c){if(n!==a){const d=l[_l];d&&(a+=";"+d),l.cssText=a,h=gl.test(a)}}else n&&e.removeAttribute("style");Ti in e&&(e[Ti]=h?l.display:"",e[Kr]&&(l.display="none"))}const os=/\s*!important$/;function xi(e,n,a){if($(a))a.forEach(l=>xi(e,n,l));else if(a==null&&(a=""),n.startsWith("--"))e.setProperty(n,a);else{const l=ml(e,n);os.test(a)?e.setProperty(Ee(l),a.replace(os,""),"important"):e[l]=a}}const as=["Webkit","Moz","ms"],$i={};function ml(e,n){const a=$i[n];if(a)return a;let l=Nt(n);if(l!=="filter"&&l in e)return $i[n]=l;l=Li(l);for(let c=0;c<as.length;c++){const h=as[c]+l;if(h in e)return $i[n]=h}return n}const ls="http://www.w3.org/1999/xlink";function fs(e,n,a,l,c,h=Uo(n)){l&&n.startsWith("xlink:")?a==null?e.removeAttributeNS(ls,n.slice(6,n.length)):e.setAttributeNS(ls,n,a):a==null||h&&!Vs(a)?e.removeAttribute(n):e.setAttribute(n,h?"":Jt(a)?String(a):a)}function cs(e,n,a,l,c){if(n==="innerHTML"||n==="textContent"){a!=null&&(e[n]=n==="innerHTML"?jr(a):a);return}const h=e.tagName;if(n==="value"&&h!=="PROGRESS"&&!h.includes("-")){const o=h==="OPTION"?e.getAttribute("value")||"":e.value,_=a==null?e.type==="checkbox"?"on":"":String(a);(o!==_||!("_value"in e))&&(e.value=_),a==null&&e.removeAttribute(n),e._value=a;return}let d=!1;if(a===""||a==null){const o=typeof e[n];o==="boolean"?a=Vs(a):a==null&&o==="string"?(a="",d=!0):o==="number"&&(a=0,d=!0)}try{e[n]=a}catch{}d&&e.removeAttribute(c||n)}function xe(e,n,a,l){e.addEventListener(n,a,l)}function vl(e,n,a,l){e.removeEventListener(n,a,l)}const us=Symbol("_vei");function xl(e,n,a,l,c=null){const h=e[us]||(e[us]={}),d=h[n];if(l&&d)d.value=l;else{const[o,_]=bl(n);if(l){const b=h[n]=Ul(l,c);xe(e,o,b,_)}else d&&(vl(e,o,d,_),h[n]=void 0)}}const hs=/(?:Once|Passive|Capture)$/;function bl(e){let n;if(hs.test(e)){n={};let l;for(;l=e.match(hs);)e=e.slice(0,e.length-l[0].length),n[l[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ee(e.slice(2)),n]}let Xi=0;const Sl=Promise.resolve(),wl=()=>Xi||(Sl.then(()=>Xi=0),Xi=Date.now());function Ul(e,n){const a=l=>{if(!l._vts)l._vts=Date.now();else if(l._vts<=a.attached)return;te(El(l,a.value),n,5,[l])};return a.value=e,a.attached=wl(),a}function El(e,n){if($(n)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},n.map(l=>c=>!c._stopped&&l&&l(c))}else return n}const ds=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Bl=(e,n,a,l,c,h)=>{const d=c==="svg";n==="class"?pl(e,l,d):n==="style"?yl(e,a,l):Fi(n)?mn(n)||xl(e,n,a,l,h):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):Cl(e,n,l,d))?(cs(e,n,l),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&fs(e,n,l,d,h,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!gt(l))?cs(e,Nt(n),l,h,n):(n==="true-value"?e._trueValue=l:n==="false-value"&&(e._falseValue=l),fs(e,n,l,d))};function Cl(e,n,a,l){if(l)return!!(n==="innerHTML"||n==="textContent"||n in e&&ds(n)&&Z(a));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const c=e.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return ds(n)&&gt(a)?!1:n in e}const Pi=e=>{const n=e.props["onUpdate:modelValue"]||!1;return $(n)?a=>_i(n,a):n};function Al(e){e.target.composing=!0}function ps(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const ze=Symbol("_assign"),Qt={created(e,{modifiers:{lazy:n,trim:a,number:l}},c){e[ze]=Pi(c);const h=l||c.props&&c.props.type==="number";xe(e,n?"change":"input",d=>{if(d.target.composing)return;let o=e.value;a&&(o=o.trim()),h&&(o=en(o)),e[ze](o)}),a&&xe(e,"change",()=>{e.value=e.value.trim()}),n||(xe(e,"compositionstart",Al),xe(e,"compositionend",ps),xe(e,"change",ps))},mounted(e,{value:n}){e.value=n??""},beforeUpdate(e,{value:n,oldValue:a,modifiers:{lazy:l,trim:c,number:h}},d){if(e[ze]=Pi(d),e.composing)return;const o=(h||e.type==="number")&&!/^0\d/.test(e.value)?en(e.value):e.value,_=n??"";o!==_&&(document.activeElement===e&&e.type!=="range"&&(l&&n===a||c&&e.value.trim()===_)||(e.value=_))}},_s={created(e,{value:n},a){e.checked=bi(n,a.props.value),e[ze]=Pi(a),xe(e,"change",()=>{e[ze](Tl(e))})},beforeUpdate(e,{value:n,oldValue:a},l){e[ze]=Pi(l),n!==a&&(e.checked=bi(n,l.props.value))}};function Tl(e){return"_value"in e?e._value:e.value}const Pl=St({patchProp:Bl},hl);let gs;function Fl(){return gs||(gs=Ra(Pl))}const Il=(...e)=>{const n=Fl().createApp(...e),{mount:a}=n;return n.mount=l=>{const c=zl(l);if(!c)return;const h=n._component;!Z(h)&&!h.render&&!h.template&&(h.template=c.innerHTML),c.nodeType===1&&(c.textContent="");const d=a(c,!1,Ll(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),d},n};function Ll(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function zl(e){return gt(e)?document.querySelector(e):e}const ui=(e,n)=>{const a=e.__vccOpts||e;for(const[l,c]of n)a[l]=c;return a},Rl={name:"App",computed:{supportsFileAPI(){return"showSaveFilePicker"in window}}},kl={id:"app"};function Ml(e,n,a,l,c,h){const d=Yn("router-link"),o=Yn("router-view");return Pt(),Mt("div",kl,[Y("nav",null,[_t(d,{to:"/message"},{default:Ye(()=>n[0]||(n[0]=[be("消息")])),_:1}),Tt(_t(d,{to:"/file"},{default:Ye(()=>n[1]||(n[1]=[be("文件")])),_:1},512),[[rs,h.supportsFileAPI]]),Tt(_t(d,{to:"/file-classic"},{default:Ye(()=>n[2]||(n[2]=[be("文件2")])),_:1},512),[[rs,!h.supportsFileAPI]]),_t(d,{to:"/video-decrypt"},{default:Ye(()=>n[3]||(n[3]=[be("视频解密")])),_:1})]),_t(o)])}const Dl=ui(Rl,[["render",Ml]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Ae=typeof document<"u";function Wr(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Ol(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&Wr(e.default)}const nt=Object.assign;function Zi(e,n){const a={};for(const l in n){const c=n[l];a[l]=Yt(c)?c.map(e):e(c)}return a}const Je=()=>{},Yt=Array.isArray,qr=/#/g,Nl=/&/g,Hl=/\//g,Gl=/=/g,Vl=/\?/g,$r=/\+/g,Yl=/%5B/g,jl=/%5D/g,Xr=/%5E/g,Kl=/%60/g,Zr=/%7B/g,Wl=/%7C/g,Qr=/%7D/g,ql=/%20/g;function Rn(e){return encodeURI(""+e).replace(Wl,"|").replace(Yl,"[").replace(jl,"]")}function $l(e){return Rn(e).replace(Zr,"{").replace(Qr,"}").replace(Xr,"^")}function pn(e){return Rn(e).replace($r,"%2B").replace(ql,"+").replace(qr,"%23").replace(Nl,"%26").replace(Kl,"`").replace(Zr,"{").replace(Qr,"}").replace(Xr,"^")}function Xl(e){return pn(e).replace(Gl,"%3D")}function Zl(e){return Rn(e).replace(qr,"%23").replace(Vl,"%3F")}function Ql(e){return e==null?"":Zl(e).replace(Hl,"%2F")}function oi(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const Jl=/\/$/,tf=e=>e.replace(Jl,"");function Qi(e,n,a="/"){let l,c={},h="",d="";const o=n.indexOf("#");let _=n.indexOf("?");return o<_&&o>=0&&(_=-1),_>-1&&(l=n.slice(0,_),h=n.slice(_+1,o>-1?o:n.length),c=e(h)),o>-1&&(l=l||n.slice(0,o),d=n.slice(o,n.length)),l=rf(l??n,a),{fullPath:l+(h&&"?")+h+d,path:l,query:c,hash:oi(d)}}function ef(e,n){const a=n.query?e(n.query):"";return n.path+(a&&"?")+a+(n.hash||"")}function ys(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function nf(e,n,a){const l=n.matched.length-1,c=a.matched.length-1;return l>-1&&l===c&&Me(n.matched[l],a.matched[c])&&Jr(n.params,a.params)&&e(n.query)===e(a.query)&&n.hash===a.hash}function Me(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function Jr(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(!sf(e[a],n[a]))return!1;return!0}function sf(e,n){return Yt(e)?ms(e,n):Yt(n)?ms(n,e):e===n}function ms(e,n){return Yt(n)?e.length===n.length&&e.every((a,l)=>a===n[l]):e.length===1&&e[0]===n}function rf(e,n){if(e.startsWith("/"))return e;if(!e)return n;const a=n.split("/"),l=e.split("/"),c=l[l.length-1];(c===".."||c===".")&&l.push("");let h=a.length-1,d,o;for(d=0;d<l.length;d++)if(o=l[d],o!==".")if(o==="..")h>1&&h--;else break;return a.slice(0,h).join("/")+"/"+l.slice(d).join("/")}const fe={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ai;(function(e){e.pop="pop",e.push="push"})(ai||(ai={}));var ti;(function(e){e.back="back",e.forward="forward",e.unknown=""})(ti||(ti={}));function of(e){if(!e)if(Ae){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),tf(e)}const af=/^[^#]+#/;function lf(e,n){return e.replace(af,"#")+n}function ff(e,n){const a=document.documentElement.getBoundingClientRect(),l=e.getBoundingClientRect();return{behavior:n.behavior,left:l.left-a.left-(n.left||0),top:l.top-a.top-(n.top||0)}}const Hi=()=>({left:window.scrollX,top:window.scrollY});function cf(e){let n;if("el"in e){const a=e.el,l=typeof a=="string"&&a.startsWith("#"),c=typeof a=="string"?l?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!c)return;n=ff(c,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function vs(e,n){return(history.state?history.state.position-n:-1)+e}const _n=new Map;function uf(e,n){_n.set(e,n)}function hf(e){const n=_n.get(e);return _n.delete(e),n}let df=()=>location.protocol+"//"+location.host;function to(e,n){const{pathname:a,search:l,hash:c}=n,h=e.indexOf("#");if(h>-1){let o=c.includes(e.slice(h))?e.slice(h).length:1,_=c.slice(o);return _[0]!=="/"&&(_="/"+_),ys(_,"")}return ys(a,e)+l+c}function pf(e,n,a,l){let c=[],h=[],d=null;const o=({state:E})=>{const C=to(e,location),U=a.value,H=n.value;let t=0;if(E){if(a.value=C,n.value=E,d&&d===U){d=null;return}t=H?E.position-H.position:0}else l(C);c.forEach(s=>{s(a.value,U,{delta:t,type:ai.pop,direction:t?t>0?ti.forward:ti.back:ti.unknown})})};function _(){d=a.value}function b(E){c.push(E);const C=()=>{const U=c.indexOf(E);U>-1&&c.splice(U,1)};return h.push(C),C}function v(){const{history:E}=window;E.state&&E.replaceState(nt({},E.state,{scroll:Hi()}),"")}function x(){for(const E of h)E();h=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",v)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",v,{passive:!0}),{pauseListeners:_,listen:b,destroy:x}}function xs(e,n,a,l=!1,c=!1){return{back:e,current:n,forward:a,replaced:l,position:window.history.length,scroll:c?Hi():null}}function _f(e){const{history:n,location:a}=window,l={value:to(e,a)},c={value:n.state};c.value||h(l.value,{back:null,current:l.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function h(_,b,v){const x=e.indexOf("#"),E=x>-1?(a.host&&document.querySelector("base")?e:e.slice(x))+_:df()+e+_;try{n[v?"replaceState":"pushState"](b,"",E),c.value=b}catch(C){console.error(C),a[v?"replace":"assign"](E)}}function d(_,b){const v=nt({},n.state,xs(c.value.back,_,c.value.forward,!0),b,{position:c.value.position});h(_,v,!0),l.value=_}function o(_,b){const v=nt({},c.value,n.state,{forward:_,scroll:Hi()});h(v.current,v,!0);const x=nt({},xs(l.value,_,null),{position:v.position+1},b);h(_,x,!1),l.value=_}return{location:l,state:c,push:o,replace:d}}function gf(e){e=of(e);const n=_f(e),a=pf(e,n.state,n.location,n.replace);function l(h,d=!0){d||a.pauseListeners(),history.go(h)}const c=nt({location:"",base:e,go:l,createHref:lf.bind(null,e)},n,a);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>n.state.value}),c}function yf(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),gf(e)}function mf(e){return typeof e=="string"||e&&typeof e=="object"}function eo(e){return typeof e=="string"||typeof e=="symbol"}const io=Symbol("");var bs;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(bs||(bs={}));function De(e,n){return nt(new Error,{type:e,[io]:!0},n)}function ie(e,n){return e instanceof Error&&io in e&&(n==null||!!(e.type&n))}const Ss="[^/]+?",vf={sensitive:!1,strict:!1,start:!0,end:!0},xf=/[.+*?^${}()[\]/\\]/g;function bf(e,n){const a=nt({},vf,n),l=[];let c=a.start?"^":"";const h=[];for(const b of e){const v=b.length?[]:[90];a.strict&&!b.length&&(c+="/");for(let x=0;x<b.length;x++){const E=b[x];let C=40+(a.sensitive?.25:0);if(E.type===0)x||(c+="/"),c+=E.value.replace(xf,"\\$&"),C+=40;else if(E.type===1){const{value:U,repeatable:H,optional:t,regexp:s}=E;h.push({name:U,repeatable:H,optional:t});const r=s||Ss;if(r!==Ss){C+=10;try{new RegExp(`(${r})`)}catch(u){throw new Error(`Invalid custom RegExp for param "${U}" (${r}): `+u.message)}}let f=H?`((?:${r})(?:/(?:${r}))*)`:`(${r})`;x||(f=t&&b.length<2?`(?:/${f})`:"/"+f),t&&(f+="?"),c+=f,C+=20,t&&(C+=-8),H&&(C+=-20),r===".*"&&(C+=-50)}v.push(C)}l.push(v)}if(a.strict&&a.end){const b=l.length-1;l[b][l[b].length-1]+=.7000000000000001}a.strict||(c+="/?"),a.end?c+="$":a.strict&&!c.endsWith("/")&&(c+="(?:/|$)");const d=new RegExp(c,a.sensitive?"":"i");function o(b){const v=b.match(d),x={};if(!v)return null;for(let E=1;E<v.length;E++){const C=v[E]||"",U=h[E-1];x[U.name]=C&&U.repeatable?C.split("/"):C}return x}function _(b){let v="",x=!1;for(const E of e){(!x||!v.endsWith("/"))&&(v+="/"),x=!1;for(const C of E)if(C.type===0)v+=C.value;else if(C.type===1){const{value:U,repeatable:H,optional:t}=C,s=U in b?b[U]:"";if(Yt(s)&&!H)throw new Error(`Provided param "${U}" is an array but it is not repeatable (* or + modifiers)`);const r=Yt(s)?s.join("/"):s;if(!r)if(t)E.length<2&&(v.endsWith("/")?v=v.slice(0,-1):x=!0);else throw new Error(`Missing required param "${U}"`);v+=r}}return v||"/"}return{re:d,score:l,keys:h,parse:o,stringify:_}}function Sf(e,n){let a=0;for(;a<e.length&&a<n.length;){const l=n[a]-e[a];if(l)return l;a++}return e.length<n.length?e.length===1&&e[0]===80?-1:1:e.length>n.length?n.length===1&&n[0]===80?1:-1:0}function no(e,n){let a=0;const l=e.score,c=n.score;for(;a<l.length&&a<c.length;){const h=Sf(l[a],c[a]);if(h)return h;a++}if(Math.abs(c.length-l.length)===1){if(ws(l))return 1;if(ws(c))return-1}return c.length-l.length}function ws(e){const n=e[e.length-1];return e.length>0&&n[n.length-1]<0}const wf={type:0,value:""},Uf=/[a-zA-Z0-9_]/;function Ef(e){if(!e)return[[]];if(e==="/")return[[wf]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(C){throw new Error(`ERR (${a})/"${b}": ${C}`)}let a=0,l=a;const c=[];let h;function d(){h&&c.push(h),h=[]}let o=0,_,b="",v="";function x(){b&&(a===0?h.push({type:0,value:b}):a===1||a===2||a===3?(h.length>1&&(_==="*"||_==="+")&&n(`A repeatable param (${b}) must be alone in its segment. eg: '/:ids+.`),h.push({type:1,value:b,regexp:v,repeatable:_==="*"||_==="+",optional:_==="*"||_==="?"})):n("Invalid state to consume buffer"),b="")}function E(){b+=_}for(;o<e.length;){if(_=e[o++],_==="\\"&&a!==2){l=a,a=4;continue}switch(a){case 0:_==="/"?(b&&x(),d()):_===":"?(x(),a=1):E();break;case 4:E(),a=l;break;case 1:_==="("?a=2:Uf.test(_)?E():(x(),a=0,_!=="*"&&_!=="?"&&_!=="+"&&o--);break;case 2:_===")"?v[v.length-1]=="\\"?v=v.slice(0,-1)+_:a=3:v+=_;break;case 3:x(),a=0,_!=="*"&&_!=="?"&&_!=="+"&&o--,v="";break;default:n("Unknown state");break}}return a===2&&n(`Unfinished custom RegExp for param "${b}"`),x(),d(),c}function Bf(e,n,a){const l=bf(Ef(e.path),a),c=nt(l,{record:e,parent:n,children:[],alias:[]});return n&&!c.record.aliasOf==!n.record.aliasOf&&n.children.push(c),c}function Cf(e,n){const a=[],l=new Map;n=Cs({strict:!1,end:!0,sensitive:!1},n);function c(x){return l.get(x)}function h(x,E,C){const U=!C,H=Es(x);H.aliasOf=C&&C.record;const t=Cs(n,x),s=[H];if("alias"in x){const u=typeof x.alias=="string"?[x.alias]:x.alias;for(const p of u)s.push(Es(nt({},H,{components:C?C.record.components:H.components,path:p,aliasOf:C?C.record:H})))}let r,f;for(const u of s){const{path:p}=u;if(E&&p[0]!=="/"){const g=E.record.path,S=g[g.length-1]==="/"?"":"/";u.path=E.record.path+(p&&S+p)}if(r=Bf(u,E,t),C?C.alias.push(r):(f=f||r,f!==r&&f.alias.push(r),U&&x.name&&!Bs(r)&&d(x.name)),so(r)&&_(r),H.children){const g=H.children;for(let S=0;S<g.length;S++)h(g[S],r,C&&C.children[S])}C=C||r}return f?()=>{d(f)}:Je}function d(x){if(eo(x)){const E=l.get(x);E&&(l.delete(x),a.splice(a.indexOf(E),1),E.children.forEach(d),E.alias.forEach(d))}else{const E=a.indexOf(x);E>-1&&(a.splice(E,1),x.record.name&&l.delete(x.record.name),x.children.forEach(d),x.alias.forEach(d))}}function o(){return a}function _(x){const E=Pf(x,a);a.splice(E,0,x),x.record.name&&!Bs(x)&&l.set(x.record.name,x)}function b(x,E){let C,U={},H,t;if("name"in x&&x.name){if(C=l.get(x.name),!C)throw De(1,{location:x});t=C.record.name,U=nt(Us(E.params,C.keys.filter(f=>!f.optional).concat(C.parent?C.parent.keys.filter(f=>f.optional):[]).map(f=>f.name)),x.params&&Us(x.params,C.keys.map(f=>f.name))),H=C.stringify(U)}else if(x.path!=null)H=x.path,C=a.find(f=>f.re.test(H)),C&&(U=C.parse(H),t=C.record.name);else{if(C=E.name?l.get(E.name):a.find(f=>f.re.test(E.path)),!C)throw De(1,{location:x,currentLocation:E});t=C.record.name,U=nt({},E.params,x.params),H=C.stringify(U)}const s=[];let r=C;for(;r;)s.unshift(r.record),r=r.parent;return{name:t,path:H,params:U,matched:s,meta:Tf(s)}}e.forEach(x=>h(x));function v(){a.length=0,l.clear()}return{addRoute:h,resolve:b,removeRoute:d,clearRoutes:v,getRoutes:o,getRecordMatcher:c}}function Us(e,n){const a={};for(const l of n)l in e&&(a[l]=e[l]);return a}function Es(e){const n={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Af(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function Af(e){const n={},a=e.props||!1;if("component"in e)n.default=a;else for(const l in e.components)n[l]=typeof a=="object"?a[l]:a;return n}function Bs(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Tf(e){return e.reduce((n,a)=>nt(n,a.meta),{})}function Cs(e,n){const a={};for(const l in e)a[l]=l in n?n[l]:e[l];return a}function Pf(e,n){let a=0,l=n.length;for(;a!==l;){const h=a+l>>1;no(e,n[h])<0?l=h:a=h+1}const c=Ff(e);return c&&(l=n.lastIndexOf(c,l-1)),l}function Ff(e){let n=e;for(;n=n.parent;)if(so(n)&&no(e,n)===0)return n}function so({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function If(e){const n={};if(e===""||e==="?")return n;const l=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<l.length;++c){const h=l[c].replace($r," "),d=h.indexOf("="),o=oi(d<0?h:h.slice(0,d)),_=d<0?null:oi(h.slice(d+1));if(o in n){let b=n[o];Yt(b)||(b=n[o]=[b]),b.push(_)}else n[o]=_}return n}function As(e){let n="";for(let a in e){const l=e[a];if(a=Xl(a),l==null){l!==void 0&&(n+=(n.length?"&":"")+a);continue}(Yt(l)?l.map(h=>h&&pn(h)):[l&&pn(l)]).forEach(h=>{h!==void 0&&(n+=(n.length?"&":"")+a,h!=null&&(n+="="+h))})}return n}function Lf(e){const n={};for(const a in e){const l=e[a];l!==void 0&&(n[a]=Yt(l)?l.map(c=>c==null?null:""+c):l==null?l:""+l)}return n}const zf=Symbol(""),Ts=Symbol(""),kn=Symbol(""),ro=Symbol(""),gn=Symbol("");function Ve(){let e=[];function n(l){return e.push(l),()=>{const c=e.indexOf(l);c>-1&&e.splice(c,1)}}function a(){e=[]}return{add:n,list:()=>e.slice(),reset:a}}function he(e,n,a,l,c,h=d=>d()){const d=l&&(l.enterCallbacks[c]=l.enterCallbacks[c]||[]);return()=>new Promise((o,_)=>{const b=E=>{E===!1?_(De(4,{from:a,to:n})):E instanceof Error?_(E):mf(E)?_(De(2,{from:n,to:E})):(d&&l.enterCallbacks[c]===d&&typeof E=="function"&&d.push(E),o())},v=h(()=>e.call(l&&l.instances[c],n,a,b));let x=Promise.resolve(v);e.length<3&&(x=x.then(b)),x.catch(E=>_(E))})}function Ji(e,n,a,l,c=h=>h()){const h=[];for(const d of e)for(const o in d.components){let _=d.components[o];if(!(n!=="beforeRouteEnter"&&!d.instances[o]))if(Wr(_)){const v=(_.__vccOpts||_)[n];v&&h.push(he(v,a,l,d,o,c))}else{let b=_();h.push(()=>b.then(v=>{if(!v)throw new Error(`Couldn't resolve component "${o}" at "${d.path}"`);const x=Ol(v)?v.default:v;d.mods[o]=v,d.components[o]=x;const C=(x.__vccOpts||x)[n];return C&&he(C,a,l,d,o,c)()}))}}return h}function Ps(e){const n=ae(kn),a=ae(ro),l=Ht(()=>{const _=Fe(e.to);return n.resolve(_)}),c=Ht(()=>{const{matched:_}=l.value,{length:b}=_,v=_[b-1],x=a.matched;if(!v||!x.length)return-1;const E=x.findIndex(Me.bind(null,v));if(E>-1)return E;const C=Fs(_[b-2]);return b>1&&Fs(v)===C&&x[x.length-1].path!==C?x.findIndex(Me.bind(null,_[b-2])):E}),h=Ht(()=>c.value>-1&&Of(a.params,l.value.params)),d=Ht(()=>c.value>-1&&c.value===a.matched.length-1&&Jr(a.params,l.value.params));function o(_={}){if(Df(_)){const b=n[Fe(e.replace)?"replace":"push"](Fe(e.to)).catch(Je);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>b),b}return Promise.resolve()}return{route:l,href:Ht(()=>l.value.href),isActive:h,isExactActive:d,navigate:o}}function Rf(e){return e.length===1?e[0]:e}const kf=gr({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ps,setup(e,{slots:n}){const a=Ri(Ps(e)),{options:l}=ae(kn),c=Ht(()=>({[Is(e.activeClass,l.linkActiveClass,"router-link-active")]:a.isActive,[Is(e.exactActiveClass,l.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const h=n.default&&Rf(n.default(a));return e.custom?h:Yr("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:c.value},h)}}}),Mf=kf;function Df(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function Of(e,n){for(const a in n){const l=n[a],c=e[a];if(typeof l=="string"){if(l!==c)return!1}else if(!Yt(c)||c.length!==l.length||l.some((h,d)=>h!==c[d]))return!1}return!0}function Fs(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Is=(e,n,a)=>e??n??a,Nf=gr({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:n,slots:a}){const l=ae(gn),c=Ht(()=>e.route||l.value),h=ae(Ts,0),d=Ht(()=>{let b=Fe(h);const{matched:v}=c.value;let x;for(;(x=v[b])&&!x.components;)b++;return b}),o=Ht(()=>c.value.matched[d.value]);gi(Ts,Ht(()=>d.value+1)),gi(zf,o),gi(gn,c);const _=Wo();return yi(()=>[_.value,o.value,e.name],([b,v,x],[E,C,U])=>{v&&(v.instances[x]=b,C&&C!==v&&b&&b===E&&(v.leaveGuards.size||(v.leaveGuards=C.leaveGuards),v.updateGuards.size||(v.updateGuards=C.updateGuards))),b&&v&&(!C||!Me(v,C)||!E)&&(v.enterCallbacks[x]||[]).forEach(H=>H(b))},{flush:"post"}),()=>{const b=c.value,v=e.name,x=o.value,E=x&&x.components[v];if(!E)return Ls(a.default,{Component:E,route:b});const C=x.props[v],U=C?C===!0?b.params:typeof C=="function"?C(b):C:null,t=Yr(E,nt({},U,n,{onVnodeUnmounted:s=>{s.component.isUnmounted&&(x.instances[v]=null)},ref:_}));return Ls(a.default,{Component:t,route:b})||t}}});function Ls(e,n){if(!e)return null;const a=e(n);return a.length===1?a[0]:a}const Hf=Nf;function Gf(e){const n=Cf(e.routes,e),a=e.parseQuery||If,l=e.stringifyQuery||As,c=e.history,h=Ve(),d=Ve(),o=Ve(),_=qo(fe);let b=fe;Ae&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const v=Zi.bind(null,P=>""+P),x=Zi.bind(null,Ql),E=Zi.bind(null,oi);function C(P,V){let N,j;return eo(P)?(N=n.getRecordMatcher(P),j=V):j=P,n.addRoute(j,N)}function U(P){const V=n.getRecordMatcher(P);V&&n.removeRoute(V)}function H(){return n.getRoutes().map(P=>P.record)}function t(P){return!!n.getRecordMatcher(P)}function s(P,V){if(V=nt({},V||_.value),typeof P=="string"){const w=Qi(a,P,V.path),T=n.resolve({path:w.path},V),L=c.createHref(w.fullPath);return nt(w,T,{params:E(T.params),hash:oi(w.hash),redirectedFrom:void 0,href:L})}let N;if(P.path!=null)N=nt({},P,{path:Qi(a,P.path,V.path).path});else{const w=nt({},P.params);for(const T in w)w[T]==null&&delete w[T];N=nt({},P,{params:x(w)}),V.params=x(V.params)}const j=n.resolve(N,V),lt=P.hash||"";j.params=v(E(j.params));const y=ef(l,nt({},P,{hash:$l(lt),path:j.path})),m=c.createHref(y);return nt({fullPath:y,hash:lt,query:l===As?Lf(P.query):P.query||{}},j,{redirectedFrom:void 0,href:m})}function r(P){return typeof P=="string"?Qi(a,P,_.value.path):nt({},P)}function f(P,V){if(b!==P)return De(8,{from:V,to:P})}function u(P){return S(P)}function p(P){return u(nt(r(P),{replace:!0}))}function g(P){const V=P.matched[P.matched.length-1];if(V&&V.redirect){const{redirect:N}=V;let j=typeof N=="function"?N(P):N;return typeof j=="string"&&(j=j.includes("?")||j.includes("#")?j=r(j):{path:j},j.params={}),nt({query:P.query,hash:P.hash,params:j.path!=null?{}:P.params},j)}}function S(P,V){const N=b=s(P),j=_.value,lt=P.state,y=P.force,m=P.replace===!0,w=g(N);if(w)return S(nt(r(w),{state:typeof w=="object"?nt({},lt,w.state):lt,force:y,replace:m}),V||N);const T=N;T.redirectedFrom=V;let L;return!y&&nf(l,j,N)&&(L=De(16,{to:T,from:j}),wt(j,j,!0,!1)),(L?Promise.resolve(L):I(T,j)).catch(F=>ie(F)?ie(F,2)?F:mt(F):J(F,T,j)).then(F=>{if(F){if(ie(F,2))return S(nt({replace:m},r(F.to),{state:typeof F.to=="object"?nt({},lt,F.to.state):lt,force:y}),V||T)}else F=K(T,j,!0,m,lt);return R(T,j,F),F})}function B(P,V){const N=f(P,V);return N?Promise.reject(N):Promise.resolve()}function A(P){const V=Dt.values().next().value;return V&&typeof V.runWithContext=="function"?V.runWithContext(P):P()}function I(P,V){let N;const[j,lt,y]=Vf(P,V);N=Ji(j.reverse(),"beforeRouteLeave",P,V);for(const w of j)w.leaveGuards.forEach(T=>{N.push(he(T,P,V))});const m=B.bind(null,P,V);return N.push(m),Ot(N).then(()=>{N=[];for(const w of h.list())N.push(he(w,P,V));return N.push(m),Ot(N)}).then(()=>{N=Ji(lt,"beforeRouteUpdate",P,V);for(const w of lt)w.updateGuards.forEach(T=>{N.push(he(T,P,V))});return N.push(m),Ot(N)}).then(()=>{N=[];for(const w of y)if(w.beforeEnter)if(Yt(w.beforeEnter))for(const T of w.beforeEnter)N.push(he(T,P,V));else N.push(he(w.beforeEnter,P,V));return N.push(m),Ot(N)}).then(()=>(P.matched.forEach(w=>w.enterCallbacks={}),N=Ji(y,"beforeRouteEnter",P,V,A),N.push(m),Ot(N))).then(()=>{N=[];for(const w of d.list())N.push(he(w,P,V));return N.push(m),Ot(N)}).catch(w=>ie(w,8)?w:Promise.reject(w))}function R(P,V,N){o.list().forEach(j=>A(()=>j(P,V,N)))}function K(P,V,N,j,lt){const y=f(P,V);if(y)return y;const m=V===fe,w=Ae?history.state:{};N&&(j||m?c.replace(P.fullPath,nt({scroll:m&&w&&w.scroll},lt)):c.push(P.fullPath,lt)),_.value=P,wt(P,V,N,m),mt()}let D;function at(){D||(D=c.listen((P,V,N)=>{if(!Q.listening)return;const j=s(P),lt=g(j);if(lt){S(nt(lt,{replace:!0,force:!0}),j).catch(Je);return}b=j;const y=_.value;Ae&&uf(vs(y.fullPath,N.delta),Hi()),I(j,y).catch(m=>ie(m,12)?m:ie(m,2)?(S(nt(r(m.to),{force:!0}),j).then(w=>{ie(w,20)&&!N.delta&&N.type===ai.pop&&c.go(-1,!1)}).catch(Je),Promise.reject()):(N.delta&&c.go(-N.delta,!1),J(m,j,y))).then(m=>{m=m||K(j,y,!1),m&&(N.delta&&!ie(m,8)?c.go(-N.delta,!1):N.type===ai.pop&&ie(m,20)&&c.go(-1,!1)),R(j,y,m)}).catch(Je)}))}let it=Ve(),ht=Ve(),tt;function J(P,V,N){mt(P);const j=ht.list();return j.length?j.forEach(lt=>lt(P,V,N)):console.error(P),Promise.reject(P)}function pt(){return tt&&_.value!==fe?Promise.resolve():new Promise((P,V)=>{it.add([P,V])})}function mt(P){return tt||(tt=!P,at(),it.list().forEach(([V,N])=>P?N(P):V()),it.reset()),P}function wt(P,V,N,j){const{scrollBehavior:lt}=e;if(!Ae||!lt)return Promise.resolve();const y=!N&&hf(vs(P.fullPath,0))||(j||!N)&&history.state&&history.state.scroll||null;return ur().then(()=>lt(P,V,y)).then(m=>m&&cf(m)).catch(m=>J(m,P,V))}const yt=P=>c.go(P);let Ut;const Dt=new Set,Q={currentRoute:_,listening:!0,addRoute:C,removeRoute:U,clearRoutes:n.clearRoutes,hasRoute:t,getRoutes:H,resolve:s,options:e,push:u,replace:p,go:yt,back:()=>yt(-1),forward:()=>yt(1),beforeEach:h.add,beforeResolve:d.add,afterEach:o.add,onError:ht.add,isReady:pt,install(P){const V=this;P.component("RouterLink",Mf),P.component("RouterView",Hf),P.config.globalProperties.$router=V,Object.defineProperty(P.config.globalProperties,"$route",{enumerable:!0,get:()=>Fe(_)}),Ae&&!Ut&&_.value===fe&&(Ut=!0,u(c.location).catch(lt=>{}));const N={};for(const lt in fe)Object.defineProperty(N,lt,{get:()=>_.value[lt],enumerable:!0});P.provide(kn,V),P.provide(ro,or(N)),P.provide(gn,_);const j=P.unmount;Dt.add(P),P.unmount=function(){Dt.delete(P),Dt.size<1&&(b=fe,D&&D(),D=null,_.value=fe,Ut=!1,tt=!1),j()}}};function Ot(P){return P.reduce((V,N)=>V.then(()=>A(N)),Promise.resolve())}return Q}function Vf(e,n){const a=[],l=[],c=[],h=Math.max(n.matched.length,e.matched.length);for(let d=0;d<h;d++){const o=n.matched[d];o&&(e.matched.find(b=>Me(b,o))?l.push(o):a.push(o));const _=e.matched[d];_&&(n.matched.find(b=>Me(b,_))||c.push(_))}return[a,l,c]}const Yf={name:"MessagePage",data(){return{inputText:"",password:"",outputText:"",copyButtonText:"复制结果",isLoading:!1}},methods:{async encryptText(){if(!this.inputText||!this.password){this.outputText="请输入消息和密码";return}try{this.isLoading=!0,this.outputText="加密中...",this.outputText=await ao(this.inputText,this.password)}catch(e){this.outputText="加密失败: "+e.message}finally{this.isLoading=!1}},async decryptText(){if(!this.inputText||!this.password){this.outputText="请输入密文和密码";return}try{this.isLoading=!0,this.outputText="解密中...",this.outputText=await oo(this.inputText,this.password)}catch(e){this.outputText="解密失败: "+e.message}finally{this.isLoading=!1}},clearAll(){this.inputText="",this.password="",this.outputText=""},async copyToClipboard(){if(!this.outputText)return;const e=this.copyButtonText;try{await navigator.clipboard.writeText(this.outputText),this.copyButtonText="复制成功!"}catch{this.copyButtonText="复制失败!"}setTimeout(()=>{this.copyButtonText=e},1500)}}},jf={class:"message-page"},Kf={class:"input-section"},Wf={class:"button-group"},qf=["disabled"],$f=["disabled"],Xf=["disabled"],Zf={class:"output-section"},Qf={class:"output-box"};function Jf(e,n,a,l,c,h){return Pt(),Mt("div",jf,[n[7]||(n[7]=Y("h2",null,"消息加密/解密",-1)),Y("div",Kf,[Tt(Y("textarea",{"onUpdate:modelValue":n[0]||(n[0]=d=>c.inputText=d),placeholder:"输入要加密的消息或要解密的密文"},null,512),[[Qt,c.inputText]]),Tt(Y("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=d=>c.password=d),placeholder:"输入密码"},null,512),[[Qt,c.password]]),Y("div",Wf,[Y("button",{onClick:n[2]||(n[2]=(...d)=>h.encryptText&&h.encryptText(...d)),disabled:c.isLoading},"加密",8,qf),Y("button",{onClick:n[3]||(n[3]=(...d)=>h.decryptText&&h.decryptText(...d)),disabled:c.isLoading},"解密",8,$f),Y("button",{onClick:n[4]||(n[4]=(...d)=>h.clearAll&&h.clearAll(...d)),disabled:c.isLoading},"清空",8,Xf)])]),Y("div",Zf,[n[6]||(n[6]=Y("h3",null,"结果:",-1)),Y("div",Qf,Re(c.outputText),1),c.outputText?(Pt(),Mt("button",{key:0,onClick:n[5]||(n[5]=(...d)=>h.copyToClipboard&&h.copyToClipboard(...d)),class:"copy-button"},Re(c.copyButtonText),1)):pe("",!0)])])}const tc=ui(Yf,[["render",Jf],["__scopeId","data-v-a73d2066"]]),ec={name:"FilePage",data(){return{selectedFileHandle:null,selectedFile:null,password:"",chunkSize:32,statusMessage:"",isLoading:!1,showPasswordChange:!1,newPassword:""}},methods:{async selectFile(){try{const[e]=await window.showOpenFilePicker({writable:!0,multiple:!1});this.selectedFileHandle=e,this.selectedFile=await e.getFile(),this.statusMessage=`已选择文件: ${this.selectedFile.name}`}catch(e){this.statusMessage="文件选择取消或出错: "+e.message}},async encryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}if(!(!this.password&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const e=`${this.selectedFile.name}.enc`,a=await(await window.showSaveFilePicker({suggestedName:e})).createWritable(),l=this.chunkSize*1024*1024;await Ms(async(c,h)=>{const d=await this.selectedFile.slice(c,h).arrayBuffer();return new Uint8Array(d)},c=>a.write(c),this.password,c=>{const h=Number(c/this.selectedFile.size*100);c>=this.selectedFile.size||h===100||h.toFixed(2)==="100.00"?this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。":this.statusMessage=`加密中... ${h.toFixed(2)}%`},null,null,l),await a.close(),this.statusMessage=`文件加密成功: ${e}`}catch(e){this.statusMessage="加密失败: "+e.message}finally{this.isLoading=!1}}},async decryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.isLoading=!0;try{const e=this.selectedFile.name.endsWith(".enc")?this.selectedFile.name.slice(0,-4):`decrypted_${this.selectedFile.name}`,a=await(await window.showSaveFilePicker({suggestedName:e})).createWritable();await ks(async(l,c)=>{const h=await this.selectedFile.slice(l,c).arrayBuffer();return new Uint8Array(h)},l=>a.write(l),this.password,l=>{const c=Number(l/this.selectedFile.size*100);l>=this.selectedFile.size||c===100||c.toFixed(2)==="100.00"?this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。":this.statusMessage=`解密中... ${c.toFixed(2)}%`}),await a.close(),this.statusMessage=`文件解密成功: ${e}`}catch(e){this.statusMessage="解密失败: "+e.message}finally{this.isLoading=!1}},clearAll(){this.selectedFile=null,this.password="",this.statusMessage=""},changePassword(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.showPasswordChange=!0,this.newPassword="",this.confirmPassword=""},cancelPasswordChange(){this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},async confirmPasswordChange(){if(!(!this.newPassword&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{this.statusMessage="正在处理...";const e=this.selectedFileHandle,a=this.selectedFile.slice(0,5e3);this.statusMessage="正在更改密码，请稍候...";const l=await Rs(a,this.password,this.newPassword);this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。";const c=await e.createWritable({keepExistingData:!0});await c.write(l),await c.close(),this.statusMessage="密码更改成功",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""}catch(e){this.statusMessage="密码更改失败: "+e.message}finally{this.isLoading=!1}}}}},ic={class:"file-page"},nc={class:"input-section"},sc={class:"file-select-group"},rc={class:"file-name"},oc={class:"chunk-size-group"},ac={class:"chunk-size-header"},lc={class:"button-group",style:{"margin-top":"0.5em"}},fc=["disabled"],cc=["disabled"],uc=["disabled"],hc=["disabled"],dc={key:0,class:"password-change-section"},pc={class:"button-group"},_c=["disabled"],gc=["disabled"],yc={key:1,class:"status-section"},mc={class:"status-box"};function vc(e,n,a,l,c,h){return Pt(),Mt("div",ic,[n[14]||(n[14]=Y("h2",null,"文件加密/解密",-1)),Y("div",nc,[Y("div",sc,[Y("button",{onClick:n[0]||(n[0]=(...d)=>h.selectFile&&h.selectFile(...d)),style:{flex:"unset",padding:"10px 20px"}},"选择文件"),Y("div",rc,Re(c.selectedFile?.name||"没有选择文件"),1)]),Tt(Y("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=d=>c.password=d),placeholder:"输入密码"},null,512),[[Qt,c.password]]),Y("div",oc,[Y("div",ac,[n[10]||(n[10]=Y("label",null,"分块大小(MiB):",-1)),Tt(Y("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=d=>c.chunkSize=d),min:"1",max:"128"},null,512),[[Qt,c.chunkSize,void 0,{number:!0}]])]),n[11]||(n[11]=Hr('<details class="hint-box" open data-v-3f6cbc91><summary class="hint-title" data-v-3f6cbc91>分块大小建议:</summary><ul class="hint-list" data-v-3f6cbc91><li data-v-3f6cbc91><strong data-v-3f6cbc91>大文件(32MiB)</strong>: 整体文件处理，提高性能</li><li data-v-3f6cbc91><strong data-v-3f6cbc91>视频文件(5-32MiB)</strong>: 增强随机读取性能</li><li data-v-3f6cbc91><strong data-v-3f6cbc91>一般视频(5MiB)</strong>: 适合大多数视频文件</li><li data-v-3f6cbc91><strong data-v-3f6cbc91>较大视频(16-32MiB)</strong>: 适合高清/4K视频</li></ul><div class="warning-text" data-v-3f6cbc91> ⚠️ 注意: 分块太小会导致文件被分成过多块，可能产生大量请求次数，造成额外费用。 请根据文件类型和大小选择合适的分块大小。 </div></details>',1))]),Y("div",lc,[Y("button",{onClick:n[3]||(n[3]=(...d)=>h.encryptFile&&h.encryptFile(...d)),disabled:c.isLoading},"加密",8,fc),Y("button",{onClick:n[4]||(n[4]=(...d)=>h.decryptFile&&h.decryptFile(...d)),disabled:c.isLoading},"解密",8,cc),Y("button",{onClick:n[5]||(n[5]=(...d)=>h.changePassword&&h.changePassword(...d)),disabled:c.isLoading},"改密",8,uc),Y("button",{onClick:n[6]||(n[6]=(...d)=>h.clearAll&&h.clearAll(...d)),disabled:c.isLoading},"清除",8,hc)])]),c.showPasswordChange?(Pt(),Mt("div",dc,[n[12]||(n[12]=Y("h3",null,"更改密码",-1)),Tt(Y("input",{type:"password","onUpdate:modelValue":n[7]||(n[7]=d=>c.newPassword=d),placeholder:"输入新密码"},null,512),[[Qt,c.newPassword]]),Y("div",pc,[Y("button",{onClick:n[8]||(n[8]=(...d)=>h.confirmPasswordChange&&h.confirmPasswordChange(...d)),disabled:c.isLoading},"确认更改",8,_c),Y("button",{onClick:n[9]||(n[9]=(...d)=>h.cancelPasswordChange&&h.cancelPasswordChange(...d)),disabled:c.isLoading},"取消",8,gc)])])):pe("",!0),c.statusMessage?(Pt(),Mt("div",yc,[n[13]||(n[13]=Y("h3",null,"状态:",-1)),Y("div",mc,Re(c.statusMessage),1)])):pe("",!0)])}const xc=ui(ec,[["render",vc],["__scopeId","data-v-3f6cbc91"]]),bc={name:"FileClassicPage",data(){return{selectedFile:null,password:"",chunkSize:32,statusMessage:"",isLoading:!1,showPasswordChange:!1,newPassword:"",confirmPassword:""}},methods:{handleFileChange(e){this.selectedFile=e.target.files[0],this.selectedFile&&(this.statusMessage=`已选择文件: ${this.selectedFile.name}`)},async encryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}if(!(!this.password&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const e=`${this.selectedFile.name}.enc`,n=document.createElement("a");n.style.display="none",document.body.appendChild(n);const a=this.chunkSize*1024*1024,l=[];await Ms(async(d,o)=>{const _=await this.selectedFile.slice(d,o).arrayBuffer();return new Uint8Array(_)},d=>{l.push(d)},this.password,d=>{const o=(d/this.selectedFile.size*100).toFixed(2);this.statusMessage=`加密中... ${o}%`},null,null,a);const c=new Blob(l,{type:"application/octet-stream"}),h=URL.createObjectURL(c);n.href=h,n.download=e,n.click(),URL.revokeObjectURL(h),document.body.removeChild(n),this.statusMessage=`文件加密成功: ${e}`}catch(e){this.statusMessage="加密失败: "+e.message}finally{this.isLoading=!1}}},async decryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.isLoading=!0;try{const e=this.selectedFile.name.endsWith(".enc")?this.selectedFile.name.slice(0,-4):`decrypted_${this.selectedFile.name}`,n=document.createElement("a");n.style.display="none",document.body.appendChild(n);const a=[];await ks(async(h,d)=>{const o=await this.selectedFile.slice(h,d).arrayBuffer();return new Uint8Array(o)},h=>{a.push(h)},this.password,h=>{const d=(h/this.selectedFile.size*100).toFixed(2);this.statusMessage=`解密中... ${d}%`});const l=new Blob(a,{type:"application/octet-stream"}),c=URL.createObjectURL(l);n.href=c,n.download=e,n.click(),URL.revokeObjectURL(c),document.body.removeChild(n),this.statusMessage=`文件解密成功: ${e}`}catch(e){this.statusMessage="解密失败: "+e.message}finally{this.isLoading=!1}},clearAll(){this.$refs.fileInput.value="",this.selectedFile=null,this.password="",this.statusMessage="",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},changePassword(){if(!this.selectedFile){this.statusMessage="请选择文件并输入当前密码";return}this.showPasswordChange=!0,this.newPassword="",this.confirmPassword=""},cancelPasswordChange(){this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},async confirmPasswordChange(){if(!(!this.newPassword&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const e=this.selectedFile.slice(0,5e3),n=await Rs(e,this.password,this.newPassword),a=document.createElement("a");a.style.display="none",document.body.appendChild(a);const l=URL.createObjectURL(new Blob([n,this.selectedFile.slice(n.size)],{type:"application/octet-stream"}));a.href=l,a.download=this.selectedFile.name,a.click(),URL.revokeObjectURL(l),document.body.removeChild(a),this.statusMessage="密码更改成功",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""}catch(e){this.statusMessage="密码更改失败: "+e.message}finally{this.isLoading=!1}}}}},Sc={class:"file-page"},wc={class:"input-section"},Uc={class:"chunk-size-group"},Ec={class:"chunk-size-header"},Bc={class:"button-group",style:{"margin-top":"0.5em"}},Cc=["disabled"],Ac=["disabled"],Tc=["disabled"],Pc=["disabled"],Fc={key:0,class:"password-change-section"},Ic={class:"button-group"},Lc=["disabled"],zc=["disabled"],Rc={key:0,class:"status-section"},kc={class:"status-box"};function Mc(e,n,a,l,c,h){return Pt(),Mt("div",Sc,[n[14]||(n[14]=Y("h2",null,"文件加密/解密(兼容版)",-1)),Y("div",wc,[Y("input",{type:"file",ref:"fileInput",onChange:n[0]||(n[0]=(...d)=>h.handleFileChange&&h.handleFileChange(...d))},null,544),Tt(Y("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=d=>c.password=d),placeholder:"输入密码"},null,512),[[Qt,c.password]]),Y("div",Uc,[Y("div",Ec,[n[10]||(n[10]=Y("label",null,"分块大小(MiB):",-1)),Tt(Y("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=d=>c.chunkSize=d),min:"1",max:"128"},null,512),[[Qt,c.chunkSize,void 0,{number:!0}]])]),n[11]||(n[11]=Hr('<details class="hint-box" open data-v-229e1619><summary class="hint-title" data-v-229e1619>分块大小建议:</summary><ul class="hint-list" data-v-229e1619><li data-v-229e1619><strong data-v-229e1619>大文件(32MiB)</strong>: 整体文件处理，提高性能</li><li data-v-229e1619><strong data-v-229e1619>视频文件(5-32MiB)</strong>: 增强随机读取性能</li><li data-v-229e1619><strong data-v-229e1619>一般视频(5MiB)</strong>: 适合大多数视频文件</li><li data-v-229e1619><strong data-v-229e1619>较大视频(16-32MiB)</strong>: 适合高清/4K视频</li></ul><div class="warning-text" data-v-229e1619> ⚠️ 注意: 分块太小会导致文件被分成过多块，可能产生大量请求次数，造成额外费用。 请根据文件类型和大小选择合适的分块大小。 </div></details>',1))]),Y("div",Bc,[Y("button",{onClick:n[3]||(n[3]=(...d)=>h.encryptFile&&h.encryptFile(...d)),disabled:c.isLoading},"加密",8,Cc),Y("button",{onClick:n[4]||(n[4]=(...d)=>h.decryptFile&&h.decryptFile(...d)),disabled:c.isLoading},"解密",8,Ac),Y("button",{onClick:n[5]||(n[5]=(...d)=>h.changePassword&&h.changePassword(...d)),disabled:c.isLoading},"改密",8,Tc),Y("button",{onClick:n[6]||(n[6]=(...d)=>h.clearAll&&h.clearAll(...d)),disabled:c.isLoading},"清除",8,Pc)]),c.showPasswordChange?(Pt(),Mt("div",Fc,[n[12]||(n[12]=Y("h3",null,"更改密码",-1)),Tt(Y("input",{type:"password","onUpdate:modelValue":n[7]||(n[7]=d=>c.newPassword=d),placeholder:"输入新密码"},null,512),[[Qt,c.newPassword]]),Y("div",Ic,[Y("button",{onClick:n[8]||(n[8]=(...d)=>h.confirmPasswordChange&&h.confirmPasswordChange(...d)),disabled:c.isLoading},"确认更改",8,Lc),Y("button",{onClick:n[9]||(n[9]=(...d)=>h.cancelPasswordChange&&h.cancelPasswordChange(...d)),disabled:c.isLoading},"取消",8,zc)])])):pe("",!0)]),c.statusMessage?(Pt(),Mt("div",Rc,[n[13]||(n[13]=Y("h3",null,"状态:",-1)),Y("div",kc,Re(c.statusMessage),1)])):pe("",!0)])}const Dc=ui(bc,[["render",Mc],["__scopeId","data-v-229e1619"]]);function Oc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tn={},zs;function Nc(){return zs||(zs=1,function(e){var n=function(){var t=new Date,s=4,r=3,f=2,u=1,p=s,g={setLogLevel:function(S){S==this.debug?p=u:S==this.info?p=f:S==this.warn?p=r:(S==this.error,p=s)},debug:function(S,B){console.debug===void 0&&(console.debug=console.log),u>=p&&console.debug("["+n.getDurationString(new Date-t,1e3)+"]","["+S+"]",B)},log:function(S,B){this.debug(S.msg)},info:function(S,B){f>=p&&console.info("["+n.getDurationString(new Date-t,1e3)+"]","["+S+"]",B)},warn:function(S,B){r>=p&&console.warn("["+n.getDurationString(new Date-t,1e3)+"]","["+S+"]",B)},error:function(S,B){s>=p&&console.error("["+n.getDurationString(new Date-t,1e3)+"]","["+S+"]",B)}};return g}();n.getDurationString=function(t,s){var r;function f(A,I){for(var R=""+A,K=R.split(".");K[0].length<I;)K[0]="0"+K[0];return K.join(".")}t<0?(r=!0,t=-t):r=!1;var u=s||1,p=t/u,g=Math.floor(p/3600);p-=g*3600;var S=Math.floor(p/60);p-=S*60;var B=p*1e3;return p=Math.floor(p),B-=p*1e3,B=Math.floor(B),(r?"-":"")+g+":"+f(S,2)+":"+f(p,2)+"."+f(B,3)},n.printRanges=function(t){var s=t.length;if(s>0){for(var r="",f=0;f<s;f++)f>0&&(r+=","),r+="["+n.getDurationString(t.start(f))+","+n.getDurationString(t.end(f))+"]";return r}else return"(empty)"},e.Log=n;var a=function(t){if(t instanceof ArrayBuffer)this.buffer=t,this.dataview=new DataView(t);else throw"Needs an array buffer";this.position=0};a.prototype.getPosition=function(){return this.position},a.prototype.getEndPosition=function(){return this.buffer.byteLength},a.prototype.getLength=function(){return this.buffer.byteLength},a.prototype.seek=function(t){var s=Math.max(0,Math.min(this.buffer.byteLength,t));return this.position=isNaN(s)||!isFinite(s)?0:s,!0},a.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},a.prototype.readAnyInt=function(t,s){var r=0;if(this.position+t<=this.buffer.byteLength){switch(t){case 1:s?r=this.dataview.getInt8(this.position):r=this.dataview.getUint8(this.position);break;case 2:s?r=this.dataview.getInt16(this.position):r=this.dataview.getUint16(this.position);break;case 3:if(s)throw"No method for reading signed 24 bits values";r=this.dataview.getUint8(this.position)<<16,r|=this.dataview.getUint8(this.position+1)<<8,r|=this.dataview.getUint8(this.position+2);break;case 4:s?r=this.dataview.getInt32(this.position):r=this.dataview.getUint32(this.position);break;case 8:if(s)throw"No method for reading signed 64 bits values";r=this.dataview.getUint32(this.position)<<32,r|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+t}return this.position+=t,r}else throw"Not enough bytes in buffer"},a.prototype.readUint8=function(){return this.readAnyInt(1,!1)},a.prototype.readUint16=function(){return this.readAnyInt(2,!1)},a.prototype.readUint24=function(){return this.readAnyInt(3,!1)},a.prototype.readUint32=function(){return this.readAnyInt(4,!1)},a.prototype.readUint64=function(){return this.readAnyInt(8,!1)},a.prototype.readString=function(t){if(this.position+t<=this.buffer.byteLength){for(var s="",r=0;r<t;r++)s+=String.fromCharCode(this.readUint8());return s}else throw"Not enough bytes in buffer"},a.prototype.readCString=function(){for(var t=[];;){var s=this.readUint8();if(s!==0)t.push(s);else break}return String.fromCharCode.apply(null,t)},a.prototype.readInt8=function(){return this.readAnyInt(1,!0)},a.prototype.readInt16=function(){return this.readAnyInt(2,!0)},a.prototype.readInt32=function(){return this.readAnyInt(4,!0)},a.prototype.readInt64=function(){return this.readAnyInt(8,!1)},a.prototype.readUint8Array=function(t){for(var s=new Uint8Array(t),r=0;r<t;r++)s[r]=this.readUint8();return s},a.prototype.readInt16Array=function(t){for(var s=new Int16Array(t),r=0;r<t;r++)s[r]=this.readInt16();return s},a.prototype.readUint16Array=function(t){for(var s=new Int16Array(t),r=0;r<t;r++)s[r]=this.readUint16();return s},a.prototype.readUint32Array=function(t){for(var s=new Uint32Array(t),r=0;r<t;r++)s[r]=this.readUint32();return s},a.prototype.readInt32Array=function(t){for(var s=new Int32Array(t),r=0;r<t;r++)s[r]=this.readInt32();return s},e.MP4BoxStream=a;var l=function(t,s,r){this._byteOffset=s||0,t instanceof ArrayBuffer?this.buffer=t:typeof t=="object"?(this.dataView=t,s&&(this._byteOffset+=s)):this.buffer=new ArrayBuffer(t||0),this.position=0,this.endianness=r??l.LITTLE_ENDIAN};l.prototype={},l.prototype.getPosition=function(){return this.position},l.prototype._realloc=function(t){if(this._dynamicSize){var s=this._byteOffset+this.position+t,r=this._buffer.byteLength;if(s<=r){s>this._byteLength&&(this._byteLength=s);return}for(r<1&&(r=1);s>r;)r*=2;var f=new ArrayBuffer(r),u=new Uint8Array(this._buffer),p=new Uint8Array(f,0,u.length);p.set(u),this.buffer=f,this._byteLength=s}},l.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var t=new ArrayBuffer(this._byteLength),s=new Uint8Array(t),r=new Uint8Array(this._buffer,0,s.length);s.set(r),this.buffer=t}},l.BIG_ENDIAN=!1,l.LITTLE_ENDIAN=!0,l.prototype._byteLength=0,Object.defineProperty(l.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(l.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(t){this._buffer=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(l.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(t){this._byteOffset=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(l.prototype,"dataView",{get:function(){return this._dataView},set:function(t){this._byteOffset=t.byteOffset,this._buffer=t.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+t.byteLength}}),l.prototype.seek=function(t){var s=Math.max(0,Math.min(this.byteLength,t));this.position=isNaN(s)||!isFinite(s)?0:s},l.prototype.isEof=function(){return this.position>=this._byteLength},l.prototype.mapUint8Array=function(t){this._realloc(t*1);var s=new Uint8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=t*1,s},l.prototype.readInt32Array=function(t,s){t=t??this.byteLength-this.position/4;var r=new Int32Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readInt16Array=function(t,s){t=t??this.byteLength-this.position/2;var r=new Int16Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readInt8Array=function(t){t=t??this.byteLength-this.position;var s=new Int8Array(t);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,t*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},l.prototype.readUint32Array=function(t,s){t=t??this.byteLength-this.position/4;var r=new Uint32Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readUint16Array=function(t,s){t=t??this.byteLength-this.position/2;var r=new Uint16Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readUint8Array=function(t){t=t??this.byteLength-this.position;var s=new Uint8Array(t);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,t*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},l.prototype.readFloat64Array=function(t,s){t=t??this.byteLength-this.position/8;var r=new Float64Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readFloat32Array=function(t,s){t=t??this.byteLength-this.position/4;var r=new Float32Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readInt32=function(t){var s=this._dataView.getInt32(this.position,t??this.endianness);return this.position+=4,s},l.prototype.readInt16=function(t){var s=this._dataView.getInt16(this.position,t??this.endianness);return this.position+=2,s},l.prototype.readInt8=function(){var t=this._dataView.getInt8(this.position);return this.position+=1,t},l.prototype.readUint32=function(t){var s=this._dataView.getUint32(this.position,t??this.endianness);return this.position+=4,s},l.prototype.readUint16=function(t){var s=this._dataView.getUint16(this.position,t??this.endianness);return this.position+=2,s},l.prototype.readUint8=function(){var t=this._dataView.getUint8(this.position);return this.position+=1,t},l.prototype.readFloat32=function(t){var s=this._dataView.getFloat32(this.position,t??this.endianness);return this.position+=4,s},l.prototype.readFloat64=function(t){var s=this._dataView.getFloat64(this.position,t??this.endianness);return this.position+=8,s},l.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,l.memcpy=function(t,s,r,f,u){var p=new Uint8Array(t,s,u),g=new Uint8Array(r,f,u);p.set(g)},l.arrayToNative=function(t,s){return s==this.endianness?t:this.flipArrayEndianness(t)},l.nativeToEndian=function(t,s){return this.endianness==s?t:this.flipArrayEndianness(t)},l.flipArrayEndianness=function(t){for(var s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r=0;r<t.byteLength;r+=t.BYTES_PER_ELEMENT)for(var f=r+t.BYTES_PER_ELEMENT-1,u=r;f>u;f--,u++){var p=s[u];s[u]=s[f],s[f]=p}return t},l.prototype.failurePosition=0,String.fromCharCodeUint8=function(t){for(var s=[],r=0;r<t.length;r++)s[r]=t[r];return String.fromCharCode.apply(null,s)},l.prototype.readString=function(t,s){return s==null||s=="ASCII"?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(t??this.byteLength-this.position)]):new TextDecoder(s).decode(this.mapUint8Array(t))},l.prototype.readCString=function(t){var s=this.byteLength-this.position,r=new Uint8Array(this._buffer,this._byteOffset+this.position),f=s;t!=null&&(f=Math.min(t,s));for(var u=0;u<f&&r[u]!==0;u++);var p=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(u)]);return t!=null?this.position+=f-u:u!=s&&(this.position+=1),p};var c=Math.pow(2,32);l.prototype.readInt64=function(){return this.readInt32()*c+this.readUint32()},l.prototype.readUint64=function(){return this.readUint32()*c+this.readUint32()},l.prototype.readInt64=function(){return this.readUint32()*c+this.readUint32()},l.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},e.DataStream=l,l.prototype.save=function(t){var s=new Blob([this.buffer]);if(window.URL&&URL.createObjectURL){var r=window.URL.createObjectURL(s),f=document.createElement("a");document.body.appendChild(f),f.setAttribute("href",r),f.setAttribute("download",t),f.setAttribute("target","_self"),f.click(),window.URL.revokeObjectURL(r)}else throw"DataStream.save: Can't create object URL."},l.prototype._dynamicSize=!0,Object.defineProperty(l.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(t){t||this._trimAlloc(),this._dynamicSize=t}}),l.prototype.shift=function(t){var s=new ArrayBuffer(this._byteLength-t),r=new Uint8Array(s),f=new Uint8Array(this._buffer,t,r.length);r.set(f),this.buffer=s,this.position-=t},l.prototype.writeInt32Array=function(t,s){if(this._realloc(t.length*4),t instanceof Int32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt32Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeInt32(t[r],s)},l.prototype.writeInt16Array=function(t,s){if(this._realloc(t.length*2),t instanceof Int16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt16Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeInt16(t[r],s)},l.prototype.writeInt8Array=function(t){if(this._realloc(t.length*1),t instanceof Int8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt8Array(t.length);else for(var s=0;s<t.length;s++)this.writeInt8(t[s])},l.prototype.writeUint32Array=function(t,s){if(this._realloc(t.length*4),t instanceof Uint32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint32Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeUint32(t[r],s)},l.prototype.writeUint16Array=function(t,s){if(this._realloc(t.length*2),t instanceof Uint16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint16Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeUint16(t[r],s)},l.prototype.writeUint8Array=function(t){if(this._realloc(t.length*1),t instanceof Uint8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint8Array(t.length);else for(var s=0;s<t.length;s++)this.writeUint8(t[s])},l.prototype.writeFloat64Array=function(t,s){if(this._realloc(t.length*8),t instanceof Float64Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat64Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeFloat64(t[r],s)},l.prototype.writeFloat32Array=function(t,s){if(this._realloc(t.length*4),t instanceof Float32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat32Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeFloat32(t[r],s)},l.prototype.writeInt32=function(t,s){this._realloc(4),this._dataView.setInt32(this.position,t,s??this.endianness),this.position+=4},l.prototype.writeInt16=function(t,s){this._realloc(2),this._dataView.setInt16(this.position,t,s??this.endianness),this.position+=2},l.prototype.writeInt8=function(t){this._realloc(1),this._dataView.setInt8(this.position,t),this.position+=1},l.prototype.writeUint32=function(t,s){this._realloc(4),this._dataView.setUint32(this.position,t,s??this.endianness),this.position+=4},l.prototype.writeUint16=function(t,s){this._realloc(2),this._dataView.setUint16(this.position,t,s??this.endianness),this.position+=2},l.prototype.writeUint8=function(t){this._realloc(1),this._dataView.setUint8(this.position,t),this.position+=1},l.prototype.writeFloat32=function(t,s){this._realloc(4),this._dataView.setFloat32(this.position,t,s??this.endianness),this.position+=4},l.prototype.writeFloat64=function(t,s){this._realloc(8),this._dataView.setFloat64(this.position,t,s??this.endianness),this.position+=8},l.prototype.writeUCS2String=function(t,s,r){r==null&&(r=t.length);for(var f=0;f<t.length&&f<r;f++)this.writeUint16(t.charCodeAt(f),s);for(;f<r;f++)this.writeUint16(0)},l.prototype.writeString=function(t,s,r){var f=0;if(s==null||s=="ASCII")if(r!=null){var u=Math.min(t.length,r);for(f=0;f<u;f++)this.writeUint8(t.charCodeAt(f));for(;f<r;f++)this.writeUint8(0)}else for(f=0;f<t.length;f++)this.writeUint8(t.charCodeAt(f));else this.writeUint8Array(new TextEncoder(s).encode(t.substring(0,r)))},l.prototype.writeCString=function(t,s){var r=0;if(s!=null){var f=Math.min(t.length,s);for(r=0;r<f;r++)this.writeUint8(t.charCodeAt(r));for(;r<s;r++)this.writeUint8(0)}else{for(r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));this.writeUint8(0)}},l.prototype.writeStruct=function(t,s){for(var r=0;r<t.length;r+=2){var f=t[r+1];this.writeType(f,s[t[r]],s)}},l.prototype.writeType=function(t,s,r){var f;if(typeof t=="function")return t(this,s);if(typeof t=="object"&&!(t instanceof Array))return t.set(this,s,r);var u=null,p="ASCII",g=this.position;switch(typeof t=="string"&&/:/.test(t)&&(f=t.split(":"),t=f[0],u=parseInt(f[1])),typeof t=="string"&&/,/.test(t)&&(f=t.split(","),t=f[0],p=parseInt(f[1])),t){case"uint8":this.writeUint8(s);break;case"int8":this.writeInt8(s);break;case"uint16":this.writeUint16(s,this.endianness);break;case"int16":this.writeInt16(s,this.endianness);break;case"uint32":this.writeUint32(s,this.endianness);break;case"int32":this.writeInt32(s,this.endianness);break;case"float32":this.writeFloat32(s,this.endianness);break;case"float64":this.writeFloat64(s,this.endianness);break;case"uint16be":this.writeUint16(s,l.BIG_ENDIAN);break;case"int16be":this.writeInt16(s,l.BIG_ENDIAN);break;case"uint32be":this.writeUint32(s,l.BIG_ENDIAN);break;case"int32be":this.writeInt32(s,l.BIG_ENDIAN);break;case"float32be":this.writeFloat32(s,l.BIG_ENDIAN);break;case"float64be":this.writeFloat64(s,l.BIG_ENDIAN);break;case"uint16le":this.writeUint16(s,l.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(s,l.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(s,l.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(s,l.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(s,l.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(s,l.LITTLE_ENDIAN);break;case"cstring":this.writeCString(s,u);break;case"string":this.writeString(s,p,u);break;case"u16string":this.writeUCS2String(s,this.endianness,u);break;case"u16stringle":this.writeUCS2String(s,l.LITTLE_ENDIAN,u);break;case"u16stringbe":this.writeUCS2String(s,l.BIG_ENDIAN,u);break;default:if(t.length==3){for(var S=t[1],B=0;B<s.length;B++)this.writeType(S,s[B]);break}else{this.writeStruct(t,s);break}}u!=null&&(this.position=g,this._realloc(u),this.position=g+u)},l.prototype.writeUint64=function(t){var s=Math.floor(t/c);this.writeUint32(s),this.writeUint32(t&4294967295)},l.prototype.writeUint24=function(t){this.writeUint8((t&16711680)>>16),this.writeUint8((t&65280)>>8),this.writeUint8(t&255)},l.prototype.adjustUint32=function(t,s){var r=this.position;this.seek(t),this.writeUint32(s),this.seek(r)},l.prototype.mapInt32Array=function(t,s){this._realloc(t*4);var r=new Int32Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*4,r},l.prototype.mapInt16Array=function(t,s){this._realloc(t*2);var r=new Int16Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*2,r},l.prototype.mapInt8Array=function(t){this._realloc(t*1);var s=new Int8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=t*1,s},l.prototype.mapUint32Array=function(t,s){this._realloc(t*4);var r=new Uint32Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*4,r},l.prototype.mapUint16Array=function(t,s){this._realloc(t*2);var r=new Uint16Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*2,r},l.prototype.mapFloat64Array=function(t,s){this._realloc(t*8);var r=new Float64Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*8,r},l.prototype.mapFloat32Array=function(t,s){this._realloc(t*4);var r=new Float32Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*4,r};var h=function(t){this.buffers=[],this.bufferIndex=-1,t&&(this.insertBuffer(t),this.bufferIndex=0)};h.prototype=new l(new ArrayBuffer,0,l.BIG_ENDIAN),h.prototype.initialized=function(){var t;return this.bufferIndex>-1?!0:this.buffers.length>0?(t=this.buffers[0],t.fileStart===0?(this.buffer=t,this.bufferIndex=0,n.debug("MultiBufferStream","Stream ready for parsing"),!0):(n.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(n.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1)},ArrayBuffer.concat=function(t,s){n.debug("ArrayBuffer","Trying to create a new buffer of size: "+(t.byteLength+s.byteLength));var r=new Uint8Array(t.byteLength+s.byteLength);return r.set(new Uint8Array(t),0),r.set(new Uint8Array(s),t.byteLength),r.buffer},h.prototype.reduceBuffer=function(t,s,r){var f;return f=new Uint8Array(r),f.set(new Uint8Array(t,s,r)),f.buffer.fileStart=t.fileStart+s,f.buffer.usedBytes=0,f.buffer},h.prototype.insertBuffer=function(t){for(var s=!0,r=0;r<this.buffers.length;r++){var f=this.buffers[r];if(t.fileStart<=f.fileStart){if(t.fileStart===f.fileStart)if(t.byteLength>f.byteLength){this.buffers.splice(r,1),r--;continue}else n.warn("MultiBufferStream","Buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+") already appended, ignoring");else t.fileStart+t.byteLength<=f.fileStart||(t=this.reduceBuffer(t,0,f.fileStart-t.fileStart)),n.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.splice(r,0,t),r===0&&(this.buffer=t);s=!1;break}else if(t.fileStart<f.fileStart+f.byteLength){var u=f.fileStart+f.byteLength-t.fileStart,p=t.byteLength-u;if(p>0)t=this.reduceBuffer(t,u,p);else{s=!1;break}}}s&&(n.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.push(t),r===0&&(this.buffer=t))},h.prototype.logBufferLevel=function(t){var s,r,f,u,p=[],g,S="";for(f=0,u=0,s=0;s<this.buffers.length;s++)r=this.buffers[s],s===0?(g={},p.push(g),g.start=r.fileStart,g.end=r.fileStart+r.byteLength,S+="["+g.start+"-"):g.end===r.fileStart?g.end=r.fileStart+r.byteLength:(g={},g.start=r.fileStart,S+=p[p.length-1].end-1+"], ["+g.start+"-",g.end=r.fileStart+r.byteLength,p.push(g)),f+=r.usedBytes,u+=r.byteLength;p.length>0&&(S+=g.end-1+"]");var B=t?n.info:n.debug;this.buffers.length===0?B("MultiBufferStream","No more buffer in memory"):B("MultiBufferStream",""+this.buffers.length+" stored buffer(s) ("+f+"/"+u+" bytes), continuous ranges: "+S)},h.prototype.cleanBuffers=function(){var t,s;for(t=0;t<this.buffers.length;t++)s=this.buffers[t],s.usedBytes===s.byteLength&&(n.debug("MultiBufferStream","Removing buffer #"+t),this.buffers.splice(t,1),t--)},h.prototype.mergeNextBuffer=function(){var t;if(this.bufferIndex+1<this.buffers.length)if(t=this.buffers[this.bufferIndex+1],t.fileStart===this.buffer.fileStart+this.buffer.byteLength){var s=this.buffer.byteLength,r=this.buffer.usedBytes,f=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,t),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=r,this.buffer.fileStart=f,n.debug("ISOFile","Concatenating buffer for box parsing (length: "+s+"->"+this.buffer.byteLength+")"),!0}else return!1;else return!1},h.prototype.findPosition=function(t,s,r){var f,u=null,p=-1;for(t===!0?f=0:f=this.bufferIndex;f<this.buffers.length&&(u=this.buffers[f],u.fileStart<=s);){p=f,r&&(u.fileStart+u.byteLength<=s?u.usedBytes=u.byteLength:u.usedBytes=s-u.fileStart,this.logBufferLevel());f++}return p!==-1?(u=this.buffers[p],u.fileStart+u.byteLength>=s?(n.debug("MultiBufferStream","Found position in existing buffer #"+p),p):-1):-1},h.prototype.findEndContiguousBuf=function(t){var s,r,f,u=t!==void 0?t:this.bufferIndex;if(r=this.buffers[u],this.buffers.length>u+1)for(s=u+1;s<this.buffers.length&&(f=this.buffers[s],f.fileStart===r.fileStart+r.byteLength);s++)r=f;return r.fileStart+r.byteLength},h.prototype.getEndFilePositionAfter=function(t){var s=this.findPosition(!0,t,!1);return s!==-1?this.findEndContiguousBuf(s):t},h.prototype.addUsedBytes=function(t){this.buffer.usedBytes+=t,this.logBufferLevel()},h.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},h.prototype.seek=function(t,s,r){var f;return f=this.findPosition(s,t,r),f!==-1?(this.buffer=this.buffers[f],this.bufferIndex=f,this.position=t-this.buffer.fileStart,n.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(n.debug("MultiBufferStream","Position "+t+" not found in buffered data"),!1)},h.prototype.getPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},h.prototype.getLength=function(){return this.byteLength},h.prototype.getEndPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength},e.MultiBufferStream=h;var d=function(){var t=3,s=4,r=5,f=6,u=[];u[t]="ES_Descriptor",u[s]="DecoderConfigDescriptor",u[r]="DecoderSpecificInfo",u[f]="SLConfigDescriptor",this.getDescriptorName=function(S){return u[S]};var p=this,g={};return this.parseOneDescriptor=function(S){var B=0,A,I,R;for(A=S.readUint8(),R=S.readUint8();R&128;)B=(B<<7)+(R&127),R=S.readUint8();return B=(B<<7)+(R&127),n.debug("MPEG4DescriptorParser","Found "+(u[A]||"Descriptor "+A)+", size "+B+" at position "+S.getPosition()),u[A]?I=new g[u[A]](B):I=new g.Descriptor(B),I.parse(S),I},g.Descriptor=function(S,B){this.tag=S,this.size=B,this.descs=[]},g.Descriptor.prototype.parse=function(S){this.data=S.readUint8Array(this.size)},g.Descriptor.prototype.findDescriptor=function(S){for(var B=0;B<this.descs.length;B++)if(this.descs[B].tag==S)return this.descs[B];return null},g.Descriptor.prototype.parseRemainingDescriptors=function(S){for(var B=S.position;S.position<B+this.size;){var A=p.parseOneDescriptor(S);this.descs.push(A)}},g.ES_Descriptor=function(S){g.Descriptor.call(this,t,S)},g.ES_Descriptor.prototype=new g.Descriptor,g.ES_Descriptor.prototype.parse=function(S){if(this.ES_ID=S.readUint16(),this.flags=S.readUint8(),this.size-=3,this.flags&128?(this.dependsOn_ES_ID=S.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,this.flags&64){var B=S.readUint8();this.URL=S.readString(B),this.size-=B+1}else this.URL="";this.flags&32?(this.OCR_ES_ID=S.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(S)},g.ES_Descriptor.prototype.getOTI=function(S){var B=this.findDescriptor(s);return B?B.oti:0},g.ES_Descriptor.prototype.getAudioConfig=function(S){var B=this.findDescriptor(s);if(!B)return null;var A=B.findDescriptor(r);if(A&&A.data){var I=(A.data[0]&248)>>3;return I===31&&A.data.length>=2&&(I=32+((A.data[0]&7)<<3)+((A.data[1]&224)>>5)),I}else return null},g.DecoderConfigDescriptor=function(S){g.Descriptor.call(this,s,S)},g.DecoderConfigDescriptor.prototype=new g.Descriptor,g.DecoderConfigDescriptor.prototype.parse=function(S){this.oti=S.readUint8(),this.streamType=S.readUint8(),this.upStream=(this.streamType>>1&1)!==0,this.streamType=this.streamType>>>2,this.bufferSize=S.readUint24(),this.maxBitrate=S.readUint32(),this.avgBitrate=S.readUint32(),this.size-=13,this.parseRemainingDescriptors(S)},g.DecoderSpecificInfo=function(S){g.Descriptor.call(this,r,S)},g.DecoderSpecificInfo.prototype=new g.Descriptor,g.SLConfigDescriptor=function(S){g.Descriptor.call(this,f,S)},g.SLConfigDescriptor.prototype=new g.Descriptor,this};e.MPEG4DescriptorParser=d;var o={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:[{type:"mdat",name:"MediaDataBox"},{type:"idat",name:"ItemDataBox"},{type:"free",name:"FreeSpaceBox"},{type:"skip",name:"FreeSpaceBox"},{type:"meco",name:"AdditionalMetadataContainerBox"},{type:"strk",name:"SubTrackBox"}],FULL_BOXES:[{type:"hmhd",name:"HintMediaHeaderBox"},{type:"nmhd",name:"NullMediaHeaderBox"},{type:"iods",name:"ObjectDescriptorBox"},{type:"xml ",name:"XMLBox"},{type:"bxml",name:"BinaryXMLBox"},{type:"ipro",name:"ItemProtectionBox"},{type:"mere",name:"MetaboxRelationBox"}],CONTAINER_BOXES:[[{type:"moov",name:"CompressedMovieBox"},["trak","pssh"]],[{type:"trak",name:"TrackBox"}],[{type:"edts",name:"EditBox"}],[{type:"mdia",name:"MediaBox"}],[{type:"minf",name:"MediaInformationBox"}],[{type:"dinf",name:"DataInformationBox"}],[{type:"stbl",name:"SampleTableBox"},["sgpd","sbgp"]],[{type:"mvex",name:"MovieExtendsBox"},["trex"]],[{type:"moof",name:"CompressedMovieFragmentBox"},["traf"]],[{type:"traf",name:"TrackFragmentBox"},["trun","sgpd","sbgp"]],[{type:"vttc",name:"VTTCueBox"}],[{type:"tref",name:"TrackReferenceBox"}],[{type:"iref",name:"ItemReferenceBox"}],[{type:"mfra",name:"MovieFragmentRandomAccessBox"},["tfra"]],[{type:"meco",name:"AdditionalMetadataContainerBox"}],[{type:"hnti",name:"trackhintinformation"}],[{type:"hinf",name:"hintstatisticsbox"}],[{type:"strk",name:"SubTrackBox"}],[{type:"strd",name:"SubTrackDefinitionBox"}],[{type:"sinf",name:"ProtectionSchemeInfoBox"}],[{type:"rinf",name:"RestrictedSchemeInfoBox"}],[{type:"schi",name:"SchemeInformationBox"}],[{type:"trgr",name:"TrackGroupBox"}],[{type:"udta",name:"UserDataBox"},["kind"]],[{type:"iprp",name:"ItemPropertiesBox"},["ipma"]],[{type:"ipco",name:"ItemPropertyContainerBox"}],[{type:"grpl",name:"GroupsListBox"}],[{type:"j2kH",name:"J2KHeaderInfoBox"}],[{type:"etyp",name:"ExtendedTypeBox"},["tyco"]]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){o.FullBox.prototype=new o.Box,o.ContainerBox.prototype=new o.Box,o.SampleEntry.prototype=new o.Box,o.TrackGroupTypeBox.prototype=new o.FullBox,o.BASIC_BOXES.forEach(function(t){o.createBoxCtor(t.type,t.name)}),o.FULL_BOXES.forEach(function(t){o.createFullBoxCtor(t.type,t.name)}),o.CONTAINER_BOXES.forEach(function(t){o.createContainerBoxCtor(t[0].type,t[0].name,null,t[1])})},Box:function(t,s,r,f){this.type=t,this.box_name=r,this.size=s,this.uuid=f},FullBox:function(t,s,r,f){o.Box.call(this,t,s,r,f),this.flags=0,this.version=0},ContainerBox:function(t,s,r,f){o.Box.call(this,t,s,r,f),this.boxes=[]},SampleEntry:function(t,s,r,f){o.ContainerBox.call(this,t,s),this.hdr_size=r,this.start=f},SampleGroupEntry:function(t){this.grouping_type=t},TrackGroupTypeBox:function(t,s){o.FullBox.call(this,t,s)},createBoxCtor:function(t,s,r){o.boxCodes.push(t),o[t+"Box"]=function(f){o.Box.call(this,t,f,s)},o[t+"Box"].prototype=new o.Box,r&&(o[t+"Box"].prototype.parse=r)},createFullBoxCtor:function(t,s,r){o[t+"Box"]=function(f){o.FullBox.call(this,t,f,s)},o[t+"Box"].prototype=new o.FullBox,o[t+"Box"].prototype.parse=function(f){this.parseFullHeader(f),r&&r.call(this,f)}},addSubBoxArrays:function(t){if(t){this.subBoxNames=t;for(var s=t.length,r=0;r<s;r++)this[t[r]+"s"]=[]}},createContainerBoxCtor:function(t,s,r,f){o[t+"Box"]=function(u){o.ContainerBox.call(this,t,u,s),o.addSubBoxArrays.call(this,f)},o[t+"Box"].prototype=new o.ContainerBox,r&&(o[t+"Box"].prototype.parse=r)},createMediaSampleEntryCtor:function(t,s,r){o.sampleEntryCodes[t]=[],o[t+"SampleEntry"]=function(f,u){o.SampleEntry.call(this,f,u),o.addSubBoxArrays.call(this,r)},o[t+"SampleEntry"].prototype=new o.SampleEntry,s&&(o[t+"SampleEntry"].prototype.parse=s)},createSampleEntryCtor:function(t,s,r,f){o.sampleEntryCodes[t].push(s),o[s+"SampleEntry"]=function(u){o[t+"SampleEntry"].call(this,s,u),o.addSubBoxArrays.call(this,f)},o[s+"SampleEntry"].prototype=new o[t+"SampleEntry"],r&&(o[s+"SampleEntry"].prototype.parse=r)},createEncryptedSampleEntryCtor:function(t,s,r){o.createSampleEntryCtor.call(this,t,s,r,["sinf"])},createSampleGroupCtor:function(t,s){o[t+"SampleGroupEntry"]=function(r){o.SampleGroupEntry.call(this,t,r)},o[t+"SampleGroupEntry"].prototype=new o.SampleGroupEntry,s&&(o[t+"SampleGroupEntry"].prototype.parse=s)},createTrackGroupCtor:function(t,s){o[t+"TrackGroupTypeBox"]=function(r){o.TrackGroupTypeBox.call(this,t,r)},o[t+"TrackGroupTypeBox"].prototype=new o.TrackGroupTypeBox,s&&(o[t+"TrackGroupTypeBox"].prototype.parse=s)},createUUIDBox:function(t,s,r,f,u){o.UUIDs.push(t),o.UUIDBoxes[t]=function(p){r?o.FullBox.call(this,"uuid",p,s,t):f?o.ContainerBox.call(this,"uuid",p,s,t):o.Box.call(this,"uuid",p,s,t)},o.UUIDBoxes[t].prototype=r?new o.FullBox:f?new o.ContainerBox:new o.Box,u&&(r?o.UUIDBoxes[t].prototype.parse=function(p){this.parseFullHeader(p),u&&u.call(this,p)}:o.UUIDBoxes[t].prototype.parse=u)}};o.initialize(),o.TKHD_FLAG_ENABLED=1,o.TKHD_FLAG_IN_MOVIE=2,o.TKHD_FLAG_IN_PREVIEW=4,o.TFHD_FLAG_BASE_DATA_OFFSET=1,o.TFHD_FLAG_SAMPLE_DESC=2,o.TFHD_FLAG_SAMPLE_DUR=8,o.TFHD_FLAG_SAMPLE_SIZE=16,o.TFHD_FLAG_SAMPLE_FLAGS=32,o.TFHD_FLAG_DUR_EMPTY=65536,o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,o.TRUN_FLAGS_DATA_OFFSET=1,o.TRUN_FLAGS_FIRST_FLAG=4,o.TRUN_FLAGS_DURATION=256,o.TRUN_FLAGS_SIZE=512,o.TRUN_FLAGS_FLAGS=1024,o.TRUN_FLAGS_CTS_OFFSET=2048,o.Box.prototype.add=function(t){return this.addBox(new o[t+"Box"])},o.Box.prototype.addBox=function(t){return this.boxes.push(t),this[t.type+"s"]?this[t.type+"s"].push(t):this[t.type]=t,t},o.Box.prototype.set=function(t,s){return this[t]=s,this},o.Box.prototype.addEntry=function(t,s){var r=s||"entries";return this[r]||(this[r]=[]),this[r].push(t),this},e.BoxParser=o,o.parseUUID=function(t){return o.parseHex16(t)},o.parseHex16=function(t){for(var s="",r=0;r<16;r++){var f=t.readUint8().toString(16);s+=f.length===1?"0"+f:f}return s},o.parseOneBox=function(t,s,r){var f,u=t.getPosition(),p=0,g,S;if(t.getEndPosition()-u<8)return n.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:o.ERR_NOT_ENOUGH_DATA};if(r&&r<8)return n.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:o.ERR_NOT_ENOUGH_DATA};var B=t.readUint32(),A=t.readString(4),I=A;if(n.debug("BoxParser","Found box of type '"+A+"' and size "+B+" at position "+u),p=8,A=="uuid"){if(t.getEndPosition()-t.getPosition()<16||r-p<16)return t.seek(u),n.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:o.ERR_NOT_ENOUGH_DATA};S=o.parseUUID(t),p+=16,I=S}if(B==1){if(t.getEndPosition()-t.getPosition()<8||r&&r-p<8)return t.seek(u),n.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+A+'" box'),{code:o.ERR_NOT_ENOUGH_DATA};B=t.readUint64(),p+=8}else if(B===0){if(r)B=r;else if(A!=="mdat")return n.error("BoxParser","Unlimited box size not supported for type: '"+A+"'"),f=new o.Box(A,B),{code:o.OK,box:f,size:f.size}}return B!==0&&B<p?(n.error("BoxParser","Box of type "+A+" has an invalid size "+B+" (too small to be a box)"),{code:o.ERR_NOT_ENOUGH_DATA,type:A,size:B,hdr_size:p,start:u}):B!==0&&r&&B>r?(n.error("BoxParser","Box of type '"+A+"' has a size "+B+" greater than its container size "+r),{code:o.ERR_NOT_ENOUGH_DATA,type:A,size:B,hdr_size:p,start:u}):B!==0&&u+B>t.getEndPosition()?(t.seek(u),n.info("BoxParser","Not enough data in stream to parse the entire '"+A+"' box"),{code:o.ERR_NOT_ENOUGH_DATA,type:A,size:B,hdr_size:p,start:u}):s?{code:o.OK,type:A,size:B,hdr_size:p,start:u}:(o[A+"Box"]?f=new o[A+"Box"](B):A!=="uuid"?(n.warn("BoxParser","Unknown box type: '"+A+"'"),f=new o.Box(A,B),f.has_unparsed_data=!0):o.UUIDBoxes[S]?f=new o.UUIDBoxes[S](B):(n.warn("BoxParser","Unknown uuid type: '"+S+"'"),f=new o.Box(A,B),f.uuid=S,f.has_unparsed_data=!0),f.hdr_size=p,f.start=u,f.write===o.Box.prototype.write&&f.type!=="mdat"&&(n.info("BoxParser","'"+I+"' box writing not yet implemented, keeping unparsed data in memory for later write"),f.parseDataAndRewind(t)),f.parse(t),g=t.getPosition()-(f.start+f.size),g<0?(n.warn("BoxParser","Parsing of box '"+I+"' did not read the entire indicated box data size (missing "+-g+" bytes), seeking forward"),t.seek(f.start+f.size)):g>0&&(n.error("BoxParser","Parsing of box '"+I+"' read "+g+" more bytes than the indicated box data size, seeking backwards"),f.size!==0&&t.seek(f.start+f.size)),{code:o.OK,box:f,size:f.size})},o.Box.prototype.parse=function(t){this.type!="mdat"?this.data=t.readUint8Array(this.size-this.hdr_size):this.size===0?t.seek(t.getEndPosition()):t.seek(this.start+this.size)},o.Box.prototype.parseDataAndRewind=function(t){this.data=t.readUint8Array(this.size-this.hdr_size),t.position-=this.size-this.hdr_size},o.FullBox.prototype.parseDataAndRewind=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,t.position-=this.size-this.hdr_size},o.FullBox.prototype.parseFullHeader=function(t){this.version=t.readUint8(),this.flags=t.readUint24(),this.hdr_size+=4},o.FullBox.prototype.parse=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},o.ContainerBox.prototype.parse=function(t){for(var s,r;t.getPosition()<this.start+this.size;)if(s=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),s.code===o.OK)if(r=s.box,this.boxes.push(r),this.subBoxNames&&this.subBoxNames.indexOf(r.type)!=-1)this[this.subBoxNames[this.subBoxNames.indexOf(r.type)]+"s"].push(r);else{var f=r.type!=="uuid"?r.type:r.uuid;this[f]?n.warn("Box of type "+f+" already stored in field of this type"):this[f]=r}else return},o.Box.prototype.parseLanguage=function(t){this.language=t.readUint16();var s=[];s[0]=this.language>>10&31,s[1]=this.language>>5&31,s[2]=this.language&31,this.languageString=String.fromCharCode(s[0]+96,s[1]+96,s[2]+96)},o.SAMPLE_ENTRY_TYPE_VISUAL="Visual",o.SAMPLE_ENTRY_TYPE_AUDIO="Audio",o.SAMPLE_ENTRY_TYPE_HINT="Hint",o.SAMPLE_ENTRY_TYPE_METADATA="Metadata",o.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",o.SAMPLE_ENTRY_TYPE_SYSTEM="System",o.SAMPLE_ENTRY_TYPE_TEXT="Text",o.SampleEntry.prototype.parseHeader=function(t){t.readUint8Array(6),this.data_reference_index=t.readUint16(),this.hdr_size+=8},o.SampleEntry.prototype.parse=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},o.SampleEntry.prototype.parseDataAndRewind=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,t.position-=this.size-this.hdr_size},o.SampleEntry.prototype.parseFooter=function(t){o.ContainerBox.prototype.parse.call(this,t)},o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_HINT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,function(t){var s;this.parseHeader(t),t.readUint16(),t.readUint16(),t.readUint32Array(3),this.width=t.readUint16(),this.height=t.readUint16(),this.horizresolution=t.readUint32(),this.vertresolution=t.readUint32(),t.readUint32(),this.frame_count=t.readUint16(),s=Math.min(31,t.readUint8()),this.compressorname=t.readString(s),s<31&&t.readString(31-s),this.depth=t.readUint16(),t.readUint16(),this.parseFooter(t)}),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,function(t){this.parseHeader(t),t.readUint32Array(2),this.channel_count=t.readUint16(),this.samplesize=t.readUint16(),t.readUint16(),t.readUint16(),this.samplerate=t.readUint32()/65536,this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dav1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvt1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"lhe1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dvh1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dvhe"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avs3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"j2ki"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"mjp2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"mjpg"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"uncv"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mha1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mha2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mhm1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mhm2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"fLaC"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT,"enct"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"encm"),o.createBoxCtor("a1lx","AV1LayeredImageIndexingProperty",function(t){var s=t.readUint8()&1,r=((s&1)+1)*16;this.layer_size=[];for(var f=0;f<3;f++)r==16?this.layer_size[f]=t.readUint16():this.layer_size[f]=t.readUint32()}),o.createBoxCtor("a1op","OperatingPointSelectorProperty",function(t){this.op_index=t.readUint8()}),o.createFullBoxCtor("auxC","AuxiliaryTypeProperty",function(t){this.aux_type=t.readCString();var s=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=t.readUint8Array(s)}),o.createBoxCtor("av1C","AV1CodecConfigurationBox",function(t){var s=t.readUint8();if((s>>7&1)!==1){n.error("av1C marker problem");return}if(this.version=s&127,this.version!==1){n.error("av1C version "+this.version+" not supported");return}if(s=t.readUint8(),this.seq_profile=s>>5&7,this.seq_level_idx_0=s&31,s=t.readUint8(),this.seq_tier_0=s>>7&1,this.high_bitdepth=s>>6&1,this.twelve_bit=s>>5&1,this.monochrome=s>>4&1,this.chroma_subsampling_x=s>>3&1,this.chroma_subsampling_y=s>>2&1,this.chroma_sample_position=s&3,s=t.readUint8(),this.reserved_1=s>>5&7,this.reserved_1!==0){n.error("av1C reserved_1 parsing problem");return}if(this.initial_presentation_delay_present=s>>4&1,this.initial_presentation_delay_present===1)this.initial_presentation_delay_minus_one=s&15;else if(this.reserved_2=s&15,this.reserved_2!==0){n.error("av1C reserved_2 parsing problem");return}var r=this.size-this.hdr_size-4;this.configOBUs=t.readUint8Array(r)});function _(t){var s="<table class='inner-table'>";s+="<thead><tr><th>length</th><th>nalu_data</th></tr></thead>",s+="<tbody>";for(var r=0;r<t.length;r++){var f=t[r];s+="<tr>",s+="<td>"+f.length+"</td>",s+="<td>",s+=f.nalu.reduce(function(u,p){return u+p.toString(16).padStart(2,"0")},"0x"),s+="</td></tr>"}return s+="</tbody></table>",s}o.createBoxCtor("avcC","AVCConfigurationBox",function(t){var s,r;for(this.configurationVersion=t.readUint8(),this.AVCProfileIndication=t.readUint8(),this.profile_compatibility=t.readUint8(),this.AVCLevelIndication=t.readUint8(),this.lengthSizeMinusOne=t.readUint8()&3,this.nb_SPS_nalus=t.readUint8()&31,r=this.size-this.hdr_size-6,this.SPS=[],this.SPS.toString=function(){return _(this)},s=0;s<this.nb_SPS_nalus;s++)this.SPS[s]={},this.SPS[s].length=t.readUint16(),this.SPS[s].nalu=t.readUint8Array(this.SPS[s].length),r-=2+this.SPS[s].length;for(this.nb_PPS_nalus=t.readUint8(),r--,this.PPS=[],this.PPS.toString=function(){return _(this)},s=0;s<this.nb_PPS_nalus;s++)this.PPS[s]={},this.PPS[s].length=t.readUint16(),this.PPS[s].nalu=t.readUint8Array(this.PPS[s].length),r-=2+this.PPS[s].length;r>0&&(this.ext=t.readUint8Array(r))}),o.createBoxCtor("btrt","BitRateBox",function(t){this.bufferSizeDB=t.readUint32(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32()}),o.createFullBoxCtor("ccst","CodingConstraintsBox",function(t){var s=t.readUint8();this.all_ref_pics_intra=(s&128)==128,this.intra_pred_used=(s&64)==64,this.max_ref_per_pic=(s&63)>>2,t.readUint24()}),o.createBoxCtor("cdef","ComponentDefinitionBox",function(t){var s;for(this.channel_count=t.readUint16(),this.channel_indexes=[],this.channel_types=[],this.channel_associations=[],s=0;s<this.channel_count;s++)this.channel_indexes.push(t.readUint16()),this.channel_types.push(t.readUint16()),this.channel_associations.push(t.readUint16())}),o.createBoxCtor("clap","CleanApertureBox",function(t){this.cleanApertureWidthN=t.readUint32(),this.cleanApertureWidthD=t.readUint32(),this.cleanApertureHeightN=t.readUint32(),this.cleanApertureHeightD=t.readUint32(),this.horizOffN=t.readUint32(),this.horizOffD=t.readUint32(),this.vertOffN=t.readUint32(),this.vertOffD=t.readUint32()}),o.createBoxCtor("clli","ContentLightLevelBox",function(t){this.max_content_light_level=t.readUint16(),this.max_pic_average_light_level=t.readUint16()}),o.createFullBoxCtor("cmex","CameraExtrinsicMatrixProperty",function(t){this.flags&1&&(this.pos_x=t.readInt32()),this.flags&2&&(this.pos_y=t.readInt32()),this.flags&4&&(this.pos_z=t.readInt32()),this.flags&8&&(this.version==0?this.flags&16?(this.quat_x=t.readInt32(),this.quat_y=t.readInt32(),this.quat_z=t.readInt32()):(this.quat_x=t.readInt16(),this.quat_y=t.readInt16(),this.quat_z=t.readInt16()):this.version==1),this.flags&32&&(this.id=t.readUint32())}),o.createFullBoxCtor("cmin","CameraIntrinsicMatrixProperty",function(t){this.focal_length_x=t.readInt32(),this.principal_point_x=t.readInt32(),this.principal_point_y=t.readInt32(),this.flags&1&&(this.focal_length_y=t.readInt32(),this.skew_factor=t.readInt32())}),o.createBoxCtor("cmpd","ComponentDefinitionBox",function(t){for(this.component_count=t.readUint32(),this.component_types=[],this.component_type_urls=[],i=0;i<this.component_count;i++){var s=t.readUint16();this.component_types.push(s),s>=32768&&this.component_type_urls.push(t.readCString())}}),o.createFullBoxCtor("co64","ChunkLargeOffsetBox",function(t){var s,r;if(s=t.readUint32(),this.chunk_offsets=[],this.version===0)for(r=0;r<s;r++)this.chunk_offsets.push(t.readUint64())}),o.createFullBoxCtor("CoLL","ContentLightLevelBox",function(t){this.maxCLL=t.readUint16(),this.maxFALL=t.readUint16()}),o.createBoxCtor("colr","ColourInformationBox",function(t){if(this.colour_type=t.readString(4),this.colour_type==="nclx"){this.colour_primaries=t.readUint16(),this.transfer_characteristics=t.readUint16(),this.matrix_coefficients=t.readUint16();var s=t.readUint8();this.full_range_flag=s>>7}else this.colour_type==="rICC"?this.ICC_profile=t.readUint8Array(this.size-4):this.colour_type==="prof"&&(this.ICC_profile=t.readUint8Array(this.size-4))}),o.createFullBoxCtor("cprt","CopyrightBox",function(t){this.parseLanguage(t),this.notice=t.readCString()}),o.createFullBoxCtor("cslg","CompositionToDecodeBox",function(t){this.version===0&&(this.compositionToDTSShift=t.readInt32(),this.leastDecodeToDisplayDelta=t.readInt32(),this.greatestDecodeToDisplayDelta=t.readInt32(),this.compositionStartTime=t.readInt32(),this.compositionEndTime=t.readInt32())}),o.createFullBoxCtor("ctts","CompositionOffsetBox",function(t){var s,r;if(s=t.readUint32(),this.sample_counts=[],this.sample_offsets=[],this.version===0)for(r=0;r<s;r++){this.sample_counts.push(t.readUint32());var f=t.readInt32();f<0&&n.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(f)}else if(this.version==1)for(r=0;r<s;r++)this.sample_counts.push(t.readUint32()),this.sample_offsets.push(t.readInt32())}),o.createBoxCtor("dac3","AC3SpecificBox",function(t){var s=t.readUint8(),r=t.readUint8(),f=t.readUint8();this.fscod=s>>6,this.bsid=s>>1&31,this.bsmod=(s&1)<<2|r>>6&3,this.acmod=r>>3&7,this.lfeon=r>>2&1,this.bit_rate_code=r&3|f>>5&7}),o.createBoxCtor("dec3","EC3SpecificBox",function(t){var s=t.readUint16();this.data_rate=s>>3,this.num_ind_sub=s&7,this.ind_subs=[];for(var r=0;r<this.num_ind_sub+1;r++){var f={};this.ind_subs.push(f);var u=t.readUint8(),p=t.readUint8(),g=t.readUint8();f.fscod=u>>6,f.bsid=u>>1&31,f.bsmod=(u&1)<<4|p>>4&15,f.acmod=p>>1&7,f.lfeon=p&1,f.num_dep_sub=g>>1&15,f.num_dep_sub>0&&(f.chan_loc=(g&1)<<8|t.readUint8())}}),o.createFullBoxCtor("dfLa","FLACSpecificBox",function(t){var s=127,r=128,f=[],u=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];do{var p=t.readUint8(),g=Math.min(p&s,u.length-1);if(g?t.readUint8Array(t.readUint24()):(t.readUint8Array(13),this.samplerate=t.readUint32()>>12,t.readUint8Array(20)),f.push(u[g]),p&r)break}while(!0);this.numMetadataBlocks=f.length+" ("+f.join(", ")+")"}),o.createBoxCtor("dimm","hintimmediateBytesSent",function(t){this.bytessent=t.readUint64()}),o.createBoxCtor("dmax","hintlongestpacket",function(t){this.time=t.readUint32()}),o.createBoxCtor("dmed","hintmediaBytesSent",function(t){this.bytessent=t.readUint64()}),o.createBoxCtor("dOps","OpusSpecificBox",function(t){if(this.Version=t.readUint8(),this.OutputChannelCount=t.readUint8(),this.PreSkip=t.readUint16(),this.InputSampleRate=t.readUint32(),this.OutputGain=t.readInt16(),this.ChannelMappingFamily=t.readUint8(),this.ChannelMappingFamily!==0){this.StreamCount=t.readUint8(),this.CoupledCount=t.readUint8(),this.ChannelMapping=[];for(var s=0;s<this.OutputChannelCount;s++)this.ChannelMapping[s]=t.readUint8()}}),o.createFullBoxCtor("dref","DataReferenceBox",function(t){var s,r;this.entries=[];for(var f=t.readUint32(),u=0;u<f;u++)if(s=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),s.code===o.OK)r=s.box,this.entries.push(r);else return}),o.createBoxCtor("drep","hintrepeatedBytesSent",function(t){this.bytessent=t.readUint64()}),o.createFullBoxCtor("elng","ExtendedLanguageBox",function(t){this.extended_language=t.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("elst","EditListBox",function(t){this.entries=[];for(var s=t.readUint32(),r=0;r<s;r++){var f={};this.entries.push(f),this.version===1?(f.segment_duration=t.readUint64(),f.media_time=t.readInt64()):(f.segment_duration=t.readUint32(),f.media_time=t.readInt32()),f.media_rate_integer=t.readInt16(),f.media_rate_fraction=t.readInt16()}}),o.createFullBoxCtor("emsg","EventMessageBox",function(t){this.version==1?(this.timescale=t.readUint32(),this.presentation_time=t.readUint64(),this.event_duration=t.readUint32(),this.id=t.readUint32(),this.scheme_id_uri=t.readCString(),this.value=t.readCString()):(this.scheme_id_uri=t.readCString(),this.value=t.readCString(),this.timescale=t.readUint32(),this.presentation_time_delta=t.readUint32(),this.event_duration=t.readUint32(),this.id=t.readUint32());var s=this.size-this.hdr_size-(4*4+(this.scheme_id_uri.length+1)+(this.value.length+1));this.version==1&&(s-=4),this.message_data=t.readUint8Array(s)}),o.createEntityToGroupCtor=function(t,s){o[t+"Box"]=function(r){o.FullBox.call(this,t,r)},o[t+"Box"].prototype=new o.FullBox,o[t+"Box"].prototype.parse=function(r){if(this.parseFullHeader(r),s)s.call(this,r);else for(this.group_id=r.readUint32(),this.num_entities_in_group=r.readUint32(),this.entity_ids=[],i=0;i<this.num_entities_in_group;i++){var f=r.readUint32();this.entity_ids.push(f)}}},o.createEntityToGroupCtor("aebr"),o.createEntityToGroupCtor("afbr"),o.createEntityToGroupCtor("albc"),o.createEntityToGroupCtor("altr"),o.createEntityToGroupCtor("brst"),o.createEntityToGroupCtor("dobr"),o.createEntityToGroupCtor("eqiv"),o.createEntityToGroupCtor("favc"),o.createEntityToGroupCtor("fobr"),o.createEntityToGroupCtor("iaug"),o.createEntityToGroupCtor("pano"),o.createEntityToGroupCtor("slid"),o.createEntityToGroupCtor("ster"),o.createEntityToGroupCtor("tsyn"),o.createEntityToGroupCtor("wbbr"),o.createEntityToGroupCtor("prgr"),o.createEntityToGroupCtor("pymd",function(t){this.group_id=t.readUint32(),this.num_entities_in_group=t.readUint32(),this.entity_ids=[];for(var s=0;s<this.num_entities_in_group;s++){var r=t.readUint32();this.entity_ids.push(r)}for(this.tile_size_x=t.readUint16(),this.tile_size_y=t.readUint16(),this.layer_binning=[],this.tiles_in_layer_column_minus1=[],this.tiles_in_layer_row_minus1=[],s=0;s<this.num_entities_in_group;s++)this.layer_binning[s]=t.readUint16(),this.tiles_in_layer_row_minus1[s]=t.readUint16(),this.tiles_in_layer_column_minus1[s]=t.readUint16()}),o.createFullBoxCtor("esds","ElementaryStreamDescriptorBox",function(t){var s=t.readUint8Array(this.size-this.hdr_size);if(typeof d<"u"){var r=new d;this.esd=r.parseOneDescriptor(new l(s.buffer,0,l.BIG_ENDIAN))}}),o.createBoxCtor("fiel","FieldHandlingBox",function(t){this.fieldCount=t.readUint8(),this.fieldOrdering=t.readUint8()}),o.createBoxCtor("frma","OriginalFormatBox",function(t){this.data_format=t.readString(4)}),o.createBoxCtor("ftyp","FileTypeBox",function(t){var s=this.size-this.hdr_size;this.major_brand=t.readString(4),this.minor_version=t.readUint32(),s-=8,this.compatible_brands=[];for(var r=0;s>=4;)this.compatible_brands[r]=t.readString(4),s-=4,r++}),o.createFullBoxCtor("hdlr","HandlerBox",function(t){this.version===0&&(t.readUint32(),this.handler=t.readString(4),t.readUint32Array(3),this.name=t.readString(this.size-this.hdr_size-20),this.name[this.name.length-1]==="\0"&&(this.name=this.name.slice(0,-1)))}),o.createBoxCtor("hvcC","HEVCConfigurationBox",function(t){var s,r,f,u;this.configurationVersion=t.readUint8(),u=t.readUint8(),this.general_profile_space=u>>6,this.general_tier_flag=(u&32)>>5,this.general_profile_idc=u&31,this.general_profile_compatibility=t.readUint32(),this.general_constraint_indicator=t.readUint8Array(6),this.general_level_idc=t.readUint8(),this.min_spatial_segmentation_idc=t.readUint16()&4095,this.parallelismType=t.readUint8()&3,this.chroma_format_idc=t.readUint8()&3,this.bit_depth_luma_minus8=t.readUint8()&7,this.bit_depth_chroma_minus8=t.readUint8()&7,this.avgFrameRate=t.readUint16(),u=t.readUint8(),this.constantFrameRate=u>>6,this.numTemporalLayers=(u&13)>>3,this.temporalIdNested=(u&4)>>2,this.lengthSizeMinusOne=u&3,this.nalu_arrays=[],this.nalu_arrays.toString=function(){var A="<table class='inner-table'>";A+="<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>",A+="<tbody>";for(var I=0;I<this.length;I++){var R=this[I];A+="<tr>",A+="<td rowspan='"+R.length+"'>"+R.completeness+"</td>",A+="<td rowspan='"+R.length+"'>"+R.nalu_type+"</td>";for(var K=0;K<R.length;K++){var D=R[K];K!==0&&(A+="<tr>"),A+="<td>",A+=D.data.reduce(function(at,it){return at+it.toString(16).padStart(2,"0")},"0x"),A+="</td></tr>"}}return A+="</tbody></table>",A};var p=t.readUint8();for(s=0;s<p;s++){var g=[];this.nalu_arrays.push(g),u=t.readUint8(),g.completeness=(u&128)>>7,g.nalu_type=u&63;var S=t.readUint16();for(r=0;r<S;r++){var B={};g.push(B),f=t.readUint16(),B.data=t.readUint8Array(f)}}}),o.createFullBoxCtor("iinf","ItemInfoBox",function(t){var s;this.version===0?this.entry_count=t.readUint16():this.entry_count=t.readUint32(),this.item_infos=[];for(var r=0;r<this.entry_count;r++)if(s=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),s.code===o.OK)s.box.type!=="infe"&&n.error("BoxParser","Expected 'infe' box, got "+s.box.type),this.item_infos[r]=s.box;else return}),o.createFullBoxCtor("iloc","ItemLocationBox",function(t){var s;s=t.readUint8(),this.offset_size=s>>4&15,this.length_size=s&15,s=t.readUint8(),this.base_offset_size=s>>4&15,this.version===1||this.version===2?this.index_size=s&15:this.index_size=0,this.items=[];var r=0;if(this.version<2)r=t.readUint16();else if(this.version===2)r=t.readUint32();else throw"version of iloc box not supported";for(var f=0;f<r;f++){var u={};if(this.items.push(u),this.version<2)u.item_ID=t.readUint16();else if(this.version===2)u.item_ID=t.readUint32();else throw"version of iloc box not supported";switch(this.version===1||this.version===2?u.construction_method=t.readUint16()&15:u.construction_method=0,u.data_reference_index=t.readUint16(),this.base_offset_size){case 0:u.base_offset=0;break;case 4:u.base_offset=t.readUint32();break;case 8:u.base_offset=t.readUint64();break;default:throw"Error reading base offset size"}var p=t.readUint16();u.extents=[];for(var g=0;g<p;g++){var S={};if(u.extents.push(S),this.version===1||this.version===2)switch(this.index_size){case 0:S.extent_index=0;break;case 4:S.extent_index=t.readUint32();break;case 8:S.extent_index=t.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:S.extent_offset=0;break;case 4:S.extent_offset=t.readUint32();break;case 8:S.extent_offset=t.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:S.extent_length=0;break;case 4:S.extent_length=t.readUint32();break;case 8:S.extent_length=t.readUint64();break;default:throw"Error reading extent index"}}}}),o.createBoxCtor("imir","ImageMirror",function(t){var s=t.readUint8();this.reserved=s>>7,this.axis=s&1}),o.createFullBoxCtor("infe","ItemInfoEntry",function(t){if((this.version===0||this.version===1)&&(this.item_ID=t.readUint16(),this.item_protection_index=t.readUint16(),this.item_name=t.readCString(),this.content_type=t.readCString(),this.content_encoding=t.readCString()),this.version===1){this.extension_type=t.readString(4),n.warn("BoxParser","Cannot parse extension type"),t.seek(this.start+this.size);return}this.version>=2&&(this.version===2?this.item_ID=t.readUint16():this.version===3&&(this.item_ID=t.readUint32()),this.item_protection_index=t.readUint16(),this.item_type=t.readString(4),this.item_name=t.readCString(),this.item_type==="mime"?(this.content_type=t.readCString(),this.content_encoding=t.readCString()):this.item_type==="uri "&&(this.item_uri_type=t.readCString()))}),o.createFullBoxCtor("ipma","ItemPropertyAssociationBox",function(t){var s,r;for(entry_count=t.readUint32(),this.associations=[],s=0;s<entry_count;s++){var f={};this.associations.push(f),this.version<1?f.id=t.readUint16():f.id=t.readUint32();var u=t.readUint8();for(f.props=[],r=0;r<u;r++){var p=t.readUint8(),g={};f.props.push(g),g.essential=(p&128)>>7===1,this.flags&1?g.property_index=(p&127)<<8|t.readUint8():g.property_index=p&127}}}),o.createFullBoxCtor("iref","ItemReferenceBox",function(t){var s,r;for(this.references=[];t.getPosition()<this.start+this.size;)if(s=o.parseOneBox(t,!0,this.size-(t.getPosition()-this.start)),s.code===o.OK)this.version===0?r=new o.SingleItemTypeReferenceBox(s.type,s.size,s.hdr_size,s.start):r=new o.SingleItemTypeReferenceBoxLarge(s.type,s.size,s.hdr_size,s.start),r.write===o.Box.prototype.write&&r.type!=="mdat"&&(n.warn("BoxParser",r.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),r.parseDataAndRewind(t)),r.parse(t),this.references.push(r);else return}),o.createBoxCtor("irot","ImageRotation",function(t){this.angle=t.readUint8()&3}),o.createFullBoxCtor("ispe","ImageSpatialExtentsProperty",function(t){this.image_width=t.readUint32(),this.image_height=t.readUint32()}),o.createFullBoxCtor("kind","KindBox",function(t){this.schemeURI=t.readCString(),this.value=t.readCString()}),o.createFullBoxCtor("leva","LevelAssignmentBox",function(t){var s=t.readUint8();this.levels=[];for(var r=0;r<s;r++){var f={};this.levels[r]=f,f.track_ID=t.readUint32();var u=t.readUint8();switch(f.padding_flag=u>>7,f.assignment_type=u&127,f.assignment_type){case 0:f.grouping_type=t.readString(4);break;case 1:f.grouping_type=t.readString(4),f.grouping_type_parameter=t.readUint32();break;case 2:break;case 3:break;case 4:f.sub_track_id=t.readUint32();break;default:n.warn("BoxParser","Unknown leva assignement type")}}}),o.createBoxCtor("lhvC","LHEVCConfigurationBox",function(t){var s,r,f;this.configurationVersion=t.readUint8(),this.min_spatial_segmentation_idc=t.readUint16()&4095,this.parallelismType=t.readUint8()&3,f=t.readUint8(),this.numTemporalLayers=(f&13)>>3,this.temporalIdNested=(f&4)>>2,this.lengthSizeMinusOne=f&3,this.nalu_arrays=[],this.nalu_arrays.toString=function(){var A="<table class='inner-table'>";A+="<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>",A+="<tbody>";for(var I=0;I<this.length;I++){var R=this[I];A+="<tr>",A+="<td rowspan='"+R.length+"'>"+R.completeness+"</td>",A+="<td rowspan='"+R.length+"'>"+R.nalu_type+"</td>";for(var K=0;K<R.length;K++){var D=R[K];K!==0&&(A+="<tr>"),A+="<td>",A+=D.data.reduce(function(at,it){return at+it.toString(16).padStart(2,"0")},"0x"),A+="</td></tr>"}}return A+="</tbody></table>",A};var u=t.readUint8();for(s=0;s<u;s++){var p=[];this.nalu_arrays.push(p),f=t.readUint8(),p.completeness=(f&128)>>7,p.nalu_type=f&63;var g=t.readUint16();for(r=0;r<g;r++){var S={};p.push(S);var B=t.readUint16();S.data=t.readUint8Array(B)}}}),o.createBoxCtor("lsel","LayerSelectorProperty",function(t){this.layer_id=t.readUint16()}),o.createBoxCtor("maxr","hintmaxrate",function(t){this.period=t.readUint32(),this.bytes=t.readUint32()});function b(t,s){this.x=t,this.y=s}b.prototype.toString=function(){return"("+this.x+","+this.y+")"},o.createBoxCtor("mdcv","MasteringDisplayColourVolumeBox",function(t){this.display_primaries=[],this.display_primaries[0]=new b(t.readUint16(),t.readUint16()),this.display_primaries[1]=new b(t.readUint16(),t.readUint16()),this.display_primaries[2]=new b(t.readUint16(),t.readUint16()),this.white_point=new b(t.readUint16(),t.readUint16()),this.max_display_mastering_luminance=t.readUint32(),this.min_display_mastering_luminance=t.readUint32()}),o.createFullBoxCtor("mdhd","MediaHeaderBox",function(t){this.version==1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.parseLanguage(t),t.readUint16()}),o.createFullBoxCtor("mehd","MovieExtendsHeaderBox",function(t){this.flags&1&&(n.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.version==1?this.fragment_duration=t.readUint64():this.fragment_duration=t.readUint32()}),o.createFullBoxCtor("meta","MetaBox",function(t){this.boxes=[],o.ContainerBox.prototype.parse.call(this,t)}),o.createFullBoxCtor("mfhd","MovieFragmentHeaderBox",function(t){this.sequence_number=t.readUint32()}),o.createFullBoxCtor("mfro","MovieFragmentRandomAccessOffsetBox",function(t){this._size=t.readUint32()}),o.createFullBoxCtor("mskC","MaskConfigurationProperty",function(t){this.bits_per_pixel=t.readUint8()}),o.createFullBoxCtor("mvhd","MovieHeaderBox",function(t){this.version==1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.rate=t.readUint32(),this.volume=t.readUint16()>>8,t.readUint16(),t.readUint32Array(2),this.matrix=t.readUint32Array(9),t.readUint32Array(6),this.next_track_id=t.readUint32()}),o.createBoxCtor("npck","hintPacketsSent",function(t){this.packetssent=t.readUint32()}),o.createBoxCtor("nump","hintPacketsSent",function(t){this.packetssent=t.readUint64()}),o.createFullBoxCtor("padb","PaddingBitsBox",function(t){var s=t.readUint32();this.padbits=[];for(var r=0;r<Math.floor((s+1)/2);r++)this.padbits=t.readUint8()}),o.createBoxCtor("pasp","PixelAspectRatioBox",function(t){this.hSpacing=t.readUint32(),this.vSpacing=t.readUint32()}),o.createBoxCtor("payl","CuePayloadBox",function(t){this.text=t.readString(this.size-this.hdr_size)}),o.createBoxCtor("payt","hintpayloadID",function(t){this.payloadID=t.readUint32();var s=t.readUint8();this.rtpmap_string=t.readString(s)}),o.createFullBoxCtor("pdin","ProgressiveDownloadInfoBox",function(t){var s=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var r=0;r<s;r++)this.rate[r]=t.readUint32(),this.initial_delay[r]=t.readUint32()}),o.createFullBoxCtor("pitm","PrimaryItemBox",function(t){this.version===0?this.item_id=t.readUint16():this.item_id=t.readUint32()}),o.createFullBoxCtor("pixi","PixelInformationProperty",function(t){var s;for(this.num_channels=t.readUint8(),this.bits_per_channels=[],s=0;s<this.num_channels;s++)this.bits_per_channels[s]=t.readUint8()}),o.createBoxCtor("pmax","hintlargestpacket",function(t){this.bytes=t.readUint32()}),o.createFullBoxCtor("prdi","ProgressiveDerivedImageItemInformationProperty",function(t){if(this.step_count=t.readUint16(),this.item_count=[],this.flags&2)for(var s=0;s<this.step_count;s++)this.item_count[s]=t.readUint16()}),o.createFullBoxCtor("prft","ProducerReferenceTimeBox",function(t){this.ref_track_id=t.readUint32(),this.ntp_timestamp=t.readUint64(),this.version===0?this.media_time=t.readUint32():this.media_time=t.readUint64()}),o.createFullBoxCtor("pssh","ProtectionSystemSpecificHeaderBox",function(t){if(this.system_id=o.parseHex16(t),this.version>0){var s=t.readUint32();this.kid=[];for(var r=0;r<s;r++)this.kid[r]=o.parseHex16(t)}var f=t.readUint32();f>0&&(this.data=t.readUint8Array(f))}),o.createFullBoxCtor("clef","TrackCleanApertureDimensionsBox",function(t){this.width=t.readUint32(),this.height=t.readUint32()}),o.createFullBoxCtor("enof","TrackEncodedPixelsDimensionsBox",function(t){this.width=t.readUint32(),this.height=t.readUint32()}),o.createFullBoxCtor("prof","TrackProductionApertureDimensionsBox",function(t){this.width=t.readUint32(),this.height=t.readUint32()}),o.createContainerBoxCtor("tapt","TrackApertureModeDimensionsBox",null,["clef","prof","enof"]),o.createBoxCtor("rtp ","rtpmoviehintinformation",function(t){this.descriptionformat=t.readString(4),this.sdptext=t.readString(this.size-this.hdr_size-4)}),o.createFullBoxCtor("saio","SampleAuxiliaryInformationOffsetsBox",function(t){this.flags&1&&(this.aux_info_type=t.readString(4),this.aux_info_type_parameter=t.readUint32());var s=t.readUint32();this.offset=[];for(var r=0;r<s;r++)this.version===0?this.offset[r]=t.readUint32():this.offset[r]=t.readUint64()}),o.createFullBoxCtor("saiz","SampleAuxiliaryInformationSizesBox",function(t){if(this.flags&1&&(this.aux_info_type=t.readString(4),this.aux_info_type_parameter=t.readUint32()),this.default_sample_info_size=t.readUint8(),this.sample_count=t.readUint32(),this.sample_info_size=[],this.default_sample_info_size===0)for(var s=0;s<this.sample_count;s++)this.sample_info_size[s]=t.readUint8()}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"mett",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"metx",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",function(t){this.parseHeader(t),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.auxiliary_mime_types=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",function(t){this.parseHeader(t),this.displayFlags=t.readUint32(),this.horizontal_justification=t.readInt8(),this.vertical_justification=t.readInt8(),this.bg_color_rgba=t.readUint8Array(4),this.box_record=t.readInt16Array(4),this.style_record=t.readUint8Array(12),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",function(t){this.parseHeader(t),this.parseFooter(t)}),o.createSampleGroupCtor("alst",function(t){var s,r=t.readUint16();for(this.first_output_sample=t.readUint16(),this.sample_offset=[],s=0;s<r;s++)this.sample_offset[s]=t.readUint32();var f=this.description_length-4-4*r;for(this.num_output_samples=[],this.num_total_samples=[],s=0;s<f/4;s++)this.num_output_samples[s]=t.readUint16(),this.num_total_samples[s]=t.readUint16()}),o.createSampleGroupCtor("avll",function(t){this.layerNumber=t.readUint8(),this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()}),o.createSampleGroupCtor("avss",function(t){this.subSequenceIdentifier=t.readUint16(),this.layerNumber=t.readUint8();var s=t.readUint8();this.durationFlag=s>>7,this.avgRateFlag=s>>6&1,this.durationFlag&&(this.duration=t.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()),this.dependency=[];for(var r=t.readUint8(),f=0;f<r;f++){var u={};this.dependency.push(u),u.subSeqDirectionFlag=t.readUint8(),u.layerNumber=t.readUint8(),u.subSequenceIdentifier=t.readUint16()}}),o.createSampleGroupCtor("dtrt",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("mvif",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("prol",function(t){this.roll_distance=t.readInt16()}),o.createSampleGroupCtor("rap ",function(t){var s=t.readUint8();this.num_leading_samples_known=s>>7,this.num_leading_samples=s&127}),o.createSampleGroupCtor("rash",function(t){if(this.operation_point_count=t.readUint16(),this.description_length!==2+(this.operation_point_count===1?2:this.operation_point_count*6)+9)n.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=t.readUint8Array(this.description_length-2);else{if(this.operation_point_count===1)this.target_rate_share=t.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var s=0;s<this.operation_point_count;s++)this.available_bitrate[s]=t.readUint32(),this.target_rate_share[s]=t.readUint16()}this.maximum_bitrate=t.readUint32(),this.minimum_bitrate=t.readUint32(),this.discard_priority=t.readUint8()}}),o.createSampleGroupCtor("roll",function(t){this.roll_distance=t.readInt16()}),o.SampleGroupEntry.prototype.parse=function(t){n.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=t.readUint8Array(this.description_length)},o.createSampleGroupCtor("scif",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("scnm",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("seig",function(t){this.reserved=t.readUint8();var s=t.readUint8();this.crypt_byte_block=s>>4,this.skip_byte_block=s&15,this.isProtected=t.readUint8(),this.Per_Sample_IV_Size=t.readUint8(),this.KID=o.parseHex16(t),this.constant_IV_size=0,this.constant_IV=0,this.isProtected===1&&this.Per_Sample_IV_Size===0&&(this.constant_IV_size=t.readUint8(),this.constant_IV=t.readUint8Array(this.constant_IV_size))}),o.createSampleGroupCtor("stsa",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("sync",function(t){var s=t.readUint8();this.NAL_unit_type=s&63}),o.createSampleGroupCtor("tele",function(t){var s=t.readUint8();this.level_independently_decodable=s>>7}),o.createSampleGroupCtor("tsas",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("tscl",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("vipr",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createFullBoxCtor("sbgp","SampleToGroupBox",function(t){this.grouping_type=t.readString(4),this.version===1?this.grouping_type_parameter=t.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var s=t.readUint32(),r=0;r<s;r++){var f={};this.entries.push(f),f.sample_count=t.readInt32(),f.group_description_index=t.readInt32()}});function v(t,s){this.bad_pixel_row=t,this.bad_pixel_column=s}v.prototype.toString=function(){return"[row: "+this.bad_pixel_row+", column: "+this.bad_pixel_column+"]"},o.createFullBoxCtor("sbpm","SensorBadPixelsMapBox",function(t){var s;for(this.component_count=t.readUint16(),this.component_index=[],s=0;s<this.component_count;s++)this.component_index.push(t.readUint16());var r=t.readUint8();for(this.correction_applied=(r&128)==128,this.num_bad_rows=t.readUint32(),this.num_bad_cols=t.readUint32(),this.num_bad_pixels=t.readUint32(),this.bad_rows=[],this.bad_columns=[],this.bad_pixels=[],s=0;s<this.num_bad_rows;s++)this.bad_rows.push(t.readUint32());for(s=0;s<this.num_bad_cols;s++)this.bad_columns.push(t.readUint32());for(s=0;s<this.num_bad_pixels;s++){var f=t.readUint32(),u=t.readUint32();this.bad_pixels.push(new v(f,u))}}),o.createFullBoxCtor("schm","SchemeTypeBox",function(t){this.scheme_type=t.readString(4),this.scheme_version=t.readUint32(),this.flags&1&&(this.scheme_uri=t.readString(this.size-this.hdr_size-8))}),o.createBoxCtor("sdp ","rtptracksdphintinformation",function(t){this.sdptext=t.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("sdtp","SampleDependencyTypeBox",function(t){var s,r=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var f=0;f<r;f++)s=t.readUint8(),this.is_leading[f]=s>>6,this.sample_depends_on[f]=s>>4&3,this.sample_is_depended_on[f]=s>>2&3,this.sample_has_redundancy[f]=s&3}),o.createFullBoxCtor("senc","SampleEncryptionBox"),o.createFullBoxCtor("sgpd","SampleGroupDescriptionBox",function(t){this.grouping_type=t.readString(4),n.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.version===1?this.default_length=t.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=t.readUint32()),this.entries=[];for(var s=t.readUint32(),r=0;r<s;r++){var f;o[this.grouping_type+"SampleGroupEntry"]?f=new o[this.grouping_type+"SampleGroupEntry"](this.grouping_type):f=new o.SampleGroupEntry(this.grouping_type),this.entries.push(f),this.version===1?this.default_length===0?f.description_length=t.readUint32():f.description_length=this.default_length:f.description_length=this.default_length,f.write===o.SampleGroupEntry.prototype.write&&(n.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),f.data=t.readUint8Array(f.description_length),t.position-=f.description_length),f.parse(t)}}),o.createFullBoxCtor("sidx","CompressedSegmentIndexBox",function(t){this.reference_ID=t.readUint32(),this.timescale=t.readUint32(),this.version===0?(this.earliest_presentation_time=t.readUint32(),this.first_offset=t.readUint32()):(this.earliest_presentation_time=t.readUint64(),this.first_offset=t.readUint64()),t.readUint16(),this.references=[];for(var s=t.readUint16(),r=0;r<s;r++){var f={};this.references.push(f);var u=t.readUint32();f.reference_type=u>>31&1,f.referenced_size=u&2147483647,f.subsegment_duration=t.readUint32(),u=t.readUint32(),f.starts_with_SAP=u>>31&1,f.SAP_type=u>>28&7,f.SAP_delta_time=u&268435455}}),o.SingleItemTypeReferenceBox=function(t,s,r,f){o.Box.call(this,t,s),this.hdr_size=r,this.start=f},o.SingleItemTypeReferenceBox.prototype=new o.Box,o.SingleItemTypeReferenceBox.prototype.parse=function(t){this.from_item_ID=t.readUint16();var s=t.readUint16();this.references=[];for(var r=0;r<s;r++)this.references[r]={},this.references[r].to_item_ID=t.readUint16()},o.SingleItemTypeReferenceBoxLarge=function(t,s,r,f){o.Box.call(this,t,s),this.hdr_size=r,this.start=f},o.SingleItemTypeReferenceBoxLarge.prototype=new o.Box,o.SingleItemTypeReferenceBoxLarge.prototype.parse=function(t){this.from_item_ID=t.readUint32();var s=t.readUint16();this.references=[];for(var r=0;r<s;r++)this.references[r]={},this.references[r].to_item_ID=t.readUint32()},o.createFullBoxCtor("SmDm","SMPTE2086MasteringDisplayMetadataBox",function(t){this.primaryRChromaticity_x=t.readUint16(),this.primaryRChromaticity_y=t.readUint16(),this.primaryGChromaticity_x=t.readUint16(),this.primaryGChromaticity_y=t.readUint16(),this.primaryBChromaticity_x=t.readUint16(),this.primaryBChromaticity_y=t.readUint16(),this.whitePointChromaticity_x=t.readUint16(),this.whitePointChromaticity_y=t.readUint16(),this.luminanceMax=t.readUint32(),this.luminanceMin=t.readUint32()}),o.createFullBoxCtor("smhd","SoundMediaHeaderBox",function(t){this.balance=t.readUint16(),t.readUint16()}),o.createFullBoxCtor("ssix","CompressedSubsegmentIndexBox",function(t){this.subsegments=[];for(var s=t.readUint32(),r=0;r<s;r++){var f={};this.subsegments.push(f),f.ranges=[];for(var u=t.readUint32(),p=0;p<u;p++){var g={};f.ranges.push(g),g.level=t.readUint8(),g.range_size=t.readUint24()}}}),o.createFullBoxCtor("stco","ChunkOffsetBox",function(t){var s;if(s=t.readUint32(),this.chunk_offsets=[],this.version===0)for(var r=0;r<s;r++)this.chunk_offsets.push(t.readUint32())}),o.createFullBoxCtor("stdp","DegradationPriorityBox",function(t){var s=(this.size-this.hdr_size)/2;this.priority=[];for(var r=0;r<s;r++)this.priority[r]=t.readUint16()}),o.createFullBoxCtor("sthd","SubtitleMediaHeaderBox"),o.createFullBoxCtor("stri","SubTrackInformationBox",function(t){this.switch_group=t.readUint16(),this.alternate_group=t.readUint16(),this.sub_track_id=t.readUint32();var s=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var r=0;r<s;r++)this.attribute_list[r]=t.readUint32()}),o.createFullBoxCtor("stsc","SampleToChunkBox",function(t){var s,r;if(s=t.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],this.version===0)for(r=0;r<s;r++)this.first_chunk.push(t.readUint32()),this.samples_per_chunk.push(t.readUint32()),this.sample_description_index.push(t.readUint32())}),o.createFullBoxCtor("stsd","SampleDescriptionBox",function(t){var s,r,f,u;for(this.entries=[],f=t.readUint32(),s=1;s<=f;s++)if(r=o.parseOneBox(t,!0,this.size-(t.getPosition()-this.start)),r.code===o.OK)o[r.type+"SampleEntry"]?(u=new o[r.type+"SampleEntry"](r.size),u.hdr_size=r.hdr_size,u.start=r.start):(n.warn("BoxParser","Unknown sample entry type: "+r.type),u=new o.SampleEntry(r.type,r.size,r.hdr_size,r.start)),u.write===o.SampleEntry.prototype.write&&(n.info("BoxParser","SampleEntry "+u.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),u.parseDataAndRewind(t)),u.parse(t),this.entries.push(u);else return}),o.createFullBoxCtor("stsg","SubTrackSampleGroupBox",function(t){this.grouping_type=t.readUint32();var s=t.readUint16();this.group_description_index=[];for(var r=0;r<s;r++)this.group_description_index[r]=t.readUint32()}),o.createFullBoxCtor("stsh","ShadowSyncSampleBox",function(t){var s,r;if(s=t.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],this.version===0)for(r=0;r<s;r++)this.shadowed_sample_numbers.push(t.readUint32()),this.sync_sample_numbers.push(t.readUint32())}),o.createFullBoxCtor("stss","SyncSampleBox",function(t){var s,r;if(r=t.readUint32(),this.version===0)for(this.sample_numbers=[],s=0;s<r;s++)this.sample_numbers.push(t.readUint32())}),o.createFullBoxCtor("stsz","SampleSizeBox",function(t){var s;if(this.sample_sizes=[],this.version===0)for(this.sample_size=t.readUint32(),this.sample_count=t.readUint32(),s=0;s<this.sample_count;s++)this.sample_size===0?this.sample_sizes.push(t.readUint32()):this.sample_sizes[s]=this.sample_size}),o.createFullBoxCtor("stts","TimeToSampleBox",function(t){var s,r,f;if(s=t.readUint32(),this.sample_counts=[],this.sample_deltas=[],this.version===0)for(r=0;r<s;r++)this.sample_counts.push(t.readUint32()),f=t.readInt32(),f<0&&(n.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),f=1),this.sample_deltas.push(f)}),o.createFullBoxCtor("stvi","StereoVideoBox",function(t){var s=t.readUint32();this.single_view_allowed=s&3,this.stereo_scheme=t.readUint32();var r=t.readUint32();this.stereo_indication_type=t.readString(r);var f,u;for(this.boxes=[];t.getPosition()<this.start+this.size;)if(f=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),f.code===o.OK)u=f.box,this.boxes.push(u),this[u.type]=u;else return}),o.createBoxCtor("styp","SegmentTypeBox",function(t){o.ftypBox.prototype.parse.call(this,t)}),o.createFullBoxCtor("stz2","CompactSampleSizeBox",function(t){var s,r;if(this.sample_sizes=[],this.version===0)if(this.reserved=t.readUint24(),this.field_size=t.readUint8(),r=t.readUint32(),this.field_size===4)for(s=0;s<r;s+=2){var f=t.readUint8();this.sample_sizes[s]=f>>4&15,this.sample_sizes[s+1]=f&15}else if(this.field_size===8)for(s=0;s<r;s++)this.sample_sizes[s]=t.readUint8();else if(this.field_size===16)for(s=0;s<r;s++)this.sample_sizes[s]=t.readUint16();else n.error("BoxParser","Error in length field in stz2 box")}),o.createFullBoxCtor("subs","SubSampleInformationBox",function(t){var s,r,f,u;for(f=t.readUint32(),this.entries=[],s=0;s<f;s++){var p={};if(this.entries[s]=p,p.sample_delta=t.readUint32(),p.subsamples=[],u=t.readUint16(),u>0)for(r=0;r<u;r++){var g={};p.subsamples.push(g),this.version==1?g.size=t.readUint32():g.size=t.readUint16(),g.priority=t.readUint8(),g.discardable=t.readUint8(),g.codec_specific_parameters=t.readUint32()}}}),o.createFullBoxCtor("tenc","TrackEncryptionBox",function(t){if(t.readUint8(),this.version===0)t.readUint8();else{var s=t.readUint8();this.default_crypt_byte_block=s>>4&15,this.default_skip_byte_block=s&15}this.default_isProtected=t.readUint8(),this.default_Per_Sample_IV_Size=t.readUint8(),this.default_KID=o.parseHex16(t),this.default_isProtected===1&&this.default_Per_Sample_IV_Size===0&&(this.default_constant_IV_size=t.readUint8(),this.default_constant_IV=t.readUint8Array(this.default_constant_IV_size))}),o.createFullBoxCtor("tfdt","TrackFragmentBaseMediaDecodeTimeBox",function(t){this.version==1?this.baseMediaDecodeTime=t.readUint64():this.baseMediaDecodeTime=t.readUint32()}),o.createFullBoxCtor("tfhd","TrackFragmentHeaderBox",function(t){var s=0;this.track_id=t.readUint32(),this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=t.readUint64(),s+=8):this.base_data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=t.readUint32(),s+=4):this.default_sample_description_index=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=t.readUint32(),s+=4):this.default_sample_duration=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=t.readUint32(),s+=4):this.default_sample_size=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=t.readUint32(),s+=4):this.default_sample_flags=0}),o.createFullBoxCtor("tfra","TrackFragmentRandomAccessBox",function(t){this.track_ID=t.readUint32(),t.readUint24();var s=t.readUint8();this.length_size_of_traf_num=s>>4&3,this.length_size_of_trun_num=s>>2&3,this.length_size_of_sample_num=s&3,this.entries=[];for(var r=t.readUint32(),f=0;f<r;f++)this.version===1?(this.time=t.readUint64(),this.moof_offset=t.readUint64()):(this.time=t.readUint32(),this.moof_offset=t.readUint32()),this.traf_number=t["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=t["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=t["readUint"+8*(this.length_size_of_sample_num+1)]()}),o.createFullBoxCtor("tkhd","TrackHeaderBox",function(t){this.version==1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint32()),t.readUint32Array(2),this.layer=t.readInt16(),this.alternate_group=t.readInt16(),this.volume=t.readInt16()>>8,t.readUint16(),this.matrix=t.readInt32Array(9),this.width=t.readUint32(),this.height=t.readUint32()}),o.createBoxCtor("tmax","hintmaxrelativetime",function(t){this.time=t.readUint32()}),o.createBoxCtor("tmin","hintminrelativetime",function(t){this.time=t.readUint32()}),o.createBoxCtor("totl","hintBytesSent",function(t){this.bytessent=t.readUint32()}),o.createBoxCtor("tpay","hintBytesSent",function(t){this.bytessent=t.readUint32()}),o.createBoxCtor("tpyl","hintBytesSent",function(t){this.bytessent=t.readUint64()}),o.TrackGroupTypeBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_group_id=t.readUint32()},o.createTrackGroupCtor("msrc"),o.TrackReferenceTypeBox=function(t,s,r,f){o.Box.call(this,t,s),this.hdr_size=r,this.start=f},o.TrackReferenceTypeBox.prototype=new o.Box,o.TrackReferenceTypeBox.prototype.parse=function(t){this.track_ids=t.readUint32Array((this.size-this.hdr_size)/4)},o.trefBox.prototype.parse=function(t){for(var s,r;t.getPosition()<this.start+this.size;)if(s=o.parseOneBox(t,!0,this.size-(t.getPosition()-this.start)),s.code===o.OK)r=new o.TrackReferenceTypeBox(s.type,s.size,s.hdr_size,s.start),r.write===o.Box.prototype.write&&r.type!=="mdat"&&(n.info("BoxParser","TrackReference "+r.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),r.parseDataAndRewind(t)),r.parse(t),this.boxes.push(r);else return},o.createFullBoxCtor("trep","TrackExtensionPropertiesBox",function(t){for(this.track_ID=t.readUint32(),this.boxes=[];t.getPosition()<this.start+this.size;)if(ret=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),ret.code===o.OK)box=ret.box,this.boxes.push(box);else return}),o.createFullBoxCtor("trex","TrackExtendsBox",function(t){this.track_id=t.readUint32(),this.default_sample_description_index=t.readUint32(),this.default_sample_duration=t.readUint32(),this.default_sample_size=t.readUint32(),this.default_sample_flags=t.readUint32()}),o.createBoxCtor("trpy","hintBytesSent",function(t){this.bytessent=t.readUint64()}),o.createFullBoxCtor("trun","TrackRunBox",function(t){var s=0;if(this.sample_count=t.readUint32(),s+=4,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=t.readInt32(),s+=4):this.data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=t.readUint32(),s+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>s)for(var r=0;r<this.sample_count;r++)this.flags&o.TRUN_FLAGS_DURATION&&(this.sample_duration[r]=t.readUint32()),this.flags&o.TRUN_FLAGS_SIZE&&(this.sample_size[r]=t.readUint32()),this.flags&o.TRUN_FLAGS_FLAGS&&(this.sample_flags[r]=t.readUint32()),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?this.sample_composition_time_offset[r]=t.readUint32():this.sample_composition_time_offset[r]=t.readInt32())}),o.createFullBoxCtor("tsel","TrackSelectionBox",function(t){this.switch_group=t.readUint32();var s=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var r=0;r<s;r++)this.attribute_list[r]=t.readUint32()}),o.createFullBoxCtor("txtC","TextConfigBox",function(t){this.config=t.readCString()}),o.createBoxCtor("tyco","TypeCombinationBox",function(t){var s=(this.size-this.hdr_size)/4;this.compatible_brands=[];for(var r=0;r<s;r++)this.compatible_brands[r]=t.readString(4)}),o.createFullBoxCtor("udes","UserDescriptionProperty",function(t){this.lang=t.readCString(),this.name=t.readCString(),this.description=t.readCString(),this.tags=t.readCString()}),o.createFullBoxCtor("uncC","UncompressedFrameConfigBox",function(t){var s;if(this.profile=t.readString(4),this.version!=1){if(this.version==0){for(this.component_count=t.readUint32(),this.component_index=[],this.component_bit_depth_minus_one=[],this.component_format=[],this.component_align_size=[],s=0;s<this.component_count;s++)this.component_index.push(t.readUint16()),this.component_bit_depth_minus_one.push(t.readUint8()),this.component_format.push(t.readUint8()),this.component_align_size.push(t.readUint8());this.sampling_type=t.readUint8(),this.interleave_type=t.readUint8(),this.block_size=t.readUint8();var r=t.readUint8();this.component_little_endian=r>>7&1,this.block_pad_lsb=r>>6&1,this.block_little_endian=r>>5&1,this.block_reversed=r>>4&1,this.pad_unknown=r>>3&1,this.pixel_size=t.readUint32(),this.row_align_size=t.readUint32(),this.tile_align_size=t.readUint32(),this.num_tile_cols_minus_one=t.readUint32(),this.num_tile_rows_minus_one=t.readUint32()}}}),o.createFullBoxCtor("url ","DataEntryUrlBox",function(t){this.flags!==1&&(this.location=t.readCString())}),o.createFullBoxCtor("urn ","DataEntryUrnBox",function(t){this.name=t.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=t.readCString())}),o.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66","LiveServerManifestBox",!0,!1,function(t){this.LiveServerManifest=t.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),o.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3","PiffProtectionSystemSpecificHeaderBox",!0,!1,function(t){this.system_id=o.parseHex16(t);var s=t.readUint32();s>0&&(this.data=t.readUint8Array(s))}),o.createUUIDBox("a2394f525a9b4f14a2446c427c648df4","PiffSampleEncryptionBox",!0,!1),o.createUUIDBox("8974dbce7be74c5184f97148f9882554","PiffTrackEncryptionBox",!0,!1,function(t){this.default_AlgorithmID=t.readUint24(),this.default_IV_size=t.readUint8(),this.default_KID=o.parseHex16(t)}),o.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f","TfrfBox",!0,!1,function(t){this.fragment_count=t.readUint8(),this.entries=[];for(var s=0;s<this.fragment_count;s++){var r={},f=0,u=0;this.version===1?(f=t.readUint64(),u=t.readUint64()):(f=t.readUint32(),u=t.readUint32()),r.absolute_time=f,r.absolute_duration=u,this.entries.push(r)}}),o.createUUIDBox("6d1d9b0542d544e680e2141daff757b2","TfxdBox",!0,!1,function(t){this.version===1?(this.absolute_time=t.readUint64(),this.duration=t.readUint64()):(this.absolute_time=t.readUint32(),this.duration=t.readUint32())}),o.createFullBoxCtor("vmhd","VideoMediaHeaderBox",function(t){this.graphicsmode=t.readUint16(),this.opcolor=t.readUint16Array(3)}),o.createFullBoxCtor("vpcC","VPCodecConfigurationRecord",function(t){var s;this.version===1?(this.profile=t.readUint8(),this.level=t.readUint8(),s=t.readUint8(),this.bitDepth=s>>4,this.chromaSubsampling=s>>1&7,this.videoFullRangeFlag=s&1,this.colourPrimaries=t.readUint8(),this.transferCharacteristics=t.readUint8(),this.matrixCoefficients=t.readUint8(),this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize)):(this.profile=t.readUint8(),this.level=t.readUint8(),s=t.readUint8(),this.bitDepth=s>>4&15,this.colorSpace=s&15,s=t.readUint8(),this.chromaSubsampling=s>>4&15,this.transferFunction=s>>1&7,this.videoFullRangeFlag=s&1,this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize))}),o.createBoxCtor("vttC","WebVTTConfigurationBox",function(t){this.text=t.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("vvcC","VvcConfigurationBox",function(t){var s,r,f={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(D){this.held_bits=D.readUint8(),this.num_held_bits=8},stream_read_2_bytes:function(D){this.held_bits=D.readUint16(),this.num_held_bits=16},extract_bits:function(D){var at=this.held_bits>>this.num_held_bits-D&(1<<D)-1;return this.num_held_bits-=D,at}};if(f.stream_read_1_bytes(t),f.extract_bits(5),this.lengthSizeMinusOne=f.extract_bits(2),this.ptl_present_flag=f.extract_bits(1),this.ptl_present_flag){f.stream_read_2_bytes(t),this.ols_idx=f.extract_bits(9),this.num_sublayers=f.extract_bits(3),this.constant_frame_rate=f.extract_bits(2),this.chroma_format_idc=f.extract_bits(2),f.stream_read_1_bytes(t),this.bit_depth_minus8=f.extract_bits(3),f.extract_bits(5);{if(f.stream_read_2_bytes(t),f.extract_bits(2),this.num_bytes_constraint_info=f.extract_bits(6),this.general_profile_idc=f.extract_bits(7),this.general_tier_flag=f.extract_bits(1),this.general_level_idc=t.readUint8(),f.stream_read_1_bytes(t),this.ptl_frame_only_constraint_flag=f.extract_bits(1),this.ptl_multilayer_enabled_flag=f.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(s=0;s<this.num_bytes_constraint_info-1;s++){var u=f.extract_bits(6);f.stream_read_1_bytes(t);var p=f.extract_bits(2);this.general_constraint_info[s]=u<<2|p}this.general_constraint_info[this.num_bytes_constraint_info-1]=f.extract_bits(6)}else f.extract_bits(6);if(this.num_sublayers>1){for(f.stream_read_1_bytes(t),this.ptl_sublayer_present_mask=0,r=this.num_sublayers-2;r>=0;--r){var g=f.extract_bits(1);this.ptl_sublayer_present_mask|=g<<r}for(r=this.num_sublayers;r<=8&&this.num_sublayers>1;++r)f.extract_bits(1);for(this.sublayer_level_idc=[],r=this.num_sublayers-2;r>=0;--r)this.ptl_sublayer_present_mask&1<<r&&(this.sublayer_level_idc[r]=t.readUint8())}if(this.ptl_num_sub_profiles=t.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(s=0;s<this.ptl_num_sub_profiles;s++)this.general_sub_profile_idc.push(t.readUint32())}this.max_picture_width=t.readUint16(),this.max_picture_height=t.readUint16(),this.avg_frame_rate=t.readUint16()}var S=12,B=13;this.nalu_arrays=[];var A=t.readUint8();for(s=0;s<A;s++){var I=[];this.nalu_arrays.push(I),f.stream_read_1_bytes(t),I.completeness=f.extract_bits(1),f.extract_bits(2),I.nalu_type=f.extract_bits(5);var R=1;for(I.nalu_type!=B&&I.nalu_type!=S&&(R=t.readUint16()),r=0;r<R;r++){var K=t.readUint16();I.push({data:t.readUint8Array(K),length:K})}}}),o.createFullBoxCtor("vvnC","VvcNALUConfigBox",function(t){var s=strm.readUint8();this.lengthSizeMinusOne=s&3}),o.SampleEntry.prototype.isVideo=function(){return!1},o.SampleEntry.prototype.isAudio=function(){return!1},o.SampleEntry.prototype.isSubtitle=function(){return!1},o.SampleEntry.prototype.isMetadata=function(){return!1},o.SampleEntry.prototype.isHint=function(){return!1},o.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},o.SampleEntry.prototype.getWidth=function(){return""},o.SampleEntry.prototype.getHeight=function(){return""},o.SampleEntry.prototype.getChannelCount=function(){return""},o.SampleEntry.prototype.getSampleRate=function(){return""},o.SampleEntry.prototype.getSampleSize=function(){return""},o.VisualSampleEntry.prototype.isVideo=function(){return!0},o.VisualSampleEntry.prototype.getWidth=function(){return this.width},o.VisualSampleEntry.prototype.getHeight=function(){return this.height},o.AudioSampleEntry.prototype.isAudio=function(){return!0},o.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},o.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},o.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},o.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},o.MetadataSampleEntry.prototype.isMetadata=function(){return!0},o.decimalToHex=function(t,s){var r=Number(t).toString(16);for(s=typeof s>"u"||s===null?s=2:s;r.length<s;)r="0"+r;return r},o.avc1SampleEntry.prototype.getCodec=o.avc2SampleEntry.prototype.getCodec=o.avc3SampleEntry.prototype.getCodec=o.avc4SampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this);return this.avcC?t+"."+o.decimalToHex(this.avcC.AVCProfileIndication)+o.decimalToHex(this.avcC.profile_compatibility)+o.decimalToHex(this.avcC.AVCLevelIndication):t},o.hev1SampleEntry.prototype.getCodec=o.hvc1SampleEntry.prototype.getCodec=function(){var t,s=o.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(s+=".",this.hvcC.general_profile_space){case 0:s+="";break;case 1:s+="A";break;case 2:s+="B";break;case 3:s+="C";break}s+=this.hvcC.general_profile_idc,s+=".";var r=this.hvcC.general_profile_compatibility,f=0;for(t=0;t<32&&(f|=r&1,t!=31);t++)f<<=1,r>>=1;s+=o.decimalToHex(f,0),s+=".",this.hvcC.general_tier_flag===0?s+="L":s+="H",s+=this.hvcC.general_level_idc;var u=!1,p="";for(t=5;t>=0;t--)(this.hvcC.general_constraint_indicator[t]||u)&&(p="."+o.decimalToHex(this.hvcC.general_constraint_indicator[t],0)+p,u=!0);s+=p}return s},o.vvc1SampleEntry.prototype.getCodec=o.vvi1SampleEntry.prototype.getCodec=function(){var t,s=o.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){s+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?s+=".H":s+=".L",s+=this.vvcC.general_level_idc;var r="";if(this.vvcC.general_constraint_info){var f=[],u=0;u|=this.vvcC.ptl_frame_only_constraint<<7,u|=this.vvcC.ptl_multilayer_enabled<<6;var p;for(t=0;t<this.vvcC.general_constraint_info.length;++t)u|=this.vvcC.general_constraint_info[t]>>2&63,f.push(u),u&&(p=t),u=this.vvcC.general_constraint_info[t]>>2&3;if(p===void 0)r=".CA";else{r=".C";var g="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",S=0,B=0;for(t=0;t<=p;++t)for(S=S<<8|f[t],B+=8;B>=5;){var A=S>>B-5&31;r+=g[A],B-=5,S&=(1<<B)-1}B&&(S<<=5-B,r+=g[S&31])}}s+=r}return s},o.mp4aSampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var s=this.esds.esd.getOTI(),r=this.esds.esd.getAudioConfig();return t+"."+o.decimalToHex(s)+(r?"."+r:"")}else return t},o.stxtSampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this);return this.mime_format?t+"."+this.mime_format:t},o.vp08SampleEntry.prototype.getCodec=o.vp09SampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this),s=this.vpcC.level;s==0&&(s="00");var r=this.vpcC.bitDepth;return r==8&&(r="08"),t+".0"+this.vpcC.profile+"."+s+"."+r},o.av01SampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this),s=this.av1C.seq_level_idx_0;s<10&&(s="0"+s);var r;return this.av1C.seq_profile===2&&this.av1C.high_bitdepth===1?r=this.av1C.twelve_bit===1?"12":"10":this.av1C.seq_profile<=2&&(r=this.av1C.high_bitdepth===1?"10":"08"),t+"."+this.av1C.seq_profile+"."+s+(this.av1C.seq_tier_0?"H":"M")+"."+r},o.Box.prototype.writeHeader=function(t,s){this.size+=8,this.size>c&&(this.size+=8),this.type==="uuid"&&(this.size+=16),n.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+t.getPosition()+(s||"")),this.size>c?t.writeUint32(1):(this.sizePosition=t.getPosition(),t.writeUint32(this.size)),t.writeString(this.type,null,4),this.type==="uuid"&&t.writeUint8Array(this.uuid),this.size>c&&t.writeUint64(this.size)},o.FullBox.prototype.writeHeader=function(t){this.size+=4,o.Box.prototype.writeHeader.call(this,t," v="+this.version+" f="+this.flags),t.writeUint8(this.version),t.writeUint24(this.flags)},o.Box.prototype.write=function(t){this.type==="mdat"?this.data&&(this.size=this.data.length,this.writeHeader(t),t.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(t),this.data&&t.writeUint8Array(this.data))},o.ContainerBox.prototype.write=function(t){this.size=0,this.writeHeader(t);for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&(this.boxes[s].write(t),this.size+=this.boxes[s].size);n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.TrackReferenceTypeBox.prototype.write=function(t){this.size=this.track_ids.length*4,this.writeHeader(t),t.writeUint32Array(this.track_ids)},o.avcCBox.prototype.write=function(t){var s;for(this.size=7,s=0;s<this.SPS.length;s++)this.size+=2+this.SPS[s].length;for(s=0;s<this.PPS.length;s++)this.size+=2+this.PPS[s].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8(this.AVCProfileIndication),t.writeUint8(this.profile_compatibility),t.writeUint8(this.AVCLevelIndication),t.writeUint8(this.lengthSizeMinusOne+252),t.writeUint8(this.SPS.length+224),s=0;s<this.SPS.length;s++)t.writeUint16(this.SPS[s].length),t.writeUint8Array(this.SPS[s].nalu);for(t.writeUint8(this.PPS.length),s=0;s<this.PPS.length;s++)t.writeUint16(this.PPS[s].length),t.writeUint8Array(this.PPS[s].nalu);this.ext&&t.writeUint8Array(this.ext)},o.co64Box.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),s=0;s<this.chunk_offsets.length;s++)t.writeUint64(this.chunk_offsets[s])},o.cslgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(t),t.writeInt32(this.compositionToDTSShift),t.writeInt32(this.leastDecodeToDisplayDelta),t.writeInt32(this.greatestDecodeToDisplayDelta),t.writeInt32(this.compositionStartTime),t.writeInt32(this.compositionEndTime)},o.cttsBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)t.writeUint32(this.sample_counts[s]),this.version===1?t.writeInt32(this.sample_offsets[s]):t.writeUint32(this.sample_offsets[s])},o.drefBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++)this.entries[s].write(t),this.size+=this.entries[s].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.elngBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(t),t.writeString(this.extended_language)},o.elstBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(t),t.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var r=this.entries[s];t.writeUint32(r.segment_duration),t.writeInt32(r.media_time),t.writeInt16(r.media_rate_integer),t.writeInt16(r.media_rate_fraction)}},o.emsgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(t),t.writeCString(this.scheme_id_uri),t.writeCString(this.value),t.writeUint32(this.timescale),t.writeUint32(this.presentation_time_delta),t.writeUint32(this.event_duration),t.writeUint32(this.id),t.writeUint8Array(this.message_data)},o.ftypBox.prototype.write=function(t){this.size=8+4*this.compatible_brands.length,this.writeHeader(t),t.writeString(this.major_brand,null,4),t.writeUint32(this.minor_version);for(var s=0;s<this.compatible_brands.length;s++)t.writeString(this.compatible_brands[s],null,4)},o.hdlrBox.prototype.write=function(t){this.size=5*4+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(t),t.writeUint32(0),t.writeString(this.handler,null,4),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeCString(this.name)},o.hvcCBox.prototype.write=function(t){var s,r;for(this.size=23,s=0;s<this.nalu_arrays.length;s++)for(this.size+=3,r=0;r<this.nalu_arrays[s].length;r++)this.size+=2+this.nalu_arrays[s][r].data.length;for(this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8((this.general_profile_space<<6)+(this.general_tier_flag<<5)+this.general_profile_idc),t.writeUint32(this.general_profile_compatibility),t.writeUint8Array(this.general_constraint_indicator),t.writeUint8(this.general_level_idc),t.writeUint16(this.min_spatial_segmentation_idc+(15<<24)),t.writeUint8(this.parallelismType+252),t.writeUint8(this.chroma_format_idc+252),t.writeUint8(this.bit_depth_luma_minus8+248),t.writeUint8(this.bit_depth_chroma_minus8+248),t.writeUint16(this.avgFrameRate),t.writeUint8((this.constantFrameRate<<6)+(this.numTemporalLayers<<3)+(this.temporalIdNested<<2)+this.lengthSizeMinusOne),t.writeUint8(this.nalu_arrays.length),s=0;s<this.nalu_arrays.length;s++)for(t.writeUint8((this.nalu_arrays[s].completeness<<7)+this.nalu_arrays[s].nalu_type),t.writeUint16(this.nalu_arrays[s].length),r=0;r<this.nalu_arrays[s].length;r++)t.writeUint16(this.nalu_arrays[s][r].data.length),t.writeUint8Array(this.nalu_arrays[s][r].data)},o.kindBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(t),t.writeCString(this.schemeURI),t.writeCString(this.value)},o.mdhdBox.prototype.write=function(t){this.size=4*4+2*2,this.flags=0,this.version=0,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint16(this.language),t.writeUint16(0)},o.mehdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.fragment_duration)},o.mfhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.sequence_number)},o.mvhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=23*4+2*2,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint32(this.rate),t.writeUint16(this.volume<<8),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32Array(this.matrix),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(this.next_track_id)},o.SampleEntry.prototype.writeHeader=function(t){this.size=8,o.Box.prototype.writeHeader.call(this,t),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint16(this.data_reference_index)},o.SampleEntry.prototype.writeFooter=function(t){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(t),this.size+=this.boxes[s].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.SampleEntry.prototype.write=function(t){this.writeHeader(t),t.writeUint8Array(this.data),this.size+=this.data.length,n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.VisualSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=2*7+6*4+32,t.writeUint16(0),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.width),t.writeUint16(this.height),t.writeUint32(this.horizresolution),t.writeUint32(this.vertresolution),t.writeUint32(0),t.writeUint16(this.frame_count),t.writeUint8(Math.min(31,this.compressorname.length)),t.writeString(this.compressorname,null,31),t.writeUint16(this.depth),t.writeInt16(-1),this.writeFooter(t)},o.AudioSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=2*4+3*4,t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.channel_count),t.writeUint16(this.samplesize),t.writeUint16(0),t.writeUint16(0),t.writeUint32(this.samplerate<<16),this.writeFooter(t)},o.stppSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,t.writeCString(this.namespace),t.writeCString(this.schema_location),t.writeCString(this.auxiliary_mime_types),this.writeFooter(t)},o.SampleGroupEntry.prototype.write=function(t){t.writeUint8Array(this.data)},o.sbgpBox.prototype.write=function(t){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(t),t.writeString(this.grouping_type,null,4),t.writeUint32(this.grouping_type_parameter),t.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var r=this.entries[s];t.writeInt32(r.sample_count),t.writeInt32(r.group_description_index)}},o.sgpdBox.prototype.write=function(t){var s,r;for(this.flags=0,this.size=12,s=0;s<this.entries.length;s++)r=this.entries[s],this.version===1&&(this.default_length===0&&(this.size+=4),this.size+=r.data.length);for(this.writeHeader(t),t.writeString(this.grouping_type,null,4),this.version===1&&t.writeUint32(this.default_length),this.version>=2&&t.writeUint32(this.default_sample_description_index),t.writeUint32(this.entries.length),s=0;s<this.entries.length;s++)r=this.entries[s],this.version===1&&this.default_length===0&&t.writeUint32(r.description_length),r.write(t)},o.sidxBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*4+2+2+12*this.references.length,this.writeHeader(t),t.writeUint32(this.reference_ID),t.writeUint32(this.timescale),t.writeUint32(this.earliest_presentation_time),t.writeUint32(this.first_offset),t.writeUint16(0),t.writeUint16(this.references.length);for(var s=0;s<this.references.length;s++){var r=this.references[s];t.writeUint32(r.reference_type<<31|r.referenced_size),t.writeUint32(r.subsegment_duration),t.writeUint32(r.starts_with_SAP<<31|r.SAP_type<<28|r.SAP_delta_time)}},o.smhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=4,this.writeHeader(t),t.writeUint16(this.balance),t.writeUint16(0)},o.stcoBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),t.writeUint32Array(this.chunk_offsets)},o.stscBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(t),t.writeUint32(this.first_chunk.length),s=0;s<this.first_chunk.length;s++)t.writeUint32(this.first_chunk[s]),t.writeUint32(this.samples_per_chunk[s]),t.writeUint32(this.sample_description_index[s])},o.stsdBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(t),t.writeUint32(this.entries.length),this.size+=4,s=0;s<this.entries.length;s++)this.entries[s].write(t),this.size+=this.entries[s].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.stshBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(t),t.writeUint32(this.shadowed_sample_numbers.length),s=0;s<this.shadowed_sample_numbers.length;s++)t.writeUint32(this.shadowed_sample_numbers[s]),t.writeUint32(this.sync_sample_numbers[s])},o.stssBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(t),t.writeUint32(this.sample_numbers.length),t.writeUint32Array(this.sample_numbers)},o.stszBox.prototype.write=function(t){var s,r=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(s=0;s+1<this.sample_sizes.length;)if(this.sample_sizes[s+1]!==this.sample_sizes[0]){r=!1;break}else s++;else r=!1;this.size=8,r||(this.size+=4*this.sample_sizes.length),this.writeHeader(t),r?t.writeUint32(this.sample_sizes[0]):t.writeUint32(0),t.writeUint32(this.sample_sizes.length),r||t.writeUint32Array(this.sample_sizes)},o.sttsBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)t.writeUint32(this.sample_counts[s]),t.writeUint32(this.sample_deltas[s])},o.tfdtBox.prototype.write=function(t){var s=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>s?1:0,this.flags=0,this.size=4,this.version===1&&(this.size+=4),this.writeHeader(t),this.version===1?t.writeUint64(this.baseMediaDecodeTime):t.writeUint32(this.baseMediaDecodeTime)},o.tfhdBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(t),t.writeUint32(this.track_id),this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&t.writeUint64(this.base_data_offset),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&t.writeUint32(this.default_sample_description_index),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&t.writeUint32(this.default_sample_duration),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&t.writeUint32(this.default_sample_size),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&t.writeUint32(this.default_sample_flags)},o.tkhdBox.prototype.write=function(t){this.version=0,this.size=4*18+2*4,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.track_id),t.writeUint32(0),t.writeUint32(this.duration),t.writeUint32(0),t.writeUint32(0),t.writeInt16(this.layer),t.writeInt16(this.alternate_group),t.writeInt16(this.volume<<8),t.writeUint16(0),t.writeInt32Array(this.matrix),t.writeUint32(this.width),t.writeUint32(this.height)},o.trexBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(t),t.writeUint32(this.track_id),t.writeUint32(this.default_sample_description_index),t.writeUint32(this.default_sample_duration),t.writeUint32(this.default_sample_size),t.writeUint32(this.default_sample_flags)},o.trunBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&o.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&o.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&o.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(t),t.writeUint32(this.sample_count),this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=t.getPosition(),t.writeInt32(this.data_offset)),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&t.writeUint32(this.first_sample_flags);for(var s=0;s<this.sample_count;s++)this.flags&o.TRUN_FLAGS_DURATION&&t.writeUint32(this.sample_duration[s]),this.flags&o.TRUN_FLAGS_SIZE&&t.writeUint32(this.sample_size[s]),this.flags&o.TRUN_FLAGS_FLAGS&&t.writeUint32(this.sample_flags[s]),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?t.writeUint32(this.sample_composition_time_offset[s]):t.writeInt32(this.sample_composition_time_offset[s]))},o["url Box"].prototype.write=function(t){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(t),this.location&&t.writeCString(this.location)},o["urn Box"].prototype.write=function(t){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(t),t.writeCString(this.name),this.location&&t.writeCString(this.location)},o.vmhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=8,this.writeHeader(t),t.writeUint16(this.graphicsmode),t.writeUint16Array(this.opcolor)},o.cttsBox.prototype.unpack=function(t){var s,r,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(r=0;r<this.sample_counts[s];r++)t[f].pts=t[f].dts+this.sample_offsets[s],f++},o.sttsBox.prototype.unpack=function(t){var s,r,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(r=0;r<this.sample_counts[s];r++)f===0?t[f].dts=0:t[f].dts=t[f-1].dts+this.sample_deltas[s],f++},o.stcoBox.prototype.unpack=function(t){var s;for(s=0;s<this.chunk_offsets.length;s++)t[s].offset=this.chunk_offsets[s]},o.stscBox.prototype.unpack=function(t){var s,r,f,u,p;for(u=0,p=0,s=0;s<this.first_chunk.length;s++)for(r=0;r<(s+1<this.first_chunk.length?this.first_chunk[s+1]:1/0);r++)for(p++,f=0;f<this.samples_per_chunk[s];f++){if(t[u])t[u].description_index=this.sample_description_index[s],t[u].chunk_index=p;else return;u++}},o.stszBox.prototype.unpack=function(t){var s;for(s=0;s<this.sample_sizes.length;s++)t[s].size=this.sample_sizes[s]},o.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],o.boxEqualFields=function(t,s){if(t&&!s)return!1;var r;for(r in t)if(!(o.DIFF_BOXES_PROP_NAMES.indexOf(r)>-1)){if(t[r]instanceof o.Box||s[r]instanceof o.Box)continue;if(typeof t[r]>"u"||typeof s[r]>"u")continue;if(typeof t[r]=="function"||typeof s[r]=="function")continue;if(t.subBoxNames&&t.subBoxNames.indexOf(r.slice(0,4))>-1||s.subBoxNames&&s.subBoxNames.indexOf(r.slice(0,4))>-1)continue;if(r==="data"||r==="start"||r==="size"||r==="creation_time"||r==="modification_time")continue;if(o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(r)>-1)continue;if(t[r]!==s[r])return!1}return!0},o.boxEqual=function(t,s){if(!o.boxEqualFields(t,s))return!1;for(var r=0;r<o.DIFF_BOXES_PROP_NAMES.length;r++){var f=o.DIFF_BOXES_PROP_NAMES[r];if(t[f]&&s[f]&&!o.boxEqual(t[f],s[f]))return!1}return!0};var x=function(){};x.prototype.parseSample=function(t){var s,r,f=new a(t.buffer);for(s=[];!f.isEos();)r=o.parseOneBox(f,!1),r.code===o.OK&&r.box.type==="vttc"&&s.push(r.box);return s},x.prototype.getText=function(t,s,r){function f(A,I,R){return R=R||"0",A=A+"",A.length>=I?A:new Array(I-A.length+1).join(R)+A}function u(A){var I=Math.floor(A/3600),R=Math.floor((A-I*3600)/60),K=Math.floor(A-I*3600-R*60),D=Math.floor((A-I*3600-R*60-K)*1e3);return""+f(I,2)+":"+f(R,2)+":"+f(K,2)+"."+f(D,3)}for(var p=this.parseSample(r),g="",S=0;S<p.length;S++){var B=p[S];g+=u(t)+" --> "+u(s)+`\r
`,g+=B.payl.text}return g};var E=function(){};E.prototype.parseSample=function(t){var s={},r;s.resources=[];var f=new a(t.data.buffer);if(!t.subsamples||t.subsamples.length===0)s.documentString=f.readString(t.data.length);else if(s.documentString=f.readString(t.subsamples[0].size),t.subsamples.length>1)for(r=1;r<t.subsamples.length;r++)s.resources[r]=f.readUint8Array(t.subsamples[r].size);return typeof DOMParser<"u"&&(s.document=new DOMParser().parseFromString(s.documentString,"application/xml")),s};var C=function(){};C.prototype.parseSample=function(t){var s,r=new a(t.data.buffer);return s=r.readString(t.data.length),s},C.prototype.parseConfig=function(t){var s,r=new a(t.buffer);return r.readUint32(),s=r.readCString(),s},e.VTTin4Parser=x,e.XMLSubtitlein4Parser=E,e.Textin4Parser=C;var U=function(t){this.stream=t||new h,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.items=[],this.entity_groups=[],this.onSidx=null,this.sidxSent=!1};U.prototype.setSegmentOptions=function(t,s,r){var f=this.getTrackById(t);if(f){var u={};this.fragmentedTracks.push(u),u.id=t,u.user=s,u.trak=f,f.nextSample=0,u.segmentStream=null,u.nb_samples=1e3,u.rapAlignement=!0,r&&(r.nbSamples&&(u.nb_samples=r.nbSamples),r.rapAlignement&&(u.rapAlignement=r.rapAlignement))}},U.prototype.unsetSegmentOptions=function(t){for(var s=-1,r=0;r<this.fragmentedTracks.length;r++){var f=this.fragmentedTracks[r];f.id==t&&(s=r)}s>-1&&this.fragmentedTracks.splice(s,1)},U.prototype.setExtractionOptions=function(t,s,r){var f=this.getTrackById(t);if(f){var u={};this.extractedTracks.push(u),u.id=t,u.user=s,u.trak=f,f.nextSample=0,u.nb_samples=1e3,u.samples=[],r&&r.nbSamples&&(u.nb_samples=r.nbSamples)}},U.prototype.unsetExtractionOptions=function(t){for(var s=-1,r=0;r<this.extractedTracks.length;r++){var f=this.extractedTracks[r];f.id==t&&(s=r)}s>-1&&this.extractedTracks.splice(s,1)},U.prototype.parse=function(){var t,s,r=!1;if(!(this.restoreParsePosition&&!this.restoreParsePosition()))for(;;)if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}else if(this.saveParsePosition&&this.saveParsePosition(),t=o.parseOneBox(this.stream,r),t.code===o.ERR_NOT_ENOUGH_DATA)if(this.processIncompleteBox){if(this.processIncompleteBox(t))continue;return}else return;else{var f;switch(s=t.box,f=s.type!=="uuid"?s.type:s.uuid,this.boxes.push(s),f){case"mdat":this.mdats.push(s);break;case"moof":this.moofs.push(s);break;case"moov":this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0);default:this[f]!==void 0&&n.warn("ISOFile","Duplicate Box of type: "+f+", overriding previous occurrence"),this[f]=s;break}this.updateUsedBytes&&this.updateUsedBytes(s,t)}},U.prototype.checkBuffer=function(t){if(t==null)throw"Buffer must be defined and non empty";if(t.fileStart===void 0)throw"Buffer must have a fileStart property";return t.byteLength===0?(n.warn("ISOFile","Ignoring empty buffer (fileStart: "+t.fileStart+")"),this.stream.logBufferLevel(),!1):(n.info("ISOFile","Processing buffer (fileStart: "+t.fileStart+")"),t.usedBytes=0,this.stream.insertBuffer(t),this.stream.logBufferLevel(),this.stream.initialized()?!0:(n.warn("ISOFile","Not ready to start parsing"),!1))},U.prototype.appendBuffer=function(t,s){var r;if(this.checkBuffer(t))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(s),this.nextSeekPosition?(r=this.nextSeekPosition,this.nextSeekPosition=void 0):r=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(r=this.stream.getEndFilePositionAfter(r))):this.nextParsePosition?r=this.nextParsePosition:r=0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(n.info("ISOFile","Done processing buffer (fileStart: "+t.fileStart+") - next buffer to fetch should have a fileStart position of "+r),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),r},U.prototype.getInfo=function(){var t,s,r={},f,u,p,g,S=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(r.hasMoov=!0,r.duration=this.moov.mvhd.duration,r.timescale=this.moov.mvhd.timescale,r.isFragmented=this.moov.mvex!=null,r.isFragmented&&this.moov.mvex.mehd&&(r.fragment_duration=this.moov.mvex.mehd.fragment_duration),r.isProgressive=this.isProgressive,r.hasIOD=this.moov.iods!=null,r.brands=[],r.brands.push(this.ftyp.major_brand),r.brands=r.brands.concat(this.ftyp.compatible_brands),r.created=new Date(S+this.moov.mvhd.creation_time*1e3),r.modified=new Date(S+this.moov.mvhd.modification_time*1e3),r.tracks=[],r.audioTracks=[],r.videoTracks=[],r.subtitleTracks=[],r.metadataTracks=[],r.hintTracks=[],r.otherTracks=[],t=0;t<this.moov.traks.length;t++){if(f=this.moov.traks[t],g=f.mdia.minf.stbl.stsd.entries[0],u={},r.tracks.push(u),u.id=f.tkhd.track_id,u.name=f.mdia.hdlr.name,u.references=[],f.tref)for(s=0;s<f.tref.boxes.length;s++)p={},u.references.push(p),p.type=f.tref.boxes[s].type,p.track_ids=f.tref.boxes[s].track_ids;f.edts&&(u.edits=f.edts.elst.entries),u.created=new Date(S+f.tkhd.creation_time*1e3),u.modified=new Date(S+f.tkhd.modification_time*1e3),u.movie_duration=f.tkhd.duration,u.movie_timescale=r.timescale,u.layer=f.tkhd.layer,u.alternate_group=f.tkhd.alternate_group,u.volume=f.tkhd.volume,u.matrix=f.tkhd.matrix,u.track_width=f.tkhd.width/65536,u.track_height=f.tkhd.height/65536,u.timescale=f.mdia.mdhd.timescale,u.cts_shift=f.mdia.minf.stbl.cslg,u.duration=f.mdia.mdhd.duration,u.samples_duration=f.samples_duration,u.codec=g.getCodec(),u.kind=f.udta&&f.udta.kinds.length?f.udta.kinds[0]:{schemeURI:"",value:""},u.language=f.mdia.elng?f.mdia.elng.extended_language:f.mdia.mdhd.languageString,u.nb_samples=f.samples.length,u.size=f.samples_size,u.bitrate=u.size*8*u.timescale/u.samples_duration,g.isAudio()?(u.type="audio",r.audioTracks.push(u),u.audio={},u.audio.sample_rate=g.getSampleRate(),u.audio.channel_count=g.getChannelCount(),u.audio.sample_size=g.getSampleSize()):g.isVideo()?(u.type="video",r.videoTracks.push(u),u.video={},u.video.width=g.getWidth(),u.video.height=g.getHeight()):g.isSubtitle()?(u.type="subtitles",r.subtitleTracks.push(u)):g.isHint()?(u.type="metadata",r.hintTracks.push(u)):g.isMetadata()?(u.type="metadata",r.metadataTracks.push(u)):(u.type="metadata",r.otherTracks.push(u))}else r.hasMoov=!1;if(r.mime="",r.hasMoov&&r.tracks){for(r.videoTracks&&r.videoTracks.length>0?r.mime+='video/mp4; codecs="':r.audioTracks&&r.audioTracks.length>0?r.mime+='audio/mp4; codecs="':r.mime+='application/mp4; codecs="',t=0;t<r.tracks.length;t++)t!==0&&(r.mime+=","),r.mime+=r.tracks[t].codec;r.mime+='"; profiles="',r.mime+=this.ftyp.compatible_brands.join(),r.mime+='"'}return r},U.prototype.setNextSeekPositionFromSample=function(t){t&&(this.nextSeekPosition?this.nextSeekPosition=Math.min(t.offset+t.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=t.offset+t.alreadyRead)},U.prototype.processSamples=function(t){var s,r;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&this.onSegment!==null)for(s=0;s<this.fragmentedTracks.length;s++){var f=this.fragmentedTracks[s];for(r=f.trak;r.nextSample<r.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Creating media fragment on track #"+f.id+" for sample "+r.nextSample);var u=this.createFragment(f.id,r.nextSample,f.segmentStream);if(u)f.segmentStream=u,r.nextSample++;else break;if((r.nextSample%f.nb_samples===0||t||r.nextSample>=r.samples.length)&&(n.info("ISOFile","Sending fragmented data on track #"+f.id+" for samples ["+Math.max(0,r.nextSample-f.nb_samples)+","+(r.nextSample-1)+"]"),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(f.id,f.user,f.segmentStream.buffer,r.nextSample,t||r.nextSample>=r.samples.length),f.segmentStream=null,f!==this.fragmentedTracks[s]))break}}if(this.onSamples!==null)for(s=0;s<this.extractedTracks.length;s++){var p=this.extractedTracks[s];for(r=p.trak;r.nextSample<r.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Exporting on track #"+p.id+" sample #"+r.nextSample);var g=this.getSample(r,r.nextSample);if(g)r.nextSample++,p.samples.push(g);else{this.setNextSeekPositionFromSample(r.samples[r.nextSample]);break}if((r.nextSample%p.nb_samples===0||r.nextSample>=r.samples.length)&&(n.debug("ISOFile","Sending samples on track #"+p.id+" for sample "+r.nextSample),this.onSamples&&this.onSamples(p.id,p.user,p.samples),p.samples=[],p!==this.extractedTracks[s]))break}}}},U.prototype.getBox=function(t){var s=this.getBoxes(t,!0);return s.length?s[0]:null},U.prototype.getBoxes=function(t,s){var r=[];return U._sweep.call(this,t,r,s),r},U._sweep=function(t,s,r){this.type&&this.type==t&&s.push(this);for(var f in this.boxes){if(s.length&&r)return;U._sweep.call(this.boxes[f],t,s,r)}},U.prototype.getTrackSamplesInfo=function(t){var s=this.getTrackById(t);if(s)return s.samples},U.prototype.getTrackSample=function(t,s){var r=this.getTrackById(t),f=this.getSample(r,s);return f},U.prototype.releaseUsedSamples=function(t,s){var r=0,f=this.getTrackById(t);f.lastValidSample||(f.lastValidSample=0);for(var u=f.lastValidSample;u<s;u++)r+=this.releaseSample(f,u);n.info("ISOFile","Track #"+t+" released samples up to "+s+" (released size: "+r+", remaining: "+this.samplesDataSize+")"),f.lastValidSample=s},U.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},U.prototype.stop=function(){this.sampleProcessingStarted=!1},U.prototype.flush=function(){n.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},U.prototype.seekTrack=function(t,s,r){var f,u,p=1/0,g=0,S=0,B;if(r.samples.length===0)return n.info("ISOFile","No sample in track, cannot seek! Using time "+n.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(f=0;f<r.samples.length;f++){if(u=r.samples[f],f===0)S=0,B=u.timescale;else if(u.cts>t*u.timescale){S=f-1;break}s&&u.is_sync&&(g=f)}for(s&&(S=g),t=r.samples[S].cts,r.nextSample=S;r.samples[S].alreadyRead===r.samples[S].size&&r.samples[S+1];)S++;return p=r.samples[S].offset+r.samples[S].alreadyRead,n.info("ISOFile","Seeking to "+(s?"RAP":"")+" sample #"+r.nextSample+" on track "+r.tkhd.track_id+", time "+n.getDurationString(t,B)+" and offset: "+p),{offset:p,time:t/B}},U.prototype.getTrackDuration=function(t){var s;return t.samples?(s=t.samples[t.samples.length-1],(s.cts+s.duration)/s.timescale):1/0},U.prototype.seek=function(t,s){var r=this.moov,f,u,p,g={offset:1/0,time:1/0};if(this.moov){for(p=0;p<r.traks.length;p++)f=r.traks[p],!(t>this.getTrackDuration(f))&&(u=this.seekTrack(t,s,f),u.offset<g.offset&&(g.offset=u.offset),u.time<g.time&&(g.time=u.time));return n.info("ISOFile","Seeking at time "+n.getDurationString(g.time,1)+" needs a buffer with a fileStart position of "+g.offset),g.offset===1/0?g={offset:this.nextParsePosition,time:0}:g.offset=this.stream.getEndFilePositionAfter(g.offset),n.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+g.offset),g}else throw"Cannot seek: moov not received!"},U.prototype.equal=function(t){for(var s=0;s<this.boxes.length&&s<t.boxes.length;){var r=this.boxes[s],f=t.boxes[s];if(!o.boxEqual(r,f))return!1;s++}return!0},e.ISOFile=U,U.prototype.lastBoxStartPosition=0,U.prototype.parsingMdat=null,U.prototype.nextParsePosition=0,U.prototype.discardMdatData=!1,U.prototype.processIncompleteBox=function(t){var s,r,f;return t.type==="mdat"?(s=new o[t.type+"Box"](t.size),this.parsingMdat=s,this.boxes.push(s),this.mdats.push(s),s.start=t.start,s.hdr_size=t.hdr_size,this.stream.addUsedBytes(s.hdr_size),this.lastBoxStartPosition=s.start+s.size,f=this.stream.seek(s.start+s.size,!1,this.discardMdatData),f?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=s.start+s.size,!1)):(t.type==="moov"&&(this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0)),r=this.stream.mergeNextBuffer?this.stream.mergeNextBuffer():!1,r?(this.nextParsePosition=this.stream.getEndPosition(),!0):(t.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+t.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},U.prototype.hasIncompleteMdat=function(){return this.parsingMdat!==null},U.prototype.processIncompleteMdat=function(){var t,s;return t=this.parsingMdat,s=this.stream.seek(t.start+t.size,!1,this.discardMdatData),s?(n.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},U.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},U.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},U.prototype.updateUsedBytes=function(t,s){this.stream.addUsedBytes&&(t.type==="mdat"?(this.stream.addUsedBytes(t.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(t.size-t.hdr_size)):this.stream.addUsedBytes(t.size))},U.prototype.add=o.Box.prototype.add,U.prototype.addBox=o.Box.prototype.addBox,U.prototype.init=function(t){var s=t||{};this.add("ftyp").set("major_brand",s.brands&&s.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",s.brands||["iso4"]);var r=this.add("moov");return r.add("mvhd").set("timescale",s.timescale||600).set("rate",s.rate||65536).set("creation_time",0).set("modification_time",0).set("duration",s.duration||0).set("volume",s.width?0:256).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("next_track_id",1),r.add("mvex"),this},U.prototype.addTrack=function(t){this.moov||this.init(t);var s=t||{};s.width=s.width||320,s.height=s.height||320,s.id=s.id||this.moov.mvhd.next_track_id,s.type=s.type||"avc1";var r=this.moov.add("trak");this.moov.mvhd.next_track_id=s.id+1,r.add("tkhd").set("flags",o.TKHD_FLAG_ENABLED|o.TKHD_FLAG_IN_MOVIE|o.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",s.id).set("duration",s.duration||0).set("layer",s.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("width",s.width<<16).set("height",s.height<<16);var f=r.add("mdia");f.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",s.timescale||1).set("duration",s.media_duration||0).set("language",s.language||"und"),f.add("hdlr").set("handler",s.hdlr||"vide").set("name",s.name||"Track created with MP4Box.js"),f.add("elng").set("extended_language",s.language||"fr-FR");var u=f.add("minf");if(o[s.type+"SampleEntry"]!==void 0){var p=new o[s.type+"SampleEntry"];p.data_reference_index=1;var g="";for(var S in o.sampleEntryCodes)for(var B=o.sampleEntryCodes[S],A=0;A<B.length;A++)if(B.indexOf(s.type)>-1){g=S;break}switch(g){case"Visual":if(u.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),p.set("width",s.width).set("height",s.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",s.type+" Compressor").set("depth",24),s.avcDecoderConfigRecord){var I=new o.avcCBox;I.parse(new a(s.avcDecoderConfigRecord)),p.addBox(I)}else if(s.hevcDecoderConfigRecord){var R=new o.hvcCBox;R.parse(new a(s.hevcDecoderConfigRecord)),p.addBox(R)}break;case"Audio":u.add("smhd").set("balance",s.balance||0),p.set("channel_count",s.channel_count||2).set("samplesize",s.samplesize||16).set("samplerate",s.samplerate||65536);break;case"Hint":u.add("hmhd");break;case"Subtitle":switch(u.add("sthd"),s.type){case"stpp":p.set("namespace",s.namespace||"nonamespace").set("schema_location",s.schema_location||"").set("auxiliary_mime_types",s.auxiliary_mime_types||"");break}break;case"Metadata":u.add("nmhd");break;case"System":u.add("nmhd");break;default:u.add("nmhd");break}s.description&&p.addBox(s.description),s.description_boxes&&s.description_boxes.forEach(function(D){p.addBox(D)}),u.add("dinf").add("dref").addEntry(new o["url Box"]().set("flags",1));var K=u.add("stbl");return K.add("stsd").addEntry(p),K.add("stts").set("sample_counts",[]).set("sample_deltas",[]),K.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),K.add("stco").set("chunk_offsets",[]),K.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",s.id).set("default_sample_description_index",s.default_sample_description_index||1).set("default_sample_duration",s.default_sample_duration||0).set("default_sample_size",s.default_sample_size||0).set("default_sample_flags",s.default_sample_flags||0),this.buildTrakSampleLists(r),s.id}},o.Box.prototype.computeSize=function(t){var s=t||new l;s.endianness=l.BIG_ENDIAN,this.write(s)},U.prototype.addSample=function(t,s,r){var f=r||{},u={},p=this.getTrackById(t);if(p!==null){u.number=p.samples.length,u.track_id=p.tkhd.track_id,u.timescale=p.mdia.mdhd.timescale,u.description_index=f.sample_description_index?f.sample_description_index-1:0,u.description=p.mdia.minf.stbl.stsd.entries[u.description_index],u.data=s,u.size=s.byteLength,u.alreadyRead=u.size,u.duration=f.duration||1,u.cts=f.cts||0,u.dts=f.dts||0,u.is_sync=f.is_sync||!1,u.is_leading=f.is_leading||0,u.depends_on=f.depends_on||0,u.is_depended_on=f.is_depended_on||0,u.has_redundancy=f.has_redundancy||0,u.degradation_priority=f.degradation_priority||0,u.offset=0,u.subsamples=f.subsamples,p.samples.push(u),p.samples_size+=u.size,p.samples_duration+=u.duration,p.first_dts===void 0&&(p.first_dts=f.dts),this.processSamples();var g=this.createSingleSampleMoof(u);return this.addBox(g),g.computeSize(),g.trafs[0].truns[0].data_offset=g.size+8,this.add("mdat").data=new Uint8Array(s),u}},U.prototype.createSingleSampleMoof=function(t){var s=0;t.is_sync?s=1<<25:s=65536;var r=new o.moofBox;r.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var f=r.add("traf"),u=this.getTrackById(t.track_id);return f.add("tfhd").set("track_id",t.track_id).set("flags",o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),f.add("tfdt").set("baseMediaDecodeTime",t.dts-(u.first_dts||0)),f.add("trun").set("flags",o.TRUN_FLAGS_DATA_OFFSET|o.TRUN_FLAGS_DURATION|o.TRUN_FLAGS_SIZE|o.TRUN_FLAGS_FLAGS|o.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[t.duration]).set("sample_size",[t.size]).set("sample_flags",[s]).set("sample_composition_time_offset",[t.cts-t.dts]),r},U.prototype.lastMoofIndex=0,U.prototype.samplesDataSize=0,U.prototype.resetTables=function(){var t,s,r,f,u,p,g,S;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,t=0;t<this.moov.traks.length;t++){s=this.moov.traks[t],s.tkhd.duration=0,s.mdia.mdhd.duration=0,r=s.mdia.minf.stbl.stco||s.mdia.minf.stbl.co64,r.chunk_offsets=[],f=s.mdia.minf.stbl.stsc,f.first_chunk=[],f.samples_per_chunk=[],f.sample_description_index=[],u=s.mdia.minf.stbl.stsz||s.mdia.minf.stbl.stz2,u.sample_sizes=[],p=s.mdia.minf.stbl.stts,p.sample_counts=[],p.sample_deltas=[],g=s.mdia.minf.stbl.ctts,g&&(g.sample_counts=[],g.sample_offsets=[]),S=s.mdia.minf.stbl.stss;var B=s.mdia.minf.stbl.boxes.indexOf(S);B!=-1&&(s.mdia.minf.stbl.boxes[B]=null)}},U.initSampleGroups=function(t,s,r,f,u){var p,g,S,B;function A(I,R,K){this.grouping_type=I,this.grouping_type_parameter=R,this.sbgp=K,this.last_sample_in_run=-1,this.entry_index=-1}for(s&&(s.sample_groups_info=[]),t.sample_groups_info||(t.sample_groups_info=[]),g=0;g<r.length;g++){for(B=r[g].grouping_type+"/"+r[g].grouping_type_parameter,S=new A(r[g].grouping_type,r[g].grouping_type_parameter,r[g]),s&&(s.sample_groups_info[B]=S),t.sample_groups_info[B]||(t.sample_groups_info[B]=S),p=0;p<f.length;p++)f[p].grouping_type===r[g].grouping_type&&(S.description=f[p],S.description.used=!0);if(u)for(p=0;p<u.length;p++)u[p].grouping_type===r[g].grouping_type&&(S.fragment_description=u[p],S.fragment_description.used=!0,S.is_fragment=!0)}if(s){if(u)for(g=0;g<u.length;g++)!u[g].used&&u[g].version>=2&&(B=u[g].grouping_type+"/0",S=new A(u[g].grouping_type,0),S.is_fragment=!0,s.sample_groups_info[B]||(s.sample_groups_info[B]=S))}else for(g=0;g<f.length;g++)!f[g].used&&f[g].version>=2&&(B=f[g].grouping_type+"/0",S=new A(f[g].grouping_type,0),t.sample_groups_info[B]||(t.sample_groups_info[B]=S))},U.setSampleGroupProperties=function(t,s,r,f){var u,p;s.sample_groups=[];for(u in f)if(s.sample_groups[u]={},s.sample_groups[u].grouping_type=f[u].grouping_type,s.sample_groups[u].grouping_type_parameter=f[u].grouping_type_parameter,r>=f[u].last_sample_in_run&&(f[u].last_sample_in_run<0&&(f[u].last_sample_in_run=0),f[u].entry_index++,f[u].entry_index<=f[u].sbgp.entries.length-1&&(f[u].last_sample_in_run+=f[u].sbgp.entries[f[u].entry_index].sample_count)),f[u].entry_index<=f[u].sbgp.entries.length-1?s.sample_groups[u].group_description_index=f[u].sbgp.entries[f[u].entry_index].group_description_index:s.sample_groups[u].group_description_index=-1,s.sample_groups[u].group_description_index!==0){var g;f[u].fragment_description?g=f[u].fragment_description:g=f[u].description,s.sample_groups[u].group_description_index>0?(s.sample_groups[u].group_description_index>65535?p=(s.sample_groups[u].group_description_index>>16)-1:p=s.sample_groups[u].group_description_index-1,g&&p>=0&&(s.sample_groups[u].description=g.entries[p])):g&&g.version>=2&&g.default_group_description_index>0&&(s.sample_groups[u].description=g.entries[g.default_group_description_index-1])}},U.process_sdtp=function(t,s,r){s&&(t?(s.is_leading=t.is_leading[r],s.depends_on=t.sample_depends_on[r],s.is_depended_on=t.sample_is_depended_on[r],s.has_redundancy=t.sample_has_redundancy[r]):(s.is_leading=0,s.depends_on=0,s.is_depended_on=0,s.has_redundancy=0))},U.prototype.buildSampleLists=function(){var t,s;for(t=0;t<this.moov.traks.length;t++)s=this.moov.traks[t],this.buildTrakSampleLists(s)},U.prototype.buildTrakSampleLists=function(t){var s,r,f,u,p,g,S,B,A,I,R,K,D,at,it,ht,tt,J,pt,mt,wt,yt,Ut,Dt;if(t.samples=[],t.samples_duration=0,t.samples_size=0,r=t.mdia.minf.stbl.stco||t.mdia.minf.stbl.co64,f=t.mdia.minf.stbl.stsc,u=t.mdia.minf.stbl.stsz||t.mdia.minf.stbl.stz2,p=t.mdia.minf.stbl.stts,g=t.mdia.minf.stbl.ctts,S=t.mdia.minf.stbl.stss,B=t.mdia.minf.stbl.stsd,A=t.mdia.minf.stbl.subs,K=t.mdia.minf.stbl.stdp,I=t.mdia.minf.stbl.sbgps,R=t.mdia.minf.stbl.sgpds,J=-1,pt=-1,mt=-1,wt=-1,yt=0,Ut=0,Dt=0,U.initSampleGroups(t,null,I,R),!(typeof u>"u")){for(s=0;s<u.sample_sizes.length;s++){var Q={};Q.number=s,Q.track_id=t.tkhd.track_id,Q.timescale=t.mdia.mdhd.timescale,Q.alreadyRead=0,t.samples[s]=Q,Q.size=u.sample_sizes[s],t.samples_size+=Q.size,s===0?(at=1,D=0,Q.chunk_index=at,Q.chunk_run_index=D,tt=f.samples_per_chunk[D],ht=0,D+1<f.first_chunk.length?it=f.first_chunk[D+1]-1:it=1/0):s<tt?(Q.chunk_index=at,Q.chunk_run_index=D):(at++,Q.chunk_index=at,ht=0,at<=it||(D++,D+1<f.first_chunk.length?it=f.first_chunk[D+1]-1:it=1/0),Q.chunk_run_index=D,tt+=f.samples_per_chunk[D]),Q.description_index=f.sample_description_index[Q.chunk_run_index]-1,Q.description=B.entries[Q.description_index],Q.offset=r.chunk_offsets[Q.chunk_index-1]+ht,ht+=Q.size,s>J&&(pt++,J<0&&(J=0),J+=p.sample_counts[pt]),s>0?(t.samples[s-1].duration=p.sample_deltas[pt],t.samples_duration+=t.samples[s-1].duration,Q.dts=t.samples[s-1].dts+t.samples[s-1].duration):Q.dts=0,g?(s>=mt&&(wt++,mt<0&&(mt=0),mt+=g.sample_counts[wt]),Q.cts=t.samples[s].dts+g.sample_offsets[wt]):Q.cts=Q.dts,S?(s==S.sample_numbers[yt]-1?(Q.is_sync=!0,yt++):(Q.is_sync=!1,Q.degradation_priority=0),A&&A.entries[Ut].sample_delta+Dt==s+1&&(Q.subsamples=A.entries[Ut].subsamples,Dt+=A.entries[Ut].sample_delta,Ut++)):Q.is_sync=!0,U.process_sdtp(t.mdia.minf.stbl.sdtp,Q,Q.number),K?Q.degradation_priority=K.priority[s]:Q.degradation_priority=0,A&&A.entries[Ut].sample_delta+Dt==s&&(Q.subsamples=A.entries[Ut].subsamples,Dt+=A.entries[Ut].sample_delta),(I.length>0||R.length>0)&&U.setSampleGroupProperties(t,Q,s,t.sample_groups_info)}s>0&&(t.samples[s-1].duration=Math.max(t.mdia.mdhd.duration-t.samples[s-1].dts,0),t.samples_duration+=t.samples[s-1].duration)}},U.prototype.updateSampleLists=function(){var t,s,r,f,u,p,g,S,B,A,I,R,K,D,at;if(this.moov!==void 0){for(;this.lastMoofIndex<this.moofs.length;)if(B=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,B.type=="moof")for(A=B,t=0;t<A.trafs.length;t++){for(I=A.trafs[t],R=this.getTrackById(I.tfhd.track_id),K=this.getTrexById(I.tfhd.track_id),I.tfhd.flags&o.TFHD_FLAG_SAMPLE_DESC?f=I.tfhd.default_sample_description_index:f=K?K.default_sample_description_index:1,I.tfhd.flags&o.TFHD_FLAG_SAMPLE_DUR?u=I.tfhd.default_sample_duration:u=K?K.default_sample_duration:0,I.tfhd.flags&o.TFHD_FLAG_SAMPLE_SIZE?p=I.tfhd.default_sample_size:p=K?K.default_sample_size:0,I.tfhd.flags&o.TFHD_FLAG_SAMPLE_FLAGS?g=I.tfhd.default_sample_flags:g=K?K.default_sample_flags:0,I.sample_number=0,I.sbgps.length>0&&U.initSampleGroups(R,I,I.sbgps,R.mdia.minf.stbl.sgpds,I.sgpds),s=0;s<I.truns.length;s++){var it=I.truns[s];for(r=0;r<it.sample_count;r++){D={},D.moof_number=this.lastMoofIndex,D.number_in_traf=I.sample_number,I.sample_number++,D.number=R.samples.length,I.first_sample_index=R.samples.length,R.samples.push(D),D.track_id=R.tkhd.track_id,D.timescale=R.mdia.mdhd.timescale,D.description_index=f-1,D.description=R.mdia.minf.stbl.stsd.entries[D.description_index],D.size=p,it.flags&o.TRUN_FLAGS_SIZE&&(D.size=it.sample_size[r]),R.samples_size+=D.size,D.duration=u,it.flags&o.TRUN_FLAGS_DURATION&&(D.duration=it.sample_duration[r]),R.samples_duration+=D.duration,R.first_traf_merged||r>0?D.dts=R.samples[R.samples.length-2].dts+R.samples[R.samples.length-2].duration:(I.tfdt?D.dts=I.tfdt.baseMediaDecodeTime:D.dts=0,R.first_traf_merged=!0),D.cts=D.dts,it.flags&o.TRUN_FLAGS_CTS_OFFSET&&(D.cts=D.dts+it.sample_composition_time_offset[r]),at=g,it.flags&o.TRUN_FLAGS_FLAGS?at=it.sample_flags[r]:r===0&&it.flags&o.TRUN_FLAGS_FIRST_FLAG&&(at=it.first_sample_flags),D.is_sync=!(at>>16&1),D.is_leading=at>>26&3,D.depends_on=at>>24&3,D.is_depended_on=at>>22&3,D.has_redundancy=at>>20&3,D.degradation_priority=at&65535;var ht=!!(I.tfhd.flags&o.TFHD_FLAG_BASE_DATA_OFFSET),tt=!!(I.tfhd.flags&o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),J=!!(it.flags&o.TRUN_FLAGS_DATA_OFFSET),pt=0;ht?pt=I.tfhd.base_data_offset:tt||s===0?pt=A.start:pt=S,s===0&&r===0?J?D.offset=pt+it.data_offset:D.offset=pt:D.offset=S,S=D.offset+D.size,(I.sbgps.length>0||I.sgpds.length>0||R.mdia.minf.stbl.sbgps.length>0||R.mdia.minf.stbl.sgpds.length>0)&&U.setSampleGroupProperties(R,D,D.number_in_traf,I.sample_groups_info)}}if(I.subs){R.has_fragment_subsamples=!0;var mt=I.first_sample_index;for(s=0;s<I.subs.entries.length;s++)mt+=I.subs.entries[s].sample_delta,D=R.samples[mt-1],D.subsamples=I.subs.entries[s].subsamples}}}},U.prototype.getSample=function(t,s){var r,f=t.samples[s];if(!this.moov)return null;if(!f.data)f.data=new Uint8Array(f.size),f.alreadyRead=0,this.samplesDataSize+=f.size,n.debug("ISOFile","Allocating sample #"+s+" on track #"+t.tkhd.track_id+" of size "+f.size+" (total: "+this.samplesDataSize+")");else if(f.alreadyRead==f.size)return f;for(;;){var u=this.stream.findPosition(!0,f.offset+f.alreadyRead,!1);if(u>-1){r=this.stream.buffers[u];var p=r.byteLength-(f.offset+f.alreadyRead-r.fileStart);if(f.size-f.alreadyRead<=p)return n.debug("ISOFile","Getting sample #"+s+" data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-r.fileStart)+" read size: "+(f.size-f.alreadyRead)+" full size: "+f.size+")"),l.memcpy(f.data.buffer,f.alreadyRead,r,f.offset+f.alreadyRead-r.fileStart,f.size-f.alreadyRead),r.usedBytes+=f.size-f.alreadyRead,this.stream.logBufferLevel(),f.alreadyRead=f.size,f;if(p===0)return null;n.debug("ISOFile","Getting sample #"+s+" partial data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-r.fileStart)+" read size: "+p+" full size: "+f.size+")"),l.memcpy(f.data.buffer,f.alreadyRead,r,f.offset+f.alreadyRead-r.fileStart,p),f.alreadyRead+=p,r.usedBytes+=p,this.stream.logBufferLevel()}else return null}},U.prototype.releaseSample=function(t,s){var r=t.samples[s];return r.data?(this.samplesDataSize-=r.size,r.data=null,r.alreadyRead=0,r.size):0},U.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},U.prototype.getCodecs=function(){var t,s="";for(t=0;t<this.moov.traks.length;t++){var r=this.moov.traks[t];t>0&&(s+=","),s+=r.mdia.minf.stbl.stsd.entries[0].getCodec()}return s},U.prototype.getTrexById=function(t){var s;if(!this.moov||!this.moov.mvex)return null;for(s=0;s<this.moov.mvex.trexs.length;s++){var r=this.moov.mvex.trexs[s];if(r.track_id==t)return r}return null},U.prototype.getTrackById=function(t){if(this.moov===void 0)return null;for(var s=0;s<this.moov.traks.length;s++){var r=this.moov.traks[s];if(r.tkhd.track_id==t)return r}return null},U.prototype.itemsDataSize=0,U.prototype.flattenItemInfo=function(){var t=this.items,s=this.entity_groups,r,f,u,p=this.meta;if(p!=null&&p.hdlr!==void 0&&p.iinf!==void 0){for(r=0;r<p.iinf.item_infos.length;r++)u={},u.id=p.iinf.item_infos[r].item_ID,t[u.id]=u,u.ref_to=[],u.name=p.iinf.item_infos[r].item_name,p.iinf.item_infos[r].protection_index>0&&(u.protection=p.ipro.protections[p.iinf.item_infos[r].protection_index-1]),p.iinf.item_infos[r].item_type?u.type=p.iinf.item_infos[r].item_type:u.type="mime",u.content_type=p.iinf.item_infos[r].content_type,u.content_encoding=p.iinf.item_infos[r].content_encoding,u.item_uri_type=p.iinf.item_infos[r].item_uri_type;if(p.grpl)for(r=0;r<p.grpl.boxes.length;r++)entity_group={},entity_group.id=p.grpl.boxes[r].group_id,entity_group.entity_ids=p.grpl.boxes[r].entity_ids,entity_group.type=p.grpl.boxes[r].type,s[entity_group.id]=entity_group;if(p.iloc)for(r=0;r<p.iloc.items.length;r++){var g=p.iloc.items[r];switch(u=t[g.item_ID],g.data_reference_index!==0&&(n.warn("Item storage with reference to other files: not supported"),u.source=p.dinf.boxes[g.data_reference_index-1]),g.construction_method){case 0:break;case 1:break;case 2:n.warn("Item storage with construction_method : not supported");break}for(u.extents=[],u.size=0,f=0;f<g.extents.length;f++)u.extents[f]={},u.extents[f].offset=g.extents[f].extent_offset+g.base_offset,g.construction_method==1&&(u.extents[f].offset+=p.idat.start+p.idat.hdr_size),u.extents[f].length=g.extents[f].extent_length,u.extents[f].alreadyRead=0,u.size+=u.extents[f].length}if(p.pitm&&(t[p.pitm.item_id].primary=!0),p.iref)for(r=0;r<p.iref.references.length;r++){var S=p.iref.references[r];for(f=0;f<S.references.length;f++)t[S.from_item_ID].ref_to.push({type:S.type,id:S.references[f]})}if(p.iprp)for(var B=0;B<p.iprp.ipmas.length;B++){var A=p.iprp.ipmas[B];for(r=0;r<A.associations.length;r++){var I=A.associations[r];if(u=t[I.id],u||(u=s[I.id]),u)for(u.properties===void 0&&(u.properties={},u.properties.boxes=[]),f=0;f<I.props.length;f++){var R=I.props[f];if(R.property_index>0&&R.property_index-1<p.iprp.ipco.boxes.length){var K=p.iprp.ipco.boxes[R.property_index-1];u.properties[K.type]=K,u.properties.boxes.push(K)}}}}}},U.prototype.getItem=function(t){var s,r;if(!this.meta)return null;if(r=this.items[t],!r.data&&r.size)r.data=new Uint8Array(r.size),r.alreadyRead=0,this.itemsDataSize+=r.size,n.debug("ISOFile","Allocating item #"+t+" of size "+r.size+" (total: "+this.itemsDataSize+")");else if(r.alreadyRead===r.size)return r;for(var f=0;f<r.extents.length;f++){var u=r.extents[f];if(u.alreadyRead!==u.length){var p=this.stream.findPosition(!0,u.offset+u.alreadyRead,!1);if(p>-1){s=this.stream.buffers[p];var g=s.byteLength-(u.offset+u.alreadyRead-s.fileStart);if(u.length-u.alreadyRead<=g)n.debug("ISOFile","Getting item #"+t+" extent #"+f+" data (alreadyRead: "+u.alreadyRead+" offset: "+(u.offset+u.alreadyRead-s.fileStart)+" read size: "+(u.length-u.alreadyRead)+" full extent size: "+u.length+" full item size: "+r.size+")"),l.memcpy(r.data.buffer,r.alreadyRead,s,u.offset+u.alreadyRead-s.fileStart,u.length-u.alreadyRead),s.usedBytes+=u.length-u.alreadyRead,this.stream.logBufferLevel(),r.alreadyRead+=u.length-u.alreadyRead,u.alreadyRead=u.length;else return n.debug("ISOFile","Getting item #"+t+" extent #"+f+" partial data (alreadyRead: "+u.alreadyRead+" offset: "+(u.offset+u.alreadyRead-s.fileStart)+" read size: "+g+" full extent size: "+u.length+" full item size: "+r.size+")"),l.memcpy(r.data.buffer,r.alreadyRead,s,u.offset+u.alreadyRead-s.fileStart,g),u.alreadyRead+=g,r.alreadyRead+=g,s.usedBytes+=g,this.stream.logBufferLevel(),null}else return null}}return r.alreadyRead===r.size?r:null},U.prototype.releaseItem=function(t){var s=this.items[t];if(s.data){this.itemsDataSize-=s.size,s.data=null,s.alreadyRead=0;for(var r=0;r<s.extents.length;r++){var f=s.extents[r];f.alreadyRead=0}return s.size}else return 0},U.prototype.processItems=function(t){for(var s in this.items){var r=this.items[s];this.getItem(r.id),t&&!r.sent&&(t(r),r.sent=!0,r.data=null)}},U.prototype.hasItem=function(t){for(var s in this.items){var r=this.items[s];if(r.name===t)return r.id}return-1},U.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},U.prototype.getPrimaryItem=function(){return!this.meta||!this.meta.pitm?null:this.getItem(this.meta.pitm.item_id)},U.prototype.itemToFragmentedTrackFile=function(t){var s=t||{},r=null;if(s.itemId?r=this.getItem(s.itemId):r=this.getPrimaryItem(),r==null)return null;var f=new U;f.discardMdatData=!1;var u={type:r.type,description_boxes:r.properties.boxes};r.properties.ispe&&(u.width=r.properties.ispe.image_width,u.height=r.properties.ispe.image_height);var p=f.addTrack(u);return p?(f.addSample(p,r.data),f):null},U.prototype.write=function(t){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(t)},U.prototype.createFragment=function(t,s,r){var f=this.getTrackById(t),u=this.getSample(f,s);if(u==null)return this.setNextSeekPositionFromSample(f.samples[s]),null;var p=r||new l;p.endianness=l.BIG_ENDIAN;var g=this.createSingleSampleMoof(u);g.write(p),g.trafs[0].truns[0].data_offset=g.size+8,n.debug("MP4Box","Adjusting data_offset with new value "+g.trafs[0].truns[0].data_offset),p.adjustUint32(g.trafs[0].truns[0].data_offset_position,g.trafs[0].truns[0].data_offset);var S=new o.mdatBox;return S.data=u.data,S.write(p),p},U.writeInitializationSegment=function(t,s,r,f){var u;n.debug("ISOFile","Generating initialization segment");var p=new l;p.endianness=l.BIG_ENDIAN,t.write(p);var g=s.add("mvex");for(r&&g.add("mehd").set("fragment_duration",r),u=0;u<s.traks.length;u++)g.add("trex").set("track_id",s.traks[u].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",f).set("default_sample_size",0).set("default_sample_flags",65536);return s.write(p),p.buffer},U.prototype.save=function(t){var s=new l;s.endianness=l.BIG_ENDIAN,this.write(s),s.save(t)},U.prototype.getBuffer=function(){var t=new l;return t.endianness=l.BIG_ENDIAN,this.write(t),t.buffer},U.prototype.initializeSegmentation=function(){var t,s,r,f;for(this.onSegment===null&&n.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),s=[],t=0;t<this.fragmentedTracks.length;t++){var u=new o.moovBox;u.mvhd=this.moov.mvhd,u.boxes.push(u.mvhd),r=this.getTrackById(this.fragmentedTracks[t].id),u.boxes.push(r),u.traks.push(r),f={},f.id=r.tkhd.track_id,f.user=this.fragmentedTracks[t].user,f.buffer=U.writeInitializationSegment(this.ftyp,u,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[t].samples.length>0?this.moov.traks[t].samples[0].duration:0),s.push(f)}return s},o.Box.prototype.printHeader=function(t){this.size+=8,this.size>c&&(this.size+=8),this.type==="uuid"&&(this.size+=16),t.log(t.indent+"size:"+this.size),t.log(t.indent+"type:"+this.type)},o.FullBox.prototype.printHeader=function(t){this.size+=4,o.Box.prototype.printHeader.call(this,t),t.log(t.indent+"version:"+this.version),t.log(t.indent+"flags:"+this.flags)},o.Box.prototype.print=function(t){this.printHeader(t)},o.ContainerBox.prototype.print=function(t){this.printHeader(t);for(var s=0;s<this.boxes.length;s++)if(this.boxes[s]){var r=t.indent;t.indent+=" ",this.boxes[s].print(t),t.indent=r}},U.prototype.print=function(t){t.indent="";for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&this.boxes[s].print(t)},o.mvhdBox.prototype.print=function(t){o.FullBox.prototype.printHeader.call(this,t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"timescale: "+this.timescale),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"rate: "+this.rate),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"next_track_id: "+this.next_track_id)},o.tkhdBox.prototype.print=function(t){o.FullBox.prototype.printHeader.call(this,t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"track_id: "+this.track_id),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"layer: "+this.layer),t.log(t.indent+"alternate_group: "+this.alternate_group),t.log(t.indent+"width: "+this.width),t.log(t.indent+"height: "+this.height)};var H={};H.createFile=function(t,s){var r=t!==void 0?t:!0,f=new U(s);return f.discardMdatData=!r,f},e.createFile=H.createFile}(tn)),tn}var Hc=Nc();const Gc=Oc(Hc);class Vc extends Error{constructor(n){super(n),this.name="NotSupportError"}}async function Yc(e,n,a=1e6,l=null){let c,h;if(Reflect.has(globalThis,"MediaSource")==!1)throw new Vc("MediaSource is not supported in this browser or context.");const d=Gc.createFile();let o=null;const _=new Map;let b;await async function u(){if(!u.request)return u.request=!0,await new Promise((p,g)=>{o=new MediaSource,e.src=URL.createObjectURL(o),o.addEventListener("sourceopen",()=>{p(),setTimeout(()=>{u.request=!1},1e3)},{once:!0}),o.addEventListener("error",g),setTimeout(g,1e4,new Error("Timeout waiting for sourceopen"))})}();let x=1;const E=function(p){var g=p.id,S=p.codec,B='video/mp4; codecs="'+S+'"',A,I=typeof TrackDefault<"u";MediaSource.isTypeSupported(B)?(c=o.addSourceBuffer(B),_.set(g,c),I&&(c.trackDefaults=new TrackDefaultList([A])),c.addEventListener("error",function(R){}),c.ms=o,c.id=g,d.setSegmentOptions(g,c,{nbSamples:10}),c.pendingAppends=[]):console.error("ms not supported")},C=function u(p){const g=p.target;g.ms.readyState==="open"&&(g.sampleNum=0,g.removeEventListener("updateend",u),g.addEventListener("updateend",U.bind(g,!0,!0)),U.call(g,!1,!0),g.ms.pendingInits--)},U=function u(p,g){if(g===!0){if(p===!0&&this.ms.readyState==="open"&&this.buffered.length>0)try{const B=e.currentTime;for(let A=0;A<this.buffered.length;A++){const I=this.buffered.start(A),R=this.buffered.end(A);if(R<B-5){this.remove(I,R);break}}}catch{}if(this.sampleNum&&(d.releaseUsedSamples(this.id,this.sampleNum),delete this.sampleNum),this.is_last)try{o.readyState==="open"&&(l?.(()=>{o.endOfStream()}),l&&(l=null))}catch{}}if(this.updating===!1&&this.pendingAppends.length>0){if(this.ms.readyState!=="open")return;var S=this.pendingAppends.shift();this.sampleNum=S.sampleNum,this.is_last=S.is_last;try{this.appendBuffer(S.buffer)}catch(B){B.name==="QuotaExceededError"&&(this.pendingAppends.splice(0,0,S),setTimeout(()=>{u.apply(this,arguments)},1e3))}}};d.onMoovStart=function(){},d.onReady=function(u){if(o.movieInfo=u,u.isFragmented?o.duration=o.original_duration=u.fragment_duration/u.timescale:o.duration=o.original_duration=u.duration/u.timescale,u){for(const p of u.tracks)E(p);b=d.initializeSegmentation();for(let p=0;p<b.length;p++){const g=b[p].user;p===0&&(g.ms.pendingInits=0),g.addEventListener("updateend",C),g.appendBuffer(b[p].buffer),g.segmentIndex=0,g.ms.pendingInits++}}},d.onSegment=function(u,p,g,S,B){const A=p;A.segmentIndex++,A.pendingAppends.push({id:u,buffer:g,sampleNum:S,is_last:B}),U.call(A,!0,!1)},d.start();function H(){const u=new Date().getTime();if(u-H.antiTik<100)return;H.antiTik=u;let p,g,S;for(p=0;p<e.buffered.length;p++)if(g=e.buffered.start(p),S=e.buffered.end(p),e.currentTime>=g&&e.currentTime<=S-Math.ceil(11*e.playbackRate))return;const B=d.seek(e.currentTime,!0);f(B.offset,B.offset+a),e.lastSeekTime=e.currentTime}H.antiTik=0;function t(){e.lastSeekTime!==e.currentTime&&H()}function s(){(isNaN(s.last_time)||e.currentTime<s.last_time||e.currentTime-s.last_time>Math.ceil(10*e.playbackRate))&&(H(),s.last_time=e.currentTime)}e.addEventListener("seeked",t),e.addEventListener("timeupdate",s);const r=()=>{h=!0,e.removeEventListener("seeked",t),e.removeEventListener("timeupdate",s),_.forEach((u,p)=>{try{u.updating&&u.abort(),o.readyState==="open"&&o.removeSourceBuffer(u),u.removeEventListener("updateend",U),d.releaseUsedSamples(p,u.sampleNum)}catch(g){console.warn("Error cleaning up SourceBuffer:",g)}}),_.clear(),d&&(d.flush(),d.onSegment=null,d.onReady=null,d.onMoovStart=null,d.stop()),URL.revokeObjectURL(e.src),e.src="data:null/null,null"};async function f(u,p,g=null,S=0){if(g==null)g=++x;else if(g!==x)return!0;if(h)return-1;if(S>64)return 3;const B=new Blob([await n(u,p)]);if(g!==x)return 2;if(!B.size){const R=new ArrayBuffer(0);return R.fileStart=u,d.appendBuffer(R,!0),d.flush(),1}const A=await B.arrayBuffer();A.fileStart=u;const I=d.appendBuffer(A,!!B.eof);return d.flush(),I?await f(I,I+a,g,++S):B.eof?!1:null}return queueMicrotask(async()=>{await f(0,999999)}),r.getMediaSource=()=>o,r}const jc={name:"VideoDecryption",data(){return{ctx:null,file:null,fileUrl:"",password:"",playing:!1,cleanup:null,mode:"local"}},methods:{handleFileSelect(e){this.file=e.target.files[0]},async getFileSize(e){const n=new AbortController,a=await fetch(e,{signal:n.signal});if(!a.ok)throw new Error(`Failed to fetch file size: ${a.statusText}`);const l=+a.headers.get("Content-Length");if(isNaN(l))throw new Error("Content-Length header is missing or invalid");return n.abort(),l},async playVideo(){try{this.playing=!0,await this.$nextTick();const e=await fo();this.ctx=e;let n=this.mode==="local"?this.file:{size:await this.getFileSize(this.fileUrl)};const a=this.mode==="local"?async(h,d)=>{const o=n.slice(h,d);return new Uint8Array(await o.arrayBuffer())}:async(h,d)=>{const o=await fetch(this.fileUrl,{headers:{Range:`bytes=${h}-${d-1}`},method:"GET"});return new Uint8Array(await o.arrayBuffer())},l=this.password;await co(e,new uo((h,d)=>a(h,d),n.size),l),console.log("ctx=",e);const c=this.$refs.videoPlayer;c.controls=!0,this.cleanup=await Yc(c,async(h,d)=>await ho(e,h,d)),this.$refs.videoDialog.showModal()}catch(e){console.error(e),alert(e),this.playing=!1}},closeDialog(){this.$refs.videoDialog.close()},handleDialogClose(){this.playing=!1,this.cleanup&&(this.cleanup(),this.cleanup=null),lo(this.ctx),console.log("ctx destroy",this.ctx),this.ctx=null}}},Kc={class:"video-decrypt-container"},Wc={class:"mode-selector"},qc=["disabled"],$c={key:0,ref:"videoPlayer",controls:"",style:{flex:"1"}};function Xc(e,n,a,l,c,h){return Pt(),Mt("div",Kc,[Y("div",Wc,[Y("label",null,[Tt(Y("input",{type:"radio","onUpdate:modelValue":n[0]||(n[0]=d=>c.mode=d),value:"local"},null,512),[[_s,c.mode]]),n[8]||(n[8]=be(" 本地文件 "))]),Y("label",null,[Tt(Y("input",{type:"radio","onUpdate:modelValue":n[1]||(n[1]=d=>c.mode=d),value:"remote"},null,512),[[_s,c.mode]]),n[9]||(n[9]=be(" 在线文件 "))])]),c.mode==="local"?(Pt(),Mt("input",{key:0,type:"file",onChange:n[2]||(n[2]=(...d)=>h.handleFileSelect&&h.handleFileSelect(...d))},null,32)):pe("",!0),c.mode==="remote"?Tt((Pt(),Mt("input",{key:1,type:"text","onUpdate:modelValue":n[3]||(n[3]=d=>c.fileUrl=d),placeholder:"输入视频URL"},null,512)),[[Qt,c.fileUrl]]):pe("",!0),Tt(Y("input",{type:"password","onUpdate:modelValue":n[4]||(n[4]=d=>c.password=d),placeholder:"输入解密密码"},null,512),[[Qt,c.password]]),Y("button",{onClick:n[5]||(n[5]=(...d)=>h.playVideo&&h.playVideo(...d)),disabled:!c.file&&c.mode==="local"||!c.fileUrl&&c.mode==="remote"||c.playing},"播放视频",8,qc),Y("dialog",{style:{width:"100%",height:"100%",display:"flex","flex-direction":"column"},ref:"videoDialog",onClose:n[7]||(n[7]=(...d)=>h.handleDialogClose&&h.handleDialogClose(...d))},[c.playing?(Pt(),Mt("video",$c,null,512)):pe("",!0),Y("button",{onClick:n[6]||(n[6]=(...d)=>h.closeDialog&&h.closeDialog(...d)),style:{"margin-top":"0.5em"}},"关闭")],544)])}const Zc=ui(jc,[["render",Xc],["__scopeId","data-v-cf04a91c"]]),Qc=[{path:"/message",name:"message",component:tc},{path:"/file",name:"file",component:xc},{path:"/file-classic",name:"file-classic",component:Dc},{path:"/video-decrypt",name:"video-decrypt",component:Zc},{path:"/",redirect:"/message"}],Jc=Gf({history:yf(),routes:Qc});Il(Dl).use(Jc).mount("#app");
//# sourceMappingURL=index-3y2nDTqA.js.map
