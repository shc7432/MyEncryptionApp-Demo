(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))l(f);new MutationObserver(f=>{for(const u of f)if(u.type==="childList")for(const h of u.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function a(f){const u={};return f.integrity&&(u.integrity=f.integrity),f.referrerPolicy&&(u.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?u.credentials="include":f.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function l(f){if(f.ep)return;f.ep=!0;const u=a(f);fetch(f.href,u)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Wn(t){const n=Object.create(null);for(const a of t.split(","))n[a]=1;return a=>a in n}const he={},Vt=[],rt=()=>{},Ea=()=>!1,en=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Xn=t=>t.startsWith("onUpdate:"),Te=Object.assign,Zn=(t,n)=>{const a=t.indexOf(n);a>-1&&t.splice(a,1)},Ca=Object.prototype.hasOwnProperty,le=(t,n)=>Ca.call(t,n),Q=Array.isArray,Gt=t=>Pi(t)==="[object Map]",tn=t=>Pi(t)==="[object Set]",Lr=t=>Pi(t)==="[object Date]",ie=t=>typeof t=="function",we=t=>typeof t=="string",st=t=>typeof t=="symbol",_e=t=>t!==null&&typeof t=="object",Fs=t=>(_e(t)||ie(t))&&ie(t.then)&&ie(t.catch),Ls=Object.prototype.toString,Pi=t=>Ls.call(t),Ba=t=>Pi(t).slice(8,-1),ks=t=>Pi(t)==="[object Object]",Jn=t=>we(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,li=Wn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),nn=t=>{const n=Object.create(null);return a=>n[a]||(n[a]=t(a))},Ta=/-(\w)/g,je=nn(t=>t.replace(Ta,(n,a)=>a?a.toUpperCase():"")),Pa=/\B([A-Z])/g,zt=nn(t=>t.replace(Pa,"-$1").toLowerCase()),rn=nn(t=>t.charAt(0).toUpperCase()+t.slice(1)),vn=nn(t=>t?`on${rn(t)}`:""),xt=(t,n)=>!Object.is(t,n),Mi=(t,...n)=>{for(let a=0;a<t.length;a++)t[a](...n)},Rs=(t,n,a,l=!1)=>{Object.defineProperty(t,n,{configurable:!0,enumerable:!1,writable:l,value:a})},Gi=t=>{const n=parseFloat(t);return isNaN(n)?t:n};let kr;const sn=()=>kr||(kr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qn(t){if(Q(t)){const n={};for(let a=0;a<t.length;a++){const l=t[a],f=we(l)?ka(l):Qn(l);if(f)for(const u in f)n[u]=f[u]}return n}else if(we(t)||_e(t))return t}const Ia=/;(?![^(]*\))/g,Fa=/:([^]+)/,La=/\/\*[^]*?\*\//g;function ka(t){const n={};return t.replace(La,"").split(Ia).forEach(a=>{if(a){const l=a.split(Fa);l.length>1&&(n[l[0].trim()]=l[1].trim())}}),n}function er(t){let n="";if(we(t))n=t;else if(Q(t))for(let a=0;a<t.length;a++){const l=er(t[a]);l&&(n+=l+" ")}else if(_e(t))for(const a in t)t[a]&&(n+=a+" ");return n.trim()}const Ra="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",za=Wn(Ra);function zs(t){return!!t||t===""}function Ma(t,n){if(t.length!==n.length)return!1;let a=!0;for(let l=0;a&&l<t.length;l++)a=qt(t[l],n[l]);return a}function qt(t,n){if(t===n)return!0;let a=Lr(t),l=Lr(n);if(a||l)return a&&l?t.getTime()===n.getTime():!1;if(a=st(t),l=st(n),a||l)return t===n;if(a=Q(t),l=Q(n),a||l)return a&&l?Ma(t,n):!1;if(a=_e(t),l=_e(n),a||l){if(!a||!l)return!1;const f=Object.keys(t).length,u=Object.keys(n).length;if(f!==u)return!1;for(const h in t){const o=t.hasOwnProperty(h),p=n.hasOwnProperty(h);if(o&&!p||!o&&p||!qt(t[h],n[h]))return!1}}return String(t)===String(n)}function Da(t,n){return t.findIndex(a=>qt(a,n))}const Ms=t=>!!(t&&t.__v_isRef===!0),$t=t=>we(t)?t:t==null?"":Q(t)||_e(t)&&(t.toString===Ls||!ie(t.toString))?Ms(t)?$t(t.value):JSON.stringify(t,Ds,2):String(t),Ds=(t,n)=>Ms(n)?Ds(t,n.value):Gt(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((a,[l,f],u)=>(a[wn(l,u)+" =>"]=f,a),{})}:tn(n)?{[`Set(${n.size})`]:[...n.values()].map(a=>wn(a))}:st(n)?wn(n):_e(n)&&!Q(n)&&!ks(n)?String(n):n,wn=(t,n="")=>{var a;return st(t)?`Symbol(${(a=t.description)!=null?a:n})`:t};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Oe;class Oa{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Oe,!n&&Oe&&(this.index=(Oe.scopes||(Oe.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,a;if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].pause();for(n=0,a=this.effects.length;n<a;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,a;if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].resume();for(n=0,a=this.effects.length;n<a;n++)this.effects[n].resume()}}run(n){if(this._active){const a=Oe;try{return Oe=this,n()}finally{Oe=a}}}on(){Oe=this}off(){Oe=this.parent}stop(n){if(this._active){this._active=!1;let a,l;for(a=0,l=this.effects.length;a<l;a++)this.effects[a].stop();for(this.effects.length=0,a=0,l=this.cleanups.length;a<l;a++)this.cleanups[a]();if(this.cleanups.length=0,this.scopes){for(a=0,l=this.scopes.length;a<l;a++)this.scopes[a].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const f=this.parent.scopes.pop();f&&f!==this&&(this.parent.scopes[this.index]=f,f.index=this.index)}this.parent=void 0}}}function Na(){return Oe}let pe;const xn=new WeakSet;class Os{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Oe&&Oe.active&&Oe.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,xn.has(this)&&(xn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Hs(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Rr(this),Vs(this);const n=pe,a=Ke;pe=this,Ke=!0;try{return this.fn()}finally{Gs(this),pe=n,Ke=a,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)nr(n);this.deps=this.depsTail=void 0,Rr(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?xn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){kn(this)&&this.run()}get dirty(){return kn(this)}}let Ns=0,fi,ci;function Hs(t,n=!1){if(t.flags|=8,n){t.next=ci,ci=t;return}t.next=fi,fi=t}function tr(){Ns++}function ir(){if(--Ns>0)return;if(ci){let n=ci;for(ci=void 0;n;){const a=n.next;n.next=void 0,n.flags&=-9,n=a}}let t;for(;fi;){let n=fi;for(fi=void 0;n;){const a=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(l){t||(t=l)}n=a}}if(t)throw t}function Vs(t){for(let n=t.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function Gs(t){let n,a=t.depsTail,l=a;for(;l;){const f=l.prevDep;l.version===-1?(l===a&&(a=f),nr(l),Ha(l)):n=l,l.dep.activeLink=l.prevActiveLink,l.prevActiveLink=void 0,l=f}t.deps=n,t.depsTail=a}function kn(t){for(let n=t.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(js(n.dep.computed)||n.dep.version!==n.version))return!0;return!!t._dirty}function js(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===mi))return;t.globalVersion=mi;const n=t.dep;if(t.flags|=2,n.version>0&&!t.isSSR&&t.deps&&!kn(t)){t.flags&=-3;return}const a=pe,l=Ke;pe=t,Ke=!0;try{Vs(t);const f=t.fn(t._value);(n.version===0||xt(f,t._value))&&(t._value=f,n.version++)}catch(f){throw n.version++,f}finally{pe=a,Ke=l,Gs(t),t.flags&=-3}}function nr(t,n=!1){const{dep:a,prevSub:l,nextSub:f}=t;if(l&&(l.nextSub=f,t.prevSub=void 0),f&&(f.prevSub=l,t.nextSub=void 0),a.subs===t&&(a.subs=l,!l&&a.computed)){a.computed.flags&=-5;for(let u=a.computed.deps;u;u=u.nextDep)nr(u,!0)}!n&&!--a.sc&&a.map&&a.map.delete(a.key)}function Ha(t){const{prevDep:n,nextDep:a}=t;n&&(n.nextDep=a,t.prevDep=void 0),a&&(a.prevDep=n,t.nextDep=void 0)}let Ke=!0;const Ys=[];function St(){Ys.push(Ke),Ke=!1}function Ut(){const t=Ys.pop();Ke=t===void 0?!0:t}function Rr(t){const{cleanup:n}=t;if(t.cleanup=void 0,n){const a=pe;pe=void 0;try{n()}finally{pe=a}}}let mi=0;class Va{constructor(n,a){this.sub=n,this.dep=a,this.version=a.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class rr{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!pe||!Ke||pe===this.computed)return;let a=this.activeLink;if(a===void 0||a.sub!==pe)a=this.activeLink=new Va(pe,this),pe.deps?(a.prevDep=pe.depsTail,pe.depsTail.nextDep=a,pe.depsTail=a):pe.deps=pe.depsTail=a,Ks(a);else if(a.version===-1&&(a.version=this.version,a.nextDep)){const l=a.nextDep;l.prevDep=a.prevDep,a.prevDep&&(a.prevDep.nextDep=l),a.prevDep=pe.depsTail,a.nextDep=void 0,pe.depsTail.nextDep=a,pe.depsTail=a,pe.deps===a&&(pe.deps=l)}return a}trigger(n){this.version++,mi++,this.notify(n)}notify(n){tr();try{for(let a=this.subs;a;a=a.prevSub)a.sub.notify()&&a.sub.dep.notify()}finally{ir()}}}function Ks(t){if(t.dep.sc++,t.sub.flags&4){const n=t.dep.computed;if(n&&!t.dep.subs){n.flags|=20;for(let l=n.deps;l;l=l.nextDep)Ks(l)}const a=t.dep.subs;a!==t&&(t.prevSub=a,a&&(a.nextSub=t)),t.dep.subs=t}}const Rn=new WeakMap,Ft=Symbol(""),zn=Symbol(""),vi=Symbol("");function Ee(t,n,a){if(Ke&&pe){let l=Rn.get(t);l||Rn.set(t,l=new Map);let f=l.get(a);f||(l.set(a,f=new rr),f.map=l,f.key=a),f.track()}}function ut(t,n,a,l,f,u){const h=Rn.get(t);if(!h){mi++;return}const o=p=>{p&&p.trigger()};if(tr(),n==="clear")h.forEach(o);else{const p=Q(t),g=p&&Jn(a);if(p&&a==="length"){const y=Number(l);h.forEach((v,S)=>{(S==="length"||S===vi||!st(S)&&S>=y)&&o(v)})}else switch((a!==void 0||h.has(void 0))&&o(h.get(a)),g&&o(h.get(vi)),n){case"add":p?g&&o(h.get("length")):(o(h.get(Ft)),Gt(t)&&o(h.get(zn)));break;case"delete":p||(o(h.get(Ft)),Gt(t)&&o(h.get(zn)));break;case"set":Gt(t)&&o(h.get(Ft));break}}ir()}function Dt(t){const n=ae(t);return n===t?n:(Ee(n,"iterate",vi),qe(t)?n:n.map(Ie))}function sr(t){return Ee(t=ae(t),"iterate",vi),t}const Ga={__proto__:null,[Symbol.iterator](){return bn(this,Symbol.iterator,Ie)},concat(...t){return Dt(this).concat(...t.map(n=>Q(n)?Dt(n):n))},entries(){return bn(this,"entries",t=>(t[1]=Ie(t[1]),t))},every(t,n){return at(this,"every",t,n,void 0,arguments)},filter(t,n){return at(this,"filter",t,n,a=>a.map(Ie),arguments)},find(t,n){return at(this,"find",t,n,Ie,arguments)},findIndex(t,n){return at(this,"findIndex",t,n,void 0,arguments)},findLast(t,n){return at(this,"findLast",t,n,Ie,arguments)},findLastIndex(t,n){return at(this,"findLastIndex",t,n,void 0,arguments)},forEach(t,n){return at(this,"forEach",t,n,void 0,arguments)},includes(...t){return An(this,"includes",t)},indexOf(...t){return An(this,"indexOf",t)},join(t){return Dt(this).join(t)},lastIndexOf(...t){return An(this,"lastIndexOf",t)},map(t,n){return at(this,"map",t,n,void 0,arguments)},pop(){return ni(this,"pop")},push(...t){return ni(this,"push",t)},reduce(t,...n){return zr(this,"reduce",t,n)},reduceRight(t,...n){return zr(this,"reduceRight",t,n)},shift(){return ni(this,"shift")},some(t,n){return at(this,"some",t,n,void 0,arguments)},splice(...t){return ni(this,"splice",t)},toReversed(){return Dt(this).toReversed()},toSorted(t){return Dt(this).toSorted(t)},toSpliced(...t){return Dt(this).toSpliced(...t)},unshift(...t){return ni(this,"unshift",t)},values(){return bn(this,"values",Ie)}};function bn(t,n,a){const l=sr(t),f=l[n]();return l!==t&&!qe(t)&&(f._next=f.next,f.next=()=>{const u=f._next();return u.value&&(u.value=a(u.value)),u}),f}const ja=Array.prototype;function at(t,n,a,l,f,u){const h=sr(t),o=h!==t&&!qe(t),p=h[n];if(p!==ja[n]){const v=p.apply(t,u);return o?Ie(v):v}let g=a;h!==t&&(o?g=function(v,S){return a.call(this,Ie(v),S,t)}:a.length>2&&(g=function(v,S){return a.call(this,v,S,t)}));const y=p.call(h,g,l);return o&&f?f(y):y}function zr(t,n,a,l){const f=sr(t);let u=a;return f!==t&&(qe(t)?a.length>3&&(u=function(h,o,p){return a.call(this,h,o,p,t)}):u=function(h,o,p){return a.call(this,h,Ie(o),p,t)}),f[n](u,...l)}function An(t,n,a){const l=ae(t);Ee(l,"iterate",vi);const f=l[n](...a);return(f===-1||f===!1)&&lr(a[0])?(a[0]=ae(a[0]),l[n](...a)):f}function ni(t,n,a=[]){St(),tr();const l=ae(t)[n].apply(t,a);return ir(),Ut(),l}const Ya=Wn("__proto__,__v_isRef,__isVue"),qs=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(st));function Ka(t){st(t)||(t=String(t));const n=ae(this);return Ee(n,"has",t),n.hasOwnProperty(t)}class $s{constructor(n=!1,a=!1){this._isReadonly=n,this._isShallow=a}get(n,a,l){if(a==="__v_skip")return n.__v_skip;const f=this._isReadonly,u=this._isShallow;if(a==="__v_isReactive")return!f;if(a==="__v_isReadonly")return f;if(a==="__v_isShallow")return u;if(a==="__v_raw")return l===(f?u?il:Js:u?Zs:Xs).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(l)?n:void 0;const h=Q(n);if(!f){let p;if(h&&(p=Ga[a]))return p;if(a==="hasOwnProperty")return Ka}const o=Reflect.get(n,a,Be(n)?n:l);return(st(a)?qs.has(a):Ya(a))||(f||Ee(n,"get",a),u)?o:Be(o)?h&&Jn(a)?o:o.value:_e(o)?f?eo(o):on(o):o}}class Ws extends $s{constructor(n=!1){super(!1,n)}set(n,a,l,f){let u=n[a];if(!this._isShallow){const p=kt(u);if(!qe(l)&&!kt(l)&&(u=ae(u),l=ae(l)),!Q(n)&&Be(u)&&!Be(l))return p?!1:(u.value=l,!0)}const h=Q(n)&&Jn(a)?Number(a)<n.length:le(n,a),o=Reflect.set(n,a,l,Be(n)?n:f);return n===ae(f)&&(h?xt(l,u)&&ut(n,"set",a,l):ut(n,"add",a,l)),o}deleteProperty(n,a){const l=le(n,a);n[a];const f=Reflect.deleteProperty(n,a);return f&&l&&ut(n,"delete",a,void 0),f}has(n,a){const l=Reflect.has(n,a);return(!st(a)||!qs.has(a))&&Ee(n,"has",a),l}ownKeys(n){return Ee(n,"iterate",Q(n)?"length":Ft),Reflect.ownKeys(n)}}class qa extends $s{constructor(n=!1){super(!0,n)}set(n,a){return!0}deleteProperty(n,a){return!0}}const $a=new Ws,Wa=new qa,Xa=new Ws(!0);const Mn=t=>t,Li=t=>Reflect.getPrototypeOf(t);function Za(t,n,a){return function(...l){const f=this.__v_raw,u=ae(f),h=Gt(u),o=t==="entries"||t===Symbol.iterator&&h,p=t==="keys"&&h,g=f[t](...l),y=a?Mn:n?Dn:Ie;return!n&&Ee(u,"iterate",p?zn:Ft),{next(){const{value:v,done:S}=g.next();return S?{value:v,done:S}:{value:o?[y(v[0]),y(v[1])]:y(v),done:S}},[Symbol.iterator](){return this}}}}function ki(t){return function(...n){return t==="delete"?!1:t==="clear"?void 0:this}}function Ja(t,n){const a={get(f){const u=this.__v_raw,h=ae(u),o=ae(f);t||(xt(f,o)&&Ee(h,"get",f),Ee(h,"get",o));const{has:p}=Li(h),g=n?Mn:t?Dn:Ie;if(p.call(h,f))return g(u.get(f));if(p.call(h,o))return g(u.get(o));u!==h&&u.get(f)},get size(){const f=this.__v_raw;return!t&&Ee(ae(f),"iterate",Ft),Reflect.get(f,"size",f)},has(f){const u=this.__v_raw,h=ae(u),o=ae(f);return t||(xt(f,o)&&Ee(h,"has",f),Ee(h,"has",o)),f===o?u.has(f):u.has(f)||u.has(o)},forEach(f,u){const h=this,o=h.__v_raw,p=ae(o),g=n?Mn:t?Dn:Ie;return!t&&Ee(p,"iterate",Ft),o.forEach((y,v)=>f.call(u,g(y),g(v),h))}};return Te(a,t?{add:ki("add"),set:ki("set"),delete:ki("delete"),clear:ki("clear")}:{add(f){!n&&!qe(f)&&!kt(f)&&(f=ae(f));const u=ae(this);return Li(u).has.call(u,f)||(u.add(f),ut(u,"add",f,f)),this},set(f,u){!n&&!qe(u)&&!kt(u)&&(u=ae(u));const h=ae(this),{has:o,get:p}=Li(h);let g=o.call(h,f);g||(f=ae(f),g=o.call(h,f));const y=p.call(h,f);return h.set(f,u),g?xt(u,y)&&ut(h,"set",f,u):ut(h,"add",f,u),this},delete(f){const u=ae(this),{has:h,get:o}=Li(u);let p=h.call(u,f);p||(f=ae(f),p=h.call(u,f)),o&&o.call(u,f);const g=u.delete(f);return p&&ut(u,"delete",f,void 0),g},clear(){const f=ae(this),u=f.size!==0,h=f.clear();return u&&ut(f,"clear",void 0,void 0),h}}),["keys","values","entries",Symbol.iterator].forEach(f=>{a[f]=Za(f,t,n)}),a}function or(t,n){const a=Ja(t,n);return(l,f,u)=>f==="__v_isReactive"?!t:f==="__v_isReadonly"?t:f==="__v_raw"?l:Reflect.get(le(a,f)&&f in l?a:l,f,u)}const Qa={get:or(!1,!1)},el={get:or(!1,!0)},tl={get:or(!0,!1)};const Xs=new WeakMap,Zs=new WeakMap,Js=new WeakMap,il=new WeakMap;function nl(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function rl(t){return t.__v_skip||!Object.isExtensible(t)?0:nl(Ba(t))}function on(t){return kt(t)?t:ar(t,!1,$a,Qa,Xs)}function Qs(t){return ar(t,!1,Xa,el,Zs)}function eo(t){return ar(t,!0,Wa,tl,Js)}function ar(t,n,a,l,f){if(!_e(t)||t.__v_raw&&!(n&&t.__v_isReactive))return t;const u=f.get(t);if(u)return u;const h=rl(t);if(h===0)return t;const o=new Proxy(t,h===2?l:a);return f.set(t,o),o}function ui(t){return kt(t)?ui(t.__v_raw):!!(t&&t.__v_isReactive)}function kt(t){return!!(t&&t.__v_isReadonly)}function qe(t){return!!(t&&t.__v_isShallow)}function lr(t){return t?!!t.__v_raw:!1}function ae(t){const n=t&&t.__v_raw;return n?ae(n):t}function sl(t){return!le(t,"__v_skip")&&Object.isExtensible(t)&&Rs(t,"__v_skip",!0),t}const Ie=t=>_e(t)?on(t):t,Dn=t=>_e(t)?eo(t):t;function Be(t){return t?t.__v_isRef===!0:!1}function ol(t){return to(t,!1)}function al(t){return to(t,!0)}function to(t,n){return Be(t)?t:new ll(t,n)}class ll{constructor(n,a){this.dep=new rr,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=a?n:ae(n),this._value=a?n:Ie(n),this.__v_isShallow=a}get value(){return this.dep.track(),this._value}set value(n){const a=this._rawValue,l=this.__v_isShallow||qe(n)||kt(n);n=l?n:ae(n),xt(n,a)&&(this._rawValue=n,this._value=l?n:Ie(n),this.dep.trigger())}}function jt(t){return Be(t)?t.value:t}const fl={get:(t,n,a)=>n==="__v_raw"?t:jt(Reflect.get(t,n,a)),set:(t,n,a,l)=>{const f=t[n];return Be(f)&&!Be(a)?(f.value=a,!0):Reflect.set(t,n,a,l)}};function io(t){return ui(t)?t:new Proxy(t,fl)}class cl{constructor(n,a,l){this.fn=n,this.setter=a,this._value=void 0,this.dep=new rr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=mi-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!a,this.isSSR=l}notify(){if(this.flags|=16,!(this.flags&8)&&pe!==this)return Hs(this,!0),!0}get value(){const n=this.dep.track();return js(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function ul(t,n,a=!1){let l,f;return ie(t)?l=t:(l=t.get,f=t.set),new cl(l,f,a)}const Ri={},ji=new WeakMap;let Pt;function hl(t,n=!1,a=Pt){if(a){let l=ji.get(a);l||ji.set(a,l=[]),l.push(t)}}function dl(t,n,a=he){const{immediate:l,deep:f,once:u,scheduler:h,augmentJob:o,call:p}=a,g=d=>f?d:qe(d)||f===!1||f===0?ht(d,1):ht(d);let y,v,S,U,b=!1,z=!1;if(Be(t)?(v=()=>t.value,b=qe(t)):ui(t)?(v=()=>g(t),b=!0):Q(t)?(z=!0,b=t.some(d=>ui(d)||qe(d)),v=()=>t.map(d=>{if(Be(d))return d.value;if(ui(d))return g(d);if(ie(d))return p?p(d,2):d()})):ie(t)?n?v=p?()=>p(t,2):t:v=()=>{if(S){St();try{S()}finally{Ut()}}const d=Pt;Pt=y;try{return p?p(t,3,[U]):t(U)}finally{Pt=d}}:v=rt,n&&f){const d=v,_=f===!0?1/0:f;v=()=>ht(d(),_)}const e=Na(),r=()=>{y.stop(),e&&e.active&&Zn(e.effects,y)};if(u&&n){const d=n;n=(..._)=>{d(..._),r()}}let s=z?new Array(t.length).fill(Ri):Ri;const c=d=>{if(!(!(y.flags&1)||!y.dirty&&!d))if(n){const _=y.run();if(f||b||(z?_.some((m,A)=>xt(m,s[A])):xt(_,s))){S&&S();const m=Pt;Pt=y;try{const A=[_,s===Ri?void 0:z&&s[0]===Ri?[]:s,U];p?p(n,3,A):n(...A),s=_}finally{Pt=m}}}else y.run()};return o&&o(c),y=new Os(v),y.scheduler=h?()=>h(c,!1):c,U=d=>hl(d,!1,y),S=y.onStop=()=>{const d=ji.get(y);if(d){if(p)p(d,4);else for(const _ of d)_();ji.delete(y)}},n?l?c(!0):s=y.run():h?h(c.bind(null,!0),!0):y.run(),r.pause=y.pause.bind(y),r.resume=y.resume.bind(y),r.stop=r,r}function ht(t,n=1/0,a){if(n<=0||!_e(t)||t.__v_skip||(a=a||new Set,a.has(t)))return t;if(a.add(t),n--,Be(t))ht(t.value,n,a);else if(Q(t))for(let l=0;l<t.length;l++)ht(t[l],n,a);else if(tn(t)||Gt(t))t.forEach(l=>{ht(l,n,a)});else if(ks(t)){for(const l in t)ht(t[l],n,a);for(const l of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,l)&&ht(t[l],n,a)}return t}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Ii(t,n,a,l){try{return l?t(...l):t()}catch(f){an(f,n,a)}}function ot(t,n,a,l){if(ie(t)){const f=Ii(t,n,a,l);return f&&Fs(f)&&f.catch(u=>{an(u,n,a)}),f}if(Q(t)){const f=[];for(let u=0;u<t.length;u++)f.push(ot(t[u],n,a,l));return f}}function an(t,n,a,l=!0){const f=n?n.vnode:null,{errorHandler:u,throwUnhandledErrorInProduction:h}=n&&n.appContext.config||he;if(n){let o=n.parent;const p=n.proxy,g=`https://vuejs.org/error-reference/#runtime-${a}`;for(;o;){const y=o.ec;if(y){for(let v=0;v<y.length;v++)if(y[v](t,p,g)===!1)return}o=o.parent}if(u){St(),Ii(u,null,10,[t,p,g]),Ut();return}}pl(t,a,f,l,h)}function pl(t,n,a,l=!0,f=!1){if(f)throw t;console.error(t)}const Fe=[];let tt=-1;const Yt=[];let yt=null,Ot=0;const no=Promise.resolve();let Yi=null;function fr(t){const n=Yi||no;return t?n.then(this?t.bind(this):t):n}function _l(t){let n=tt+1,a=Fe.length;for(;n<a;){const l=n+a>>>1,f=Fe[l],u=wi(f);u<t||u===t&&f.flags&2?n=l+1:a=l}return n}function cr(t){if(!(t.flags&1)){const n=wi(t),a=Fe[Fe.length-1];!a||!(t.flags&2)&&n>=wi(a)?Fe.push(t):Fe.splice(_l(n),0,t),t.flags|=1,ro()}}function ro(){Yi||(Yi=no.then(oo))}function gl(t){Q(t)?Yt.push(...t):yt&&t.id===-1?yt.splice(Ot+1,0,t):t.flags&1||(Yt.push(t),t.flags|=1),ro()}function Mr(t,n,a=tt+1){for(;a<Fe.length;a++){const l=Fe[a];if(l&&l.flags&2){if(t&&l.id!==t.uid)continue;Fe.splice(a,1),a--,l.flags&4&&(l.flags&=-2),l(),l.flags&4||(l.flags&=-2)}}}function so(t){if(Yt.length){const n=[...new Set(Yt)].sort((a,l)=>wi(a)-wi(l));if(Yt.length=0,yt){yt.push(...n);return}for(yt=n,Ot=0;Ot<yt.length;Ot++){const a=yt[Ot];a.flags&4&&(a.flags&=-2),a.flags&8||a(),a.flags&=-2}yt=null,Ot=0}}const wi=t=>t.id==null?t.flags&2?-1:1/0:t.id;function oo(t){try{for(tt=0;tt<Fe.length;tt++){const n=Fe[tt];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),Ii(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;tt<Fe.length;tt++){const n=Fe[tt];n&&(n.flags&=-2)}tt=-1,Fe.length=0,so(),Yi=null,(Fe.length||Yt.length)&&oo()}}let Ne=null,ao=null;function Ki(t){const n=Ne;return Ne=t,ao=t&&t.type.__scopeId||null,n}function Nt(t,n=Ne,a){if(!n||t._n)return t;const l=(...f)=>{l._d&&$r(-1);const u=Ki(n);let h;try{h=t(...f)}finally{Ki(u),l._d&&$r(1)}return h};return l._n=!0,l._c=!0,l._d=!0,l}function ve(t,n){if(Ne===null)return t;const a=un(Ne),l=t.dirs||(t.dirs=[]);for(let f=0;f<n.length;f++){let[u,h,o,p=he]=n[f];u&&(ie(u)&&(u={mounted:u,updated:u}),u.deep&&ht(h),l.push({dir:u,instance:a,value:h,oldValue:void 0,arg:o,modifiers:p}))}return t}function Ct(t,n,a,l){const f=t.dirs,u=n&&n.dirs;for(let h=0;h<f.length;h++){const o=f[h];u&&(o.oldValue=u[h].value);let p=o.dir[l];p&&(St(),ot(p,a,8,[t.el,o,t,n]),Ut())}}const yl=Symbol("_vte"),ml=t=>t.__isTeleport;function ur(t,n){t.shapeFlag&6&&t.component?(t.transition=n,ur(t.component.subTree,n)):t.shapeFlag&128?(t.ssContent.transition=n.clone(t.ssContent),t.ssFallback.transition=n.clone(t.ssFallback)):t.transition=n}/*! #__NO_SIDE_EFFECTS__ */function lo(t,n){return ie(t)?Te({name:t.name},n,{setup:t}):t}function fo(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function qi(t,n,a,l,f=!1){if(Q(t)){t.forEach((b,z)=>qi(b,n&&(Q(n)?n[z]:n),a,l,f));return}if(hi(l)&&!f){l.shapeFlag&512&&l.type.__asyncResolved&&l.component.subTree.component&&qi(t,n,a,l.component.subTree);return}const u=l.shapeFlag&4?un(l.component):l.el,h=f?null:u,{i:o,r:p}=t,g=n&&n.r,y=o.refs===he?o.refs={}:o.refs,v=o.setupState,S=ae(v),U=v===he?()=>!1:b=>le(S,b);if(g!=null&&g!==p&&(we(g)?(y[g]=null,U(g)&&(v[g]=null)):Be(g)&&(g.value=null)),ie(p))Ii(p,o,12,[h,y]);else{const b=we(p),z=Be(p);if(b||z){const e=()=>{if(t.f){const r=b?U(p)?v[p]:y[p]:p.value;f?Q(r)&&Zn(r,u):Q(r)?r.includes(u)||r.push(u):b?(y[p]=[u],U(p)&&(v[p]=y[p])):(p.value=[u],t.k&&(y[t.k]=p.value))}else b?(y[p]=h,U(p)&&(v[p]=h)):z&&(p.value=h,t.k&&(y[t.k]=h))};h?(e.id=-1,Me(e,a)):e()}}}sn().requestIdleCallback;sn().cancelIdleCallback;const hi=t=>!!t.type.__asyncLoader,co=t=>t.type.__isKeepAlive;function vl(t,n){uo(t,"a",n)}function wl(t,n){uo(t,"da",n)}function uo(t,n,a=Ce){const l=t.__wdc||(t.__wdc=()=>{let f=a;for(;f;){if(f.isDeactivated)return;f=f.parent}return t()});if(ln(n,l,a),a){let f=a.parent;for(;f&&f.parent;)co(f.parent.vnode)&&xl(l,n,a,f),f=f.parent}}function xl(t,n,a,l){const f=ln(n,t,l,!0);ho(()=>{Zn(l[n],f)},a)}function ln(t,n,a=Ce,l=!1){if(a){const f=a[t]||(a[t]=[]),u=n.__weh||(n.__weh=(...h)=>{St();const o=Fi(a),p=ot(n,a,t,h);return o(),Ut(),p});return l?f.unshift(u):f.push(u),u}}const _t=t=>(n,a=Ce)=>{(!bi||t==="sp")&&ln(t,(...l)=>n(...l),a)},bl=_t("bm"),Al=_t("m"),Sl=_t("bu"),Ul=_t("u"),El=_t("bum"),ho=_t("um"),Cl=_t("sp"),Bl=_t("rtg"),Tl=_t("rtc");function Pl(t,n=Ce){ln("ec",t,n)}const Il="components";function Dr(t,n){return Ll(Il,t,!0,n)||t}const Fl=Symbol.for("v-ndc");function Ll(t,n,a=!0,l=!1){const f=Ne||Ce;if(f){const u=f.type;{const o=xf(u,!1);if(o&&(o===n||o===je(n)||o===rn(je(n))))return u}const h=Or(f[t]||u[t],n)||Or(f.appContext[t],n);return!h&&l?u:h}}function Or(t,n){return t&&(t[n]||t[je(n)]||t[rn(je(n))])}const On=t=>t?ko(t)?un(t):On(t.parent):null,di=Te(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>On(t.parent),$root:t=>On(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>_o(t),$forceUpdate:t=>t.f||(t.f=()=>{cr(t.update)}),$nextTick:t=>t.n||(t.n=fr.bind(t.proxy)),$watch:t=>ef.bind(t)}),Sn=(t,n)=>t!==he&&!t.__isScriptSetup&&le(t,n),kl={get({_:t},n){if(n==="__v_skip")return!0;const{ctx:a,setupState:l,data:f,props:u,accessCache:h,type:o,appContext:p}=t;let g;if(n[0]!=="$"){const U=h[n];if(U!==void 0)switch(U){case 1:return l[n];case 2:return f[n];case 4:return a[n];case 3:return u[n]}else{if(Sn(l,n))return h[n]=1,l[n];if(f!==he&&le(f,n))return h[n]=2,f[n];if((g=t.propsOptions[0])&&le(g,n))return h[n]=3,u[n];if(a!==he&&le(a,n))return h[n]=4,a[n];Nn&&(h[n]=0)}}const y=di[n];let v,S;if(y)return n==="$attrs"&&Ee(t.attrs,"get",""),y(t);if((v=o.__cssModules)&&(v=v[n]))return v;if(a!==he&&le(a,n))return h[n]=4,a[n];if(S=p.config.globalProperties,le(S,n))return S[n]},set({_:t},n,a){const{data:l,setupState:f,ctx:u}=t;return Sn(f,n)?(f[n]=a,!0):l!==he&&le(l,n)?(l[n]=a,!0):le(t.props,n)||n[0]==="$"&&n.slice(1)in t?!1:(u[n]=a,!0)},has({_:{data:t,setupState:n,accessCache:a,ctx:l,appContext:f,propsOptions:u}},h){let o;return!!a[h]||t!==he&&le(t,h)||Sn(n,h)||(o=u[0])&&le(o,h)||le(l,h)||le(di,h)||le(f.config.globalProperties,h)},defineProperty(t,n,a){return a.get!=null?t._.accessCache[n]=0:le(a,"value")&&this.set(t,n,a.value,null),Reflect.defineProperty(t,n,a)}};function Nr(t){return Q(t)?t.reduce((n,a)=>(n[a]=null,n),{}):t}let Nn=!0;function Rl(t){const n=_o(t),a=t.proxy,l=t.ctx;Nn=!1,n.beforeCreate&&Hr(n.beforeCreate,t,"bc");const{data:f,computed:u,methods:h,watch:o,provide:p,inject:g,created:y,beforeMount:v,mounted:S,beforeUpdate:U,updated:b,activated:z,deactivated:e,beforeDestroy:r,beforeUnmount:s,destroyed:c,unmounted:d,render:_,renderTracked:m,renderTriggered:A,errorCaptured:B,serverPrefetch:T,expose:C,inheritAttrs:P,components:L,directives:R,filters:X}=n;if(g&&zl(g,l,null),h)for(const O in h){const H=h[O];ie(H)&&(l[O]=H.bind(a))}if(f){const O=f.call(a,a);_e(O)&&(t.data=on(O))}if(Nn=!0,u)for(const O in u){const H=u[O],ne=ie(H)?H.bind(a,a):ie(H.get)?H.get.bind(a,a):rt,ce=!ie(H)&&ie(H.set)?H.set.bind(a):rt,ye=Ye({get:ne,set:ce});Object.defineProperty(l,O,{enumerable:!0,configurable:!0,get:()=>ye.value,set:ge=>ye.value=ge})}if(o)for(const O in o)po(o[O],l,a,O);if(p){const O=ie(p)?p.call(a):p;Reflect.ownKeys(O).forEach(H=>{Di(H,O[H])})}y&&Hr(y,t,"c");function re(O,H){Q(H)?H.forEach(ne=>O(ne.bind(a))):H&&O(H.bind(a))}if(re(bl,v),re(Al,S),re(Sl,U),re(Ul,b),re(vl,z),re(wl,e),re(Pl,B),re(Tl,m),re(Bl,A),re(El,s),re(ho,d),re(Cl,T),Q(C))if(C.length){const O=t.exposed||(t.exposed={});C.forEach(H=>{Object.defineProperty(O,H,{get:()=>a[H],set:ne=>a[H]=ne})})}else t.exposed||(t.exposed={});_&&t.render===rt&&(t.render=_),P!=null&&(t.inheritAttrs=P),L&&(t.components=L),R&&(t.directives=R),T&&fo(t)}function zl(t,n,a=rt){Q(t)&&(t=Hn(t));for(const l in t){const f=t[l];let u;_e(f)?"default"in f?u=dt(f.from||l,f.default,!0):u=dt(f.from||l):u=dt(f),Be(u)?Object.defineProperty(n,l,{enumerable:!0,configurable:!0,get:()=>u.value,set:h=>u.value=h}):n[l]=u}}function Hr(t,n,a){ot(Q(t)?t.map(l=>l.bind(n.proxy)):t.bind(n.proxy),n,a)}function po(t,n,a,l){let f=l.includes(".")?To(a,l):()=>a[l];if(we(t)){const u=n[t];ie(u)&&Oi(f,u)}else if(ie(t))Oi(f,t.bind(a));else if(_e(t))if(Q(t))t.forEach(u=>po(u,n,a,l));else{const u=ie(t.handler)?t.handler.bind(a):n[t.handler];ie(u)&&Oi(f,u,t)}}function _o(t){const n=t.type,{mixins:a,extends:l}=n,{mixins:f,optionsCache:u,config:{optionMergeStrategies:h}}=t.appContext,o=u.get(n);let p;return o?p=o:!f.length&&!a&&!l?p=n:(p={},f.length&&f.forEach(g=>$i(p,g,h,!0)),$i(p,n,h)),_e(n)&&u.set(n,p),p}function $i(t,n,a,l=!1){const{mixins:f,extends:u}=n;u&&$i(t,u,a,!0),f&&f.forEach(h=>$i(t,h,a,!0));for(const h in n)if(!(l&&h==="expose")){const o=Ml[h]||a&&a[h];t[h]=o?o(t[h],n[h]):n[h]}return t}const Ml={data:Vr,props:Gr,emits:Gr,methods:ai,computed:ai,beforeCreate:Pe,created:Pe,beforeMount:Pe,mounted:Pe,beforeUpdate:Pe,updated:Pe,beforeDestroy:Pe,beforeUnmount:Pe,destroyed:Pe,unmounted:Pe,activated:Pe,deactivated:Pe,errorCaptured:Pe,serverPrefetch:Pe,components:ai,directives:ai,watch:Ol,provide:Vr,inject:Dl};function Vr(t,n){return n?t?function(){return Te(ie(t)?t.call(this,this):t,ie(n)?n.call(this,this):n)}:n:t}function Dl(t,n){return ai(Hn(t),Hn(n))}function Hn(t){if(Q(t)){const n={};for(let a=0;a<t.length;a++)n[t[a]]=t[a];return n}return t}function Pe(t,n){return t?[...new Set([].concat(t,n))]:n}function ai(t,n){return t?Te(Object.create(null),t,n):n}function Gr(t,n){return t?Q(t)&&Q(n)?[...new Set([...t,...n])]:Te(Object.create(null),Nr(t),Nr(n??{})):n}function Ol(t,n){if(!t)return n;if(!n)return t;const a=Te(Object.create(null),t);for(const l in n)a[l]=Pe(t[l],n[l]);return a}function go(){return{app:null,config:{isNativeTag:Ea,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Nl=0;function Hl(t,n){return function(l,f=null){ie(l)||(l=Te({},l)),f!=null&&!_e(f)&&(f=null);const u=go(),h=new WeakSet,o=[];let p=!1;const g=u.app={_uid:Nl++,_component:l,_props:f,_container:null,_context:u,_instance:null,version:Af,get config(){return u.config},set config(y){},use(y,...v){return h.has(y)||(y&&ie(y.install)?(h.add(y),y.install(g,...v)):ie(y)&&(h.add(y),y(g,...v))),g},mixin(y){return u.mixins.includes(y)||u.mixins.push(y),g},component(y,v){return v?(u.components[y]=v,g):u.components[y]},directive(y,v){return v?(u.directives[y]=v,g):u.directives[y]},mount(y,v,S){if(!p){const U=g._ceVNode||me(l,f);return U.appContext=u,S===!0?S="svg":S===!1&&(S=void 0),t(U,y,S),p=!0,g._container=y,y.__vue_app__=g,un(U.component)}},onUnmount(y){o.push(y)},unmount(){p&&(ot(o,g._instance,16),t(null,g._container),delete g._container.__vue_app__)},provide(y,v){return u.provides[y]=v,g},runWithContext(y){const v=Kt;Kt=g;try{return y()}finally{Kt=v}}};return g}}let Kt=null;function Di(t,n){if(Ce){let a=Ce.provides;const l=Ce.parent&&Ce.parent.provides;l===a&&(a=Ce.provides=Object.create(l)),a[t]=n}}function dt(t,n,a=!1){const l=Ce||Ne;if(l||Kt){const f=Kt?Kt._context.provides:l?l.parent==null?l.vnode.appContext&&l.vnode.appContext.provides:l.parent.provides:void 0;if(f&&t in f)return f[t];if(arguments.length>1)return a&&ie(n)?n.call(l&&l.proxy):n}}const yo={},mo=()=>Object.create(yo),vo=t=>Object.getPrototypeOf(t)===yo;function Vl(t,n,a,l=!1){const f={},u=mo();t.propsDefaults=Object.create(null),wo(t,n,f,u);for(const h in t.propsOptions[0])h in f||(f[h]=void 0);a?t.props=l?f:Qs(f):t.type.props?t.props=f:t.props=u,t.attrs=u}function Gl(t,n,a,l){const{props:f,attrs:u,vnode:{patchFlag:h}}=t,o=ae(f),[p]=t.propsOptions;let g=!1;if((l||h>0)&&!(h&16)){if(h&8){const y=t.vnode.dynamicProps;for(let v=0;v<y.length;v++){let S=y[v];if(fn(t.emitsOptions,S))continue;const U=n[S];if(p)if(le(u,S))U!==u[S]&&(u[S]=U,g=!0);else{const b=je(S);f[b]=Vn(p,o,b,U,t,!1)}else U!==u[S]&&(u[S]=U,g=!0)}}}else{wo(t,n,f,u)&&(g=!0);let y;for(const v in o)(!n||!le(n,v)&&((y=zt(v))===v||!le(n,y)))&&(p?a&&(a[v]!==void 0||a[y]!==void 0)&&(f[v]=Vn(p,o,v,void 0,t,!0)):delete f[v]);if(u!==o)for(const v in u)(!n||!le(n,v))&&(delete u[v],g=!0)}g&&ut(t.attrs,"set","")}function wo(t,n,a,l){const[f,u]=t.propsOptions;let h=!1,o;if(n)for(let p in n){if(li(p))continue;const g=n[p];let y;f&&le(f,y=je(p))?!u||!u.includes(y)?a[y]=g:(o||(o={}))[y]=g:fn(t.emitsOptions,p)||(!(p in l)||g!==l[p])&&(l[p]=g,h=!0)}if(u){const p=ae(a),g=o||he;for(let y=0;y<u.length;y++){const v=u[y];a[v]=Vn(f,p,v,g[v],t,!le(g,v))}}return h}function Vn(t,n,a,l,f,u){const h=t[a];if(h!=null){const o=le(h,"default");if(o&&l===void 0){const p=h.default;if(h.type!==Function&&!h.skipFactory&&ie(p)){const{propsDefaults:g}=f;if(a in g)l=g[a];else{const y=Fi(f);l=g[a]=p.call(null,n),y()}}else l=p;f.ce&&f.ce._setProp(a,l)}h[0]&&(u&&!o?l=!1:h[1]&&(l===""||l===zt(a))&&(l=!0))}return l}const jl=new WeakMap;function xo(t,n,a=!1){const l=a?jl:n.propsCache,f=l.get(t);if(f)return f;const u=t.props,h={},o=[];let p=!1;if(!ie(t)){const y=v=>{p=!0;const[S,U]=xo(v,n,!0);Te(h,S),U&&o.push(...U)};!a&&n.mixins.length&&n.mixins.forEach(y),t.extends&&y(t.extends),t.mixins&&t.mixins.forEach(y)}if(!u&&!p)return _e(t)&&l.set(t,Vt),Vt;if(Q(u))for(let y=0;y<u.length;y++){const v=je(u[y]);jr(v)&&(h[v]=he)}else if(u)for(const y in u){const v=je(y);if(jr(v)){const S=u[y],U=h[v]=Q(S)||ie(S)?{type:S}:Te({},S),b=U.type;let z=!1,e=!0;if(Q(b))for(let r=0;r<b.length;++r){const s=b[r],c=ie(s)&&s.name;if(c==="Boolean"){z=!0;break}else c==="String"&&(e=!1)}else z=ie(b)&&b.name==="Boolean";U[0]=z,U[1]=e,(z||le(U,"default"))&&o.push(v)}}const g=[h,o];return _e(t)&&l.set(t,g),g}function jr(t){return t[0]!=="$"&&!li(t)}const bo=t=>t[0]==="_"||t==="$stable",hr=t=>Q(t)?t.map(it):[it(t)],Yl=(t,n,a)=>{if(n._n)return n;const l=Nt((...f)=>hr(n(...f)),a);return l._c=!1,l},Ao=(t,n,a)=>{const l=t._ctx;for(const f in t){if(bo(f))continue;const u=t[f];if(ie(u))n[f]=Yl(f,u,l);else if(u!=null){const h=hr(u);n[f]=()=>h}}},So=(t,n)=>{const a=hr(n);t.slots.default=()=>a},Uo=(t,n,a)=>{for(const l in n)(a||l!=="_")&&(t[l]=n[l])},Kl=(t,n,a)=>{const l=t.slots=mo();if(t.vnode.shapeFlag&32){const f=n._;f?(Uo(l,n,a),a&&Rs(l,"_",f,!0)):Ao(n,l)}else n&&So(t,n)},ql=(t,n,a)=>{const{vnode:l,slots:f}=t;let u=!0,h=he;if(l.shapeFlag&32){const o=n._;o?a&&o===1?u=!1:Uo(f,n,a):(u=!n.$stable,Ao(n,f)),h=n}else n&&(So(t,n),h={default:1});if(u)for(const o in f)!bo(o)&&h[o]==null&&delete f[o]},Me=lf;function $l(t){return Wl(t)}function Wl(t,n){const a=sn();a.__VUE__=!0;const{insert:l,remove:f,patchProp:u,createElement:h,createText:o,createComment:p,setText:g,setElementText:y,parentNode:v,nextSibling:S,setScopeId:U=rt,insertStaticContent:b}=t,z=(w,x,E,F=null,M=null,k=null,Y=void 0,V=null,N=!!x.dynamicChildren)=>{if(w===x)return;w&&!ri(w,x)&&(F=I(w),ge(w,M,k,!0),w=null),x.patchFlag===-2&&(N=!1,x.dynamicChildren=null);const{type:D,ref:J,shapeFlag:K}=x;switch(D){case cn:e(w,x,E,F);break;case Rt:r(w,x,E,F);break;case Ni:w==null&&s(x,E,F,Y);break;case ct:L(w,x,E,F,M,k,Y,V,N);break;default:K&1?_(w,x,E,F,M,k,Y,V,N):K&6?R(w,x,E,F,M,k,Y,V,N):(K&64||K&128)&&D.process(w,x,E,F,M,k,Y,V,N,$)}J!=null&&M&&qi(J,w&&w.ref,k,x||w,!x)},e=(w,x,E,F)=>{if(w==null)l(x.el=o(x.children),E,F);else{const M=x.el=w.el;x.children!==w.children&&g(M,x.children)}},r=(w,x,E,F)=>{w==null?l(x.el=p(x.children||""),E,F):x.el=w.el},s=(w,x,E,F)=>{[w.el,w.anchor]=b(w.children,x,E,F,w.el,w.anchor)},c=({el:w,anchor:x},E,F)=>{let M;for(;w&&w!==x;)M=S(w),l(w,E,F),w=M;l(x,E,F)},d=({el:w,anchor:x})=>{let E;for(;w&&w!==x;)E=S(w),f(w),w=E;f(x)},_=(w,x,E,F,M,k,Y,V,N)=>{x.type==="svg"?Y="svg":x.type==="math"&&(Y="mathml"),w==null?m(x,E,F,M,k,Y,V,N):T(w,x,M,k,Y,V,N)},m=(w,x,E,F,M,k,Y,V)=>{let N,D;const{props:J,shapeFlag:K,transition:Z,dirs:te}=w;if(N=w.el=h(w.type,k,J&&J.is,J),K&8?y(N,w.children):K&16&&B(w.children,N,null,F,M,Un(w,k),Y,V),te&&Ct(w,null,F,"created"),A(N,w,w.scopeId,Y,F),J){for(const de in J)de!=="value"&&!li(de)&&u(N,de,null,J[de],k,F);"value"in J&&u(N,"value",null,J.value,k),(D=J.onVnodeBeforeMount)&&et(D,F,w)}te&&Ct(w,null,F,"beforeMount");const se=Xl(M,Z);se&&Z.beforeEnter(N),l(N,x,E),((D=J&&J.onVnodeMounted)||se||te)&&Me(()=>{D&&et(D,F,w),se&&Z.enter(N),te&&Ct(w,null,F,"mounted")},M)},A=(w,x,E,F,M)=>{if(E&&U(w,E),F)for(let k=0;k<F.length;k++)U(w,F[k]);if(M){let k=M.subTree;if(x===k||Io(k.type)&&(k.ssContent===x||k.ssFallback===x)){const Y=M.vnode;A(w,Y,Y.scopeId,Y.slotScopeIds,M.parent)}}},B=(w,x,E,F,M,k,Y,V,N=0)=>{for(let D=N;D<w.length;D++){const J=w[D]=V?mt(w[D]):it(w[D]);z(null,J,x,E,F,M,k,Y,V)}},T=(w,x,E,F,M,k,Y)=>{const V=x.el=w.el;let{patchFlag:N,dynamicChildren:D,dirs:J}=x;N|=w.patchFlag&16;const K=w.props||he,Z=x.props||he;let te;if(E&&Bt(E,!1),(te=Z.onVnodeBeforeUpdate)&&et(te,E,x,w),J&&Ct(x,w,E,"beforeUpdate"),E&&Bt(E,!0),(K.innerHTML&&Z.innerHTML==null||K.textContent&&Z.textContent==null)&&y(V,""),D?C(w.dynamicChildren,D,V,E,F,Un(x,M),k):Y||H(w,x,V,null,E,F,Un(x,M),k,!1),N>0){if(N&16)P(V,K,Z,E,M);else if(N&2&&K.class!==Z.class&&u(V,"class",null,Z.class,M),N&4&&u(V,"style",K.style,Z.style,M),N&8){const se=x.dynamicProps;for(let de=0;de<se.length;de++){const fe=se[de],Re=K[fe],Le=Z[fe];(Le!==Re||fe==="value")&&u(V,fe,Re,Le,M,E)}}N&1&&w.children!==x.children&&y(V,x.children)}else!Y&&D==null&&P(V,K,Z,E,M);((te=Z.onVnodeUpdated)||J)&&Me(()=>{te&&et(te,E,x,w),J&&Ct(x,w,E,"updated")},F)},C=(w,x,E,F,M,k,Y)=>{for(let V=0;V<x.length;V++){const N=w[V],D=x[V],J=N.el&&(N.type===ct||!ri(N,D)||N.shapeFlag&70)?v(N.el):E;z(N,D,J,null,F,M,k,Y,!0)}},P=(w,x,E,F,M)=>{if(x!==E){if(x!==he)for(const k in x)!li(k)&&!(k in E)&&u(w,k,x[k],null,M,F);for(const k in E){if(li(k))continue;const Y=E[k],V=x[k];Y!==V&&k!=="value"&&u(w,k,V,Y,M,F)}"value"in E&&u(w,"value",x.value,E.value,M)}},L=(w,x,E,F,M,k,Y,V,N)=>{const D=x.el=w?w.el:o(""),J=x.anchor=w?w.anchor:o("");let{patchFlag:K,dynamicChildren:Z,slotScopeIds:te}=x;te&&(V=V?V.concat(te):te),w==null?(l(D,E,F),l(J,E,F),B(x.children||[],E,J,M,k,Y,V,N)):K>0&&K&64&&Z&&w.dynamicChildren?(C(w.dynamicChildren,Z,E,M,k,Y,V),(x.key!=null||M&&x===M.subTree)&&Eo(w,x,!0)):H(w,x,E,J,M,k,Y,V,N)},R=(w,x,E,F,M,k,Y,V,N)=>{x.slotScopeIds=V,w==null?x.shapeFlag&512?M.ctx.activate(x,E,F,Y,N):X(x,E,F,M,k,Y,N):W(w,x,N)},X=(w,x,E,F,M,k,Y)=>{const V=w.component=gf(w,F,M);if(co(w)&&(V.ctx.renderer=$),yf(V,!1,Y),V.asyncDep){if(M&&M.registerDep(V,re,Y),!w.el){const N=V.subTree=me(Rt);r(null,N,x,E)}}else re(V,w,x,E,M,k,Y)},W=(w,x,E)=>{const F=x.component=w.component;if(of(w,x,E))if(F.asyncDep&&!F.asyncResolved){O(F,x,E);return}else F.next=x,F.update();else x.el=w.el,F.vnode=x},re=(w,x,E,F,M,k,Y)=>{const V=()=>{if(w.isMounted){let{next:K,bu:Z,u:te,parent:se,vnode:de}=w;{const Je=Co(w);if(Je){K&&(K.el=de.el,O(w,K,Y)),Je.asyncDep.then(()=>{w.isUnmounted||V()});return}}let fe=K,Re;Bt(w,!1),K?(K.el=de.el,O(w,K,Y)):K=de,Z&&Mi(Z),(Re=K.props&&K.props.onVnodeBeforeUpdate)&&et(Re,se,K,de),Bt(w,!0);const Le=Kr(w),Ze=w.subTree;w.subTree=Le,z(Ze,Le,v(Ze.el),I(Ze),w,M,k),K.el=Le.el,fe===null&&af(w,Le.el),te&&Me(te,M),(Re=K.props&&K.props.onVnodeUpdated)&&Me(()=>et(Re,se,K,de),M)}else{let K;const{el:Z,props:te}=x,{bm:se,m:de,parent:fe,root:Re,type:Le}=w,Ze=hi(x);Bt(w,!1),se&&Mi(se),!Ze&&(K=te&&te.onVnodeBeforeMount)&&et(K,fe,x),Bt(w,!0);{Re.ce&&Re.ce._injectChildStyle(Le);const Je=w.subTree=Kr(w);z(null,Je,E,F,w,M,k),x.el=Je.el}if(de&&Me(de,M),!Ze&&(K=te&&te.onVnodeMounted)){const Je=x;Me(()=>et(K,fe,Je),M)}(x.shapeFlag&256||fe&&hi(fe.vnode)&&fe.vnode.shapeFlag&256)&&w.a&&Me(w.a,M),w.isMounted=!0,x=E=F=null}};w.scope.on();const N=w.effect=new Os(V);w.scope.off();const D=w.update=N.run.bind(N),J=w.job=N.runIfDirty.bind(N);J.i=w,J.id=w.uid,N.scheduler=()=>cr(J),Bt(w,!0),D()},O=(w,x,E)=>{x.component=w;const F=w.vnode.props;w.vnode=x,w.next=null,Gl(w,x.props,F,E),ql(w,x.children,E),St(),Mr(w),Ut()},H=(w,x,E,F,M,k,Y,V,N=!1)=>{const D=w&&w.children,J=w?w.shapeFlag:0,K=x.children,{patchFlag:Z,shapeFlag:te}=x;if(Z>0){if(Z&128){ce(D,K,E,F,M,k,Y,V,N);return}else if(Z&256){ne(D,K,E,F,M,k,Y,V,N);return}}te&8?(J&16&&Se(D,M,k),K!==D&&y(E,K)):J&16?te&16?ce(D,K,E,F,M,k,Y,V,N):Se(D,M,k,!0):(J&8&&y(E,""),te&16&&B(K,E,F,M,k,Y,V,N))},ne=(w,x,E,F,M,k,Y,V,N)=>{w=w||Vt,x=x||Vt;const D=w.length,J=x.length,K=Math.min(D,J);let Z;for(Z=0;Z<K;Z++){const te=x[Z]=N?mt(x[Z]):it(x[Z]);z(w[Z],te,E,null,M,k,Y,V,N)}D>J?Se(w,M,k,!0,!1,K):B(x,E,F,M,k,Y,V,N,K)},ce=(w,x,E,F,M,k,Y,V,N)=>{let D=0;const J=x.length;let K=w.length-1,Z=J-1;for(;D<=K&&D<=Z;){const te=w[D],se=x[D]=N?mt(x[D]):it(x[D]);if(ri(te,se))z(te,se,E,null,M,k,Y,V,N);else break;D++}for(;D<=K&&D<=Z;){const te=w[K],se=x[Z]=N?mt(x[Z]):it(x[Z]);if(ri(te,se))z(te,se,E,null,M,k,Y,V,N);else break;K--,Z--}if(D>K){if(D<=Z){const te=Z+1,se=te<J?x[te].el:F;for(;D<=Z;)z(null,x[D]=N?mt(x[D]):it(x[D]),E,se,M,k,Y,V,N),D++}}else if(D>Z)for(;D<=K;)ge(w[D],M,k,!0),D++;else{const te=D,se=D,de=new Map;for(D=se;D<=Z;D++){const ze=x[D]=N?mt(x[D]):it(x[D]);ze.key!=null&&de.set(ze.key,D)}let fe,Re=0;const Le=Z-se+1;let Ze=!1,Je=0;const ii=new Array(Le);for(D=0;D<Le;D++)ii[D]=0;for(D=te;D<=K;D++){const ze=w[D];if(Re>=Le){ge(ze,M,k,!0);continue}let Qe;if(ze.key!=null)Qe=de.get(ze.key);else for(fe=se;fe<=Z;fe++)if(ii[fe-se]===0&&ri(ze,x[fe])){Qe=fe;break}Qe===void 0?ge(ze,M,k,!0):(ii[Qe-se]=D+1,Qe>=Je?Je=Qe:Ze=!0,z(ze,x[Qe],E,null,M,k,Y,V,N),Re++)}const Ir=Ze?Zl(ii):Vt;for(fe=Ir.length-1,D=Le-1;D>=0;D--){const ze=se+D,Qe=x[ze],Fr=ze+1<J?x[ze+1].el:F;ii[D]===0?z(null,Qe,E,Fr,M,k,Y,V,N):Ze&&(fe<0||D!==Ir[fe]?ye(Qe,E,Fr,2):fe--)}}},ye=(w,x,E,F,M=null)=>{const{el:k,type:Y,transition:V,children:N,shapeFlag:D}=w;if(D&6){ye(w.component.subTree,x,E,F);return}if(D&128){w.suspense.move(x,E,F);return}if(D&64){Y.move(w,x,E,$);return}if(Y===ct){l(k,x,E);for(let K=0;K<N.length;K++)ye(N[K],x,E,F);l(w.anchor,x,E);return}if(Y===Ni){c(w,x,E);return}if(F!==2&&D&1&&V)if(F===0)V.beforeEnter(k),l(k,x,E),Me(()=>V.enter(k),M);else{const{leave:K,delayLeave:Z,afterLeave:te}=V,se=()=>l(k,x,E),de=()=>{K(k,()=>{se(),te&&te()})};Z?Z(k,se,de):de()}else l(k,x,E)},ge=(w,x,E,F=!1,M=!1)=>{const{type:k,props:Y,ref:V,children:N,dynamicChildren:D,shapeFlag:J,patchFlag:K,dirs:Z,cacheIndex:te}=w;if(K===-2&&(M=!1),V!=null&&qi(V,null,E,w,!0),te!=null&&(x.renderCache[te]=void 0),J&256){x.ctx.deactivate(w);return}const se=J&1&&Z,de=!hi(w);let fe;if(de&&(fe=Y&&Y.onVnodeBeforeUnmount)&&et(fe,x,w),J&6)ee(w.component,E,F);else{if(J&128){w.suspense.unmount(E,F);return}se&&Ct(w,null,x,"beforeUnmount"),J&64?w.type.remove(w,x,E,$,F):D&&!D.hasOnce&&(k!==ct||K>0&&K&64)?Se(D,x,E,!1,!0):(k===ct&&K&384||!M&&J&16)&&Se(N,x,E),F&&be(w)}(de&&(fe=Y&&Y.onVnodeUnmounted)||se)&&Me(()=>{fe&&et(fe,x,w),se&&Ct(w,null,x,"unmounted")},E)},be=w=>{const{type:x,el:E,anchor:F,transition:M}=w;if(x===ct){Ae(E,F);return}if(x===Ni){d(w);return}const k=()=>{f(E),M&&!M.persisted&&M.afterLeave&&M.afterLeave()};if(w.shapeFlag&1&&M&&!M.persisted){const{leave:Y,delayLeave:V}=M,N=()=>Y(E,k);V?V(w.el,k,N):N()}else k()},Ae=(w,x)=>{let E;for(;w!==x;)E=S(w),f(w),w=E;f(x)},ee=(w,x,E)=>{const{bum:F,scope:M,job:k,subTree:Y,um:V,m:N,a:D}=w;Yr(N),Yr(D),F&&Mi(F),M.stop(),k&&(k.flags|=8,ge(Y,w,x,E)),V&&Me(V,x),Me(()=>{w.isUnmounted=!0},x),x&&x.pendingBranch&&!x.isUnmounted&&w.asyncDep&&!w.asyncResolved&&w.suspenseId===x.pendingId&&(x.deps--,x.deps===0&&x.resolve())},Se=(w,x,E,F=!1,M=!1,k=0)=>{for(let Y=k;Y<w.length;Y++)ge(w[Y],x,E,F,M)},I=w=>{if(w.shapeFlag&6)return I(w.component.subTree);if(w.shapeFlag&128)return w.suspense.next();const x=S(w.anchor||w.el),E=x&&x[yl];return E?S(E):x};let q=!1;const j=(w,x,E)=>{w==null?x._vnode&&ge(x._vnode,null,null,!0):z(x._vnode||null,w,x,null,null,null,E),x._vnode=w,q||(q=!0,Mr(),so(),q=!1)},$={p:z,um:ge,m:ye,r:be,mt:X,mc:B,pc:H,pbc:C,n:I,o:t};return{render:j,hydrate:void 0,createApp:Hl(j)}}function Un({type:t,props:n},a){return a==="svg"&&t==="foreignObject"||a==="mathml"&&t==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:a}function Bt({effect:t,job:n},a){a?(t.flags|=32,n.flags|=4):(t.flags&=-33,n.flags&=-5)}function Xl(t,n){return(!t||t&&!t.pendingBranch)&&n&&!n.persisted}function Eo(t,n,a=!1){const l=t.children,f=n.children;if(Q(l)&&Q(f))for(let u=0;u<l.length;u++){const h=l[u];let o=f[u];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=f[u]=mt(f[u]),o.el=h.el),!a&&o.patchFlag!==-2&&Eo(h,o)),o.type===cn&&(o.el=h.el)}}function Zl(t){const n=t.slice(),a=[0];let l,f,u,h,o;const p=t.length;for(l=0;l<p;l++){const g=t[l];if(g!==0){if(f=a[a.length-1],t[f]<g){n[l]=f,a.push(l);continue}for(u=0,h=a.length-1;u<h;)o=u+h>>1,t[a[o]]<g?u=o+1:h=o;g<t[a[u]]&&(u>0&&(n[l]=a[u-1]),a[u]=l)}}for(u=a.length,h=a[u-1];u-- >0;)a[u]=h,h=n[h];return a}function Co(t){const n=t.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:Co(n)}function Yr(t){if(t)for(let n=0;n<t.length;n++)t[n].flags|=8}const Jl=Symbol.for("v-scx"),Ql=()=>dt(Jl);function Oi(t,n,a){return Bo(t,n,a)}function Bo(t,n,a=he){const{immediate:l,deep:f,flush:u,once:h}=a,o=Te({},a),p=n&&l||!n&&u!=="post";let g;if(bi){if(u==="sync"){const U=Ql();g=U.__watcherHandles||(U.__watcherHandles=[])}else if(!p){const U=()=>{};return U.stop=rt,U.resume=rt,U.pause=rt,U}}const y=Ce;o.call=(U,b,z)=>ot(U,y,b,z);let v=!1;u==="post"?o.scheduler=U=>{Me(U,y&&y.suspense)}:u!=="sync"&&(v=!0,o.scheduler=(U,b)=>{b?U():cr(U)}),o.augmentJob=U=>{n&&(U.flags|=4),v&&(U.flags|=2,y&&(U.id=y.uid,U.i=y))};const S=dl(t,n,o);return bi&&(g?g.push(S):p&&S()),S}function ef(t,n,a){const l=this.proxy,f=we(t)?t.includes(".")?To(l,t):()=>l[t]:t.bind(l,l);let u;ie(n)?u=n:(u=n.handler,a=n);const h=Fi(this),o=Bo(f,u.bind(l),a);return h(),o}function To(t,n){const a=n.split(".");return()=>{let l=t;for(let f=0;f<a.length&&l;f++)l=l[a[f]];return l}}const tf=(t,n)=>n==="modelValue"||n==="model-value"?t.modelModifiers:t[`${n}Modifiers`]||t[`${je(n)}Modifiers`]||t[`${zt(n)}Modifiers`];function nf(t,n,...a){if(t.isUnmounted)return;const l=t.vnode.props||he;let f=a;const u=n.startsWith("update:"),h=u&&tf(l,n.slice(7));h&&(h.trim&&(f=a.map(y=>we(y)?y.trim():y)),h.number&&(f=a.map(Gi)));let o,p=l[o=vn(n)]||l[o=vn(je(n))];!p&&u&&(p=l[o=vn(zt(n))]),p&&ot(p,t,6,f);const g=l[o+"Once"];if(g){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,ot(g,t,6,f)}}function Po(t,n,a=!1){const l=n.emitsCache,f=l.get(t);if(f!==void 0)return f;const u=t.emits;let h={},o=!1;if(!ie(t)){const p=g=>{const y=Po(g,n,!0);y&&(o=!0,Te(h,y))};!a&&n.mixins.length&&n.mixins.forEach(p),t.extends&&p(t.extends),t.mixins&&t.mixins.forEach(p)}return!u&&!o?(_e(t)&&l.set(t,null),null):(Q(u)?u.forEach(p=>h[p]=null):Te(h,u),_e(t)&&l.set(t,h),h)}function fn(t,n){return!t||!en(n)?!1:(n=n.slice(2).replace(/Once$/,""),le(t,n[0].toLowerCase()+n.slice(1))||le(t,zt(n))||le(t,n))}function Kr(t){const{type:n,vnode:a,proxy:l,withProxy:f,propsOptions:[u],slots:h,attrs:o,emit:p,render:g,renderCache:y,props:v,data:S,setupState:U,ctx:b,inheritAttrs:z}=t,e=Ki(t);let r,s;try{if(a.shapeFlag&4){const d=f||l,_=d;r=it(g.call(_,d,y,v,U,S,b)),s=o}else{const d=n;r=it(d.length>1?d(v,{attrs:o,slots:h,emit:p}):d(v,null)),s=n.props?o:rf(o)}}catch(d){pi.length=0,an(d,t,1),r=me(Rt)}let c=r;if(s&&z!==!1){const d=Object.keys(s),{shapeFlag:_}=c;d.length&&_&7&&(u&&d.some(Xn)&&(s=sf(s,u)),c=Wt(c,s,!1,!0))}return a.dirs&&(c=Wt(c,null,!1,!0),c.dirs=c.dirs?c.dirs.concat(a.dirs):a.dirs),a.transition&&ur(c,a.transition),r=c,Ki(e),r}const rf=t=>{let n;for(const a in t)(a==="class"||a==="style"||en(a))&&((n||(n={}))[a]=t[a]);return n},sf=(t,n)=>{const a={};for(const l in t)(!Xn(l)||!(l.slice(9)in n))&&(a[l]=t[l]);return a};function of(t,n,a){const{props:l,children:f,component:u}=t,{props:h,children:o,patchFlag:p}=n,g=u.emitsOptions;if(n.dirs||n.transition)return!0;if(a&&p>=0){if(p&1024)return!0;if(p&16)return l?qr(l,h,g):!!h;if(p&8){const y=n.dynamicProps;for(let v=0;v<y.length;v++){const S=y[v];if(h[S]!==l[S]&&!fn(g,S))return!0}}}else return(f||o)&&(!o||!o.$stable)?!0:l===h?!1:l?h?qr(l,h,g):!0:!!h;return!1}function qr(t,n,a){const l=Object.keys(n);if(l.length!==Object.keys(t).length)return!0;for(let f=0;f<l.length;f++){const u=l[f];if(n[u]!==t[u]&&!fn(a,u))return!0}return!1}function af({vnode:t,parent:n},a){for(;n;){const l=n.subTree;if(l.suspense&&l.suspense.activeBranch===t&&(l.el=t.el),l===t)(t=n.vnode).el=a,n=n.parent;else break}}const Io=t=>t.__isSuspense;function lf(t,n){n&&n.pendingBranch?Q(t)?n.effects.push(...t):n.effects.push(t):gl(t)}const ct=Symbol.for("v-fgt"),cn=Symbol.for("v-txt"),Rt=Symbol.for("v-cmt"),Ni=Symbol.for("v-stc"),pi=[];let He=null;function xe(t=!1){pi.push(He=t?null:[])}function ff(){pi.pop(),He=pi[pi.length-1]||null}let xi=1;function $r(t,n=!1){xi+=t,t<0&&He&&n&&(He.hasOnce=!0)}function Fo(t){return t.dynamicChildren=xi>0?He||Vt:null,ff(),xi>0&&He&&He.push(t),t}function Ue(t,n,a,l,f,u){return Fo(G(t,n,a,l,f,u,!0))}function cf(t,n,a,l,f){return Fo(me(t,n,a,l,f,!0))}function Wi(t){return t?t.__v_isVNode===!0:!1}function ri(t,n){return t.type===n.type&&t.key===n.key}const Lo=({key:t})=>t??null,Hi=({ref:t,ref_key:n,ref_for:a})=>(typeof t=="number"&&(t=""+t),t!=null?we(t)||Be(t)||ie(t)?{i:Ne,r:t,k:n,f:!!a}:t:null);function G(t,n=null,a=null,l=0,f=null,u=t===ct?0:1,h=!1,o=!1){const p={__v_isVNode:!0,__v_skip:!0,type:t,props:n,key:n&&Lo(n),ref:n&&Hi(n),scopeId:ao,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:l,dynamicProps:f,dynamicChildren:null,appContext:null,ctx:Ne};return o?(pr(p,a),u&128&&t.normalize(p)):a&&(p.shapeFlag|=we(a)?8:16),xi>0&&!h&&He&&(p.patchFlag>0||u&6)&&p.patchFlag!==32&&He.push(p),p}const me=uf;function uf(t,n=null,a=null,l=0,f=null,u=!1){if((!t||t===Fl)&&(t=Rt),Wi(t)){const o=Wt(t,n,!0);return a&&pr(o,a),xi>0&&!u&&He&&(o.shapeFlag&6?He[He.indexOf(t)]=o:He.push(o)),o.patchFlag=-2,o}if(bf(t)&&(t=t.__vccOpts),n){n=hf(n);let{class:o,style:p}=n;o&&!we(o)&&(n.class=er(o)),_e(p)&&(lr(p)&&!Q(p)&&(p=Te({},p)),n.style=Qn(p))}const h=we(t)?1:Io(t)?128:ml(t)?64:_e(t)?4:ie(t)?2:0;return G(t,n,a,l,f,h,u,!0)}function hf(t){return t?lr(t)||vo(t)?Te({},t):t:null}function Wt(t,n,a=!1,l=!1){const{props:f,ref:u,patchFlag:h,children:o,transition:p}=t,g=n?df(f||{},n):f,y={__v_isVNode:!0,__v_skip:!0,type:t.type,props:g,key:g&&Lo(g),ref:n&&n.ref?a&&u?Q(u)?u.concat(Hi(n)):[u,Hi(n)]:Hi(n):u,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:n&&t.type!==ct?h===-1?16:h|16:h,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:p,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Wt(t.ssContent),ssFallback:t.ssFallback&&Wt(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return p&&l&&ur(y,p.clone(y)),y}function nt(t=" ",n=0){return me(cn,null,t,n)}function dr(t,n){const a=me(Ni,null,t);return a.staticCount=n,a}function $e(t="",n=!1){return n?(xe(),cf(Rt,null,t)):me(Rt,null,t)}function it(t){return t==null||typeof t=="boolean"?me(Rt):Q(t)?me(ct,null,t.slice()):Wi(t)?mt(t):me(cn,null,String(t))}function mt(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Wt(t)}function pr(t,n){let a=0;const{shapeFlag:l}=t;if(n==null)n=null;else if(Q(n))a=16;else if(typeof n=="object")if(l&65){const f=n.default;f&&(f._c&&(f._d=!1),pr(t,f()),f._c&&(f._d=!0));return}else{a=32;const f=n._;!f&&!vo(n)?n._ctx=Ne:f===3&&Ne&&(Ne.slots._===1?n._=1:(n._=2,t.patchFlag|=1024))}else ie(n)?(n={default:n,_ctx:Ne},a=32):(n=String(n),l&64?(a=16,n=[nt(n)]):a=8);t.children=n,t.shapeFlag|=a}function df(...t){const n={};for(let a=0;a<t.length;a++){const l=t[a];for(const f in l)if(f==="class")n.class!==l.class&&(n.class=er([n.class,l.class]));else if(f==="style")n.style=Qn([n.style,l.style]);else if(en(f)){const u=n[f],h=l[f];h&&u!==h&&!(Q(u)&&u.includes(h))&&(n[f]=u?[].concat(u,h):h)}else f!==""&&(n[f]=l[f])}return n}function et(t,n,a,l=null){ot(t,n,7,[a,l])}const pf=go();let _f=0;function gf(t,n,a){const l=t.type,f=(n?n.appContext:t.appContext)||pf,u={uid:_f++,vnode:t,type:l,parent:n,appContext:f,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Oa(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(f.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:xo(l,f),emitsOptions:Po(l,f),emit:null,emitted:null,propsDefaults:he,inheritAttrs:l.inheritAttrs,ctx:he,data:he,props:he,attrs:he,slots:he,refs:he,setupState:he,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=n?n.root:u,u.emit=nf.bind(null,u),t.ce&&t.ce(u),u}let Ce=null,Xi,Gn;{const t=sn(),n=(a,l)=>{let f;return(f=t[a])||(f=t[a]=[]),f.push(l),u=>{f.length>1?f.forEach(h=>h(u)):f[0](u)}};Xi=n("__VUE_INSTANCE_SETTERS__",a=>Ce=a),Gn=n("__VUE_SSR_SETTERS__",a=>bi=a)}const Fi=t=>{const n=Ce;return Xi(t),t.scope.on(),()=>{t.scope.off(),Xi(n)}},Wr=()=>{Ce&&Ce.scope.off(),Xi(null)};function ko(t){return t.vnode.shapeFlag&4}let bi=!1;function yf(t,n=!1,a=!1){n&&Gn(n);const{props:l,children:f}=t.vnode,u=ko(t);Vl(t,l,u,n),Kl(t,f,a);const h=u?mf(t,n):void 0;return n&&Gn(!1),h}function mf(t,n){const a=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,kl);const{setup:l}=a;if(l){St();const f=t.setupContext=l.length>1?wf(t):null,u=Fi(t),h=Ii(l,t,0,[t.props,f]),o=Fs(h);if(Ut(),u(),(o||t.sp)&&!hi(t)&&fo(t),o){if(h.then(Wr,Wr),n)return h.then(p=>{Xr(t,p)}).catch(p=>{an(p,t,0)});t.asyncDep=h}else Xr(t,h)}else Ro(t)}function Xr(t,n,a){ie(n)?t.type.__ssrInlineRender?t.ssrRender=n:t.render=n:_e(n)&&(t.setupState=io(n)),Ro(t)}function Ro(t,n,a){const l=t.type;t.render||(t.render=l.render||rt);{const f=Fi(t);St();try{Rl(t)}finally{Ut(),f()}}}const vf={get(t,n){return Ee(t,"get",""),t[n]}};function wf(t){const n=a=>{t.exposed=a||{}};return{attrs:new Proxy(t.attrs,vf),slots:t.slots,emit:t.emit,expose:n}}function un(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(io(sl(t.exposed)),{get(n,a){if(a in n)return n[a];if(a in di)return di[a](t)},has(n,a){return a in n||a in di}})):t.proxy}function xf(t,n=!0){return ie(t)?t.displayName||t.name:t.name||n&&t.__name}function bf(t){return ie(t)&&"__vccOpts"in t}const Ye=(t,n)=>ul(t,n,bi);function zo(t,n,a){const l=arguments.length;return l===2?_e(n)&&!Q(n)?Wi(n)?me(t,null,[n]):me(t,n):me(t,null,n):(l>3?a=Array.prototype.slice.call(arguments,2):l===3&&Wi(a)&&(a=[a]),me(t,n,a))}const Af="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jn;const Zr=typeof window<"u"&&window.trustedTypes;if(Zr)try{jn=Zr.createPolicy("vue",{createHTML:t=>t})}catch{}const Mo=jn?t=>jn.createHTML(t):t=>t,Sf="http://www.w3.org/2000/svg",Uf="http://www.w3.org/1998/Math/MathML",ft=typeof document<"u"?document:null,Jr=ft&&ft.createElement("template"),Ef={insert:(t,n,a)=>{n.insertBefore(t,a||null)},remove:t=>{const n=t.parentNode;n&&n.removeChild(t)},createElement:(t,n,a,l)=>{const f=n==="svg"?ft.createElementNS(Sf,t):n==="mathml"?ft.createElementNS(Uf,t):a?ft.createElement(t,{is:a}):ft.createElement(t);return t==="select"&&l&&l.multiple!=null&&f.setAttribute("multiple",l.multiple),f},createText:t=>ft.createTextNode(t),createComment:t=>ft.createComment(t),setText:(t,n)=>{t.nodeValue=n},setElementText:(t,n)=>{t.textContent=n},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ft.querySelector(t),setScopeId(t,n){t.setAttribute(n,"")},insertStaticContent(t,n,a,l,f,u){const h=a?a.previousSibling:n.lastChild;if(f&&(f===u||f.nextSibling))for(;n.insertBefore(f.cloneNode(!0),a),!(f===u||!(f=f.nextSibling)););else{Jr.innerHTML=Mo(l==="svg"?`<svg>${t}</svg>`:l==="mathml"?`<math>${t}</math>`:t);const o=Jr.content;if(l==="svg"||l==="mathml"){const p=o.firstChild;for(;p.firstChild;)o.appendChild(p.firstChild);o.removeChild(p)}n.insertBefore(o,a)}return[h?h.nextSibling:n.firstChild,a?a.previousSibling:n.lastChild]}},Cf=Symbol("_vtc");function Bf(t,n,a){const l=t[Cf];l&&(n=(n?[n,...l]:[...l]).join(" ")),n==null?t.removeAttribute("class"):a?t.setAttribute("class",n):t.className=n}const Zi=Symbol("_vod"),Do=Symbol("_vsh"),En={beforeMount(t,{value:n},{transition:a}){t[Zi]=t.style.display==="none"?"":t.style.display,a&&n?a.beforeEnter(t):si(t,n)},mounted(t,{value:n},{transition:a}){a&&n&&a.enter(t)},updated(t,{value:n,oldValue:a},{transition:l}){!n!=!a&&(l?n?(l.beforeEnter(t),si(t,!0),l.enter(t)):l.leave(t,()=>{si(t,!1)}):si(t,n))},beforeUnmount(t,{value:n}){si(t,n)}};function si(t,n){t.style.display=n?t[Zi]:"none",t[Do]=!n}const Tf=Symbol(""),Pf=/(^|;)\s*display\s*:/;function If(t,n,a){const l=t.style,f=we(a);let u=!1;if(a&&!f){if(n)if(we(n))for(const h of n.split(";")){const o=h.slice(0,h.indexOf(":")).trim();a[o]==null&&Vi(l,o,"")}else for(const h in n)a[h]==null&&Vi(l,h,"");for(const h in a)h==="display"&&(u=!0),Vi(l,h,a[h])}else if(f){if(n!==a){const h=l[Tf];h&&(a+=";"+h),l.cssText=a,u=Pf.test(a)}}else n&&t.removeAttribute("style");Zi in t&&(t[Zi]=u?l.display:"",t[Do]&&(l.display="none"))}const Qr=/\s*!important$/;function Vi(t,n,a){if(Q(a))a.forEach(l=>Vi(t,n,l));else if(a==null&&(a=""),n.startsWith("--"))t.setProperty(n,a);else{const l=Ff(t,n);Qr.test(a)?t.setProperty(zt(l),a.replace(Qr,""),"important"):t[l]=a}}const es=["Webkit","Moz","ms"],Cn={};function Ff(t,n){const a=Cn[n];if(a)return a;let l=je(n);if(l!=="filter"&&l in t)return Cn[n]=l;l=rn(l);for(let f=0;f<es.length;f++){const u=es[f]+l;if(u in t)return Cn[n]=u}return n}const ts="http://www.w3.org/1999/xlink";function is(t,n,a,l,f,u=za(n)){l&&n.startsWith("xlink:")?a==null?t.removeAttributeNS(ts,n.slice(6,n.length)):t.setAttributeNS(ts,n,a):a==null||u&&!zs(a)?t.removeAttribute(n):t.setAttribute(n,u?"":st(a)?String(a):a)}function ns(t,n,a,l,f){if(n==="innerHTML"||n==="textContent"){a!=null&&(t[n]=n==="innerHTML"?Mo(a):a);return}const u=t.tagName;if(n==="value"&&u!=="PROGRESS"&&!u.includes("-")){const o=u==="OPTION"?t.getAttribute("value")||"":t.value,p=a==null?t.type==="checkbox"?"on":"":String(a);(o!==p||!("_value"in t))&&(t.value=p),a==null&&t.removeAttribute(n),t._value=a;return}let h=!1;if(a===""||a==null){const o=typeof t[n];o==="boolean"?a=zs(a):a==null&&o==="string"?(a="",h=!0):o==="number"&&(a=0,h=!0)}try{t[n]=a}catch{}h&&t.removeAttribute(f||n)}function wt(t,n,a,l){t.addEventListener(n,a,l)}function Lf(t,n,a,l){t.removeEventListener(n,a,l)}const rs=Symbol("_vei");function kf(t,n,a,l,f=null){const u=t[rs]||(t[rs]={}),h=u[n];if(l&&h)h.value=l;else{const[o,p]=Rf(n);if(l){const g=u[n]=Df(l,f);wt(t,o,g,p)}else h&&(Lf(t,o,h,p),u[n]=void 0)}}const ss=/(?:Once|Passive|Capture)$/;function Rf(t){let n;if(ss.test(t)){n={};let l;for(;l=t.match(ss);)t=t.slice(0,t.length-l[0].length),n[l[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):zt(t.slice(2)),n]}let Bn=0;const zf=Promise.resolve(),Mf=()=>Bn||(zf.then(()=>Bn=0),Bn=Date.now());function Df(t,n){const a=l=>{if(!l._vts)l._vts=Date.now();else if(l._vts<=a.attached)return;ot(Of(l,a.value),n,5,[l])};return a.value=t,a.attached=Mf(),a}function Of(t,n){if(Q(n)){const a=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{a.call(t),t._stopped=!0},n.map(l=>f=>!f._stopped&&l&&l(f))}else return n}const os=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Nf=(t,n,a,l,f,u)=>{const h=f==="svg";n==="class"?Bf(t,l,h):n==="style"?If(t,a,l):en(n)?Xn(n)||kf(t,n,a,l,u):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):Hf(t,n,l,h))?(ns(t,n,l),!t.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&is(t,n,l,h,u,n!=="value")):t._isVueCE&&(/[A-Z]/.test(n)||!we(l))?ns(t,je(n),l,u,n):(n==="true-value"?t._trueValue=l:n==="false-value"&&(t._falseValue=l),is(t,n,l,h))};function Hf(t,n,a,l){if(l)return!!(n==="innerHTML"||n==="textContent"||n in t&&os(n)&&ie(a));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&t.tagName==="INPUT"||n==="type"&&t.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const f=t.tagName;if(f==="IMG"||f==="VIDEO"||f==="CANVAS"||f==="SOURCE")return!1}return os(n)&&we(a)?!1:n in t}const Xt=t=>{const n=t.props["onUpdate:modelValue"]||!1;return Q(n)?a=>Mi(n,a):n};function Vf(t){t.target.composing=!0}function as(t){const n=t.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const pt=Symbol("_assign"),Ve={created(t,{modifiers:{lazy:n,trim:a,number:l}},f){t[pt]=Xt(f);const u=l||f.props&&f.props.type==="number";wt(t,n?"change":"input",h=>{if(h.target.composing)return;let o=t.value;a&&(o=o.trim()),u&&(o=Gi(o)),t[pt](o)}),a&&wt(t,"change",()=>{t.value=t.value.trim()}),n||(wt(t,"compositionstart",Vf),wt(t,"compositionend",as),wt(t,"change",as))},mounted(t,{value:n}){t.value=n??""},beforeUpdate(t,{value:n,oldValue:a,modifiers:{lazy:l,trim:f,number:u}},h){if(t[pt]=Xt(h),t.composing)return;const o=(u||t.type==="number")&&!/^0\d/.test(t.value)?Gi(t.value):t.value,p=n??"";o!==p&&(document.activeElement===t&&t.type!=="range"&&(l&&n===a||f&&t.value.trim()===p)||(t.value=p))}},Ji={created(t,{value:n},a){t.checked=qt(n,a.props.value),t[pt]=Xt(a),wt(t,"change",()=>{t[pt](Ai(t))})},beforeUpdate(t,{value:n,oldValue:a},l){t[pt]=Xt(l),n!==a&&(t.checked=qt(n,l.props.value))}},Gf={deep:!0,created(t,{value:n,modifiers:{number:a}},l){const f=tn(n);wt(t,"change",()=>{const u=Array.prototype.filter.call(t.options,h=>h.selected).map(h=>a?Gi(Ai(h)):Ai(h));t[pt](t.multiple?f?new Set(u):u:u[0]),t._assigning=!0,fr(()=>{t._assigning=!1})}),t[pt]=Xt(l)},mounted(t,{value:n}){ls(t,n)},beforeUpdate(t,n,a){t[pt]=Xt(a)},updated(t,{value:n}){t._assigning||ls(t,n)}};function ls(t,n){const a=t.multiple,l=Q(n);if(!(a&&!l&&!tn(n))){for(let f=0,u=t.options.length;f<u;f++){const h=t.options[f],o=Ai(h);if(a)if(l){const p=typeof o;p==="string"||p==="number"?h.selected=n.some(g=>String(g)===String(o)):h.selected=Da(n,o)>-1}else h.selected=n.has(o);else if(qt(Ai(h),n)){t.selectedIndex!==f&&(t.selectedIndex=f);return}}!a&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Ai(t){return"_value"in t?t._value:t.value}const jf=["ctrl","shift","alt","meta"],Yf={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,n)=>jf.some(a=>t[`${a}Key`]&&!n.includes(a))},fs=(t,n)=>{const a=t._withMods||(t._withMods={}),l=n.join(".");return a[l]||(a[l]=(f,...u)=>{for(let h=0;h<n.length;h++){const o=Yf[n[h]];if(o&&o(f,n))return}return t(f,...u)})},Kf=Te({patchProp:Nf},Ef);let cs;function qf(){return cs||(cs=$l(Kf))}const $f=(...t)=>{const n=qf().createApp(...t),{mount:a}=n;return n.mount=l=>{const f=Xf(l);if(!f)return;const u=n._component;!ie(u)&&!u.render&&!u.template&&(u.template=f.innerHTML),f.nodeType===1&&(f.textContent="");const h=a(f,!1,Wf(f));return f instanceof Element&&(f.removeAttribute("v-cloak"),f.setAttribute("data-v-app","")),h},n};function Wf(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Xf(t){return we(t)?document.querySelector(t):t}const Qt=(t,n)=>{const a=t.__vccOpts||t;for(const[l,f]of n)a[l]=f;return a},Zf={name:"App",computed:{supportsFileAPI(){return"showSaveFilePicker"in window}}},Jf={id:"app"};function Qf(t,n,a,l,f,u){const h=Dr("router-link"),o=Dr("router-view");return xe(),Ue("div",Jf,[G("nav",null,[me(h,{to:"/message"},{default:Nt(()=>n[0]||(n[0]=[nt("消息")])),_:1}),ve(me(h,{to:"/file"},{default:Nt(()=>n[1]||(n[1]=[nt("文件")])),_:1},512),[[En,u.supportsFileAPI]]),ve(me(h,{to:"/file-classic"},{default:Nt(()=>n[2]||(n[2]=[nt("文件2")])),_:1},512),[[En,!u.supportsFileAPI]]),me(h,{to:"/preview"},{default:Nt(()=>n[3]||(n[3]=[nt("预览")])),_:1}),ve(me(h,{to:"/video-decrypt"},{default:Nt(()=>n[4]||(n[4]=[nt("视频解密")])),_:1},512),[[En,0]])]),me(o)])}const ec=Qt(Zf,[["render",Qf]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Ht=typeof document<"u";function Oo(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function tc(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&Oo(t.default)}const oe=Object.assign;function Tn(t,n){const a={};for(const l in n){const f=n[l];a[l]=Xe(f)?f.map(t):t(f)}return a}const _i=()=>{},Xe=Array.isArray,No=/#/g,ic=/&/g,nc=/\//g,rc=/=/g,sc=/\?/g,Ho=/\+/g,oc=/%5B/g,ac=/%5D/g,Vo=/%5E/g,lc=/%60/g,Go=/%7B/g,fc=/%7C/g,jo=/%7D/g,cc=/%20/g;function _r(t){return encodeURI(""+t).replace(fc,"|").replace(oc,"[").replace(ac,"]")}function uc(t){return _r(t).replace(Go,"{").replace(jo,"}").replace(Vo,"^")}function Yn(t){return _r(t).replace(Ho,"%2B").replace(cc,"+").replace(No,"%23").replace(ic,"%26").replace(lc,"`").replace(Go,"{").replace(jo,"}").replace(Vo,"^")}function hc(t){return Yn(t).replace(rc,"%3D")}function dc(t){return _r(t).replace(No,"%23").replace(sc,"%3F")}function pc(t){return t==null?"":dc(t).replace(nc,"%2F")}function Si(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const _c=/\/$/,gc=t=>t.replace(_c,"");function Pn(t,n,a="/"){let l,f={},u="",h="";const o=n.indexOf("#");let p=n.indexOf("?");return o<p&&o>=0&&(p=-1),p>-1&&(l=n.slice(0,p),u=n.slice(p+1,o>-1?o:n.length),f=t(u)),o>-1&&(l=l||n.slice(0,o),h=n.slice(o,n.length)),l=wc(l??n,a),{fullPath:l+(u&&"?")+u+h,path:l,query:f,hash:Si(h)}}function yc(t,n){const a=n.query?t(n.query):"";return n.path+(a&&"?")+a+(n.hash||"")}function us(t,n){return!n||!t.toLowerCase().startsWith(n.toLowerCase())?t:t.slice(n.length)||"/"}function mc(t,n,a){const l=n.matched.length-1,f=a.matched.length-1;return l>-1&&l===f&&Zt(n.matched[l],a.matched[f])&&Yo(n.params,a.params)&&t(n.query)===t(a.query)&&n.hash===a.hash}function Zt(t,n){return(t.aliasOf||t)===(n.aliasOf||n)}function Yo(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const a in t)if(!vc(t[a],n[a]))return!1;return!0}function vc(t,n){return Xe(t)?hs(t,n):Xe(n)?hs(n,t):t===n}function hs(t,n){return Xe(n)?t.length===n.length&&t.every((a,l)=>a===n[l]):t.length===1&&t[0]===n}function wc(t,n){if(t.startsWith("/"))return t;if(!t)return n;const a=n.split("/"),l=t.split("/"),f=l[l.length-1];(f===".."||f===".")&&l.push("");let u=a.length-1,h,o;for(h=0;h<l.length;h++)if(o=l[h],o!==".")if(o==="..")u>1&&u--;else break;return a.slice(0,u).join("/")+"/"+l.slice(h).join("/")}const gt={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Ui;(function(t){t.pop="pop",t.push="push"})(Ui||(Ui={}));var gi;(function(t){t.back="back",t.forward="forward",t.unknown=""})(gi||(gi={}));function xc(t){if(!t)if(Ht){const n=document.querySelector("base");t=n&&n.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),gc(t)}const bc=/^[^#]+#/;function Ac(t,n){return t.replace(bc,"#")+n}function Sc(t,n){const a=document.documentElement.getBoundingClientRect(),l=t.getBoundingClientRect();return{behavior:n.behavior,left:l.left-a.left-(n.left||0),top:l.top-a.top-(n.top||0)}}const hn=()=>({left:window.scrollX,top:window.scrollY});function Uc(t){let n;if("el"in t){const a=t.el,l=typeof a=="string"&&a.startsWith("#"),f=typeof a=="string"?l?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!f)return;n=Sc(f,t)}else n=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function ds(t,n){return(history.state?history.state.position-n:-1)+t}const Kn=new Map;function Ec(t,n){Kn.set(t,n)}function Cc(t){const n=Kn.get(t);return Kn.delete(t),n}let Bc=()=>location.protocol+"//"+location.host;function Ko(t,n){const{pathname:a,search:l,hash:f}=n,u=t.indexOf("#");if(u>-1){let o=f.includes(t.slice(u))?t.slice(u).length:1,p=f.slice(o);return p[0]!=="/"&&(p="/"+p),us(p,"")}return us(a,t)+l+f}function Tc(t,n,a,l){let f=[],u=[],h=null;const o=({state:S})=>{const U=Ko(t,location),b=a.value,z=n.value;let e=0;if(S){if(a.value=U,n.value=S,h&&h===b){h=null;return}e=z?S.position-z.position:0}else l(U);f.forEach(r=>{r(a.value,b,{delta:e,type:Ui.pop,direction:e?e>0?gi.forward:gi.back:gi.unknown})})};function p(){h=a.value}function g(S){f.push(S);const U=()=>{const b=f.indexOf(S);b>-1&&f.splice(b,1)};return u.push(U),U}function y(){const{history:S}=window;S.state&&S.replaceState(oe({},S.state,{scroll:hn()}),"")}function v(){for(const S of u)S();u=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",y)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",y,{passive:!0}),{pauseListeners:p,listen:g,destroy:v}}function ps(t,n,a,l=!1,f=!1){return{back:t,current:n,forward:a,replaced:l,position:window.history.length,scroll:f?hn():null}}function Pc(t){const{history:n,location:a}=window,l={value:Ko(t,a)},f={value:n.state};f.value||u(l.value,{back:null,current:l.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function u(p,g,y){const v=t.indexOf("#"),S=v>-1?(a.host&&document.querySelector("base")?t:t.slice(v))+p:Bc()+t+p;try{n[y?"replaceState":"pushState"](g,"",S),f.value=g}catch(U){console.error(U),a[y?"replace":"assign"](S)}}function h(p,g){const y=oe({},n.state,ps(f.value.back,p,f.value.forward,!0),g,{position:f.value.position});u(p,y,!0),l.value=p}function o(p,g){const y=oe({},f.value,n.state,{forward:p,scroll:hn()});u(y.current,y,!0);const v=oe({},ps(l.value,p,null),{position:y.position+1},g);u(p,v,!1),l.value=p}return{location:l,state:f,push:o,replace:h}}function Ic(t){t=xc(t);const n=Pc(t),a=Tc(t,n.state,n.location,n.replace);function l(u,h=!0){h||a.pauseListeners(),history.go(u)}const f=oe({location:"",base:t,go:l,createHref:Ac.bind(null,t)},n,a);return Object.defineProperty(f,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(f,"state",{enumerable:!0,get:()=>n.state.value}),f}function Fc(t){return t=location.host?t||location.pathname+location.search:"",t.includes("#")||(t+="#"),Ic(t)}function Lc(t){return typeof t=="string"||t&&typeof t=="object"}function qo(t){return typeof t=="string"||typeof t=="symbol"}const $o=Symbol("");var _s;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(_s||(_s={}));function Jt(t,n){return oe(new Error,{type:t,[$o]:!0},n)}function lt(t,n){return t instanceof Error&&$o in t&&(n==null||!!(t.type&n))}const gs="[^/]+?",kc={sensitive:!1,strict:!1,start:!0,end:!0},Rc=/[.+*?^${}()[\]/\\]/g;function zc(t,n){const a=oe({},kc,n),l=[];let f=a.start?"^":"";const u=[];for(const g of t){const y=g.length?[]:[90];a.strict&&!g.length&&(f+="/");for(let v=0;v<g.length;v++){const S=g[v];let U=40+(a.sensitive?.25:0);if(S.type===0)v||(f+="/"),f+=S.value.replace(Rc,"\\$&"),U+=40;else if(S.type===1){const{value:b,repeatable:z,optional:e,regexp:r}=S;u.push({name:b,repeatable:z,optional:e});const s=r||gs;if(s!==gs){U+=10;try{new RegExp(`(${s})`)}catch(d){throw new Error(`Invalid custom RegExp for param "${b}" (${s}): `+d.message)}}let c=z?`((?:${s})(?:/(?:${s}))*)`:`(${s})`;v||(c=e&&g.length<2?`(?:/${c})`:"/"+c),e&&(c+="?"),f+=c,U+=20,e&&(U+=-8),z&&(U+=-20),s===".*"&&(U+=-50)}y.push(U)}l.push(y)}if(a.strict&&a.end){const g=l.length-1;l[g][l[g].length-1]+=.7000000000000001}a.strict||(f+="/?"),a.end?f+="$":a.strict&&!f.endsWith("/")&&(f+="(?:/|$)");const h=new RegExp(f,a.sensitive?"":"i");function o(g){const y=g.match(h),v={};if(!y)return null;for(let S=1;S<y.length;S++){const U=y[S]||"",b=u[S-1];v[b.name]=U&&b.repeatable?U.split("/"):U}return v}function p(g){let y="",v=!1;for(const S of t){(!v||!y.endsWith("/"))&&(y+="/"),v=!1;for(const U of S)if(U.type===0)y+=U.value;else if(U.type===1){const{value:b,repeatable:z,optional:e}=U,r=b in g?g[b]:"";if(Xe(r)&&!z)throw new Error(`Provided param "${b}" is an array but it is not repeatable (* or + modifiers)`);const s=Xe(r)?r.join("/"):r;if(!s)if(e)S.length<2&&(y.endsWith("/")?y=y.slice(0,-1):v=!0);else throw new Error(`Missing required param "${b}"`);y+=s}}return y||"/"}return{re:h,score:l,keys:u,parse:o,stringify:p}}function Mc(t,n){let a=0;for(;a<t.length&&a<n.length;){const l=n[a]-t[a];if(l)return l;a++}return t.length<n.length?t.length===1&&t[0]===80?-1:1:t.length>n.length?n.length===1&&n[0]===80?1:-1:0}function Wo(t,n){let a=0;const l=t.score,f=n.score;for(;a<l.length&&a<f.length;){const u=Mc(l[a],f[a]);if(u)return u;a++}if(Math.abs(f.length-l.length)===1){if(ys(l))return 1;if(ys(f))return-1}return f.length-l.length}function ys(t){const n=t[t.length-1];return t.length>0&&n[n.length-1]<0}const Dc={type:0,value:""},Oc=/[a-zA-Z0-9_]/;function Nc(t){if(!t)return[[]];if(t==="/")return[[Dc]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function n(U){throw new Error(`ERR (${a})/"${g}": ${U}`)}let a=0,l=a;const f=[];let u;function h(){u&&f.push(u),u=[]}let o=0,p,g="",y="";function v(){g&&(a===0?u.push({type:0,value:g}):a===1||a===2||a===3?(u.length>1&&(p==="*"||p==="+")&&n(`A repeatable param (${g}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:g,regexp:y,repeatable:p==="*"||p==="+",optional:p==="*"||p==="?"})):n("Invalid state to consume buffer"),g="")}function S(){g+=p}for(;o<t.length;){if(p=t[o++],p==="\\"&&a!==2){l=a,a=4;continue}switch(a){case 0:p==="/"?(g&&v(),h()):p===":"?(v(),a=1):S();break;case 4:S(),a=l;break;case 1:p==="("?a=2:Oc.test(p)?S():(v(),a=0,p!=="*"&&p!=="?"&&p!=="+"&&o--);break;case 2:p===")"?y[y.length-1]=="\\"?y=y.slice(0,-1)+p:a=3:y+=p;break;case 3:v(),a=0,p!=="*"&&p!=="?"&&p!=="+"&&o--,y="";break;default:n("Unknown state");break}}return a===2&&n(`Unfinished custom RegExp for param "${g}"`),v(),h(),f}function Hc(t,n,a){const l=zc(Nc(t.path),a),f=oe(l,{record:t,parent:n,children:[],alias:[]});return n&&!f.record.aliasOf==!n.record.aliasOf&&n.children.push(f),f}function Vc(t,n){const a=[],l=new Map;n=xs({strict:!1,end:!0,sensitive:!1},n);function f(v){return l.get(v)}function u(v,S,U){const b=!U,z=vs(v);z.aliasOf=U&&U.record;const e=xs(n,v),r=[z];if("alias"in v){const d=typeof v.alias=="string"?[v.alias]:v.alias;for(const _ of d)r.push(vs(oe({},z,{components:U?U.record.components:z.components,path:_,aliasOf:U?U.record:z})))}let s,c;for(const d of r){const{path:_}=d;if(S&&_[0]!=="/"){const m=S.record.path,A=m[m.length-1]==="/"?"":"/";d.path=S.record.path+(_&&A+_)}if(s=Hc(d,S,e),U?U.alias.push(s):(c=c||s,c!==s&&c.alias.push(s),b&&v.name&&!ws(s)&&h(v.name)),Xo(s)&&p(s),z.children){const m=z.children;for(let A=0;A<m.length;A++)u(m[A],s,U&&U.children[A])}U=U||s}return c?()=>{h(c)}:_i}function h(v){if(qo(v)){const S=l.get(v);S&&(l.delete(v),a.splice(a.indexOf(S),1),S.children.forEach(h),S.alias.forEach(h))}else{const S=a.indexOf(v);S>-1&&(a.splice(S,1),v.record.name&&l.delete(v.record.name),v.children.forEach(h),v.alias.forEach(h))}}function o(){return a}function p(v){const S=Yc(v,a);a.splice(S,0,v),v.record.name&&!ws(v)&&l.set(v.record.name,v)}function g(v,S){let U,b={},z,e;if("name"in v&&v.name){if(U=l.get(v.name),!U)throw Jt(1,{location:v});e=U.record.name,b=oe(ms(S.params,U.keys.filter(c=>!c.optional).concat(U.parent?U.parent.keys.filter(c=>c.optional):[]).map(c=>c.name)),v.params&&ms(v.params,U.keys.map(c=>c.name))),z=U.stringify(b)}else if(v.path!=null)z=v.path,U=a.find(c=>c.re.test(z)),U&&(b=U.parse(z),e=U.record.name);else{if(U=S.name?l.get(S.name):a.find(c=>c.re.test(S.path)),!U)throw Jt(1,{location:v,currentLocation:S});e=U.record.name,b=oe({},S.params,v.params),z=U.stringify(b)}const r=[];let s=U;for(;s;)r.unshift(s.record),s=s.parent;return{name:e,path:z,params:b,matched:r,meta:jc(r)}}t.forEach(v=>u(v));function y(){a.length=0,l.clear()}return{addRoute:u,resolve:g,removeRoute:h,clearRoutes:y,getRoutes:o,getRecordMatcher:f}}function ms(t,n){const a={};for(const l of n)l in t&&(a[l]=t[l]);return a}function vs(t){const n={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:Gc(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function Gc(t){const n={},a=t.props||!1;if("component"in t)n.default=a;else for(const l in t.components)n[l]=typeof a=="object"?a[l]:a;return n}function ws(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function jc(t){return t.reduce((n,a)=>oe(n,a.meta),{})}function xs(t,n){const a={};for(const l in t)a[l]=l in n?n[l]:t[l];return a}function Yc(t,n){let a=0,l=n.length;for(;a!==l;){const u=a+l>>1;Wo(t,n[u])<0?l=u:a=u+1}const f=Kc(t);return f&&(l=n.lastIndexOf(f,l-1)),l}function Kc(t){let n=t;for(;n=n.parent;)if(Xo(n)&&Wo(t,n)===0)return n}function Xo({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function qc(t){const n={};if(t===""||t==="?")return n;const l=(t[0]==="?"?t.slice(1):t).split("&");for(let f=0;f<l.length;++f){const u=l[f].replace(Ho," "),h=u.indexOf("="),o=Si(h<0?u:u.slice(0,h)),p=h<0?null:Si(u.slice(h+1));if(o in n){let g=n[o];Xe(g)||(g=n[o]=[g]),g.push(p)}else n[o]=p}return n}function bs(t){let n="";for(let a in t){const l=t[a];if(a=hc(a),l==null){l!==void 0&&(n+=(n.length?"&":"")+a);continue}(Xe(l)?l.map(u=>u&&Yn(u)):[l&&Yn(l)]).forEach(u=>{u!==void 0&&(n+=(n.length?"&":"")+a,u!=null&&(n+="="+u))})}return n}function $c(t){const n={};for(const a in t){const l=t[a];l!==void 0&&(n[a]=Xe(l)?l.map(f=>f==null?null:""+f):l==null?l:""+l)}return n}const Wc=Symbol(""),As=Symbol(""),gr=Symbol(""),Zo=Symbol(""),qn=Symbol("");function oi(){let t=[];function n(l){return t.push(l),()=>{const f=t.indexOf(l);f>-1&&t.splice(f,1)}}function a(){t=[]}return{add:n,list:()=>t.slice(),reset:a}}function vt(t,n,a,l,f,u=h=>h()){const h=l&&(l.enterCallbacks[f]=l.enterCallbacks[f]||[]);return()=>new Promise((o,p)=>{const g=S=>{S===!1?p(Jt(4,{from:a,to:n})):S instanceof Error?p(S):Lc(S)?p(Jt(2,{from:n,to:S})):(h&&l.enterCallbacks[f]===h&&typeof S=="function"&&h.push(S),o())},y=u(()=>t.call(l&&l.instances[f],n,a,g));let v=Promise.resolve(y);t.length<3&&(v=v.then(g)),v.catch(S=>p(S))})}function In(t,n,a,l,f=u=>u()){const u=[];for(const h of t)for(const o in h.components){let p=h.components[o];if(!(n!=="beforeRouteEnter"&&!h.instances[o]))if(Oo(p)){const y=(p.__vccOpts||p)[n];y&&u.push(vt(y,a,l,h,o,f))}else{let g=p();u.push(()=>g.then(y=>{if(!y)throw new Error(`Couldn't resolve component "${o}" at "${h.path}"`);const v=tc(y)?y.default:y;h.mods[o]=y,h.components[o]=v;const U=(v.__vccOpts||v)[n];return U&&vt(U,a,l,h,o,f)()}))}}return u}function Ss(t){const n=dt(gr),a=dt(Zo),l=Ye(()=>{const p=jt(t.to);return n.resolve(p)}),f=Ye(()=>{const{matched:p}=l.value,{length:g}=p,y=p[g-1],v=a.matched;if(!y||!v.length)return-1;const S=v.findIndex(Zt.bind(null,y));if(S>-1)return S;const U=Us(p[g-2]);return g>1&&Us(y)===U&&v[v.length-1].path!==U?v.findIndex(Zt.bind(null,p[g-2])):S}),u=Ye(()=>f.value>-1&&eu(a.params,l.value.params)),h=Ye(()=>f.value>-1&&f.value===a.matched.length-1&&Yo(a.params,l.value.params));function o(p={}){if(Qc(p)){const g=n[jt(t.replace)?"replace":"push"](jt(t.to)).catch(_i);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>g),g}return Promise.resolve()}return{route:l,href:Ye(()=>l.value.href),isActive:u,isExactActive:h,navigate:o}}function Xc(t){return t.length===1?t[0]:t}const Zc=lo({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ss,setup(t,{slots:n}){const a=on(Ss(t)),{options:l}=dt(gr),f=Ye(()=>({[Es(t.activeClass,l.linkActiveClass,"router-link-active")]:a.isActive,[Es(t.exactActiveClass,l.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const u=n.default&&Xc(n.default(a));return t.custom?u:zo("a",{"aria-current":a.isExactActive?t.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:f.value},u)}}}),Jc=Zc;function Qc(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const n=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return t.preventDefault&&t.preventDefault(),!0}}function eu(t,n){for(const a in n){const l=n[a],f=t[a];if(typeof l=="string"){if(l!==f)return!1}else if(!Xe(f)||f.length!==l.length||l.some((u,h)=>u!==f[h]))return!1}return!0}function Us(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const Es=(t,n,a)=>t??n??a,tu=lo({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:n,slots:a}){const l=dt(qn),f=Ye(()=>t.route||l.value),u=dt(As,0),h=Ye(()=>{let g=jt(u);const{matched:y}=f.value;let v;for(;(v=y[g])&&!v.components;)g++;return g}),o=Ye(()=>f.value.matched[h.value]);Di(As,Ye(()=>h.value+1)),Di(Wc,o),Di(qn,f);const p=ol();return Oi(()=>[p.value,o.value,t.name],([g,y,v],[S,U,b])=>{y&&(y.instances[v]=g,U&&U!==y&&g&&g===S&&(y.leaveGuards.size||(y.leaveGuards=U.leaveGuards),y.updateGuards.size||(y.updateGuards=U.updateGuards))),g&&y&&(!U||!Zt(y,U)||!S)&&(y.enterCallbacks[v]||[]).forEach(z=>z(g))},{flush:"post"}),()=>{const g=f.value,y=t.name,v=o.value,S=v&&v.components[y];if(!S)return Cs(a.default,{Component:S,route:g});const U=v.props[y],b=U?U===!0?g.params:typeof U=="function"?U(g):U:null,e=zo(S,oe({},b,n,{onVnodeUnmounted:r=>{r.component.isUnmounted&&(v.instances[y]=null)},ref:p}));return Cs(a.default,{Component:e,route:g})||e}}});function Cs(t,n){if(!t)return null;const a=t(n);return a.length===1?a[0]:a}const iu=tu;function nu(t){const n=Vc(t.routes,t),a=t.parseQuery||qc,l=t.stringifyQuery||bs,f=t.history,u=oi(),h=oi(),o=oi(),p=al(gt);let g=gt;Ht&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const y=Tn.bind(null,I=>""+I),v=Tn.bind(null,pc),S=Tn.bind(null,Si);function U(I,q){let j,$;return qo(I)?(j=n.getRecordMatcher(I),$=q):$=I,n.addRoute($,j)}function b(I){const q=n.getRecordMatcher(I);q&&n.removeRoute(q)}function z(){return n.getRoutes().map(I=>I.record)}function e(I){return!!n.getRecordMatcher(I)}function r(I,q){if(q=oe({},q||p.value),typeof I=="string"){const E=Pn(a,I,q.path),F=n.resolve({path:E.path},q),M=f.createHref(E.fullPath);return oe(E,F,{params:S(F.params),hash:Si(E.hash),redirectedFrom:void 0,href:M})}let j;if(I.path!=null)j=oe({},I,{path:Pn(a,I.path,q.path).path});else{const E=oe({},I.params);for(const F in E)E[F]==null&&delete E[F];j=oe({},I,{params:v(E)}),q.params=v(q.params)}const $=n.resolve(j,q),ue=I.hash||"";$.params=y(S($.params));const w=yc(l,oe({},I,{hash:uc(ue),path:$.path})),x=f.createHref(w);return oe({fullPath:w,hash:ue,query:l===bs?$c(I.query):I.query||{}},$,{redirectedFrom:void 0,href:x})}function s(I){return typeof I=="string"?Pn(a,I,p.value.path):oe({},I)}function c(I,q){if(g!==I)return Jt(8,{from:q,to:I})}function d(I){return A(I)}function _(I){return d(oe(s(I),{replace:!0}))}function m(I){const q=I.matched[I.matched.length-1];if(q&&q.redirect){const{redirect:j}=q;let $=typeof j=="function"?j(I):j;return typeof $=="string"&&($=$.includes("?")||$.includes("#")?$=s($):{path:$},$.params={}),oe({query:I.query,hash:I.hash,params:$.path!=null?{}:I.params},$)}}function A(I,q){const j=g=r(I),$=p.value,ue=I.state,w=I.force,x=I.replace===!0,E=m(j);if(E)return A(oe(s(E),{state:typeof E=="object"?oe({},ue,E.state):ue,force:w,replace:x}),q||j);const F=j;F.redirectedFrom=q;let M;return!w&&mc(l,$,j)&&(M=Jt(16,{to:F,from:$}),ye($,$,!0,!1)),(M?Promise.resolve(M):C(F,$)).catch(k=>lt(k)?lt(k,2)?k:ce(k):H(k,F,$)).then(k=>{if(k){if(lt(k,2))return A(oe({replace:x},s(k.to),{state:typeof k.to=="object"?oe({},ue,k.to.state):ue,force:w}),q||F)}else k=L(F,$,!0,x,ue);return P(F,$,k),k})}function B(I,q){const j=c(I,q);return j?Promise.reject(j):Promise.resolve()}function T(I){const q=Ae.values().next().value;return q&&typeof q.runWithContext=="function"?q.runWithContext(I):I()}function C(I,q){let j;const[$,ue,w]=ru(I,q);j=In($.reverse(),"beforeRouteLeave",I,q);for(const E of $)E.leaveGuards.forEach(F=>{j.push(vt(F,I,q))});const x=B.bind(null,I,q);return j.push(x),Se(j).then(()=>{j=[];for(const E of u.list())j.push(vt(E,I,q));return j.push(x),Se(j)}).then(()=>{j=In(ue,"beforeRouteUpdate",I,q);for(const E of ue)E.updateGuards.forEach(F=>{j.push(vt(F,I,q))});return j.push(x),Se(j)}).then(()=>{j=[];for(const E of w)if(E.beforeEnter)if(Xe(E.beforeEnter))for(const F of E.beforeEnter)j.push(vt(F,I,q));else j.push(vt(E.beforeEnter,I,q));return j.push(x),Se(j)}).then(()=>(I.matched.forEach(E=>E.enterCallbacks={}),j=In(w,"beforeRouteEnter",I,q,T),j.push(x),Se(j))).then(()=>{j=[];for(const E of h.list())j.push(vt(E,I,q));return j.push(x),Se(j)}).catch(E=>lt(E,8)?E:Promise.reject(E))}function P(I,q,j){o.list().forEach($=>T(()=>$(I,q,j)))}function L(I,q,j,$,ue){const w=c(I,q);if(w)return w;const x=q===gt,E=Ht?history.state:{};j&&($||x?f.replace(I.fullPath,oe({scroll:x&&E&&E.scroll},ue)):f.push(I.fullPath,ue)),p.value=I,ye(I,q,j,x),ce()}let R;function X(){R||(R=f.listen((I,q,j)=>{if(!ee.listening)return;const $=r(I),ue=m($);if(ue){A(oe(ue,{replace:!0,force:!0}),$).catch(_i);return}g=$;const w=p.value;Ht&&Ec(ds(w.fullPath,j.delta),hn()),C($,w).catch(x=>lt(x,12)?x:lt(x,2)?(A(oe(s(x.to),{force:!0}),$).then(E=>{lt(E,20)&&!j.delta&&j.type===Ui.pop&&f.go(-1,!1)}).catch(_i),Promise.reject()):(j.delta&&f.go(-j.delta,!1),H(x,$,w))).then(x=>{x=x||L($,w,!1),x&&(j.delta&&!lt(x,8)?f.go(-j.delta,!1):j.type===Ui.pop&&lt(x,20)&&f.go(-1,!1)),P($,w,x)}).catch(_i)}))}let W=oi(),re=oi(),O;function H(I,q,j){ce(I);const $=re.list();return $.length?$.forEach(ue=>ue(I,q,j)):console.error(I),Promise.reject(I)}function ne(){return O&&p.value!==gt?Promise.resolve():new Promise((I,q)=>{W.add([I,q])})}function ce(I){return O||(O=!I,X(),W.list().forEach(([q,j])=>I?j(I):q()),W.reset()),I}function ye(I,q,j,$){const{scrollBehavior:ue}=t;if(!Ht||!ue)return Promise.resolve();const w=!j&&Cc(ds(I.fullPath,0))||($||!j)&&history.state&&history.state.scroll||null;return fr().then(()=>ue(I,q,w)).then(x=>x&&Uc(x)).catch(x=>H(x,I,q))}const ge=I=>f.go(I);let be;const Ae=new Set,ee={currentRoute:p,listening:!0,addRoute:U,removeRoute:b,clearRoutes:n.clearRoutes,hasRoute:e,getRoutes:z,resolve:r,options:t,push:d,replace:_,go:ge,back:()=>ge(-1),forward:()=>ge(1),beforeEach:u.add,beforeResolve:h.add,afterEach:o.add,onError:re.add,isReady:ne,install(I){const q=this;I.component("RouterLink",Jc),I.component("RouterView",iu),I.config.globalProperties.$router=q,Object.defineProperty(I.config.globalProperties,"$route",{enumerable:!0,get:()=>jt(p)}),Ht&&!be&&p.value===gt&&(be=!0,d(f.location).catch(ue=>{}));const j={};for(const ue in gt)Object.defineProperty(j,ue,{get:()=>p.value[ue],enumerable:!0});I.provide(gr,q),I.provide(Zo,Qs(j)),I.provide(qn,p);const $=I.unmount;Ae.add(I),I.unmount=function(){Ae.delete(I),Ae.size<1&&(g=gt,R&&R(),R=null,p.value=gt,be=!1,O=!1),$()}}};function Se(I){return I.reduce((q,j)=>q.then(()=>T(j)),Promise.resolve())}return ee}function ru(t,n){const a=[],l=[],f=[],u=Math.max(n.matched.length,t.matched.length);for(let h=0;h<u;h++){const o=n.matched[h];o&&(t.matched.find(g=>Zt(g,o))?l.push(o):a.push(o));const p=t.matched[h];p&&(n.matched.find(g=>Zt(g,p))||f.push(p))}return[a,l,f]}var su=Object.defineProperty,Jo=(t,n)=>{for(var a in n)su(t,a,{get:n[a],enumerable:!0})},Qo=new Array(256);for(let t=0;t<256;t++)Qo[t]=t.toString(16).padStart(2,"0");function Ei(t){if(!t||!(t instanceof Uint8Array))throw new TypeError("Input must be a Uint8Array");const n=t.length,a=new Array(n);for(let l=0;l<n;l++)a[l]=Qo[t[l]];return a.join("")}var Bs={get InvalidHexStringException(){throw new TypeError("Invalid hex string")}};function bt(t){if(typeof t!="string")throw new TypeError("Input must be a string");const n=t.length;if(n%2!==0)throw new TypeError("Hex string must have even length");t=t.toLowerCase();const a=new Uint8Array(n>>1);for(let l=0;l<n;l+=2){const f=t.charCodeAt(l),u=t.charCodeAt(l+1),h=f>=97&&f<=102?f-87:f>=48&&f<=57?f-48:Bs.InvalidHexStringException,o=u>=97&&u<=102?u-87:u>=48&&u<=57?u-48:Bs.InvalidHexStringException;a[l>>1]=h<<4|o}return a}function Ci(t){const n=new Uint8Array(t);return crypto.getRandomValues(n),n}function ou(){const t=Ci(1);return new Uint8Array(t)[0]}function Lt(t,n="utf-8"){if(typeof t!="string")throw new TypeError("Input must be a string");if(n.toLowerCase()!=="utf-8")throw new Error("Only 'utf-8' encoding is supported");return new TextEncoder().encode(t)}function ke(t,n="utf-8"){if(t instanceof Uint8Array||(t=new Uint8Array(t)),n.toLowerCase()!=="utf-8")throw new Error("Only 'utf-8' encoding is supported");return new TextDecoder().decode(t)}var au={};Jo(au,{BadDataException:()=>yi,CannotDecryptException:()=>br,ChaCha20NotSupportedException:()=>ua,CryptContextNotInitedException:()=>la,CryptContextReleasedException:()=>ca,CryptContextReusedException:()=>aa,DangerousEncryptionAlgorithmException:()=>ha,DataError:()=>Mt,EncryptionAlgorithmNotSupportedException:()=>Ti,EncryptionError:()=>mr,EncryptionVersionMismatchException:()=>Bi,EndOfFileException:()=>lu,ExpectedError:()=>ta,FileCorruptedException:()=>wr,IVException:()=>sa,InputError:()=>_n,InternalError:()=>We,InvalidCryptContextTypeException:()=>fa,InvalidEndMarkerException:()=>xr,InvalidFileFormatException:()=>vr,InvalidParameterException:()=>Ge,InvalidScryptParameterException:()=>ra,LibraryError:()=>yr,NetworkError:()=>ea,NotSupportedException:()=>Ar,OperationNotPermittedException:()=>Sr,ParameterError:()=>Et,RuntimeException:()=>dn,UnexpectedError:()=>pn,UnexpectedFailureInChunkDecryptionException:()=>oa,UserException:()=>ia,VersionSystemError:()=>na});var yr=class extends Error{constructor(t="Library Error",n=void 0){super(t,n),this.name="LibraryError"}},mr=class extends yr{constructor(t="Encryption Error",n=void 0){super(t,n),this.name="EncryptionError"}},ea=class extends yr{constructor(t="(Network Error)",n=void 0){super(t,n),this.name="NetworkError"}},ta=class extends mr{constructor(t="(Expected Error)",n=void 0){super(t,n),this.name="ExpectedError"}},dn=class extends mr{constructor(t="(Runtime Error)",n=void 0){super(t,n),this.name="RuntimeException"}},pn=class extends dn{constructor(t="(Unexpected Error)",n=void 0){super(t,n),this.name="UnexpectedError"}},We=class extends pn{constructor(t="(Internal Error)",n=void 0){super(t,n),this.name="InternalError"}},_n=class extends dn{constructor(t="(Input Error)",n=void 0){super(t,n),this.name="InputError"}},Et=class extends _n{constructor(t="(Data Error)",n=void 0){super(t,n),this.name="ParameterError"}},Mt=class extends _n{constructor(t="(Data Error)",n=void 0){super(t,n),this.name="DataError"}},ia=class extends dn{constructor(t="(The end user has a fault that caused the exception. This is not code bug.)",n=void 0){super(t,n),this.name="UserException"}},na=class extends Mt{constructor(t="(Version System Error)",n=void 0){super(t,n),this.name="VersionSystemError"}},Ge=class extends Et{constructor(t="The parameter provided is invalid.",n=void 0){super(t,n),this.name="InvalidParameterException"}},yi=class extends Mt{constructor(t="The data is bad.",n=void 0){super(t,n),this.name="BadDataException"}},ra=class extends Et{constructor(t="The N, r, or p is not valid or out of range.",n=void 0){super(t,n),this.name="InvalidScryptParameterException"}},Bi=class extends na{constructor(t="The version of the encryption library doesn't match.",n=void 0){super(t,n),this.name="EncryptionVersionMismatchException"}},vr=class extends Mt{constructor(t="The file format is invalid.",n=void 0){super(t,n),this.name="InvalidFileFormatException"}},sa=class extends We{constructor(t="IV Exception.",n=void 0){super(t,n),this.name="IVException"}},wr=class extends Mt{constructor(t="File is corrupted.",n=void 0){super(t,n),this.name="FileCorruptedException"}},xr=class extends Mt{constructor(t="The end marker is invalid.",n=void 0){super(t,n),this.name="InvalidEndMarkerException"}},br=class extends ia{constructor(t="Cannot decrypt",n=void 0){super(t,n),this.name="CannotDecryptException"}},oa=class extends pn{constructor(t="An unexpected failure occurred while decrypting the chunk. The file may be corrupted.",n=void 0){super(t,n),this.name="UnexpectedFailureInChunkDecryptionException"}},aa=class extends Et{constructor(t="Not allowed to reuse a crypt context.",n=void 0){super(t,n),this.name="CryptContextReusedException"}},Ar=class extends _n{constructor(t="Operation not supported",n=void 0){super(t,n),this.name="NotSupportedException"}},lu=class extends ta{constructor(t="End of File",n=void 0){super(t,n),this.name="EndOfFileException"}},la=class extends Et{constructor(t="Crypt context is not initialized.",n=void 0){super(t,n),this.name="CryptContextNotInitedException"}},fa=class extends Et{constructor(t="Invalid crypt context type.",n=void 0){super(t,n),this.name="InvalidCryptContextTypeException"}},ca=class extends Et{constructor(t="Crypt context has been released.",n=void 0){super(t,n),this.name="CryptContextReleasedException"}},Sr=class extends Et{constructor(t="Operation not permitted.",n=void 0){super(t,n),this.name="OperationNotPermittedException"}},Ti=class extends Mt{constructor(t="The specified encryption algorithm is not supported.",n=void 0){super(t,n),this.name="EncryptionAlgorithmNotSupportedException"}},ua=class extends Ti{constructor(t="ChaCha20 is not supported yet.",n=void 0){super(t,n),this.name="ChaCha20NotSupportedException"}},ha=class extends Ti{constructor(t="The specified encryption algorithm is DANGEROUS.",n=void 0){super(t,n),this.name="DangerousEncryptionAlgorithmException"}},Ur={};(function(){const t=Ur;var n;(function(u){function h(b){return U?new U(b):new Array(b)}function o(b){return U?new U(b):b}function p(b){for(var z=b.length/2,e=h(z),r=0;r<z;r++){var s=parseInt(b.substr(2*r,2),16);if(isNaN(s))throw Error("invalid hex data");e[r]=s}return e}function g(b){for(var z=b.length,e="",r=0;r<z;r++){var s=255&b[r],c=s.toString(16);s<16&&(c="0"+c),e+=c}return e}function y(b){var z=t.TextEncoder;if(z)return new z().encode(b);for(var e=[],r=0,s=0,c=encodeURI(b),d=c.length;r<d;){var _=c.charCodeAt(r);if(_==37){var m=c.substr(r+1,2);_=parseInt(m,16),r+=3}else r++;e[s++]=_}return o(e)}function v(b){for(var z=b.length,e="",r=0;r<z;r++){var s=b[r],c=s.toString(16);s<16&&(c="0"+c),e+="%"+c}return decodeURIComponent(e)}function S(b){b.style.cssText="position:absolute;top:-999px"}var U=t.Uint8Array;u.hexToBytes=p,u.bytesToHex=g,u.strToBytes=y,u.bytesToStr=v,u.hideDom=S})(n||(n={}));var a;(function(u){function h(){return"Worker"in t}function o(z){f.__asmjs_cb=U,async function(){try{const e=`
const window = globalThis["scrypt_loader_9470f487e3aa154f278269e99e6a42502ca77b8da3867a46a548909659a3db4a"]
/// START ASM.JS
!function(){function A(){"use strict";function A(A){return r(self,{},A)}function e(){return 8200}var r=function(A,e,r){"use asm";var n=new A.Int32Array(r),t=A.Math.imul,i=new A.Int8Array(r),a=new A.Uint8Array(r);function o(A,e,r,o,u,c,s){A=A|0;e=e|0;r=r|0;o=o|0;u=u|0;c=c|0;s=s|0;var l=0,w=0,h=0,v=0,d=0,y=0,p=0,g=0,b=0,m=0,M=0,k=0,U=0,L=0,I=0,x=0,E=0,D=0,K=0,R=0,B=0,F=0,O=0,_=0,C=0,H=0,j=0,q=0,G=0,N=0,P=0,S=0;C=e<<7;q=e<<5;N=o+C|0;M=o+(e<<8)|0;if(u|0){A:do if(c>>>0<s>>>0){k=C+-64|0;U=o+k|0;L=A+-1|0;I=q&1073741792;x=N+k|0;if(!I){b=c;while(1){f(o,N,e);f(N,o,e);b=b+2|0;if(b>>>0>=s>>>0)break A}}else g=c;do{_=M+((t(n[U>>2]&L,q)|0)<<2)|0;v=0;do{H=o+(v<<2)|0;n[H>>2]=n[H>>2]^n[_+(v<<2)>>2];v=v+1|0}while((v|0)!=(I|0));f(o,N,e);j=M+((t(n[x>>2]&L,q)|0)<<2)|0;d=0;do{G=N+(d<<2)|0;n[G>>2]=n[G>>2]^n[j+(d<<2)>>2];d=d+1|0}while((d|0)!=(I|0));f(N,o,e);g=g+2|0}while(g>>>0<s>>>0)}while(0);if((s|0)==(A|0)&(q|0)!=0)m=0;else return;do{P=r+(m<<2)|0;S=n[o+(m<<2)>>2]|0;i[P>>0]=S;i[P+1>>0]=S>>>8;i[P+2>>0]=S>>>16;i[P+3>>0]=S>>>24;m=m+1|0}while((m|0)!=(q|0));return}if((c|0)==0&(q|0)!=0){p=0;do{E=r+(p<<2)|0;n[o+(p<<2)>>2]=(a[E+1>>0]|0)<<8|(a[E>>0]|0)|(a[E+2>>0]|0)<<16|(a[E+3>>0]|0)<<24;p=p+1|0}while((p|0)!=(q|0))}D=t(q,c)|0;K=t(q,s)|0;if(D>>>0>=K>>>0)return;R=q&1073741792;if(!R){w=D;do{f(o,N,e);w=w+q+q|0;f(N,o,e)}while(w>>>0<K>>>0);return}else l=D;do{B=M+(l<<2)|0;h=0;do{n[B+(h<<2)>>2]=n[o+(h<<2)>>2];h=h+1|0}while((h|0)!=(R|0));F=l+q|0;f(o,N,e);O=M+(F<<2)|0;y=0;do{n[O+(y<<2)>>2]=n[N+(y<<2)>>2];y=y+1|0}while((y|0)!=(R|0));l=F+q|0;f(N,o,e)}while(l>>>0<K>>>0);return}function f(A,e,r){A=A|0;e=e|0;r=r|0;var t=0,i=0,a=0,o=0,f=0,u=0,c=0,s=0,l=0,w=0,h=0,v=0,d=0,y=0,p=0,g=0,b=0,m=0,M=0,k=0,U=0,L=0,I=0,x=0,E=0,D=0,K=0,R=0,B=0,F=0,O=0,_=0,C=0,H=0,j=0,q=0,G=0,N=0,P=0,S=0,V=0,Z=0,Q=0,T=0,J=0,Y=0,W=0,z=0,X=0,$=0,AA=0,eA=0,rA=0,nA=0,tA=0,iA=0,aA=0,oA=0,fA=0,uA=0,cA=0,sA=0,lA=0,wA=0,hA=0,vA=0,dA=0,yA=0,pA=0,gA=0,bA=0,mA=0,MA=0,kA=0,UA=0,LA=0,IA=0,xA=0,EA=0,DA=0,KA=0,RA=0,BA=0,FA=0,OA=0,_A=0,CA=0,HA=0,jA=0,qA=0,GA=0,NA=0,PA=0,SA=0,VA=0,ZA=0,QA=0,TA=0,JA=0,YA=0,WA=0,zA=0,XA=0,$A=0,Ae=0,ee=0,re=0,ne=0,te=0,ie=0,ae=0,oe=0,fe=0,ue=0,ce=0,se=0,le=0,we=0,he=0,ve=0,de=0,ye=0,pe=0,ge=0,be=0,me=0,Me=0,ke=0,Ue=0,Le=0,Ie=0,xe=0,Ee=0,De=0,Ke=0,Re=0,Be=0,Fe=0,Oe=0,_e=0,Ce=0,He=0,je=0,qe=0,Ge=0,Ne=0,Pe=0,Se=0,Ve=0,Ze=0,Qe=0,Te=0,Je=0,Ye=0,We=0,ze=0,Xe=0,$e=0,Ar=0,er=0,rr=0,nr=0,tr=0,ir=0,ar=0,or=0,fr=0,ur=0,cr=0,sr=0,lr=0,wr=0,hr=0,vr=0,dr=0,yr=0,pr=0,gr=0,br=0,mr=0,Mr=0,kr=0,Ur=0,Lr=0,Ir=0,xr=0,Er=0,Dr=0,Kr=0,Rr=0,Br=0,Fr=0,Or=0,_r=0,Cr=0,Hr=0,jr=0,qr=0,Gr=0,Nr=0,Pr=0,Sr=0,Vr=0,Zr=0,Qr=0,Tr=0,Jr=0,Yr=0,Wr=0,zr=0,Xr=0,$r=0,An=0,en=0,rn=0,nn=0,tn=0,an=0,on=0,fn=0,un=0,cn=0,sn=0,ln=0,wn=0,hn=0,vn=0,dn=0,yn=0,pn=0,gn=0,bn=0,mn=0,Mn=0,kn=0,Un=0,Ln=0,In=0,xn=0,En=0,Dn=0,Kn=0,Rn=0,Bn=0,Fn=0,On=0,_n=0,Cn=0,Hn=0,jn=0,qn=0,Gn=0,Nn=0,Pn=0,Sn=0,Vn=0,Zn=0,Qn=0,Tn=0,Jn=0,Yn=0,Wn=0,zn=0,Xn=0,$n=0,At=0,et=0,rt=0,nt=0,tt=0,it=0,at=0,ot=0,ft=0,ut=0,ct=0,st=0,lt=0,wt=0,ht=0,vt=0,dt=0,yt=0,pt=0,gt=0,bt=0,mt=0,Mt=0,kt=0,Ut=0,Lt=0,It=0,xt=0,Et=0,Dt=0,Kt=0,Rt=0,Bt=0,Ft=0,Ot=0,_t=0,Ct=0,Ht=0,jt=0,qt=0,Gt=0,Nt=0,Pt=0,St=0,Vt=0,Zt=0,Qt=0,Tt=0,Jt=0,Yt=0,Wt=0,zt=0,Xt=0,$t=0,Ai=0,ei=0,ri=0,ni=0,ti=0,ii=0,ai=0,oi=0,fi=0,ui=0,ci=0,si=0,li=0,wi=0,hi=0,vi=0,di=0,yi=0,pi=0,gi=0,bi=0,mi=0,Mi=0,ki=0,Ui=0,Li=0,Ii=0,xi=0,Ei=0,Di=0,Ki=0,Ri=0,Bi=0,Fi=0,Oi=0,_i=0,Ci=0,Hi=0,ji=0,qi=0,Gi=0,Ni=0,Pi=0,Si=0,Vi=0,Zi=0,Qi=0,Ti=0,Ji=0,Yi=0,Wi=0,zi=0,Xi=0,$i=0,Aa=0,ea=0,ra=0,na=0,ta=0,ia=0,aa=0,oa=0,fa=0,ua=0,ca=0,sa=0,la=0,wa=0,ha=0,va=0,da=0,ya=0,pa=0,ga=0,ba=0,ma=0,Ma=0,ka=0,Ua=0,La=0,Ia=0,xa=0,Ea=0,Da=0,Ka=0,Ra=0,Ba=0,Fa=0,Oa=0,_a=0,Ca=0,Ha=0,ja=0,qa=0,Ga=0,Na=0,Pa=0,Sa=0,Va=0,Za=0,Qa=0,Ta=0,Ja=0,Ya=0,Wa=0,za=0,Xa=0,$a=0,Ao=0,eo=0,ro=0,no=0,to=0,io=0,ao=0,oo=0,fo=0,uo=0,co=0,so=0,lo=0,wo=0,ho=0,vo=0,yo=0,po=0,go=0,bo=0,mo=0,Mo=0,ko=0,Uo=0,Lo=0,Io=0,xo=0,Eo=0,Do=0,Ko=0,Ro=0,Bo=0,Fo=0,Oo=0,_o=0,Co=0,Ho=0,jo=0,qo=0,Go=0,No=0,Po=0,So=0,Vo=0,Zo=0,Qo=0,To=0,Jo=0,Yo=0,Wo=0,zo=0,Xo=0,$o=0,Af=0,ef=0,rf=0,nf=0,tf=0,af=0,of=0,ff=0,uf=0,cf=0,sf=0,lf=0,wf=0,hf=0,vf=0,df=0,yf=0,pf=0,gf=0,bf=0,mf=0,Mf=0,kf=0,Uf=0,Lf=0,If=0,xf=0,Ef=0,Df=0,Kf=0,Rf=0,Bf=0,Ff=0,Of=0,_f=0,Cf=0,Hf=0,jf=0,qf=0,Gf=0,Nf=0,Pf=0,Sf=0,Vf=0,Zf=0,Qf=0,Tf=0,Jf=0,Yf=0,Wf=0,zf=0,Xf=0,$f=0,Au=0,eu=0,ru=0,nu=0,tu=0,iu=0,au=0,ou=0,fu=0,uu=0,cu=0,su=0,lu=0,wu=0,hu=0,vu=0,du=0,yu=0,pu=0,gu=0,bu=0,mu=0,Mu=0,ku=0,Uu=0,Lu=0,Iu=0,xu=0,Eu=0,Du=0,Ku=0,Ru=0,Bu=0,Fu=0,Ou=0,_u=0,Cu=0,Hu=0,ju=0,qu=0,Gu=0,Nu=0,Pu=0,Su=0,Vu=0;ct=r<<1;Ba=A+((r<<5)+-16<<2)|0;if(!ct)return;Tt=r<<4;t=n[Ba>>2]|0;i=n[Ba+4>>2]|0;a=n[Ba+8>>2]|0;o=n[Ba+12>>2]|0;f=n[Ba+16>>2]|0;u=n[Ba+20>>2]|0;c=n[Ba+24>>2]|0;s=n[Ba+28>>2]|0;l=n[Ba+32>>2]|0;w=n[Ba+36>>2]|0;h=n[Ba+40>>2]|0;v=n[Ba+44>>2]|0;d=n[Ba+48>>2]|0;y=n[Ba+52>>2]|0;p=n[Ba+56>>2]|0;g=n[Ba+60>>2]|0;b=0;do{Xt=b<<4;ni=A+(Xt<<2)|0;li=n[ni>>2]^t;Li=n[ni+4>>2]^i;ji=n[ni+8>>2]^a;zi=n[ni+12>>2]^o;ca=n[ni+16>>2]^f;ka=n[ni+20>>2]^u;Ha=n[ni+24>>2]^c;Wa=n[ni+28>>2]^s;fo=n[ni+32>>2]^l;mo=n[ni+36>>2]^w;Bo=n[ni+40>>2]^h;Wo=n[ni+44>>2]^v;ff=n[ni+48>>2]^d;gf=n[ni+52>>2]^y;Bf=n[ni+56>>2]^p;Zf=n[ni+60>>2]^g;Wf=ff+li|0;wu=(Wf<<7|Wf>>>25)^ca;pu=wu+li|0;_u=(pu<<9|pu>>>23)^fo;Gu=_u+wu|0;F=(Gu<<13|Gu>>>19)^ff;j=F+_u|0;eA=(j<<18|j>>>14)^li;aA=ka+Li|0;kA=mo^(aA<<7|aA>>>25);EA=kA+ka|0;ZA=gf^(EA<<9|EA>>>23);WA=ZA+kA|0;we=(WA<<13|WA>>>19)^Li;pe=we+ZA|0;_e=(pe<<18|pe>>>14)^ka;Ge=Bo+Ha|0;nr=Bf^(Ge<<7|Ge>>>25);fr=nr+Bo|0;Lr=(fr<<9|fr>>>23)^ji;Kr=Lr+nr|0;Zr=(Kr<<13|Kr>>>19)^Ha;Yr=Zr+Lr|0;en=(Yr<<18|Yr>>>14)^Bo;rn=Zf+Wo|0;nn=(rn<<7|rn>>>25)^zi;tn=nn+Zf|0;an=(tn<<9|tn>>>23)^Wa;on=an+nn|0;fn=(on<<13|on>>>19)^Wo;un=fn+an|0;cn=(un<<18|un>>>14)^Zf;sn=eA+nn|0;ln=(sn<<7|sn>>>25)^we;wn=ln+eA|0;hn=(wn<<9|wn>>>23)^Lr;vn=hn+ln|0;dn=(vn<<13|vn>>>19)^nn;yn=dn+hn|0;pn=(yn<<18|yn>>>14)^eA;gn=_e+wu|0;bn=(gn<<7|gn>>>25)^Zr;mn=bn+_e|0;Mn=(mn<<9|mn>>>23)^an;kn=Mn+bn|0;Un=(kn<<13|kn>>>19)^wu;Ln=Un+Mn|0;In=(Ln<<18|Ln>>>14)^_e;xn=en+kA|0;En=(xn<<7|xn>>>25)^fn;Dn=En+en|0;Kn=(Dn<<9|Dn>>>23)^_u;Rn=Kn+En|0;Bn=(Rn<<13|Rn>>>19)^kA;Fn=Bn+Kn|0;On=(Fn<<18|Fn>>>14)^en;_n=cn+nr|0;Cn=(_n<<7|_n>>>25)^F;Hn=Cn+cn|0;jn=(Hn<<9|Hn>>>23)^ZA;qn=jn+Cn|0;Gn=(qn<<13|qn>>>19)^nr;Nn=Gn+jn|0;Pn=(Nn<<18|Nn>>>14)^cn;Sn=pn+Cn|0;Vn=(Sn<<7|Sn>>>25)^Un;Zn=Vn+pn|0;Qn=(Zn<<9|Zn>>>23)^Kn;Tn=Qn+Vn|0;Jn=(Tn<<13|Tn>>>19)^Cn;Yn=Jn+Qn|0;Wn=(Yn<<18|Yn>>>14)^pn;zn=In+ln|0;Xn=(zn<<7|zn>>>25)^Bn;$n=Xn+In|0;At=($n<<9|$n>>>23)^jn;et=At+Xn|0;rt=(et<<13|et>>>19)^ln;nt=rt+At|0;tt=(nt<<18|nt>>>14)^In;it=On+bn|0;at=(it<<7|it>>>25)^Gn;ot=at+On|0;ft=(ot<<9|ot>>>23)^hn;ut=ft+at|0;st=(ut<<13|ut>>>19)^bn;lt=st+ft|0;wt=(lt<<18|lt>>>14)^On;ht=Pn+En|0;vt=(ht<<7|ht>>>25)^dn;dt=vt+Pn|0;yt=(dt<<9|dt>>>23)^Mn;pt=yt+vt|0;gt=(pt<<13|pt>>>19)^En;bt=gt+yt|0;mt=(bt<<18|bt>>>14)^Pn;Mt=Wn+vt|0;kt=(Mt<<7|Mt>>>25)^rt;Ut=kt+Wn|0;Lt=(Ut<<9|Ut>>>23)^ft;It=Lt+kt|0;xt=(It<<13|It>>>19)^vt;Et=xt+Lt|0;Dt=(Et<<18|Et>>>14)^Wn;Kt=tt+Vn|0;Rt=(Kt<<7|Kt>>>25)^st;Bt=Rt+tt|0;Ft=(Bt<<9|Bt>>>23)^yt;Ot=Ft+Rt|0;_t=(Ot<<13|Ot>>>19)^Vn;Ct=_t+Ft|0;Ht=(Ct<<18|Ct>>>14)^tt;jt=wt+Xn|0;qt=(jt<<7|jt>>>25)^gt;Gt=qt+wt|0;Nt=(Gt<<9|Gt>>>23)^Qn;Pt=Nt+qt|0;St=(Pt<<13|Pt>>>19)^Xn;Vt=St+Nt|0;Zt=(Vt<<18|Vt>>>14)^wt;Qt=mt+at|0;Jt=(Qt<<7|Qt>>>25)^Jn;Yt=Jt+mt|0;Wt=(Yt<<9|Yt>>>23)^At;zt=Wt+Jt|0;$t=(zt<<13|zt>>>19)^at;Ai=$t+Wt|0;ei=(Ai<<18|Ai>>>14)^mt;ri=Dt+Jt|0;ti=(ri<<7|ri>>>25)^_t;ii=ti+Dt|0;ai=(ii<<9|ii>>>23)^Nt;oi=ai+ti|0;fi=(oi<<13|oi>>>19)^Jt;ui=fi+ai|0;ci=(ui<<18|ui>>>14)^Dt;si=Ht+kt|0;wi=(si<<7|si>>>25)^St;hi=wi+Ht|0;vi=(hi<<9|hi>>>23)^Wt;di=vi+wi|0;yi=(di<<13|di>>>19)^kt;pi=yi+vi|0;gi=(pi<<18|pi>>>14)^Ht;bi=Zt+Rt|0;mi=(bi<<7|bi>>>25)^$t;Mi=mi+Zt|0;ki=(Mi<<9|Mi>>>23)^Lt;Ui=ki+mi|0;Ii=(Ui<<13|Ui>>>19)^Rt;xi=Ii+ki|0;Ei=(xi<<18|xi>>>14)^Zt;Di=ei+qt|0;Ki=(Di<<7|Di>>>25)^xt;Ri=Ki+ei|0;Bi=(Ri<<9|Ri>>>23)^Ft;Fi=Bi+Ki|0;Oi=(Fi<<13|Fi>>>19)^qt;_i=Oi+Bi|0;Ci=(_i<<18|_i>>>14)^ei;Hi=ci+Ki|0;qi=(Hi<<7|Hi>>>25)^yi;Gi=qi+ci|0;Ni=(Gi<<9|Gi>>>23)^ki;Pi=Ni+qi|0;Si=(Pi<<13|Pi>>>19)^Ki;Vi=Si+Ni|0;Zi=(Vi<<18|Vi>>>14)^ci;Qi=gi+ti|0;Ti=(Qi<<7|Qi>>>25)^Ii;Ji=Ti+gi|0;Yi=(Ji<<9|Ji>>>23)^Bi;Wi=Yi+Ti|0;Xi=(Wi<<13|Wi>>>19)^ti;$i=Xi+Yi|0;Aa=($i<<18|$i>>>14)^gi;ea=Ei+wi|0;ra=(ea<<7|ea>>>25)^Oi;na=ra+Ei|0;ta=(na<<9|na>>>23)^ai;ia=ta+ra|0;aa=(ia<<13|ia>>>19)^wi;oa=aa+ta|0;fa=(oa<<18|oa>>>14)^Ei;ua=Ci+mi|0;sa=(ua<<7|ua>>>25)^fi;la=sa+Ci|0;wa=(la<<9|la>>>23)^vi;ha=wa+sa|0;va=(ha<<13|ha>>>19)^mi;da=va+wa|0;ya=(da<<18|da>>>14)^Ci;pa=Zi+sa|0;ga=(pa<<7|pa>>>25)^Xi;ba=ga+Zi|0;ma=(ba<<9|ba>>>23)^ta;Ma=ma+ga|0;Ua=(Ma<<13|Ma>>>19)^sa;La=Ua+ma|0;Ia=(La<<18|La>>>14)^Zi;xa=Aa+qi|0;Ea=(xa<<7|xa>>>25)^aa;Da=Ea+Aa|0;Ka=(Da<<9|Da>>>23)^wa;Ra=Ka+Ea|0;Fa=(Ra<<13|Ra>>>19)^qi;Oa=Fa+Ka|0;_a=(Oa<<18|Oa>>>14)^Aa;Ca=fa+Ti|0;ja=(Ca<<7|Ca>>>25)^va;qa=ja+fa|0;Ga=(qa<<9|qa>>>23)^Ni;Na=Ga+ja|0;Pa=(Na<<13|Na>>>19)^Ti;Sa=Pa+Ga|0;Va=(Sa<<18|Sa>>>14)^fa;Za=ya+ra|0;Qa=(Za<<7|Za>>>25)^Si;Ta=Qa+ya|0;Ja=(Ta<<9|Ta>>>23)^Yi;Ya=Ja+Qa|0;za=(Ya<<13|Ya>>>19)^ra;Xa=za+Ja|0;$a=(Xa<<18|Xa>>>14)^ya;Ao=Ia+Qa|0;eo=(Ao<<7|Ao>>>25)^Fa;ro=eo+Ia|0;no=(ro<<9|ro>>>23)^Ga;to=no+eo|0;io=(to<<13|to>>>19)^Qa;ao=io+no|0;oo=_a+ga|0;uo=(oo<<7|oo>>>25)^Pa;co=uo+_a|0;so=(co<<9|co>>>23)^Ja;lo=so+uo|0;wo=(lo<<13|lo>>>19)^ga;ho=wo+so|0;vo=Va+Ea|0;yo=(vo<<7|vo>>>25)^za;po=yo+Va|0;go=(po<<9|po>>>23)^ma;bo=go+yo|0;Mo=(bo<<13|bo>>>19)^Ea;ko=Mo+go|0;Uo=$a+ja|0;Lo=(Uo<<7|Uo>>>25)^Ua;Io=Lo+$a|0;xo=(Io<<9|Io>>>23)^Ka;Eo=xo+Lo|0;Do=(Eo<<13|Eo>>>19)^ja;Ko=Do+xo|0;Ro=((ao<<18|ao>>>14)^Ia)+li|0;Fo=eo+Li|0;Oo=no+ji|0;_o=io+zi|0;Co=wo+ca|0;Ho=((ho<<18|ho>>>14)^_a)+ka|0;jo=uo+Ha|0;qo=so+Wa|0;Go=go+fo|0;No=Mo+mo|0;Po=((ko<<18|ko>>>14)^Va)+Bo|0;So=yo+Wo|0;Vo=Lo+ff|0;Zo=xo+gf|0;Qo=Do+Bf|0;To=((Ko<<18|Ko>>>14)^$a)+Zf|0;Jo=b<<3;Yo=e+(Jo<<2)|0;n[Yo>>2]=Ro;n[Yo+4>>2]=Fo;n[Yo+8>>2]=Oo;n[Yo+12>>2]=_o;n[Yo+16>>2]=Co;n[Yo+20>>2]=Ho;n[Yo+24>>2]=jo;n[Yo+28>>2]=qo;n[Yo+32>>2]=Go;n[Yo+36>>2]=No;n[Yo+40>>2]=Po;n[Yo+44>>2]=So;n[Yo+48>>2]=Vo;n[Yo+52>>2]=Zo;n[Yo+56>>2]=Qo;n[Yo+60>>2]=To;zo=A+((Xt|16)<<2)|0;Xo=Ro^n[zo>>2];$o=Fo^n[zo+4>>2];Af=Oo^n[zo+8>>2];ef=_o^n[zo+12>>2];rf=Co^n[zo+16>>2];nf=Ho^n[zo+20>>2];tf=jo^n[zo+24>>2];af=qo^n[zo+28>>2];of=Go^n[zo+32>>2];uf=No^n[zo+36>>2];cf=Po^n[zo+40>>2];sf=So^n[zo+44>>2];lf=Vo^n[zo+48>>2];wf=Zo^n[zo+52>>2];hf=Qo^n[zo+56>>2];vf=To^n[zo+60>>2];df=Xo+lf|0;yf=(df<<7|df>>>25)^rf;pf=yf+Xo|0;bf=(pf<<9|pf>>>23)^of;mf=bf+yf|0;Mf=(mf<<13|mf>>>19)^lf;kf=Mf+bf|0;Uf=(kf<<18|kf>>>14)^Xo;Lf=nf+$o|0;If=(Lf<<7|Lf>>>25)^uf;xf=If+nf|0;Ef=(xf<<9|xf>>>23)^wf;Df=Ef+If|0;Kf=(Df<<13|Df>>>19)^$o;Rf=Kf+Ef|0;Ff=(Rf<<18|Rf>>>14)^nf;Of=cf+tf|0;_f=(Of<<7|Of>>>25)^hf;Cf=_f+cf|0;Hf=(Cf<<9|Cf>>>23)^Af;jf=Hf+_f|0;qf=(jf<<13|jf>>>19)^tf;Gf=qf+Hf|0;Nf=(Gf<<18|Gf>>>14)^cf;Pf=vf+sf|0;Sf=(Pf<<7|Pf>>>25)^ef;Vf=Sf+vf|0;Qf=(Vf<<9|Vf>>>23)^af;Tf=Qf+Sf|0;Jf=(Tf<<13|Tf>>>19)^sf;Yf=Jf+Qf|0;zf=(Yf<<18|Yf>>>14)^vf;Xf=Uf+Sf|0;$f=(Xf<<7|Xf>>>25)^Kf;Au=$f+Uf|0;eu=(Au<<9|Au>>>23)^Hf;ru=eu+$f|0;nu=(ru<<13|ru>>>19)^Sf;tu=nu+eu|0;iu=(tu<<18|tu>>>14)^Uf;au=Ff+yf|0;ou=(au<<7|au>>>25)^qf;fu=ou+Ff|0;uu=(fu<<9|fu>>>23)^Qf;cu=uu+ou|0;su=(cu<<13|cu>>>19)^yf;lu=su+uu|0;hu=(lu<<18|lu>>>14)^Ff;vu=Nf+If|0;du=(vu<<7|vu>>>25)^Jf;yu=du+Nf|0;gu=(yu<<9|yu>>>23)^bf;bu=gu+du|0;mu=(bu<<13|bu>>>19)^If;Mu=mu+gu|0;ku=(Mu<<18|Mu>>>14)^Nf;Uu=zf+_f|0;Lu=(Uu<<7|Uu>>>25)^Mf;Iu=Lu+zf|0;xu=(Iu<<9|Iu>>>23)^Ef;Eu=xu+Lu|0;Du=(Eu<<13|Eu>>>19)^_f;Ku=Du+xu|0;Ru=(Ku<<18|Ku>>>14)^zf;Bu=iu+Lu|0;Fu=(Bu<<7|Bu>>>25)^su;Ou=Fu+iu|0;Cu=(Ou<<9|Ou>>>23)^gu;Hu=Cu+Fu|0;ju=(Hu<<13|Hu>>>19)^Lu;qu=ju+Cu|0;Nu=(qu<<18|qu>>>14)^iu;Pu=hu+$f|0;Su=(Pu<<7|Pu>>>25)^mu;Vu=Su+hu|0;m=(Vu<<9|Vu>>>23)^xu;M=m+Su|0;k=(M<<13|M>>>19)^$f;U=k+m|0;L=(U<<18|U>>>14)^hu;I=ku+ou|0;x=(I<<7|I>>>25)^Du;E=x+ku|0;D=(E<<9|E>>>23)^eu;K=D+x|0;R=(K<<13|K>>>19)^ou;B=R+D|0;O=(B<<18|B>>>14)^ku;_=Ru+du|0;C=(_<<7|_>>>25)^nu;H=C+Ru|0;q=(H<<9|H>>>23)^uu;G=q+C|0;N=(G<<13|G>>>19)^du;P=N+q|0;S=(P<<18|P>>>14)^Ru;V=Nu+C|0;Z=(V<<7|V>>>25)^k;Q=Z+Nu|0;T=(Q<<9|Q>>>23)^D;J=T+Z|0;Y=(J<<13|J>>>19)^C;W=Y+T|0;z=(W<<18|W>>>14)^Nu;X=L+Fu|0;$=(X<<7|X>>>25)^R;AA=$+L|0;rA=(AA<<9|AA>>>23)^q;nA=rA+$|0;tA=(nA<<13|nA>>>19)^Fu;iA=tA+rA|0;oA=(iA<<18|iA>>>14)^L;fA=O+Su|0;uA=(fA<<7|fA>>>25)^N;cA=uA+O|0;sA=(cA<<9|cA>>>23)^Cu;lA=sA+uA|0;wA=(lA<<13|lA>>>19)^Su;hA=wA+sA|0;vA=(hA<<18|hA>>>14)^O;dA=S+x|0;yA=(dA<<7|dA>>>25)^ju;pA=yA+S|0;gA=(pA<<9|pA>>>23)^m;bA=gA+yA|0;mA=(bA<<13|bA>>>19)^x;MA=mA+gA|0;UA=(MA<<18|MA>>>14)^S;LA=z+yA|0;IA=(LA<<7|LA>>>25)^tA;xA=IA+z|0;DA=(xA<<9|xA>>>23)^sA;KA=DA+IA|0;RA=(KA<<13|KA>>>19)^yA;BA=RA+DA|0;FA=(BA<<18|BA>>>14)^z;OA=oA+Z|0;_A=(OA<<7|OA>>>25)^wA;CA=_A+oA|0;HA=(CA<<9|CA>>>23)^gA;jA=HA+_A|0;qA=(jA<<13|jA>>>19)^Z;GA=qA+HA|0;NA=(GA<<18|GA>>>14)^oA;PA=vA+$|0;SA=(PA<<7|PA>>>25)^mA;VA=SA+vA|0;QA=(VA<<9|VA>>>23)^T;TA=QA+SA|0;JA=(TA<<13|TA>>>19)^$;YA=JA+QA|0;zA=(YA<<18|YA>>>14)^vA;XA=UA+uA|0;$A=(XA<<7|XA>>>25)^Y;Ae=$A+UA|0;ee=(Ae<<9|Ae>>>23)^rA;re=ee+$A|0;ne=(re<<13|re>>>19)^uA;te=ne+ee|0;ie=(te<<18|te>>>14)^UA;ae=FA+$A|0;oe=(ae<<7|ae>>>25)^qA;fe=oe+FA|0;ue=(fe<<9|fe>>>23)^QA;ce=ue+oe|0;se=(ce<<13|ce>>>19)^$A;le=se+ue|0;he=(le<<18|le>>>14)^FA;ve=NA+IA|0;de=(ve<<7|ve>>>25)^JA;ye=de+NA|0;ge=(ye<<9|ye>>>23)^ee;be=ge+de|0;me=(be<<13|be>>>19)^IA;Me=me+ge|0;ke=(Me<<18|Me>>>14)^NA;Ue=zA+_A|0;Le=(Ue<<7|Ue>>>25)^ne;Ie=Le+zA|0;xe=(Ie<<9|Ie>>>23)^DA;Ee=xe+Le|0;De=(Ee<<13|Ee>>>19)^_A;Ke=De+xe|0;Re=(Ke<<18|Ke>>>14)^zA;Be=ie+SA|0;Fe=(Be<<7|Be>>>25)^RA;Oe=Fe+ie|0;Ce=(Oe<<9|Oe>>>23)^HA;He=Ce+Fe|0;je=(He<<13|He>>>19)^SA;qe=je+Ce|0;Ne=(qe<<18|qe>>>14)^ie;Pe=he+Fe|0;Se=(Pe<<7|Pe>>>25)^me;Ve=Se+he|0;Ze=(Ve<<9|Ve>>>23)^xe;Qe=Ze+Se|0;Te=(Qe<<13|Qe>>>19)^Fe;Je=Te+Ze|0;Ye=(Je<<18|Je>>>14)^he;We=ke+oe|0;ze=(We<<7|We>>>25)^De;Xe=ze+ke|0;$e=(Xe<<9|Xe>>>23)^Ce;Ar=$e+ze|0;er=(Ar<<13|Ar>>>19)^oe;rr=er+$e|0;tr=(rr<<18|rr>>>14)^ke;ir=Re+de|0;ar=(ir<<7|ir>>>25)^je;or=ar+Re|0;ur=(or<<9|or>>>23)^ue;cr=ur+ar|0;sr=(cr<<13|cr>>>19)^de;lr=sr+ur|0;wr=(lr<<18|lr>>>14)^Re;hr=Ne+Le|0;vr=(hr<<7|hr>>>25)^se;dr=vr+Ne|0;yr=(dr<<9|dr>>>23)^ge;pr=yr+vr|0;gr=(pr<<13|pr>>>19)^Le;br=gr+yr|0;mr=(br<<18|br>>>14)^Ne;Mr=Ye+vr|0;kr=(Mr<<7|Mr>>>25)^er;Ur=kr+Ye|0;Ir=(Ur<<9|Ur>>>23)^ur;xr=Ir+kr|0;Er=(xr<<13|xr>>>19)^vr;Dr=Er+Ir|0;Rr=tr+Se|0;Br=(Rr<<7|Rr>>>25)^sr;Fr=Br+tr|0;Or=(Fr<<9|Fr>>>23)^yr;_r=Or+Br|0;Cr=(_r<<13|_r>>>19)^Se;Hr=Cr+Or|0;jr=wr+ze|0;qr=(jr<<7|jr>>>25)^gr;Gr=qr+wr|0;Nr=(Gr<<9|Gr>>>23)^Ze;Pr=Nr+qr|0;Sr=(Pr<<13|Pr>>>19)^ze;Vr=Sr+Nr|0;Qr=mr+ar|0;Tr=(Qr<<7|Qr>>>25)^Te;Jr=Tr+mr|0;Wr=(Jr<<9|Jr>>>23)^$e;zr=Wr+Tr|0;Xr=(zr<<13|zr>>>19)^ar;$r=Xr+Wr|0;t=((Dr<<18|Dr>>>14)^Ye)+Xo|0;i=kr+$o|0;a=Ir+Af|0;o=Er+ef|0;f=Cr+rf|0;u=((Hr<<18|Hr>>>14)^tr)+nf|0;c=Br+tf|0;s=Or+af|0;l=Nr+of|0;w=Sr+uf|0;h=((Vr<<18|Vr>>>14)^wr)+cf|0;v=qr+sf|0;d=Tr+lf|0;y=Wr+wf|0;p=Xr+hf|0;g=(($r<<18|$r>>>14)^mr)+vf|0;An=e+(Jo+Tt<<2)|0;n[An>>2]=t;n[An+4>>2]=i;n[An+8>>2]=a;n[An+12>>2]=o;n[An+16>>2]=f;n[An+20>>2]=u;n[An+24>>2]=c;n[An+28>>2]=s;n[An+32>>2]=l;n[An+36>>2]=w;n[An+40>>2]=h;n[An+44>>2]=v;n[An+48>>2]=d;n[An+52>>2]=y;n[An+56>>2]=p;n[An+60>>2]=g;b=b+2|0}while(b>>>0<ct>>>0);return}return{_SMix:o}};return{create:A,getHeap:e}}function e(){"use strict";function A(A){for(var e=new Uint8Array(A),n=atob("mC+KQpFEN3HP+8C1pdu16VvCVjnxEfFZpII/ktVeHKuYqgfYAVuDEr6FMSTDfQxVdF2+cv6x3oCnBtybdPGbwcFpm+SGR77vxp3BD8yhDCRvLOktqoR0StypsFzaiPl2UlE+mG3GMajIJwOwx39Zv/ML4MZHkafVUWPKBmcpKRSFCrcnOCEbLvxtLE0TDThTVHMKZbsKanYuycKBhSxykqHov6JLZhqocItLwqNRbMcZ6JLRJAaZ1oU1DvRwoGoQFsGkGQhsNx5Md0gntbywNLMMHDlKqthOT8qcW/NvLmjugo90b2OleBR4yIQIAseM+v++kOtsUKT3o/m+8nhxxgUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAYAcAAAAEAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAr/////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAQAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="),t=8,i=0;i<n.length;i++)e[t+i]=n.charCodeAt(i);return r(self,{},A)}function e(){return 8636}var r=function(A,e,r){"use asm";var n=new A.Int32Array(r),t=new A.Int8Array(r),i=new A.Uint8Array(r);function a(A,e,r,i,a,u){A=A|0;e=e|0;r=r|0;i=i|0;a=a|0;u=u|0;var s=0,l=0,w=0,h=0,v=0,d=0,y=0,p=0,g=0,b=0,m=0;if(e>>>0>64){n[191]=0;n[183]=1779033703;n[184]=-1150833019;n[185]=1013904242;n[186]=-1521486534;n[187]=1359893119;n[188]=-1694144372;n[189]=528734635;n[190]=1541459225;o(732,A,e);c(1816,732);l=1816;w=32}else{l=A;w=e}n[191]=0;n[183]=1779033703;n[184]=-1150833019;n[185]=1013904242;n[186]=-1521486534;n[187]=1359893119;n[188]=-1694144372;n[189]=528734635;n[190]=1541459225;g=1752;m=g+64|0;do{t[g>>0]=54;g=g+1|0}while((g|0)<(m|0));if(!w)h=1;else{t[1752]=t[l>>0]^54;if((w|0)==1)h=0;else{t[1753]=t[l+1>>0]^54;if((w|0)==2)h=0;else{t[1754]=t[l+2>>0]^54;if((w|0)==3)h=0;else{v=3;do{t[1752+v>>0]=t[l+v>>0]^t[1752+v>>0];v=v+1|0}while((v|0)!=(w|0));h=0}}}}o(732,1752,64);n[216]=0;n[208]=1779033703;n[209]=-1150833019;n[210]=1013904242;n[211]=-1521486534;n[212]=1359893119;n[213]=-1694144372;n[214]=528734635;n[215]=1541459225;g=1752;m=g+64|0;do{t[g>>0]=92;g=g+1|0}while((g|0)<(m|0));if(!h){t[1752]=t[l>>0]^92;if((w|0)!=1){t[1753]=t[l+1>>0]^92;if((w|0)!=2){t[1754]=t[l+2>>0]^92;if((w|0)!=3){d=3;do{t[1752+d>>0]=t[l+d>>0]^t[1752+d>>0];d=d+1|0}while((d|0)!=(w|0))}}}}o(832,1752,64);o(732,r,i);if(u|0){s=0;p=0;do{s=s+1|0;t[1687]=s;t[1686]=s>>>8;t[1685]=s>>>16;t[1684]=s>>>24;f(932,732,200)|0;o(932,1684,4);c(1848,932);o(1032,1848,32);c(1688,1032);g=1720;b=1688;m=g+32|0;do{t[g>>0]=t[b>>0]|0;g=g+1|0;b=b+1|0}while((g|0)<(m|0));y=u-p|0;f(a+p|0,1720,(y>>>0>32?32:y)|0)|0;p=s<<5}while(p>>>0<u>>>0)}return}function o(A,e,r){A=A|0;e=e|0;r=r|0;var t=0,i=0,a=0,o=0,c=0,s=0,l=0,w=0,h=0,v=0,d=0,y=0,p=0,g=0,b=0;do if(r|0){p=A+32|0;g=n[p>>2]|0;b=g>>>3&63;n[p>>2]=g+(r<<3);c=64-b|0;s=A+36+b|0;if(c>>>0>r>>>0){f(s|0,e|0,r|0)|0;break}f(s|0,e|0,c|0)|0;l=A+36|0;u(A,l);w=e+c|0;h=r-c|0;if(h>>>0>63){v=b+r+-128|0;d=v&-64;y=d+128-b|0;a=h;o=w;while(1){u(A,o);a=a+-64|0;if(a>>>0<=63)break;else o=o+64|0}t=e+y|0;i=v-d|0}else{t=w;i=h}f(l|0,t|0,i|0)|0}while(0);return}function f(A,e,r){A=A|0;e=e|0;r=r|0;var i=0;i=A|0;if((A&3)==(e&3)){while(A&3){if(!r)return i|0;t[A>>0]=t[e>>0]|0;A=A+1|0;e=e+1|0;r=r-1|0}while((r|0)>=4){n[A>>2]=n[e>>2];A=A+4|0;e=e+4|0;r=r-4|0}}while((r|0)>0){t[A>>0]=t[e>>0]|0;A=A+1|0;e=e+1|0;r=r-1|0}return i|0}function u(A,e){A=A|0;e=e|0;var r=0,t=0,a=0,o=0,f=0,u=0,c=0,s=0,l=0,w=0,h=0,v=0,d=0,y=0,p=0,g=0,b=0;r=0;do{w=e+(r<<2)|0;n[444+(r<<2)>>2]=(i[w+2>>0]|0)<<8|(i[w+3>>0]|0)|(i[w+1>>0]|0)<<16|(i[w>>0]|0)<<24;r=r+1|0}while((r|0)!=16);t=16;h=n[111]|0;do{l=n[444+(t+-2<<2)>>2]|0;b=h;h=n[444+(t+-15<<2)>>2]|0;n[444+(t<<2)>>2]=b+(n[444+(t+-7<<2)>>2]|0)+((l>>>19|l<<13)^l>>>10^(l>>>17|l<<15))+((h>>>18|h<<14)^h>>>3^(h>>>7|h<<25));t=t+1|0}while((t|0)!=64);n[175]=n[A>>2];n[176]=n[A+4>>2];n[177]=n[A+8>>2];n[178]=n[A+12>>2];n[179]=n[A+16>>2];n[180]=n[A+20>>2];n[181]=n[A+24>>2];n[182]=n[A+28>>2];a=0;do{v=700+(((71-a|0)%8|0)<<2)|0;d=n[700+(((68-a|0)%8|0)<<2)>>2]|0;y=n[700+(((70-a|0)%8|0)<<2)>>2]|0;p=(n[444+(a<<2)>>2]|0)+(n[v>>2]|0)+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(n[8+(a<<2)>>2]|0)+((y^n[700+(((69-a|0)%8|0)<<2)>>2])&d^y)|0;g=n[700+(((64-a|0)%8|0)<<2)>>2]|0;f=n[700+(((65-a|0)%8|0)<<2)>>2]|0;u=n[700+(((66-a|0)%8|0)<<2)>>2]|0;c=700+(((67-a|0)%8|0)<<2)|0;n[c>>2]=(n[c>>2]|0)+p;n[v>>2]=((g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10))+p+((u|f)&g|u&f);a=a+1|0}while((a|0)!=64);o=0;do{s=A+(o<<2)|0;n[s>>2]=(n[s>>2]|0)+(n[700+(o<<2)>>2]|0);o=o+1|0}while((o|0)!=8);return}function c(A,e){A=A|0;e=e|0;var r=0,i=0,a=0,f=0,u=0;u=n[e+32>>2]|0;t[1139]=u;t[1138]=u>>>8;t[1137]=u>>>16;t[1136]=u>>>24;i=u>>>3&63;n[283]=0;o(e,380,(i>>>0<56?56:120)-i|0);o(e,1132,8);r=0;do{a=A+(r<<2)|0;f=n[e+(r<<2)>>2]|0;t[a+3>>0]=f;t[a+2>>0]=f>>>8;t[a+1>>0]=f>>>16;t[a>>0]=f>>>24;r=r+1|0}while((r|0)!=8);return}return{_PBKDF2_OneIter:a}};return{create:A,getHeap:e}}var r,n=function(){"use strict";function e(){}function r(A,r){u=A,c=r,f=128*r,o=d+f;var n=d+f*(3+A),t=16777216*Math.ceil(n/16777216);if(!s||s.byteLength<t){try{s=new ArrayBuffer(t)}catch(A){return!1}l=new Uint8Array(s),p=y.create(s),e()}return!0}function n(A){var e=new Uint8Array(A);l.set(e,d),h=262144/c,w=0,v=!0}function t(A){h=h*A>>1<<1}function i(){var A,e=h,r=w,n=r+e,i=0;switch(n>=u&&(n=u,e=n-r,i=v?1:2),2!=i&&g(e),0==i&&(A=b()),p._SMix(u,c,d,o,v?0:1,r,n),i){case 0:A=b()-A,w=n,t(100/A);break;case 1:w=0,v=!1,t(.7);break;case 2:var a=s.slice(d,d+f);g({state:"done",step:e,output:a},[a])}}function a(A){var e=A.data;if(e===!0)return void i();switch(e.cmd){case"task":n(e.input),i();break;case"config":var t=r(e.N,e.r);g({state:t?"ready":"fail"});break;case"free":p=l=s=null}}var o,f,u,c,s,l,w,h,v,d=64,y=A(),p=null,g=self.postMessage,b=Date.now;addEventListener("message",a)};!function(r){function t(A,e,r,n,t,i,a){L=128*e,h=r,E=r*A*2,I=n,K=0;var o=O.getHeap();p=o,o+=t,g=o,o+=i,b=o,o+=a,m=o,o+=L*r,o=65536*Math.ceil(o/65536),(!d||d.byteLength<o)&&(d=new ArrayBuffer(o),y=new Uint8Array(d),_=O.create(d)),v||(v=u());for(var f=0;f<I;f++){var c=C[f];c||(c=new Worker(v),c.onmessage=s,c.tag=0,C[f]=c),c.postMessage({cmd:"config",N:A,r:e})}}function i(A,e,r){y.set(A,p),y.set(e,g),M=A.length,k=e.length,U=r,x=!0,D=0,R=0,B=0,_._PBKDF2_OneIter(p,M,g,k,m,L*h);for(var n=0;n<I;n++)l(C[n])}function a(){x=!1}function o(){C.forEach(function(A){A.postMessage({cmd:"free"})})}function f(){C.forEach(function(A){A.terminate()}),C=[],d=y=O=null,URL.revokeObjectURL(v)}function u(){var e="("+n+")();"+A,r=new Blob([e],{type:"text/javascript"});return URL.createObjectURL(r)}function c(){_._PBKDF2_OneIter(p,M,m,L*h,b,U>32?U:32);var A=new Uint8Array(d,b,U);x=!1,w("oncomplete",A)}function s(A){var e=this,r=A.data;if("number"==typeof r){if(!x)return;e.postMessage(!0),D+=r;var n=Date.now();return n-F>50&&w("onprogress",D/E),void(F=n)}switch(r.state){case"done":if(!x)return;var t=new Uint8Array(r.output),i=e.tag;y.set(t,m+L*i),D+=r.step,++B==h?c():R<h&&l(e);break;case"ready":++K==I&&w("onready");break;case"fail":w("onerror","memory alloc fail")}}function l(A){var e=m+R*L,r=d.slice(e,e+L);A.tag=R++,A.postMessage({cmd:"task",input:r},[r])}function w(A,e){var r=window.scrypt;r&&r.__asmjs_cb(A,e)}var h,v,d,y,p,g,b,m,M,k,U,L,I,x,E,D,K,R,B,F,O=e(),_=null,C=[];r.config=t,r.hash=i,r.stop=a,r.free=o,r.unload=f,w("onload",r)}(r||(r={}))}();
//# sourceMappingURL=../sourcemap/asmjs.js.map
///END ASM.JS
`,r=new Blob([e],{type:"text/javascript"});await import(URL.createObjectURL(r))}catch{u.onerror("script load fail")}}()}function p(z,e,r){b.hash(z,e,r)}function g(z,e,r,s,c,d,_){b.config.apply(this,arguments)}function y(){b.stop()}function v(){b.free()}function S(){b&&(b.unload(),b=null)}function U(z,e){z=="onload"&&(b=e),u[z](e),z==="onload"&&delete globalThis.scrypt_loader_9470f487e3aa154f278269e99e6a42502ca77b8da3867a46a548909659a3db4a}var b;u.check=h,u.load=o,u.hash=p,u.config=g,u.stop=y,u.free=v,u.unload=S})(a||(a={}));var l,f;(function(u){function h(){return"asmjs"}function o(O,H){if(O)switch(arguments.length){case 1:return O();case 2:return O(H)}}function p(){P&&(clearTimeout(P),P=0)}function g(O,H,ne){if(T<2)throw Error("scrypt not loaded");if(T<4)throw Error("scrypt not configed");if(T==5)throw Error("scrypt is running");if(T=5,ne=ne||W,O=O||[],H=H||[],O.length>R)throw Error("pass.length > maxPassLen");if(H.length>X)throw Error("salt.length > maxSaltLen");if(ne>W)throw Error("dkLen > maxDkLen");m.hash(O,H,ne)}function y(){if(!A){A=[];for(var O in B)B[O].check()&&A.push(O)}return A}function v(O){if(!(T>=1)){if(!O&&(O=h(),!O))throw Error("no available mod");if(m=B[O],!m)throw Error("unsupported mod: "+O);m.onload=function(){p(),o(u.onload)},m.onerror=function(H){b(),o(u.onerror,H)},m.onready=function(){T=4,o(u.onready)},m.onprogress=function(H){o(u.onprogress,H)},m.oncomplete=function(H){T=4,o(u.onprogress,1),o(u.oncomplete,H)},p(),P=setTimeout(function(){b(),o(u.onerror,"load timeout")},L),T=1,m.load(C)}}function S(){m.stop(),T=4}function U(){T==4&&(m.free(),T=2)}function b(){T!=0&&(m.unload(),T=0),p()}function z(O,H,ne){if(!O)throw Error("config() takes at least 1 argument");var ce=0|O.N;if(!(1<ce&&ce<=8388608))throw Error("param N out of range (1 < N <= 2^23)");if(ce&ce-1)throw Error("param N must be power of 2");var ye=0|O.r;if(!(0<ye&&ye<256))throw Error("param r out of range (0 < r < 256)");var ge=0|O.P;if(!(0<ge&&ge<256))throw Error("param P out of range (0 < P < 256)");var be=ce*ye*128;if(be>1073741824)throw Error("memory limit exceeded (N * r * 128 > 1G)");if(H){var Ae=H.maxPassLen;if(Ae==null)Ae=R;else if(Ae<=0)throw Error("invalid maxPassLen");var ee=H.maxSaltLen;if(ee==null)ee=X;else if(ee<=0)throw Error("invalid maxSaltLen");var Se=H.maxDkLen;if(Se==null)Se=W;else if(Se<=0)throw Error("invalid maxDkLen");var I=H.maxThread;if(I==null)I=re;else if(I<=0)throw Error("invalid maxThread");ne||(R=0|Ae,X=0|ee,W=0|Se,re=0|I)}if(!ne){var q=Math.ceil(ge/re),j=Math.ceil(ge/q);m.config(ce,ye,ge,j,R,X,W),T=3}}function e(O){return n.strToBytes(O)}function r(O){return n.bytesToStr(O)}function s(O){if(O.length%2)throw Error("invalid hex length");return n.hexToBytes(O)}function c(O){return n.bytesToHex(O)}function d(O){/\/$/.test(O)||(O+="/"),C=O}function _(O){L=O}var m,A,B={asmjs:a,flash:l},T=0,C="",P=0,L=3e4,R=64,X=64,W=64,re=1;u.hash=g,u.getAvailableMod=y,u.load=v,u.stop=S,u.free=U,u.unload=b,u.config=z,u.strToBin=e,u.binToStr=r,u.hexToBin=s,u.binToHex=c,u.setResPath=d,u.setResTimeout=_,t.scrypt=u})(f||(f={}))})();globalThis.scrypt_loader_9470f487e3aa154f278269e99e6a42502ca77b8da3867a46a548909659a3db4a=Ur;var It=Ur.scrypt;It.load();var fu=function(){const t=[];let n=!1;const a=f=>new Promise(async(u,h)=>{It.onprogress=o=>{f.onprogress&&f.onprogress(o)},It.oncomplete=o=>{f.resolve(o),u(!0)},It.onerror=o=>{f.reject(o),u(!1)};try{It.config({N:f.N,r:f.r,P:f.p},{maxPassLen:8192,maxSaltLen:2048,maxDkLen:1024,maxThread:1}),await new Promise(o=>It.onready=o),It.hash(f.key,f.salt,f.dklen)}catch(o){h(o)}});async function l(){let f=null;for(;t.length;)try{f=t.splice(0,1)[0],await a(f),await cu()}catch(u){f?.reject(u)}n=!1}return function(u,h,o,p,g,y,v=null){return new Promise((S,U)=>{t.push({key:u,salt:h,N:o,r:p,p:g,dklen:y,resolve:S,reject:U,onprogress:v}),n||(n=!0,setTimeout(l))})}}();function cu(){return new Promise(t=>setTimeout(t))}var At=4096,da=[85,170,85,170,85,170,85,170],Er=[85,170,85,170,85,170,85,170,170,85,170,85,170,85,170,85,85,170,85,170,85,170,85,170,170,85,170,85,170,85,170,85],Cr=[85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170],Qi=[255,253,240,16,19,208,18,24,85,170],uu=typeof process>"u"?requestAnimationFrame:setTimeout;function Br(){return new Promise(t=>uu(t))}function gn(t,n){return t?(String(t)==="1.1"&&(n=null),n?`${t}/${n}`:`${t}/0`):"Unknown Version"}var pa=gn("1.1"),hu=gn("1.2",10020);async function _a(t){const n=await t(0,13);if(ke(n)!=="MyEncryption/")throw new vr;const a=ke(await t(13,16));if(!["1.1","1.2"].includes(a))throw new Bi;const l=new DataView((await t(16,20)).buffer).getUint32(0,!0);return gn(a,l)}function ga(t){if(t&&t!=="AES-GCM")throw t==="ChaCha20"||t==="ChaCha20-Poly1305"?new ua:t==="DES"||t==="RC4"?new ha:t==="XTS-AES"?new Ti("XTS-AES Not supported yet"):new Ti(void 0,{cause:new Error(String(t))})}function du(t){try{return JSON.parse(t)}catch{throw new Ge("The JSON is not valid.")}}async function yn(t,n,a=null,l=null){const f=Ci(12),{derived_key:u,parameter:h,N:o}=await ti(n,f,a,l);l=o;const p=await crypto.subtle.importKey("raw",u,"AES-GCM",!1,["encrypt"]);if(typeof t!="string")throw new Sr("The ability to directly encrypt binary data has been removed in the new version. Please use `encrypt_file` instead.");const g="AES-GCM",y=await crypto.subtle.encrypt({name:g,iv:f},p,Lt(t)),v=new Uint8Array(f.length+y.byteLength);return v.set(f,0),v.set(new Uint8Array(y),f.length),`:${Ei(v)}:${h}:${l}:${5.6}:${g}:`}async function ei(t,n){let a;if(t.charAt(0)===":"){const b=t.split(":");if(b.length!==8)throw new yi("The message is bad.");const[,z,e,r,s,c,d]=b;a={data:z,phrase:e,salt:r,N:+s,v:+c,a:d}}else a=du(t);const l=parseInt(a.N),f=a.a;ga(f);const u=bt(a.data);let h,o;a.parameter?[h,o]=a.parameter.split(":"):(h=a.phrase,o=a.salt);const p=bt(o);if(isNaN(l)||!h||!u||!p)throw new yi("The message or parameters are bad.");if(u.length<28)throw new yi("The message was too short.");const g=u.slice(0,12),y=u.slice(12,-16),v=u.slice(-16),S=typeof n=="string"?(await ti(n,g,h,l,p)).derived_key:n,U=await crypto.subtle.importKey("raw",S,"AES-GCM",!1,["decrypt"]);try{const b=await crypto.subtle.decrypt({name:"AES-GCM",iv:g},U,new Uint8Array([...y,...v]));try{return ke(b)}catch{throw new Sr("The ability to directly decrypt binary data has been removed in the new version. If you have encrypted binary data, please recover it using the old version.")}}catch(b){if(!b)throw new We("Internal error.",{cause:b});const z=b.name;if(z==="InvalidAccessError")throw new Ge("InvalidAccessError.",{cause:b});if(z==="OperationError")throw new br("Cannot decrypt. Did you provide the correct password?",{cause:b});if(!b)throw new We("Unexpected error.",{cause:b})}}var Ts=["Furina","Neuvillette","Venti","Nahida","Kinich","Kazuha"];async function ti(t,n,a=null,l=null,f=null,u=8,h=1,o=32){if(l===null&&(l=262144),typeof l!="number"||l>2097152)throw new ra;if(f||(f=Ci(64)),a||(a=Ts[ou()%Ts.length]),a.includes(":"))throw new Ge('phrase MUST NOT contain ":"');const p=`${a}:${Ei(f)}`,g=`MyEncryption/1.1 Fontaine/4.2 Iv/${Ei(n)} user_parameter=${p} user_key=${t}`;return{derived_key:await fu(Lt(g),f,l,u,h,o),parameter:p,N:l}}async function ya(t,n,a,l=null,f=null,u=null,h=32*1024*1024){if(!h)throw new Ge("chunk_size must be greater than 0.");await n(Lt("MyEncryption/1.2"));const o=10020,p=new ArrayBuffer(4);new DataView(p).setUint32(0,o,!0),await n(new Uint8Array(p));const g=Ei(Ci(64)),y=await yn(g,a),v=Lt(y);if(v.length>At)throw new We("(Internal Error) This should not happen. Contact the application developer.");const S=new ArrayBuffer(4);new DataView(S).setUint32(0,v.length,!0),await n(new Uint8Array(S)),await n(v);const U=new Uint8Array(At-v.length-4).fill(0);await n(U),l?.(0),await Br();const b=Ci(12),{derived_key:z,parameter:e,N:r}=await ti(g,b,f,u);u=r;const s={parameter:e,N:u,v:5.5,a:"AES-GCM",iv:Ei(b)},c=Lt(JSON.stringify(s)),d=new ArrayBuffer(4);new DataView(d).setUint32(0,c.length,!0),await n(new Uint8Array(d)),await n(c);const _=new ArrayBuffer(8);new DataView(_).setBigUint64(0,BigInt(h),!0),await n(new Uint8Array(_));let m=0,A=1,B=0;const T=new ArrayBuffer(8);new DataView(T).setBigUint64(0,BigInt(A),!0),await n(new Uint8Array(T)),l?.(0);const C=await crypto.subtle.importKey("raw",z,{name:"AES-GCM"},!1,["encrypt"]);for(;;){const L=await t(B,B+h);if(!(L instanceof Uint8Array))throw new yi("The file chunk is not a Uint8Array.");if(L.length===0)break;const R=L.length<h,X=new ArrayBuffer(12);if(A>=2**64||A>=Number.MAX_SAFE_INTEGER)throw new sa("nonce_counter exceeded the maximum value.");if(new DataView(X).setBigUint64(4,BigInt(A),!0),A++,R){await n(new Uint8Array(Er));const H=new ArrayBuffer(8);new DataView(H).setBigUint64(0,BigInt(L.length),!0),await n(new Uint8Array(H))}const W=new Uint8Array(X),re=await crypto.subtle.encrypt({name:"AES-GCM",iv:W},C,L),O=new Uint8Array(re);await n(O),m+=L.length,B+=L.length,l?.(m)}await n(new Uint8Array(Cr));const P=new ArrayBuffer(8);return new DataView(P).setBigUint64(0,BigInt(m),!0),await n(new Uint8Array(P)),await n(new Uint8Array(Qi)),!0}async function pu(t,n,a,l=null){const f=await t(0,16);if(ke(f)!=="MyEncryption/1.1")throw new TypeError("Invalid file format");let u=16;const h=await t(u,u+4),o=new DataView(h.buffer).getUint32(0,!0);u+=4;const p=ke(await t(u,u+o));u+=1024;const g=await ei(p,a),y=await t(u,u+4),v=new DataView(y.buffer).getUint32(0,!0);u+=4;const S=JSON.parse(ke(await t(u,u+v)));u+=v;const[U,b]=S.parameter.split(":"),z=bt(b),e=bt(S.iv),r=S.N;l?.(0),await Br();const{derived_key:s}=await ti(g,e,U,r,z);let c=0;const d=await crypto.subtle.importKey("raw",s,{name:"AES-GCM"},!1,["decrypt"]);for(;;){const B=await t(u,u+8);if(u+=8,B.every((X,W)=>X===[255,253,240,16,19,208,18,24][W]))break;const T=Number(new DataView(B.buffer).getBigUint64(0,!0)),C=await t(u,u+12);u+=12;const P=await t(u,u+T+16);u+=T+16;const L=P,R=await crypto.subtle.decrypt({name:"AES-GCM",iv:C},d,L);await n(new Uint8Array(R)),c+=R.byteLength,l&&l(c)}const _=await t(u,u+8),m=Number(new DataView(_.buffer).getBigUint64(0,!0));u+=8;const A=await t(u,u+2);if(c!==m)throw new wr("File corrupted: total bytes mismatch");if(!A.every((B,T)=>B===[85,170][T]))throw new xr("Invalid end marker");return!0}async function Tr(t,n,a,l=null){let f=20;if(await _a(t)===pa){if(typeof a!="string")throw new Ar("operation not supported");return await pu(t,n,a,l)}const h=new DataView((await t(f,f+4)).buffer).getUint32(0,!0),o=ke(await t(f+4,f+4+h));if(f+=At,h>At)throw new We("(Internal Error) This should not happen. Contact the application developer.");const p=typeof a=="string"?await ei(o,a):null,g=await t(f,f+4),y=new DataView(g.buffer).getUint32(0,!0);f+=4;const v=JSON.parse(ke(await t(f,f+y)));f+=y;const S=v.v;if(![5.5].includes(S))throw new Bi;const[U,b]=v.parameter.split(":"),z=bt(b),e=bt(v.iv),r=v.N,s=v.a;ga(s);const c=Number(new DataView((await t(f,f+8)).buffer).getBigUint64(0,!0));let d=Number(new DataView((await t(f+8,f+16)).buffer).getBigUint64(0,!0));f+=16,l?.(0),await Br();const _=typeof a=="string"?(await ti(p,e,U,r,z)).derived_key:a;let m=0,A=!1;const B=await crypto.subtle.importKey("raw",_,{name:"AES-GCM"},!1,["decrypt"]);for(;;){const L=await t(f,f+8);let R=0;if(L.every((H,ne)=>H===da[ne])){const H=await t(f,f+32);if(H.every((ne,ce)=>ne===Cr[ce])){f+=32;break}if(H.every((ne,ce)=>ne===Er[ce])){A=!0,f+=32;const ne=await t(f,f+8);if(f+=8,R=Number(new DataView(ne.buffer).getBigUint64(0,!0)),R===0)break}}const X=A?R:c,W=new ArrayBuffer(12);new DataView(W).setBigUint64(4,BigInt(d),!0),d++;const re=await t(f,f+X+16);f+=X+16;const O=re;try{const H=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(W)},B,O);await n(new Uint8Array(H)),m+=H.byteLength}catch(H){if(!H)throw new We("Internal error.",{cause:H});const ne=H.name;if(ne==="InvalidAccessError")throw new Ge("InvalidAccessError.",{cause:H});if(ne==="OperationError")throw new oa(void 0,{cause:H});if(!H)throw new We("Unexpected error.",{cause:H})}l&&l(m)}const T=await t(f,f+8),C=Number(new DataView(T.buffer).getBigUint64(0,!0));f+=8;const P=await t(f,f+Qi.length);if(m!==C)throw new wr("total bytes mismatch");if(!P.every((L,R)=>L===Qi[R]))throw new xr;return!0}async function _u(t,n){const a=[];if(!await Tr(async(u,h)=>new Uint8Array(await t.slice(u,h).arrayBuffer()),u=>a.push(u),n))throw new pn;return new Blob(a)}async function gu(t,n,a){if(t.size<1044)throw new Error("Data not enough");const l=t.slice(0,16);if(await l.text()!=="MyEncryption/1.1")throw new TypeError("Invalid file format");const u=new DataView(await t.slice(16,20).arrayBuffer()).getUint32(0,!0),h=ke(await t.slice(20,20+u).arrayBuffer()),o=await yn(await ei(h,n),a);if(o.length>1024)throw new Error("(Internal Error) This should not happen. Contact the application developer.");const p=o.length,g=new ArrayBuffer(4);new DataView(g).setUint32(0,p,!0);const v=[l,g,Lt(o)],S=new Uint8Array(1024-o.length).fill(0);return v.push(S),new Blob(v)}async function ma(t,n,a){if(t.size<1044)throw new Error("Data not enough");if(await _a(async(S,U)=>new Uint8Array(await t.slice(S,U).arrayBuffer()))===pa)return await gu(t,n,a);const f=new DataView(await t.slice(20,24).arrayBuffer()).getUint32(0,!0),u=ke(await t.slice(24,24+f).arrayBuffer()),h=await yn(await ei(u,n),a);if(h.length>1024)throw new Error("(Internal Error) This should not happen. Contact the application developer.");const o=h.length,p=new ArrayBuffer(4);new DataView(p).setUint32(0,o,!0);const y=[t.slice(0,20),p,Lt(h)],v=new Uint8Array(At-h.length-4).fill(0);return y.push(v),new Blob(y)}var Pr=Object.create(null);Pr[Symbol.toStringTag]="CryptContext";Pr.toString=function(){return`${this[Symbol.toStringTag]} Object`};async function zi(t){return t instanceof Promise?await t:t}async function va(){const t=Object.create(Pr);return Object.defineProperty(t,"_created",{value:!0}),t}async function wa(t){if(!t||t._released)throw new Ge("Invalid context");for(const n of Reflect.ownKeys(t)){if(typeof n=="symbol"){Reflect.deleteProperty(t,n);continue}const a=Reflect.get(t,n);a&&(a.release?await zi(a.release()):a.free?await zi(a.free()):a.reset?await zi(a.reset()):a.clear&&await zi(a.clear())),n.startsWith("_")||Reflect.deleteProperty(t,n)}return Object.defineProperty(t,"_released",{value:!0}),!0}var xa=class{#i=null;#e={position:null,end:null,data:null};#t=null;get[Symbol.toStringTag](){return"Stream"}constructor(t,n){if(typeof t!="function")throw new Ge("Stream: Invalid reader");if(this.#i=t,typeof n!="number")throw new Ge("Stream: Invalid size");this.#t=n}get size(){return this.#t}#n=null;async read(t,n,a=null,l=null){if(!this.#i)throw new Error("Stream: The stream has been closed.");if(this.#e.position!=null&&this.#e.end&&this.#e.data&&t>=this.#e.position&&n<=this.#e.end)return this.#e.data.slice(t-this.#e.position,n-this.#e.position);if(t<0)throw new Ge("Stream: Invalid start position");if(n>this.#t&&(n=this.#t),a>this.#t&&(a=this.#t),this.#n=l,a){const u=await this.#i(t,a,l?.signal);return this.#n=null,this.#e.position=t,this.#e.end=t+u.length,this.#e.data=u,u.slice(0,n-t)}const f=await this.#i(t,n,l?.signal);return this.#n=null,f}abort(){this.#n?.abort()}purge(){this.#e.position=this.#e.data=this.#e.end=null}close(){this.#i=null,this.purge()}};async function ba(t,n,a,{cache:l=!0,cache_max_size:f=256*1024*1024}={}){if(t._inited)throw new aa;Object.defineProperty(t,"_inited",{value:!0}),t._type="@decrypt_stream",t.stream={stream:n,release:()=>t.stream.stream.close()};const u=await n.read(0,13,5e3);if(ke(u)!=="MyEncryption/")throw new vr;const h=ke(await n.read(13,16));if(!["1.1","1.2"].includes(h))throw new Bi;const o=new DataView((await n.read(16,20)).buffer).getUint32(0,!0),p=gn(h,o);let g=20;if(p!==hu)throw new Ar("Cannot perform a streamed decryption on V1.1 files");const y=new DataView((await n.read(g,g+4)).buffer).getUint32(0,!0),v=ke(await n.read(g+4,g+4+y));if(g+=At,y>At)throw new We("(Internal Error) This should not happen. Contact the application developer.");const S=await ei(v,a),U=await n.read(g,g+4),b=new DataView(U.buffer).getUint32(0,!0);g+=4;const z=JSON.parse(ke(await n.read(g,g+b)));g+=b;const e=z.v;if(![5.5].includes(e))throw new Bi;const[r,s]=z.parameter.split(":"),c=bt(s),d=bt(z.iv),_=z.N,m=Number(new DataView((await n.read(g,g+8)).buffer).getBigUint64(0,!0));let A=Number(new DataView((await n.read(g+8,g+16)).buffer).getBigUint64(0,!0));g+=16;const{derived_key:B}=await ti(S,d,r,_,c),T=await crypto.subtle.importKey("raw",B,{name:"AES-GCM"},!1,["decrypt"]);return t.key=T,t.chunk_size=m,t.nonce_counter=A,t.header_json_length=b,t.cache_enabled=!!l,t.cached_chunks=new Map,t.cached_chunks_add_order=new Array,t.cached_size=0,t.cache_max_size=f,!0}async function Aa(t,n,a,l){if(!t._inited)throw new la;if(t._type!=="@decrypt_stream")throw new fa(t._type);if(t._released)throw new ca;const f=t.stream.stream,u=t.chunk_size,h=t.nonce_counter,o=[],p=20+At+4+t.header_json_length+8+8,g=u+16,y=Math.floor((f.size-p-(80+Qi.length))/g),v=Math.max(0,Math.floor(n/u)),S=Math.min(y,Math.floor(a/u));if(S<0||v>y)throw new Ge("Out of range");const U=async s=>{if(t.cache_enabled&&t.cached_chunks.has(s))return t.cached_chunks.get(s);let c=p+s*g;const d=await f.read(c,c+8,c+2*g,l);let _=0;if(d.every((C,P)=>C===da[P])){const C=await f.read(c,c+32,null,l);if(c+=32,C.every((P,L)=>P===Cr[L]))return!1;if(C.every((P,L)=>P===Er[L])){const P=await f.read(c,c+8,null,l);if(c+=8,_=Number(new DataView(P.buffer).getBigUint64(0,!0)),_===0)return!1}}const m=_||u,A=await f.read(c,c+m+16,null,l),B=h+s,T=new ArrayBuffer(12);new DataView(T).setBigUint64(4,BigInt(B),!0);try{const C=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(T)},t.key,A);if(t.cache_enabled)for(C.byteLength<t.cache_max_size&&(t.cached_chunks_add_order.push(s),t.cached_chunks.set(s,C),t.cached_size+=C.byteLength);t.cached_size>t.cache_max_size;){const P=t.cached_chunks_add_order.shift();t.cached_size-=t.cached_chunks.get(P).byteLength,t.cached_chunks.delete(P)}return C}catch(C){if(!C)throw new We("Internal error.",{cause:C});const P=C.name;if(P==="InvalidAccessError")throw new Ge("InvalidAccessError.",{cause:C});if(P==="OperationError")throw new br("Cannot decrypt. Did you provide the correct password?",{cause:C});if(!C)throw new We("Unexpected error.",{cause:C})}};let b=!1;for(let s=v;s<=S;s++){const c=await U(s);if(!c){b=!0;break}o.push(c)}const z=new Blob(o),e=v*u,r=z.slice(n-e,a-e);return b&&(r.eof=!0),r}var yu={};Jo(yu,{createReaderForFileSystemHandle:()=>mu,createReaderForLocalFile:()=>Sa,createReaderForRemoteObject:()=>vu,createWriterForFileSystemHandle:()=>wu,createWriterForMemoryBuffer:()=>xu});async function Sa(t){return async(n,a)=>new Uint8Array(await t.slice(n,a).arrayBuffer())}async function mu(t){const n=await t.getFile();return await Sa(n)}async function vu(t){return async(n,a)=>{const l=await fetch(t,{headers:{Range:`bytes=${n}-${a-1}`}});if(!l.ok)throw new ea(`Network Error: HTTP ${l.status} : ${l.statusText}`,{response:l});return new Uint8Array(await l.arrayBuffer())}}async function wu(t){const n=await t.createWritable();return async a=>{await n.write(a)}}async function xu(t){return async n=>{t.push(n)}}const bu={name:"MessagePage",data(){return{inputText:"",password:"",outputText:"",copyButtonText:"复制结果",isLoading:!1}},methods:{async encryptText(){if(!this.inputText||!this.password){this.outputText="请输入消息和密码";return}try{this.isLoading=!0,this.outputText="加密中...",this.outputText=await yn(this.inputText,this.password)}catch(t){this.outputText="加密失败: "+t.message}finally{this.isLoading=!1}},async decryptText(){if(!this.inputText||!this.password){this.outputText="请输入密文和密码";return}try{this.isLoading=!0,this.outputText="解密中...",this.outputText=await ei(this.inputText,this.password)}catch(t){this.outputText="解密失败: "+t.message}finally{this.isLoading=!1}},clearAll(){this.inputText="",this.password="",this.outputText=""},async copyToClipboard(){if(!this.outputText)return;const t=this.copyButtonText;try{await navigator.clipboard.writeText(this.outputText),this.copyButtonText="复制成功!"}catch{this.copyButtonText="复制失败!"}setTimeout(()=>{this.copyButtonText=t},1500)}}},Au={class:"message-page"},Su={class:"input-section"},Uu={class:"button-group"},Eu=["disabled"],Cu=["disabled"],Bu=["disabled"],Tu={class:"output-section"},Pu={class:"output-box"};function Iu(t,n,a,l,f,u){return xe(),Ue("div",Au,[n[7]||(n[7]=G("h2",null,"消息加密/解密",-1)),G("div",Su,[ve(G("textarea",{"onUpdate:modelValue":n[0]||(n[0]=h=>f.inputText=h),placeholder:"输入要加密的消息或要解密的密文"},null,512),[[Ve,f.inputText]]),ve(G("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=h=>f.password=h),placeholder:"输入密码"},null,512),[[Ve,f.password]]),G("div",Uu,[G("button",{onClick:n[2]||(n[2]=(...h)=>u.encryptText&&u.encryptText(...h)),disabled:f.isLoading},"加密",8,Eu),G("button",{onClick:n[3]||(n[3]=(...h)=>u.decryptText&&u.decryptText(...h)),disabled:f.isLoading},"解密",8,Cu),G("button",{onClick:n[4]||(n[4]=(...h)=>u.clearAll&&u.clearAll(...h)),disabled:f.isLoading},"清空",8,Bu)])]),G("div",Tu,[n[6]||(n[6]=G("h3",null,"结果:",-1)),G("div",Pu,$t(f.outputText),1),f.outputText?(xe(),Ue("button",{key:0,onClick:n[5]||(n[5]=(...h)=>u.copyToClipboard&&u.copyToClipboard(...h)),class:"copy-button"},$t(f.copyButtonText),1)):$e("",!0)])])}const Fu=Qt(bu,[["render",Iu],["__scopeId","data-v-6d09f3d5"]]),Lu={name:"FilePage",data(){return{selectedFileHandle:null,selectedFile:null,password:"",chunkSize:32,statusMessage:"",isLoading:!1,showPasswordChange:!1,newPassword:""}},methods:{async selectFile(){try{const[t]=await window.showOpenFilePicker({writable:!0,multiple:!1});this.selectedFileHandle=t,this.selectedFile=await t.getFile(),this.statusMessage=`已选择文件: ${this.selectedFile.name}`}catch(t){this.statusMessage="文件选择取消或出错: "+t.message}},async encryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}if(!(!this.password&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const t=`${this.selectedFile.name}.enc`,a=await(await window.showSaveFilePicker({suggestedName:t})).createWritable(),l=this.chunkSize*1024*1024;await ya(async(f,u)=>{const h=await this.selectedFile.slice(f,u).arrayBuffer();return new Uint8Array(h)},f=>a.write(f),this.password,f=>{const u=Number(f/this.selectedFile.size*100);f>=this.selectedFile.size||u===100||u.toFixed(2)==="100.00"?this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。":this.statusMessage=`加密中... ${u.toFixed(2)}%`},null,null,l),await a.close(),this.statusMessage=`文件加密成功: ${t}`}catch(t){this.statusMessage="加密失败: "+t.message}finally{this.isLoading=!1}}},async decryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.isLoading=!0;try{const t=this.selectedFile.name.endsWith(".enc")?this.selectedFile.name.slice(0,-4):`decrypted_${this.selectedFile.name}`,a=await(await window.showSaveFilePicker({suggestedName:t})).createWritable();await Tr(async(l,f)=>{const u=await this.selectedFile.slice(l,f).arrayBuffer();return new Uint8Array(u)},l=>a.write(l),this.password,l=>{const f=Number(l/this.selectedFile.size*100);l>=this.selectedFile.size||f===100||f.toFixed(2)==="100.00"?this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。":this.statusMessage=`解密中... ${f.toFixed(2)}%`}),await a.close(),this.statusMessage=`文件解密成功: ${t}`}catch(t){this.statusMessage="解密失败: "+t.message}finally{this.isLoading=!1}},clearAll(){this.selectedFile=null,this.password="",this.statusMessage=""},changePassword(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.showPasswordChange=!0,this.newPassword="",this.confirmPassword=""},cancelPasswordChange(){this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},async confirmPasswordChange(){if(!(!this.newPassword&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{this.statusMessage="正在处理...";const t=this.selectedFileHandle,a=this.selectedFile.slice(0,5e3);this.statusMessage="正在更改密码，请稍候...";const l=await ma(a,this.password,this.newPassword);this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。";const f=await t.createWritable({keepExistingData:!0});await f.write(l),await f.close(),this.statusMessage="密码更改成功",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""}catch(t){this.statusMessage="密码更改失败: "+t.message}finally{this.isLoading=!1}}}}},ku={class:"file-page"},Ru={class:"input-section"},zu={class:"file-select-group"},Mu={class:"file-name"},Du={class:"chunk-size-group"},Ou={class:"chunk-size-header"},Nu={class:"button-group",style:{"margin-top":"0.5em"}},Hu=["disabled"],Vu=["disabled"],Gu=["disabled"],ju=["disabled"],Yu={key:0,class:"password-change-section"},Ku={class:"button-group"},qu=["disabled"],$u=["disabled"],Wu={key:1,class:"status-section"},Xu={class:"status-box"};function Zu(t,n,a,l,f,u){return xe(),Ue("div",ku,[n[14]||(n[14]=G("h2",null,"文件加密/解密",-1)),G("div",Ru,[G("div",zu,[G("button",{onClick:n[0]||(n[0]=(...h)=>u.selectFile&&u.selectFile(...h)),style:{flex:"unset",padding:"10px 20px"}},"选择文件"),G("div",Mu,$t(f.selectedFile?.name||"没有选择文件"),1)]),ve(G("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=h=>f.password=h),placeholder:"输入密码"},null,512),[[Ve,f.password]]),G("div",Du,[G("div",Ou,[n[10]||(n[10]=G("label",null,"分块大小(MiB):",-1)),ve(G("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=h=>f.chunkSize=h),min:"1",max:"128"},null,512),[[Ve,f.chunkSize,void 0,{number:!0}]])]),n[11]||(n[11]=dr('<details class="hint-box" open data-v-0db39e02><summary class="hint-title" data-v-0db39e02>分块大小建议:</summary><ul class="hint-list" data-v-0db39e02><li data-v-0db39e02><strong data-v-0db39e02>大文件(32MiB)</strong>: 整体文件处理，提高性能</li><li data-v-0db39e02><strong data-v-0db39e02>视频文件(5-32MiB)</strong>: 增强随机读取性能</li><li data-v-0db39e02><strong data-v-0db39e02>一般视频(5MiB)</strong>: 适合大多数视频文件</li><li data-v-0db39e02><strong data-v-0db39e02>较大视频(16-32MiB)</strong>: 适合高清/4K视频</li></ul><div class="warning-text" data-v-0db39e02> ⚠️ 注意: 分块太小会导致文件被分成过多块，可能产生大量请求次数，造成额外费用。 请根据文件类型和大小选择合适的分块大小。 </div></details>',1))]),G("div",Nu,[G("button",{onClick:n[3]||(n[3]=(...h)=>u.encryptFile&&u.encryptFile(...h)),disabled:f.isLoading},"加密",8,Hu),G("button",{onClick:n[4]||(n[4]=(...h)=>u.decryptFile&&u.decryptFile(...h)),disabled:f.isLoading},"解密",8,Vu),G("button",{onClick:n[5]||(n[5]=(...h)=>u.changePassword&&u.changePassword(...h)),disabled:f.isLoading},"改密",8,Gu),G("button",{onClick:n[6]||(n[6]=(...h)=>u.clearAll&&u.clearAll(...h)),disabled:f.isLoading},"清除",8,ju)])]),f.showPasswordChange?(xe(),Ue("div",Yu,[n[12]||(n[12]=G("h3",null,"更改密码",-1)),ve(G("input",{type:"password","onUpdate:modelValue":n[7]||(n[7]=h=>f.newPassword=h),placeholder:"输入新密码"},null,512),[[Ve,f.newPassword]]),G("div",Ku,[G("button",{onClick:n[8]||(n[8]=(...h)=>u.confirmPasswordChange&&u.confirmPasswordChange(...h)),disabled:f.isLoading},"确认更改",8,qu),G("button",{onClick:n[9]||(n[9]=(...h)=>u.cancelPasswordChange&&u.cancelPasswordChange(...h)),disabled:f.isLoading},"取消",8,$u)])])):$e("",!0),f.statusMessage?(xe(),Ue("div",Wu,[n[13]||(n[13]=G("h3",null,"状态:",-1)),G("div",Xu,$t(f.statusMessage),1)])):$e("",!0)])}const Ju=Qt(Lu,[["render",Zu],["__scopeId","data-v-0db39e02"]]),Qu={name:"FileClassicPage",data(){return{selectedFile:null,password:"",chunkSize:32,statusMessage:"",isLoading:!1,showPasswordChange:!1,newPassword:"",confirmPassword:""}},methods:{handleFileChange(t){this.selectedFile=t.target.files[0],this.selectedFile&&(this.statusMessage=`已选择文件: ${this.selectedFile.name}`)},async encryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}if(!(!this.password&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const t=`${this.selectedFile.name}.enc`,n=document.createElement("a");n.style.display="none",document.body.appendChild(n);const a=this.chunkSize*1024*1024,l=[];await ya(async(h,o)=>{const p=await this.selectedFile.slice(h,o).arrayBuffer();return new Uint8Array(p)},h=>{l.push(h)},this.password,h=>{const o=(h/this.selectedFile.size*100).toFixed(2);this.statusMessage=`加密中... ${o}%`},null,null,a);const f=new Blob(l,{type:"application/octet-stream"}),u=URL.createObjectURL(f);n.href=u,n.download=t,n.click(),URL.revokeObjectURL(u),document.body.removeChild(n),this.statusMessage=`文件加密成功: ${t}`}catch(t){this.statusMessage="加密失败: "+t.message}finally{this.isLoading=!1}}},async decryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.isLoading=!0;try{const t=this.selectedFile.name.endsWith(".enc")?this.selectedFile.name.slice(0,-4):`decrypted_${this.selectedFile.name}`,n=document.createElement("a");n.style.display="none",document.body.appendChild(n);const a=[];await Tr(async(u,h)=>{const o=await this.selectedFile.slice(u,h).arrayBuffer();return new Uint8Array(o)},u=>{a.push(u)},this.password,u=>{const h=(u/this.selectedFile.size*100).toFixed(2);this.statusMessage=`解密中... ${h}%`});const l=new Blob(a,{type:"application/octet-stream"}),f=URL.createObjectURL(l);n.href=f,n.download=t,n.click(),URL.revokeObjectURL(f),document.body.removeChild(n),this.statusMessage=`文件解密成功: ${t}`}catch(t){this.statusMessage="解密失败: "+t.message}finally{this.isLoading=!1}},clearAll(){this.$refs.fileInput.value="",this.selectedFile=null,this.password="",this.statusMessage="",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},changePassword(){if(!this.selectedFile){this.statusMessage="请选择文件并输入当前密码";return}this.showPasswordChange=!0,this.newPassword="",this.confirmPassword=""},cancelPasswordChange(){this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},async confirmPasswordChange(){if(!(!this.newPassword&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const t=this.selectedFile.slice(0,5e3),n=await ma(t,this.password,this.newPassword),a=document.createElement("a");a.style.display="none",document.body.appendChild(a);const l=URL.createObjectURL(new Blob([n,this.selectedFile.slice(n.size)],{type:"application/octet-stream"}));a.href=l,a.download=this.selectedFile.name,a.click(),URL.revokeObjectURL(l),document.body.removeChild(a),this.statusMessage="密码更改成功",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""}catch(t){this.statusMessage="密码更改失败: "+t.message}finally{this.isLoading=!1}}}}},eh={class:"file-page"},th={class:"input-section"},ih={class:"chunk-size-group"},nh={class:"chunk-size-header"},rh={class:"button-group",style:{"margin-top":"0.5em"}},sh=["disabled"],oh=["disabled"],ah=["disabled"],lh=["disabled"],fh={key:0,class:"password-change-section"},ch={class:"button-group"},uh=["disabled"],hh=["disabled"],dh={key:0,class:"status-section"},ph={class:"status-box"};function _h(t,n,a,l,f,u){return xe(),Ue("div",eh,[n[14]||(n[14]=G("h2",null,"文件加密/解密(兼容版)",-1)),G("div",th,[G("input",{type:"file",ref:"fileInput",onChange:n[0]||(n[0]=(...h)=>u.handleFileChange&&u.handleFileChange(...h))},null,544),ve(G("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=h=>f.password=h),placeholder:"输入密码"},null,512),[[Ve,f.password]]),G("div",ih,[G("div",nh,[n[10]||(n[10]=G("label",null,"分块大小(MiB):",-1)),ve(G("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=h=>f.chunkSize=h),min:"1",max:"128"},null,512),[[Ve,f.chunkSize,void 0,{number:!0}]])]),n[11]||(n[11]=dr('<details class="hint-box" open data-v-a4342bf7><summary class="hint-title" data-v-a4342bf7>分块大小建议:</summary><ul class="hint-list" data-v-a4342bf7><li data-v-a4342bf7><strong data-v-a4342bf7>大文件(32MiB)</strong>: 整体文件处理，提高性能</li><li data-v-a4342bf7><strong data-v-a4342bf7>视频文件(5-32MiB)</strong>: 增强随机读取性能</li><li data-v-a4342bf7><strong data-v-a4342bf7>一般视频(5MiB)</strong>: 适合大多数视频文件</li><li data-v-a4342bf7><strong data-v-a4342bf7>较大视频(16-32MiB)</strong>: 适合高清/4K视频</li></ul><div class="warning-text" data-v-a4342bf7> ⚠️ 注意: 分块太小会导致文件被分成过多块，可能产生大量请求次数，造成额外费用。 请根据文件类型和大小选择合适的分块大小。 </div></details>',1))]),G("div",rh,[G("button",{onClick:n[3]||(n[3]=(...h)=>u.encryptFile&&u.encryptFile(...h)),disabled:f.isLoading},"加密",8,sh),G("button",{onClick:n[4]||(n[4]=(...h)=>u.decryptFile&&u.decryptFile(...h)),disabled:f.isLoading},"解密",8,oh),G("button",{onClick:n[5]||(n[5]=(...h)=>u.changePassword&&u.changePassword(...h)),disabled:f.isLoading},"改密",8,ah),G("button",{onClick:n[6]||(n[6]=(...h)=>u.clearAll&&u.clearAll(...h)),disabled:f.isLoading},"清除",8,lh)]),f.showPasswordChange?(xe(),Ue("div",fh,[n[12]||(n[12]=G("h3",null,"更改密码",-1)),ve(G("input",{type:"password","onUpdate:modelValue":n[7]||(n[7]=h=>f.newPassword=h),placeholder:"输入新密码"},null,512),[[Ve,f.newPassword]]),G("div",ch,[G("button",{onClick:n[8]||(n[8]=(...h)=>u.confirmPasswordChange&&u.confirmPasswordChange(...h)),disabled:f.isLoading},"确认更改",8,uh),G("button",{onClick:n[9]||(n[9]=(...h)=>u.cancelPasswordChange&&u.cancelPasswordChange(...h)),disabled:f.isLoading},"取消",8,hh)])])):$e("",!0)]),f.statusMessage?(xe(),Ue("div",dh,[n[13]||(n[13]=G("h3",null,"状态:",-1)),G("div",ph,$t(f.statusMessage),1)])):$e("",!0)])}const gh=Qt(Qu,[["render",_h],["__scopeId","data-v-a4342bf7"]]);function yh(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Fn={},Ps;function mh(){return Ps||(Ps=1,function(t){var n=function(){var e=new Date,r=4,s=3,c=2,d=1,_=r,m={setLogLevel:function(A){A==this.debug?_=d:A==this.info?_=c:A==this.warn?_=s:(A==this.error,_=r)},debug:function(A,B){console.debug===void 0&&(console.debug=console.log),d>=_&&console.debug("["+n.getDurationString(new Date-e,1e3)+"]","["+A+"]",B)},log:function(A,B){this.debug(A.msg)},info:function(A,B){c>=_&&console.info("["+n.getDurationString(new Date-e,1e3)+"]","["+A+"]",B)},warn:function(A,B){s>=_&&console.warn("["+n.getDurationString(new Date-e,1e3)+"]","["+A+"]",B)},error:function(A,B){r>=_&&console.error("["+n.getDurationString(new Date-e,1e3)+"]","["+A+"]",B)}};return m}();n.getDurationString=function(e,r){var s;function c(T,C){for(var P=""+T,L=P.split(".");L[0].length<C;)L[0]="0"+L[0];return L.join(".")}e<0?(s=!0,e=-e):s=!1;var d=r||1,_=e/d,m=Math.floor(_/3600);_-=m*3600;var A=Math.floor(_/60);_-=A*60;var B=_*1e3;return _=Math.floor(_),B-=_*1e3,B=Math.floor(B),(s?"-":"")+m+":"+c(A,2)+":"+c(_,2)+"."+c(B,3)},n.printRanges=function(e){var r=e.length;if(r>0){for(var s="",c=0;c<r;c++)c>0&&(s+=","),s+="["+n.getDurationString(e.start(c))+","+n.getDurationString(e.end(c))+"]";return s}else return"(empty)"},t.Log=n;var a=function(e){if(e instanceof ArrayBuffer)this.buffer=e,this.dataview=new DataView(e);else throw"Needs an array buffer";this.position=0};a.prototype.getPosition=function(){return this.position},a.prototype.getEndPosition=function(){return this.buffer.byteLength},a.prototype.getLength=function(){return this.buffer.byteLength},a.prototype.seek=function(e){var r=Math.max(0,Math.min(this.buffer.byteLength,e));return this.position=isNaN(r)||!isFinite(r)?0:r,!0},a.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},a.prototype.readAnyInt=function(e,r){var s=0;if(this.position+e<=this.buffer.byteLength){switch(e){case 1:r?s=this.dataview.getInt8(this.position):s=this.dataview.getUint8(this.position);break;case 2:r?s=this.dataview.getInt16(this.position):s=this.dataview.getUint16(this.position);break;case 3:if(r)throw"No method for reading signed 24 bits values";s=this.dataview.getUint8(this.position)<<16,s|=this.dataview.getUint8(this.position+1)<<8,s|=this.dataview.getUint8(this.position+2);break;case 4:r?s=this.dataview.getInt32(this.position):s=this.dataview.getUint32(this.position);break;case 8:if(r)throw"No method for reading signed 64 bits values";s=this.dataview.getUint32(this.position)<<32,s|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+e}return this.position+=e,s}else throw"Not enough bytes in buffer"},a.prototype.readUint8=function(){return this.readAnyInt(1,!1)},a.prototype.readUint16=function(){return this.readAnyInt(2,!1)},a.prototype.readUint24=function(){return this.readAnyInt(3,!1)},a.prototype.readUint32=function(){return this.readAnyInt(4,!1)},a.prototype.readUint64=function(){return this.readAnyInt(8,!1)},a.prototype.readString=function(e){if(this.position+e<=this.buffer.byteLength){for(var r="",s=0;s<e;s++)r+=String.fromCharCode(this.readUint8());return r}else throw"Not enough bytes in buffer"},a.prototype.readCString=function(){for(var e=[];;){var r=this.readUint8();if(r!==0)e.push(r);else break}return String.fromCharCode.apply(null,e)},a.prototype.readInt8=function(){return this.readAnyInt(1,!0)},a.prototype.readInt16=function(){return this.readAnyInt(2,!0)},a.prototype.readInt32=function(){return this.readAnyInt(4,!0)},a.prototype.readInt64=function(){return this.readAnyInt(8,!1)},a.prototype.readUint8Array=function(e){for(var r=new Uint8Array(e),s=0;s<e;s++)r[s]=this.readUint8();return r},a.prototype.readInt16Array=function(e){for(var r=new Int16Array(e),s=0;s<e;s++)r[s]=this.readInt16();return r},a.prototype.readUint16Array=function(e){for(var r=new Int16Array(e),s=0;s<e;s++)r[s]=this.readUint16();return r},a.prototype.readUint32Array=function(e){for(var r=new Uint32Array(e),s=0;s<e;s++)r[s]=this.readUint32();return r},a.prototype.readInt32Array=function(e){for(var r=new Int32Array(e),s=0;s<e;s++)r[s]=this.readInt32();return r},t.MP4BoxStream=a;var l=function(e,r,s){this._byteOffset=r||0,e instanceof ArrayBuffer?this.buffer=e:typeof e=="object"?(this.dataView=e,r&&(this._byteOffset+=r)):this.buffer=new ArrayBuffer(e||0),this.position=0,this.endianness=s??l.LITTLE_ENDIAN};l.prototype={},l.prototype.getPosition=function(){return this.position},l.prototype._realloc=function(e){if(this._dynamicSize){var r=this._byteOffset+this.position+e,s=this._buffer.byteLength;if(r<=s){r>this._byteLength&&(this._byteLength=r);return}for(s<1&&(s=1);r>s;)s*=2;var c=new ArrayBuffer(s),d=new Uint8Array(this._buffer),_=new Uint8Array(c,0,d.length);_.set(d),this.buffer=c,this._byteLength=r}},l.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var e=new ArrayBuffer(this._byteLength),r=new Uint8Array(e),s=new Uint8Array(this._buffer,0,r.length);r.set(s),this.buffer=e}},l.BIG_ENDIAN=!1,l.LITTLE_ENDIAN=!0,l.prototype._byteLength=0,Object.defineProperty(l.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(l.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(e){this._buffer=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(l.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(e){this._byteOffset=e,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(l.prototype,"dataView",{get:function(){return this._dataView},set:function(e){this._byteOffset=e.byteOffset,this._buffer=e.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+e.byteLength}}),l.prototype.seek=function(e){var r=Math.max(0,Math.min(this.byteLength,e));this.position=isNaN(r)||!isFinite(r)?0:r},l.prototype.isEof=function(){return this.position>=this._byteLength},l.prototype.mapUint8Array=function(e){this._realloc(e*1);var r=new Uint8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,r},l.prototype.readInt32Array=function(e,r){e=e??this.byteLength-this.position/4;var s=new Int32Array(e);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),l.arrayToNative(s,r??this.endianness),this.position+=s.byteLength,s},l.prototype.readInt16Array=function(e,r){e=e??this.byteLength-this.position/2;var s=new Int16Array(e);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),l.arrayToNative(s,r??this.endianness),this.position+=s.byteLength,s},l.prototype.readInt8Array=function(e){e=e??this.byteLength-this.position;var r=new Int8Array(e);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,e*r.BYTES_PER_ELEMENT),this.position+=r.byteLength,r},l.prototype.readUint32Array=function(e,r){e=e??this.byteLength-this.position/4;var s=new Uint32Array(e);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),l.arrayToNative(s,r??this.endianness),this.position+=s.byteLength,s},l.prototype.readUint16Array=function(e,r){e=e??this.byteLength-this.position/2;var s=new Uint16Array(e);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),l.arrayToNative(s,r??this.endianness),this.position+=s.byteLength,s},l.prototype.readUint8Array=function(e){e=e??this.byteLength-this.position;var r=new Uint8Array(e);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,e*r.BYTES_PER_ELEMENT),this.position+=r.byteLength,r},l.prototype.readFloat64Array=function(e,r){e=e??this.byteLength-this.position/8;var s=new Float64Array(e);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),l.arrayToNative(s,r??this.endianness),this.position+=s.byteLength,s},l.prototype.readFloat32Array=function(e,r){e=e??this.byteLength-this.position/4;var s=new Float32Array(e);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,e*s.BYTES_PER_ELEMENT),l.arrayToNative(s,r??this.endianness),this.position+=s.byteLength,s},l.prototype.readInt32=function(e){var r=this._dataView.getInt32(this.position,e??this.endianness);return this.position+=4,r},l.prototype.readInt16=function(e){var r=this._dataView.getInt16(this.position,e??this.endianness);return this.position+=2,r},l.prototype.readInt8=function(){var e=this._dataView.getInt8(this.position);return this.position+=1,e},l.prototype.readUint32=function(e){var r=this._dataView.getUint32(this.position,e??this.endianness);return this.position+=4,r},l.prototype.readUint16=function(e){var r=this._dataView.getUint16(this.position,e??this.endianness);return this.position+=2,r},l.prototype.readUint8=function(){var e=this._dataView.getUint8(this.position);return this.position+=1,e},l.prototype.readFloat32=function(e){var r=this._dataView.getFloat32(this.position,e??this.endianness);return this.position+=4,r},l.prototype.readFloat64=function(e){var r=this._dataView.getFloat64(this.position,e??this.endianness);return this.position+=8,r},l.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,l.memcpy=function(e,r,s,c,d){var _=new Uint8Array(e,r,d),m=new Uint8Array(s,c,d);_.set(m)},l.arrayToNative=function(e,r){return r==this.endianness?e:this.flipArrayEndianness(e)},l.nativeToEndian=function(e,r){return this.endianness==r?e:this.flipArrayEndianness(e)},l.flipArrayEndianness=function(e){for(var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),s=0;s<e.byteLength;s+=e.BYTES_PER_ELEMENT)for(var c=s+e.BYTES_PER_ELEMENT-1,d=s;c>d;c--,d++){var _=r[d];r[d]=r[c],r[c]=_}return e},l.prototype.failurePosition=0,String.fromCharCodeUint8=function(e){for(var r=[],s=0;s<e.length;s++)r[s]=e[s];return String.fromCharCode.apply(null,r)},l.prototype.readString=function(e,r){return r==null||r=="ASCII"?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(e??this.byteLength-this.position)]):new TextDecoder(r).decode(this.mapUint8Array(e))},l.prototype.readCString=function(e){var r=this.byteLength-this.position,s=new Uint8Array(this._buffer,this._byteOffset+this.position),c=r;e!=null&&(c=Math.min(e,r));for(var d=0;d<c&&s[d]!==0;d++);var _=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(d)]);return e!=null?this.position+=c-d:d!=r&&(this.position+=1),_};var f=Math.pow(2,32);l.prototype.readInt64=function(){return this.readInt32()*f+this.readUint32()},l.prototype.readUint64=function(){return this.readUint32()*f+this.readUint32()},l.prototype.readInt64=function(){return this.readUint32()*f+this.readUint32()},l.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},t.DataStream=l,l.prototype.save=function(e){var r=new Blob([this.buffer]);if(window.URL&&URL.createObjectURL){var s=window.URL.createObjectURL(r),c=document.createElement("a");document.body.appendChild(c),c.setAttribute("href",s),c.setAttribute("download",e),c.setAttribute("target","_self"),c.click(),window.URL.revokeObjectURL(s)}else throw"DataStream.save: Can't create object URL."},l.prototype._dynamicSize=!0,Object.defineProperty(l.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(e){e||this._trimAlloc(),this._dynamicSize=e}}),l.prototype.shift=function(e){var r=new ArrayBuffer(this._byteLength-e),s=new Uint8Array(r),c=new Uint8Array(this._buffer,e,s.length);s.set(c),this.buffer=r,this.position-=e},l.prototype.writeInt32Array=function(e,r){if(this._realloc(e.length*4),e instanceof Int32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt32Array(e.length,r);else for(var s=0;s<e.length;s++)this.writeInt32(e[s],r)},l.prototype.writeInt16Array=function(e,r){if(this._realloc(e.length*2),e instanceof Int16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt16Array(e.length,r);else for(var s=0;s<e.length;s++)this.writeInt16(e[s],r)},l.prototype.writeInt8Array=function(e){if(this._realloc(e.length*1),e instanceof Int8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapInt8Array(e.length);else for(var r=0;r<e.length;r++)this.writeInt8(e[r])},l.prototype.writeUint32Array=function(e,r){if(this._realloc(e.length*4),e instanceof Uint32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint32Array(e.length,r);else for(var s=0;s<e.length;s++)this.writeUint32(e[s],r)},l.prototype.writeUint16Array=function(e,r){if(this._realloc(e.length*2),e instanceof Uint16Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint16Array(e.length,r);else for(var s=0;s<e.length;s++)this.writeUint16(e[s],r)},l.prototype.writeUint8Array=function(e){if(this._realloc(e.length*1),e instanceof Uint8Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapUint8Array(e.length);else for(var r=0;r<e.length;r++)this.writeUint8(e[r])},l.prototype.writeFloat64Array=function(e,r){if(this._realloc(e.length*8),e instanceof Float64Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat64Array(e.length,r);else for(var s=0;s<e.length;s++)this.writeFloat64(e[s],r)},l.prototype.writeFloat32Array=function(e,r){if(this._realloc(e.length*4),e instanceof Float32Array&&this.byteOffset+this.position%e.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,e.buffer,0,e.byteLength),this.mapFloat32Array(e.length,r);else for(var s=0;s<e.length;s++)this.writeFloat32(e[s],r)},l.prototype.writeInt32=function(e,r){this._realloc(4),this._dataView.setInt32(this.position,e,r??this.endianness),this.position+=4},l.prototype.writeInt16=function(e,r){this._realloc(2),this._dataView.setInt16(this.position,e,r??this.endianness),this.position+=2},l.prototype.writeInt8=function(e){this._realloc(1),this._dataView.setInt8(this.position,e),this.position+=1},l.prototype.writeUint32=function(e,r){this._realloc(4),this._dataView.setUint32(this.position,e,r??this.endianness),this.position+=4},l.prototype.writeUint16=function(e,r){this._realloc(2),this._dataView.setUint16(this.position,e,r??this.endianness),this.position+=2},l.prototype.writeUint8=function(e){this._realloc(1),this._dataView.setUint8(this.position,e),this.position+=1},l.prototype.writeFloat32=function(e,r){this._realloc(4),this._dataView.setFloat32(this.position,e,r??this.endianness),this.position+=4},l.prototype.writeFloat64=function(e,r){this._realloc(8),this._dataView.setFloat64(this.position,e,r??this.endianness),this.position+=8},l.prototype.writeUCS2String=function(e,r,s){s==null&&(s=e.length);for(var c=0;c<e.length&&c<s;c++)this.writeUint16(e.charCodeAt(c),r);for(;c<s;c++)this.writeUint16(0)},l.prototype.writeString=function(e,r,s){var c=0;if(r==null||r=="ASCII")if(s!=null){var d=Math.min(e.length,s);for(c=0;c<d;c++)this.writeUint8(e.charCodeAt(c));for(;c<s;c++)this.writeUint8(0)}else for(c=0;c<e.length;c++)this.writeUint8(e.charCodeAt(c));else this.writeUint8Array(new TextEncoder(r).encode(e.substring(0,s)))},l.prototype.writeCString=function(e,r){var s=0;if(r!=null){var c=Math.min(e.length,r);for(s=0;s<c;s++)this.writeUint8(e.charCodeAt(s));for(;s<r;s++)this.writeUint8(0)}else{for(s=0;s<e.length;s++)this.writeUint8(e.charCodeAt(s));this.writeUint8(0)}},l.prototype.writeStruct=function(e,r){for(var s=0;s<e.length;s+=2){var c=e[s+1];this.writeType(c,r[e[s]],r)}},l.prototype.writeType=function(e,r,s){var c;if(typeof e=="function")return e(this,r);if(typeof e=="object"&&!(e instanceof Array))return e.set(this,r,s);var d=null,_="ASCII",m=this.position;switch(typeof e=="string"&&/:/.test(e)&&(c=e.split(":"),e=c[0],d=parseInt(c[1])),typeof e=="string"&&/,/.test(e)&&(c=e.split(","),e=c[0],_=parseInt(c[1])),e){case"uint8":this.writeUint8(r);break;case"int8":this.writeInt8(r);break;case"uint16":this.writeUint16(r,this.endianness);break;case"int16":this.writeInt16(r,this.endianness);break;case"uint32":this.writeUint32(r,this.endianness);break;case"int32":this.writeInt32(r,this.endianness);break;case"float32":this.writeFloat32(r,this.endianness);break;case"float64":this.writeFloat64(r,this.endianness);break;case"uint16be":this.writeUint16(r,l.BIG_ENDIAN);break;case"int16be":this.writeInt16(r,l.BIG_ENDIAN);break;case"uint32be":this.writeUint32(r,l.BIG_ENDIAN);break;case"int32be":this.writeInt32(r,l.BIG_ENDIAN);break;case"float32be":this.writeFloat32(r,l.BIG_ENDIAN);break;case"float64be":this.writeFloat64(r,l.BIG_ENDIAN);break;case"uint16le":this.writeUint16(r,l.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(r,l.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(r,l.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(r,l.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(r,l.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(r,l.LITTLE_ENDIAN);break;case"cstring":this.writeCString(r,d);break;case"string":this.writeString(r,_,d);break;case"u16string":this.writeUCS2String(r,this.endianness,d);break;case"u16stringle":this.writeUCS2String(r,l.LITTLE_ENDIAN,d);break;case"u16stringbe":this.writeUCS2String(r,l.BIG_ENDIAN,d);break;default:if(e.length==3){for(var A=e[1],B=0;B<r.length;B++)this.writeType(A,r[B]);break}else{this.writeStruct(e,r);break}}d!=null&&(this.position=m,this._realloc(d),this.position=m+d)},l.prototype.writeUint64=function(e){var r=Math.floor(e/f);this.writeUint32(r),this.writeUint32(e&4294967295)},l.prototype.writeUint24=function(e){this.writeUint8((e&16711680)>>16),this.writeUint8((e&65280)>>8),this.writeUint8(e&255)},l.prototype.adjustUint32=function(e,r){var s=this.position;this.seek(e),this.writeUint32(r),this.seek(s)},l.prototype.mapInt32Array=function(e,r){this._realloc(e*4);var s=new Int32Array(this._buffer,this.byteOffset+this.position,e);return l.arrayToNative(s,r??this.endianness),this.position+=e*4,s},l.prototype.mapInt16Array=function(e,r){this._realloc(e*2);var s=new Int16Array(this._buffer,this.byteOffset+this.position,e);return l.arrayToNative(s,r??this.endianness),this.position+=e*2,s},l.prototype.mapInt8Array=function(e){this._realloc(e*1);var r=new Int8Array(this._buffer,this.byteOffset+this.position,e);return this.position+=e*1,r},l.prototype.mapUint32Array=function(e,r){this._realloc(e*4);var s=new Uint32Array(this._buffer,this.byteOffset+this.position,e);return l.arrayToNative(s,r??this.endianness),this.position+=e*4,s},l.prototype.mapUint16Array=function(e,r){this._realloc(e*2);var s=new Uint16Array(this._buffer,this.byteOffset+this.position,e);return l.arrayToNative(s,r??this.endianness),this.position+=e*2,s},l.prototype.mapFloat64Array=function(e,r){this._realloc(e*8);var s=new Float64Array(this._buffer,this.byteOffset+this.position,e);return l.arrayToNative(s,r??this.endianness),this.position+=e*8,s},l.prototype.mapFloat32Array=function(e,r){this._realloc(e*4);var s=new Float32Array(this._buffer,this.byteOffset+this.position,e);return l.arrayToNative(s,r??this.endianness),this.position+=e*4,s};var u=function(e){this.buffers=[],this.bufferIndex=-1,e&&(this.insertBuffer(e),this.bufferIndex=0)};u.prototype=new l(new ArrayBuffer,0,l.BIG_ENDIAN),u.prototype.initialized=function(){var e;return this.bufferIndex>-1?!0:this.buffers.length>0?(e=this.buffers[0],e.fileStart===0?(this.buffer=e,this.bufferIndex=0,n.debug("MultiBufferStream","Stream ready for parsing"),!0):(n.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(n.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1)},ArrayBuffer.concat=function(e,r){n.debug("ArrayBuffer","Trying to create a new buffer of size: "+(e.byteLength+r.byteLength));var s=new Uint8Array(e.byteLength+r.byteLength);return s.set(new Uint8Array(e),0),s.set(new Uint8Array(r),e.byteLength),s.buffer},u.prototype.reduceBuffer=function(e,r,s){var c;return c=new Uint8Array(s),c.set(new Uint8Array(e,r,s)),c.buffer.fileStart=e.fileStart+r,c.buffer.usedBytes=0,c.buffer},u.prototype.insertBuffer=function(e){for(var r=!0,s=0;s<this.buffers.length;s++){var c=this.buffers[s];if(e.fileStart<=c.fileStart){if(e.fileStart===c.fileStart)if(e.byteLength>c.byteLength){this.buffers.splice(s,1),s--;continue}else n.warn("MultiBufferStream","Buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+") already appended, ignoring");else e.fileStart+e.byteLength<=c.fileStart||(e=this.reduceBuffer(e,0,c.fileStart-e.fileStart)),n.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.splice(s,0,e),s===0&&(this.buffer=e);r=!1;break}else if(e.fileStart<c.fileStart+c.byteLength){var d=c.fileStart+c.byteLength-e.fileStart,_=e.byteLength-d;if(_>0)e=this.reduceBuffer(e,d,_);else{r=!1;break}}}r&&(n.debug("MultiBufferStream","Appending new buffer (fileStart: "+e.fileStart+" - Length: "+e.byteLength+")"),this.buffers.push(e),s===0&&(this.buffer=e))},u.prototype.logBufferLevel=function(e){var r,s,c,d,_=[],m,A="";for(c=0,d=0,r=0;r<this.buffers.length;r++)s=this.buffers[r],r===0?(m={},_.push(m),m.start=s.fileStart,m.end=s.fileStart+s.byteLength,A+="["+m.start+"-"):m.end===s.fileStart?m.end=s.fileStart+s.byteLength:(m={},m.start=s.fileStart,A+=_[_.length-1].end-1+"], ["+m.start+"-",m.end=s.fileStart+s.byteLength,_.push(m)),c+=s.usedBytes,d+=s.byteLength;_.length>0&&(A+=m.end-1+"]");var B=e?n.info:n.debug;this.buffers.length===0?B("MultiBufferStream","No more buffer in memory"):B("MultiBufferStream",""+this.buffers.length+" stored buffer(s) ("+c+"/"+d+" bytes), continuous ranges: "+A)},u.prototype.cleanBuffers=function(){var e,r;for(e=0;e<this.buffers.length;e++)r=this.buffers[e],r.usedBytes===r.byteLength&&(n.debug("MultiBufferStream","Removing buffer #"+e),this.buffers.splice(e,1),e--)},u.prototype.mergeNextBuffer=function(){var e;if(this.bufferIndex+1<this.buffers.length)if(e=this.buffers[this.bufferIndex+1],e.fileStart===this.buffer.fileStart+this.buffer.byteLength){var r=this.buffer.byteLength,s=this.buffer.usedBytes,c=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,e),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=s,this.buffer.fileStart=c,n.debug("ISOFile","Concatenating buffer for box parsing (length: "+r+"->"+this.buffer.byteLength+")"),!0}else return!1;else return!1},u.prototype.findPosition=function(e,r,s){var c,d=null,_=-1;for(e===!0?c=0:c=this.bufferIndex;c<this.buffers.length&&(d=this.buffers[c],d.fileStart<=r);){_=c,s&&(d.fileStart+d.byteLength<=r?d.usedBytes=d.byteLength:d.usedBytes=r-d.fileStart,this.logBufferLevel());c++}return _!==-1?(d=this.buffers[_],d.fileStart+d.byteLength>=r?(n.debug("MultiBufferStream","Found position in existing buffer #"+_),_):-1):-1},u.prototype.findEndContiguousBuf=function(e){var r,s,c,d=e!==void 0?e:this.bufferIndex;if(s=this.buffers[d],this.buffers.length>d+1)for(r=d+1;r<this.buffers.length&&(c=this.buffers[r],c.fileStart===s.fileStart+s.byteLength);r++)s=c;return s.fileStart+s.byteLength},u.prototype.getEndFilePositionAfter=function(e){var r=this.findPosition(!0,e,!1);return r!==-1?this.findEndContiguousBuf(r):e},u.prototype.addUsedBytes=function(e){this.buffer.usedBytes+=e,this.logBufferLevel()},u.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},u.prototype.seek=function(e,r,s){var c;return c=this.findPosition(r,e,s),c!==-1?(this.buffer=this.buffers[c],this.bufferIndex=c,this.position=e-this.buffer.fileStart,n.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(n.debug("MultiBufferStream","Position "+e+" not found in buffered data"),!1)},u.prototype.getPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},u.prototype.getLength=function(){return this.byteLength},u.prototype.getEndPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength},t.MultiBufferStream=u;var h=function(){var e=3,r=4,s=5,c=6,d=[];d[e]="ES_Descriptor",d[r]="DecoderConfigDescriptor",d[s]="DecoderSpecificInfo",d[c]="SLConfigDescriptor",this.getDescriptorName=function(A){return d[A]};var _=this,m={};return this.parseOneDescriptor=function(A){var B=0,T,C,P;for(T=A.readUint8(),P=A.readUint8();P&128;)B=(B<<7)+(P&127),P=A.readUint8();return B=(B<<7)+(P&127),n.debug("MPEG4DescriptorParser","Found "+(d[T]||"Descriptor "+T)+", size "+B+" at position "+A.getPosition()),d[T]?C=new m[d[T]](B):C=new m.Descriptor(B),C.parse(A),C},m.Descriptor=function(A,B){this.tag=A,this.size=B,this.descs=[]},m.Descriptor.prototype.parse=function(A){this.data=A.readUint8Array(this.size)},m.Descriptor.prototype.findDescriptor=function(A){for(var B=0;B<this.descs.length;B++)if(this.descs[B].tag==A)return this.descs[B];return null},m.Descriptor.prototype.parseRemainingDescriptors=function(A){for(var B=A.position;A.position<B+this.size;){var T=_.parseOneDescriptor(A);this.descs.push(T)}},m.ES_Descriptor=function(A){m.Descriptor.call(this,e,A)},m.ES_Descriptor.prototype=new m.Descriptor,m.ES_Descriptor.prototype.parse=function(A){if(this.ES_ID=A.readUint16(),this.flags=A.readUint8(),this.size-=3,this.flags&128?(this.dependsOn_ES_ID=A.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,this.flags&64){var B=A.readUint8();this.URL=A.readString(B),this.size-=B+1}else this.URL="";this.flags&32?(this.OCR_ES_ID=A.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(A)},m.ES_Descriptor.prototype.getOTI=function(A){var B=this.findDescriptor(r);return B?B.oti:0},m.ES_Descriptor.prototype.getAudioConfig=function(A){var B=this.findDescriptor(r);if(!B)return null;var T=B.findDescriptor(s);if(T&&T.data){var C=(T.data[0]&248)>>3;return C===31&&T.data.length>=2&&(C=32+((T.data[0]&7)<<3)+((T.data[1]&224)>>5)),C}else return null},m.DecoderConfigDescriptor=function(A){m.Descriptor.call(this,r,A)},m.DecoderConfigDescriptor.prototype=new m.Descriptor,m.DecoderConfigDescriptor.prototype.parse=function(A){this.oti=A.readUint8(),this.streamType=A.readUint8(),this.upStream=(this.streamType>>1&1)!==0,this.streamType=this.streamType>>>2,this.bufferSize=A.readUint24(),this.maxBitrate=A.readUint32(),this.avgBitrate=A.readUint32(),this.size-=13,this.parseRemainingDescriptors(A)},m.DecoderSpecificInfo=function(A){m.Descriptor.call(this,s,A)},m.DecoderSpecificInfo.prototype=new m.Descriptor,m.SLConfigDescriptor=function(A){m.Descriptor.call(this,c,A)},m.SLConfigDescriptor.prototype=new m.Descriptor,this};t.MPEG4DescriptorParser=h;var o={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:[{type:"mdat",name:"MediaDataBox"},{type:"idat",name:"ItemDataBox"},{type:"free",name:"FreeSpaceBox"},{type:"skip",name:"FreeSpaceBox"},{type:"meco",name:"AdditionalMetadataContainerBox"},{type:"strk",name:"SubTrackBox"}],FULL_BOXES:[{type:"hmhd",name:"HintMediaHeaderBox"},{type:"nmhd",name:"NullMediaHeaderBox"},{type:"iods",name:"ObjectDescriptorBox"},{type:"xml ",name:"XMLBox"},{type:"bxml",name:"BinaryXMLBox"},{type:"ipro",name:"ItemProtectionBox"},{type:"mere",name:"MetaboxRelationBox"}],CONTAINER_BOXES:[[{type:"moov",name:"CompressedMovieBox"},["trak","pssh"]],[{type:"trak",name:"TrackBox"}],[{type:"edts",name:"EditBox"}],[{type:"mdia",name:"MediaBox"}],[{type:"minf",name:"MediaInformationBox"}],[{type:"dinf",name:"DataInformationBox"}],[{type:"stbl",name:"SampleTableBox"},["sgpd","sbgp"]],[{type:"mvex",name:"MovieExtendsBox"},["trex"]],[{type:"moof",name:"CompressedMovieFragmentBox"},["traf"]],[{type:"traf",name:"TrackFragmentBox"},["trun","sgpd","sbgp"]],[{type:"vttc",name:"VTTCueBox"}],[{type:"tref",name:"TrackReferenceBox"}],[{type:"iref",name:"ItemReferenceBox"}],[{type:"mfra",name:"MovieFragmentRandomAccessBox"},["tfra"]],[{type:"meco",name:"AdditionalMetadataContainerBox"}],[{type:"hnti",name:"trackhintinformation"}],[{type:"hinf",name:"hintstatisticsbox"}],[{type:"strk",name:"SubTrackBox"}],[{type:"strd",name:"SubTrackDefinitionBox"}],[{type:"sinf",name:"ProtectionSchemeInfoBox"}],[{type:"rinf",name:"RestrictedSchemeInfoBox"}],[{type:"schi",name:"SchemeInformationBox"}],[{type:"trgr",name:"TrackGroupBox"}],[{type:"udta",name:"UserDataBox"},["kind"]],[{type:"iprp",name:"ItemPropertiesBox"},["ipma"]],[{type:"ipco",name:"ItemPropertyContainerBox"}],[{type:"grpl",name:"GroupsListBox"}],[{type:"j2kH",name:"J2KHeaderInfoBox"}],[{type:"etyp",name:"ExtendedTypeBox"},["tyco"]]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){o.FullBox.prototype=new o.Box,o.ContainerBox.prototype=new o.Box,o.SampleEntry.prototype=new o.Box,o.TrackGroupTypeBox.prototype=new o.FullBox,o.BASIC_BOXES.forEach(function(e){o.createBoxCtor(e.type,e.name)}),o.FULL_BOXES.forEach(function(e){o.createFullBoxCtor(e.type,e.name)}),o.CONTAINER_BOXES.forEach(function(e){o.createContainerBoxCtor(e[0].type,e[0].name,null,e[1])})},Box:function(e,r,s,c){this.type=e,this.box_name=s,this.size=r,this.uuid=c},FullBox:function(e,r,s,c){o.Box.call(this,e,r,s,c),this.flags=0,this.version=0},ContainerBox:function(e,r,s,c){o.Box.call(this,e,r,s,c),this.boxes=[]},SampleEntry:function(e,r,s,c){o.ContainerBox.call(this,e,r),this.hdr_size=s,this.start=c},SampleGroupEntry:function(e){this.grouping_type=e},TrackGroupTypeBox:function(e,r){o.FullBox.call(this,e,r)},createBoxCtor:function(e,r,s){o.boxCodes.push(e),o[e+"Box"]=function(c){o.Box.call(this,e,c,r)},o[e+"Box"].prototype=new o.Box,s&&(o[e+"Box"].prototype.parse=s)},createFullBoxCtor:function(e,r,s){o[e+"Box"]=function(c){o.FullBox.call(this,e,c,r)},o[e+"Box"].prototype=new o.FullBox,o[e+"Box"].prototype.parse=function(c){this.parseFullHeader(c),s&&s.call(this,c)}},addSubBoxArrays:function(e){if(e){this.subBoxNames=e;for(var r=e.length,s=0;s<r;s++)this[e[s]+"s"]=[]}},createContainerBoxCtor:function(e,r,s,c){o[e+"Box"]=function(d){o.ContainerBox.call(this,e,d,r),o.addSubBoxArrays.call(this,c)},o[e+"Box"].prototype=new o.ContainerBox,s&&(o[e+"Box"].prototype.parse=s)},createMediaSampleEntryCtor:function(e,r,s){o.sampleEntryCodes[e]=[],o[e+"SampleEntry"]=function(c,d){o.SampleEntry.call(this,c,d),o.addSubBoxArrays.call(this,s)},o[e+"SampleEntry"].prototype=new o.SampleEntry,r&&(o[e+"SampleEntry"].prototype.parse=r)},createSampleEntryCtor:function(e,r,s,c){o.sampleEntryCodes[e].push(r),o[r+"SampleEntry"]=function(d){o[e+"SampleEntry"].call(this,r,d),o.addSubBoxArrays.call(this,c)},o[r+"SampleEntry"].prototype=new o[e+"SampleEntry"],s&&(o[r+"SampleEntry"].prototype.parse=s)},createEncryptedSampleEntryCtor:function(e,r,s){o.createSampleEntryCtor.call(this,e,r,s,["sinf"])},createSampleGroupCtor:function(e,r){o[e+"SampleGroupEntry"]=function(s){o.SampleGroupEntry.call(this,e,s)},o[e+"SampleGroupEntry"].prototype=new o.SampleGroupEntry,r&&(o[e+"SampleGroupEntry"].prototype.parse=r)},createTrackGroupCtor:function(e,r){o[e+"TrackGroupTypeBox"]=function(s){o.TrackGroupTypeBox.call(this,e,s)},o[e+"TrackGroupTypeBox"].prototype=new o.TrackGroupTypeBox,r&&(o[e+"TrackGroupTypeBox"].prototype.parse=r)},createUUIDBox:function(e,r,s,c,d){o.UUIDs.push(e),o.UUIDBoxes[e]=function(_){s?o.FullBox.call(this,"uuid",_,r,e):c?o.ContainerBox.call(this,"uuid",_,r,e):o.Box.call(this,"uuid",_,r,e)},o.UUIDBoxes[e].prototype=s?new o.FullBox:c?new o.ContainerBox:new o.Box,d&&(s?o.UUIDBoxes[e].prototype.parse=function(_){this.parseFullHeader(_),d&&d.call(this,_)}:o.UUIDBoxes[e].prototype.parse=d)}};o.initialize(),o.TKHD_FLAG_ENABLED=1,o.TKHD_FLAG_IN_MOVIE=2,o.TKHD_FLAG_IN_PREVIEW=4,o.TFHD_FLAG_BASE_DATA_OFFSET=1,o.TFHD_FLAG_SAMPLE_DESC=2,o.TFHD_FLAG_SAMPLE_DUR=8,o.TFHD_FLAG_SAMPLE_SIZE=16,o.TFHD_FLAG_SAMPLE_FLAGS=32,o.TFHD_FLAG_DUR_EMPTY=65536,o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,o.TRUN_FLAGS_DATA_OFFSET=1,o.TRUN_FLAGS_FIRST_FLAG=4,o.TRUN_FLAGS_DURATION=256,o.TRUN_FLAGS_SIZE=512,o.TRUN_FLAGS_FLAGS=1024,o.TRUN_FLAGS_CTS_OFFSET=2048,o.Box.prototype.add=function(e){return this.addBox(new o[e+"Box"])},o.Box.prototype.addBox=function(e){return this.boxes.push(e),this[e.type+"s"]?this[e.type+"s"].push(e):this[e.type]=e,e},o.Box.prototype.set=function(e,r){return this[e]=r,this},o.Box.prototype.addEntry=function(e,r){var s=r||"entries";return this[s]||(this[s]=[]),this[s].push(e),this},t.BoxParser=o,o.parseUUID=function(e){return o.parseHex16(e)},o.parseHex16=function(e){for(var r="",s=0;s<16;s++){var c=e.readUint8().toString(16);r+=c.length===1?"0"+c:c}return r},o.parseOneBox=function(e,r,s){var c,d=e.getPosition(),_=0,m,A;if(e.getEndPosition()-d<8)return n.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:o.ERR_NOT_ENOUGH_DATA};if(s&&s<8)return n.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:o.ERR_NOT_ENOUGH_DATA};var B=e.readUint32(),T=e.readString(4),C=T;if(n.debug("BoxParser","Found box of type '"+T+"' and size "+B+" at position "+d),_=8,T=="uuid"){if(e.getEndPosition()-e.getPosition()<16||s-_<16)return e.seek(d),n.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:o.ERR_NOT_ENOUGH_DATA};A=o.parseUUID(e),_+=16,C=A}if(B==1){if(e.getEndPosition()-e.getPosition()<8||s&&s-_<8)return e.seek(d),n.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+T+'" box'),{code:o.ERR_NOT_ENOUGH_DATA};B=e.readUint64(),_+=8}else if(B===0){if(s)B=s;else if(T!=="mdat")return n.error("BoxParser","Unlimited box size not supported for type: '"+T+"'"),c=new o.Box(T,B),{code:o.OK,box:c,size:c.size}}return B!==0&&B<_?(n.error("BoxParser","Box of type "+T+" has an invalid size "+B+" (too small to be a box)"),{code:o.ERR_NOT_ENOUGH_DATA,type:T,size:B,hdr_size:_,start:d}):B!==0&&s&&B>s?(n.error("BoxParser","Box of type '"+T+"' has a size "+B+" greater than its container size "+s),{code:o.ERR_NOT_ENOUGH_DATA,type:T,size:B,hdr_size:_,start:d}):B!==0&&d+B>e.getEndPosition()?(e.seek(d),n.info("BoxParser","Not enough data in stream to parse the entire '"+T+"' box"),{code:o.ERR_NOT_ENOUGH_DATA,type:T,size:B,hdr_size:_,start:d}):r?{code:o.OK,type:T,size:B,hdr_size:_,start:d}:(o[T+"Box"]?c=new o[T+"Box"](B):T!=="uuid"?(n.warn("BoxParser","Unknown box type: '"+T+"'"),c=new o.Box(T,B),c.has_unparsed_data=!0):o.UUIDBoxes[A]?c=new o.UUIDBoxes[A](B):(n.warn("BoxParser","Unknown uuid type: '"+A+"'"),c=new o.Box(T,B),c.uuid=A,c.has_unparsed_data=!0),c.hdr_size=_,c.start=d,c.write===o.Box.prototype.write&&c.type!=="mdat"&&(n.info("BoxParser","'"+C+"' box writing not yet implemented, keeping unparsed data in memory for later write"),c.parseDataAndRewind(e)),c.parse(e),m=e.getPosition()-(c.start+c.size),m<0?(n.warn("BoxParser","Parsing of box '"+C+"' did not read the entire indicated box data size (missing "+-m+" bytes), seeking forward"),e.seek(c.start+c.size)):m>0&&(n.error("BoxParser","Parsing of box '"+C+"' read "+m+" more bytes than the indicated box data size, seeking backwards"),c.size!==0&&e.seek(c.start+c.size)),{code:o.OK,box:c,size:c.size})},o.Box.prototype.parse=function(e){this.type!="mdat"?this.data=e.readUint8Array(this.size-this.hdr_size):this.size===0?e.seek(e.getEndPosition()):e.seek(this.start+this.size)},o.Box.prototype.parseDataAndRewind=function(e){this.data=e.readUint8Array(this.size-this.hdr_size),e.position-=this.size-this.hdr_size},o.FullBox.prototype.parseDataAndRewind=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,e.position-=this.size-this.hdr_size},o.FullBox.prototype.parseFullHeader=function(e){this.version=e.readUint8(),this.flags=e.readUint24(),this.hdr_size+=4},o.FullBox.prototype.parse=function(e){this.parseFullHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},o.ContainerBox.prototype.parse=function(e){for(var r,s;e.getPosition()<this.start+this.size;)if(r=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),r.code===o.OK)if(s=r.box,this.boxes.push(s),this.subBoxNames&&this.subBoxNames.indexOf(s.type)!=-1)this[this.subBoxNames[this.subBoxNames.indexOf(s.type)]+"s"].push(s);else{var c=s.type!=="uuid"?s.type:s.uuid;this[c]?n.warn("Box of type "+c+" already stored in field of this type"):this[c]=s}else return},o.Box.prototype.parseLanguage=function(e){this.language=e.readUint16();var r=[];r[0]=this.language>>10&31,r[1]=this.language>>5&31,r[2]=this.language&31,this.languageString=String.fromCharCode(r[0]+96,r[1]+96,r[2]+96)},o.SAMPLE_ENTRY_TYPE_VISUAL="Visual",o.SAMPLE_ENTRY_TYPE_AUDIO="Audio",o.SAMPLE_ENTRY_TYPE_HINT="Hint",o.SAMPLE_ENTRY_TYPE_METADATA="Metadata",o.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",o.SAMPLE_ENTRY_TYPE_SYSTEM="System",o.SAMPLE_ENTRY_TYPE_TEXT="Text",o.SampleEntry.prototype.parseHeader=function(e){e.readUint8Array(6),this.data_reference_index=e.readUint16(),this.hdr_size+=8},o.SampleEntry.prototype.parse=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size)},o.SampleEntry.prototype.parseDataAndRewind=function(e){this.parseHeader(e),this.data=e.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,e.position-=this.size-this.hdr_size},o.SampleEntry.prototype.parseFooter=function(e){o.ContainerBox.prototype.parse.call(this,e)},o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_HINT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,function(e){var r;this.parseHeader(e),e.readUint16(),e.readUint16(),e.readUint32Array(3),this.width=e.readUint16(),this.height=e.readUint16(),this.horizresolution=e.readUint32(),this.vertresolution=e.readUint32(),e.readUint32(),this.frame_count=e.readUint16(),r=Math.min(31,e.readUint8()),this.compressorname=e.readString(r),r<31&&e.readString(31-r),this.depth=e.readUint16(),e.readUint16(),this.parseFooter(e)}),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,function(e){this.parseHeader(e),e.readUint32Array(2),this.channel_count=e.readUint16(),this.samplesize=e.readUint16(),e.readUint16(),e.readUint16(),this.samplerate=e.readUint32()/65536,this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dav1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvt1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"lhe1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dvh1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dvhe"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avs3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"j2ki"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"mjp2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"mjpg"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"uncv"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mha1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mha2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mhm1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mhm2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"fLaC"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT,"enct"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"encm"),o.createBoxCtor("a1lx","AV1LayeredImageIndexingProperty",function(e){var r=e.readUint8()&1,s=((r&1)+1)*16;this.layer_size=[];for(var c=0;c<3;c++)s==16?this.layer_size[c]=e.readUint16():this.layer_size[c]=e.readUint32()}),o.createBoxCtor("a1op","OperatingPointSelectorProperty",function(e){this.op_index=e.readUint8()}),o.createFullBoxCtor("auxC","AuxiliaryTypeProperty",function(e){this.aux_type=e.readCString();var r=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=e.readUint8Array(r)}),o.createBoxCtor("av1C","AV1CodecConfigurationBox",function(e){var r=e.readUint8();if((r>>7&1)!==1){n.error("av1C marker problem");return}if(this.version=r&127,this.version!==1){n.error("av1C version "+this.version+" not supported");return}if(r=e.readUint8(),this.seq_profile=r>>5&7,this.seq_level_idx_0=r&31,r=e.readUint8(),this.seq_tier_0=r>>7&1,this.high_bitdepth=r>>6&1,this.twelve_bit=r>>5&1,this.monochrome=r>>4&1,this.chroma_subsampling_x=r>>3&1,this.chroma_subsampling_y=r>>2&1,this.chroma_sample_position=r&3,r=e.readUint8(),this.reserved_1=r>>5&7,this.reserved_1!==0){n.error("av1C reserved_1 parsing problem");return}if(this.initial_presentation_delay_present=r>>4&1,this.initial_presentation_delay_present===1)this.initial_presentation_delay_minus_one=r&15;else if(this.reserved_2=r&15,this.reserved_2!==0){n.error("av1C reserved_2 parsing problem");return}var s=this.size-this.hdr_size-4;this.configOBUs=e.readUint8Array(s)});function p(e){var r="<table class='inner-table'>";r+="<thead><tr><th>length</th><th>nalu_data</th></tr></thead>",r+="<tbody>";for(var s=0;s<e.length;s++){var c=e[s];r+="<tr>",r+="<td>"+c.length+"</td>",r+="<td>",r+=c.nalu.reduce(function(d,_){return d+_.toString(16).padStart(2,"0")},"0x"),r+="</td></tr>"}return r+="</tbody></table>",r}o.createBoxCtor("avcC","AVCConfigurationBox",function(e){var r,s;for(this.configurationVersion=e.readUint8(),this.AVCProfileIndication=e.readUint8(),this.profile_compatibility=e.readUint8(),this.AVCLevelIndication=e.readUint8(),this.lengthSizeMinusOne=e.readUint8()&3,this.nb_SPS_nalus=e.readUint8()&31,s=this.size-this.hdr_size-6,this.SPS=[],this.SPS.toString=function(){return p(this)},r=0;r<this.nb_SPS_nalus;r++)this.SPS[r]={},this.SPS[r].length=e.readUint16(),this.SPS[r].nalu=e.readUint8Array(this.SPS[r].length),s-=2+this.SPS[r].length;for(this.nb_PPS_nalus=e.readUint8(),s--,this.PPS=[],this.PPS.toString=function(){return p(this)},r=0;r<this.nb_PPS_nalus;r++)this.PPS[r]={},this.PPS[r].length=e.readUint16(),this.PPS[r].nalu=e.readUint8Array(this.PPS[r].length),s-=2+this.PPS[r].length;s>0&&(this.ext=e.readUint8Array(s))}),o.createBoxCtor("btrt","BitRateBox",function(e){this.bufferSizeDB=e.readUint32(),this.maxBitrate=e.readUint32(),this.avgBitrate=e.readUint32()}),o.createFullBoxCtor("ccst","CodingConstraintsBox",function(e){var r=e.readUint8();this.all_ref_pics_intra=(r&128)==128,this.intra_pred_used=(r&64)==64,this.max_ref_per_pic=(r&63)>>2,e.readUint24()}),o.createBoxCtor("cdef","ComponentDefinitionBox",function(e){var r;for(this.channel_count=e.readUint16(),this.channel_indexes=[],this.channel_types=[],this.channel_associations=[],r=0;r<this.channel_count;r++)this.channel_indexes.push(e.readUint16()),this.channel_types.push(e.readUint16()),this.channel_associations.push(e.readUint16())}),o.createBoxCtor("clap","CleanApertureBox",function(e){this.cleanApertureWidthN=e.readUint32(),this.cleanApertureWidthD=e.readUint32(),this.cleanApertureHeightN=e.readUint32(),this.cleanApertureHeightD=e.readUint32(),this.horizOffN=e.readUint32(),this.horizOffD=e.readUint32(),this.vertOffN=e.readUint32(),this.vertOffD=e.readUint32()}),o.createBoxCtor("clli","ContentLightLevelBox",function(e){this.max_content_light_level=e.readUint16(),this.max_pic_average_light_level=e.readUint16()}),o.createFullBoxCtor("cmex","CameraExtrinsicMatrixProperty",function(e){this.flags&1&&(this.pos_x=e.readInt32()),this.flags&2&&(this.pos_y=e.readInt32()),this.flags&4&&(this.pos_z=e.readInt32()),this.flags&8&&(this.version==0?this.flags&16?(this.quat_x=e.readInt32(),this.quat_y=e.readInt32(),this.quat_z=e.readInt32()):(this.quat_x=e.readInt16(),this.quat_y=e.readInt16(),this.quat_z=e.readInt16()):this.version==1),this.flags&32&&(this.id=e.readUint32())}),o.createFullBoxCtor("cmin","CameraIntrinsicMatrixProperty",function(e){this.focal_length_x=e.readInt32(),this.principal_point_x=e.readInt32(),this.principal_point_y=e.readInt32(),this.flags&1&&(this.focal_length_y=e.readInt32(),this.skew_factor=e.readInt32())}),o.createBoxCtor("cmpd","ComponentDefinitionBox",function(e){for(this.component_count=e.readUint32(),this.component_types=[],this.component_type_urls=[],i=0;i<this.component_count;i++){var r=e.readUint16();this.component_types.push(r),r>=32768&&this.component_type_urls.push(e.readCString())}}),o.createFullBoxCtor("co64","ChunkLargeOffsetBox",function(e){var r,s;if(r=e.readUint32(),this.chunk_offsets=[],this.version===0)for(s=0;s<r;s++)this.chunk_offsets.push(e.readUint64())}),o.createFullBoxCtor("CoLL","ContentLightLevelBox",function(e){this.maxCLL=e.readUint16(),this.maxFALL=e.readUint16()}),o.createBoxCtor("colr","ColourInformationBox",function(e){if(this.colour_type=e.readString(4),this.colour_type==="nclx"){this.colour_primaries=e.readUint16(),this.transfer_characteristics=e.readUint16(),this.matrix_coefficients=e.readUint16();var r=e.readUint8();this.full_range_flag=r>>7}else this.colour_type==="rICC"?this.ICC_profile=e.readUint8Array(this.size-4):this.colour_type==="prof"&&(this.ICC_profile=e.readUint8Array(this.size-4))}),o.createFullBoxCtor("cprt","CopyrightBox",function(e){this.parseLanguage(e),this.notice=e.readCString()}),o.createFullBoxCtor("cslg","CompositionToDecodeBox",function(e){this.version===0&&(this.compositionToDTSShift=e.readInt32(),this.leastDecodeToDisplayDelta=e.readInt32(),this.greatestDecodeToDisplayDelta=e.readInt32(),this.compositionStartTime=e.readInt32(),this.compositionEndTime=e.readInt32())}),o.createFullBoxCtor("ctts","CompositionOffsetBox",function(e){var r,s;if(r=e.readUint32(),this.sample_counts=[],this.sample_offsets=[],this.version===0)for(s=0;s<r;s++){this.sample_counts.push(e.readUint32());var c=e.readInt32();c<0&&n.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(c)}else if(this.version==1)for(s=0;s<r;s++)this.sample_counts.push(e.readUint32()),this.sample_offsets.push(e.readInt32())}),o.createBoxCtor("dac3","AC3SpecificBox",function(e){var r=e.readUint8(),s=e.readUint8(),c=e.readUint8();this.fscod=r>>6,this.bsid=r>>1&31,this.bsmod=(r&1)<<2|s>>6&3,this.acmod=s>>3&7,this.lfeon=s>>2&1,this.bit_rate_code=s&3|c>>5&7}),o.createBoxCtor("dec3","EC3SpecificBox",function(e){var r=e.readUint16();this.data_rate=r>>3,this.num_ind_sub=r&7,this.ind_subs=[];for(var s=0;s<this.num_ind_sub+1;s++){var c={};this.ind_subs.push(c);var d=e.readUint8(),_=e.readUint8(),m=e.readUint8();c.fscod=d>>6,c.bsid=d>>1&31,c.bsmod=(d&1)<<4|_>>4&15,c.acmod=_>>1&7,c.lfeon=_&1,c.num_dep_sub=m>>1&15,c.num_dep_sub>0&&(c.chan_loc=(m&1)<<8|e.readUint8())}}),o.createFullBoxCtor("dfLa","FLACSpecificBox",function(e){var r=127,s=128,c=[],d=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];do{var _=e.readUint8(),m=Math.min(_&r,d.length-1);if(m?e.readUint8Array(e.readUint24()):(e.readUint8Array(13),this.samplerate=e.readUint32()>>12,e.readUint8Array(20)),c.push(d[m]),_&s)break}while(!0);this.numMetadataBlocks=c.length+" ("+c.join(", ")+")"}),o.createBoxCtor("dimm","hintimmediateBytesSent",function(e){this.bytessent=e.readUint64()}),o.createBoxCtor("dmax","hintlongestpacket",function(e){this.time=e.readUint32()}),o.createBoxCtor("dmed","hintmediaBytesSent",function(e){this.bytessent=e.readUint64()}),o.createBoxCtor("dOps","OpusSpecificBox",function(e){if(this.Version=e.readUint8(),this.OutputChannelCount=e.readUint8(),this.PreSkip=e.readUint16(),this.InputSampleRate=e.readUint32(),this.OutputGain=e.readInt16(),this.ChannelMappingFamily=e.readUint8(),this.ChannelMappingFamily!==0){this.StreamCount=e.readUint8(),this.CoupledCount=e.readUint8(),this.ChannelMapping=[];for(var r=0;r<this.OutputChannelCount;r++)this.ChannelMapping[r]=e.readUint8()}}),o.createFullBoxCtor("dref","DataReferenceBox",function(e){var r,s;this.entries=[];for(var c=e.readUint32(),d=0;d<c;d++)if(r=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),r.code===o.OK)s=r.box,this.entries.push(s);else return}),o.createBoxCtor("drep","hintrepeatedBytesSent",function(e){this.bytessent=e.readUint64()}),o.createFullBoxCtor("elng","ExtendedLanguageBox",function(e){this.extended_language=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("elst","EditListBox",function(e){this.entries=[];for(var r=e.readUint32(),s=0;s<r;s++){var c={};this.entries.push(c),this.version===1?(c.segment_duration=e.readUint64(),c.media_time=e.readInt64()):(c.segment_duration=e.readUint32(),c.media_time=e.readInt32()),c.media_rate_integer=e.readInt16(),c.media_rate_fraction=e.readInt16()}}),o.createFullBoxCtor("emsg","EventMessageBox",function(e){this.version==1?(this.timescale=e.readUint32(),this.presentation_time=e.readUint64(),this.event_duration=e.readUint32(),this.id=e.readUint32(),this.scheme_id_uri=e.readCString(),this.value=e.readCString()):(this.scheme_id_uri=e.readCString(),this.value=e.readCString(),this.timescale=e.readUint32(),this.presentation_time_delta=e.readUint32(),this.event_duration=e.readUint32(),this.id=e.readUint32());var r=this.size-this.hdr_size-(4*4+(this.scheme_id_uri.length+1)+(this.value.length+1));this.version==1&&(r-=4),this.message_data=e.readUint8Array(r)}),o.createEntityToGroupCtor=function(e,r){o[e+"Box"]=function(s){o.FullBox.call(this,e,s)},o[e+"Box"].prototype=new o.FullBox,o[e+"Box"].prototype.parse=function(s){if(this.parseFullHeader(s),r)r.call(this,s);else for(this.group_id=s.readUint32(),this.num_entities_in_group=s.readUint32(),this.entity_ids=[],i=0;i<this.num_entities_in_group;i++){var c=s.readUint32();this.entity_ids.push(c)}}},o.createEntityToGroupCtor("aebr"),o.createEntityToGroupCtor("afbr"),o.createEntityToGroupCtor("albc"),o.createEntityToGroupCtor("altr"),o.createEntityToGroupCtor("brst"),o.createEntityToGroupCtor("dobr"),o.createEntityToGroupCtor("eqiv"),o.createEntityToGroupCtor("favc"),o.createEntityToGroupCtor("fobr"),o.createEntityToGroupCtor("iaug"),o.createEntityToGroupCtor("pano"),o.createEntityToGroupCtor("slid"),o.createEntityToGroupCtor("ster"),o.createEntityToGroupCtor("tsyn"),o.createEntityToGroupCtor("wbbr"),o.createEntityToGroupCtor("prgr"),o.createEntityToGroupCtor("pymd",function(e){this.group_id=e.readUint32(),this.num_entities_in_group=e.readUint32(),this.entity_ids=[];for(var r=0;r<this.num_entities_in_group;r++){var s=e.readUint32();this.entity_ids.push(s)}for(this.tile_size_x=e.readUint16(),this.tile_size_y=e.readUint16(),this.layer_binning=[],this.tiles_in_layer_column_minus1=[],this.tiles_in_layer_row_minus1=[],r=0;r<this.num_entities_in_group;r++)this.layer_binning[r]=e.readUint16(),this.tiles_in_layer_row_minus1[r]=e.readUint16(),this.tiles_in_layer_column_minus1[r]=e.readUint16()}),o.createFullBoxCtor("esds","ElementaryStreamDescriptorBox",function(e){var r=e.readUint8Array(this.size-this.hdr_size);if(typeof h<"u"){var s=new h;this.esd=s.parseOneDescriptor(new l(r.buffer,0,l.BIG_ENDIAN))}}),o.createBoxCtor("fiel","FieldHandlingBox",function(e){this.fieldCount=e.readUint8(),this.fieldOrdering=e.readUint8()}),o.createBoxCtor("frma","OriginalFormatBox",function(e){this.data_format=e.readString(4)}),o.createBoxCtor("ftyp","FileTypeBox",function(e){var r=this.size-this.hdr_size;this.major_brand=e.readString(4),this.minor_version=e.readUint32(),r-=8,this.compatible_brands=[];for(var s=0;r>=4;)this.compatible_brands[s]=e.readString(4),r-=4,s++}),o.createFullBoxCtor("hdlr","HandlerBox",function(e){this.version===0&&(e.readUint32(),this.handler=e.readString(4),e.readUint32Array(3),this.name=e.readString(this.size-this.hdr_size-20),this.name[this.name.length-1]==="\0"&&(this.name=this.name.slice(0,-1)))}),o.createBoxCtor("hvcC","HEVCConfigurationBox",function(e){var r,s,c,d;this.configurationVersion=e.readUint8(),d=e.readUint8(),this.general_profile_space=d>>6,this.general_tier_flag=(d&32)>>5,this.general_profile_idc=d&31,this.general_profile_compatibility=e.readUint32(),this.general_constraint_indicator=e.readUint8Array(6),this.general_level_idc=e.readUint8(),this.min_spatial_segmentation_idc=e.readUint16()&4095,this.parallelismType=e.readUint8()&3,this.chroma_format_idc=e.readUint8()&3,this.bit_depth_luma_minus8=e.readUint8()&7,this.bit_depth_chroma_minus8=e.readUint8()&7,this.avgFrameRate=e.readUint16(),d=e.readUint8(),this.constantFrameRate=d>>6,this.numTemporalLayers=(d&13)>>3,this.temporalIdNested=(d&4)>>2,this.lengthSizeMinusOne=d&3,this.nalu_arrays=[],this.nalu_arrays.toString=function(){var T="<table class='inner-table'>";T+="<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>",T+="<tbody>";for(var C=0;C<this.length;C++){var P=this[C];T+="<tr>",T+="<td rowspan='"+P.length+"'>"+P.completeness+"</td>",T+="<td rowspan='"+P.length+"'>"+P.nalu_type+"</td>";for(var L=0;L<P.length;L++){var R=P[L];L!==0&&(T+="<tr>"),T+="<td>",T+=R.data.reduce(function(X,W){return X+W.toString(16).padStart(2,"0")},"0x"),T+="</td></tr>"}}return T+="</tbody></table>",T};var _=e.readUint8();for(r=0;r<_;r++){var m=[];this.nalu_arrays.push(m),d=e.readUint8(),m.completeness=(d&128)>>7,m.nalu_type=d&63;var A=e.readUint16();for(s=0;s<A;s++){var B={};m.push(B),c=e.readUint16(),B.data=e.readUint8Array(c)}}}),o.createFullBoxCtor("iinf","ItemInfoBox",function(e){var r;this.version===0?this.entry_count=e.readUint16():this.entry_count=e.readUint32(),this.item_infos=[];for(var s=0;s<this.entry_count;s++)if(r=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),r.code===o.OK)r.box.type!=="infe"&&n.error("BoxParser","Expected 'infe' box, got "+r.box.type),this.item_infos[s]=r.box;else return}),o.createFullBoxCtor("iloc","ItemLocationBox",function(e){var r;r=e.readUint8(),this.offset_size=r>>4&15,this.length_size=r&15,r=e.readUint8(),this.base_offset_size=r>>4&15,this.version===1||this.version===2?this.index_size=r&15:this.index_size=0,this.items=[];var s=0;if(this.version<2)s=e.readUint16();else if(this.version===2)s=e.readUint32();else throw"version of iloc box not supported";for(var c=0;c<s;c++){var d={};if(this.items.push(d),this.version<2)d.item_ID=e.readUint16();else if(this.version===2)d.item_ID=e.readUint32();else throw"version of iloc box not supported";switch(this.version===1||this.version===2?d.construction_method=e.readUint16()&15:d.construction_method=0,d.data_reference_index=e.readUint16(),this.base_offset_size){case 0:d.base_offset=0;break;case 4:d.base_offset=e.readUint32();break;case 8:d.base_offset=e.readUint64();break;default:throw"Error reading base offset size"}var _=e.readUint16();d.extents=[];for(var m=0;m<_;m++){var A={};if(d.extents.push(A),this.version===1||this.version===2)switch(this.index_size){case 0:A.extent_index=0;break;case 4:A.extent_index=e.readUint32();break;case 8:A.extent_index=e.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:A.extent_offset=0;break;case 4:A.extent_offset=e.readUint32();break;case 8:A.extent_offset=e.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:A.extent_length=0;break;case 4:A.extent_length=e.readUint32();break;case 8:A.extent_length=e.readUint64();break;default:throw"Error reading extent index"}}}}),o.createBoxCtor("imir","ImageMirror",function(e){var r=e.readUint8();this.reserved=r>>7,this.axis=r&1}),o.createFullBoxCtor("infe","ItemInfoEntry",function(e){if((this.version===0||this.version===1)&&(this.item_ID=e.readUint16(),this.item_protection_index=e.readUint16(),this.item_name=e.readCString(),this.content_type=e.readCString(),this.content_encoding=e.readCString()),this.version===1){this.extension_type=e.readString(4),n.warn("BoxParser","Cannot parse extension type"),e.seek(this.start+this.size);return}this.version>=2&&(this.version===2?this.item_ID=e.readUint16():this.version===3&&(this.item_ID=e.readUint32()),this.item_protection_index=e.readUint16(),this.item_type=e.readString(4),this.item_name=e.readCString(),this.item_type==="mime"?(this.content_type=e.readCString(),this.content_encoding=e.readCString()):this.item_type==="uri "&&(this.item_uri_type=e.readCString()))}),o.createFullBoxCtor("ipma","ItemPropertyAssociationBox",function(e){var r,s;for(entry_count=e.readUint32(),this.associations=[],r=0;r<entry_count;r++){var c={};this.associations.push(c),this.version<1?c.id=e.readUint16():c.id=e.readUint32();var d=e.readUint8();for(c.props=[],s=0;s<d;s++){var _=e.readUint8(),m={};c.props.push(m),m.essential=(_&128)>>7===1,this.flags&1?m.property_index=(_&127)<<8|e.readUint8():m.property_index=_&127}}}),o.createFullBoxCtor("iref","ItemReferenceBox",function(e){var r,s;for(this.references=[];e.getPosition()<this.start+this.size;)if(r=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),r.code===o.OK)this.version===0?s=new o.SingleItemTypeReferenceBox(r.type,r.size,r.hdr_size,r.start):s=new o.SingleItemTypeReferenceBoxLarge(r.type,r.size,r.hdr_size,r.start),s.write===o.Box.prototype.write&&s.type!=="mdat"&&(n.warn("BoxParser",s.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),s.parseDataAndRewind(e)),s.parse(e),this.references.push(s);else return}),o.createBoxCtor("irot","ImageRotation",function(e){this.angle=e.readUint8()&3}),o.createFullBoxCtor("ispe","ImageSpatialExtentsProperty",function(e){this.image_width=e.readUint32(),this.image_height=e.readUint32()}),o.createFullBoxCtor("kind","KindBox",function(e){this.schemeURI=e.readCString(),this.value=e.readCString()}),o.createFullBoxCtor("leva","LevelAssignmentBox",function(e){var r=e.readUint8();this.levels=[];for(var s=0;s<r;s++){var c={};this.levels[s]=c,c.track_ID=e.readUint32();var d=e.readUint8();switch(c.padding_flag=d>>7,c.assignment_type=d&127,c.assignment_type){case 0:c.grouping_type=e.readString(4);break;case 1:c.grouping_type=e.readString(4),c.grouping_type_parameter=e.readUint32();break;case 2:break;case 3:break;case 4:c.sub_track_id=e.readUint32();break;default:n.warn("BoxParser","Unknown leva assignement type")}}}),o.createBoxCtor("lhvC","LHEVCConfigurationBox",function(e){var r,s,c;this.configurationVersion=e.readUint8(),this.min_spatial_segmentation_idc=e.readUint16()&4095,this.parallelismType=e.readUint8()&3,c=e.readUint8(),this.numTemporalLayers=(c&13)>>3,this.temporalIdNested=(c&4)>>2,this.lengthSizeMinusOne=c&3,this.nalu_arrays=[],this.nalu_arrays.toString=function(){var T="<table class='inner-table'>";T+="<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>",T+="<tbody>";for(var C=0;C<this.length;C++){var P=this[C];T+="<tr>",T+="<td rowspan='"+P.length+"'>"+P.completeness+"</td>",T+="<td rowspan='"+P.length+"'>"+P.nalu_type+"</td>";for(var L=0;L<P.length;L++){var R=P[L];L!==0&&(T+="<tr>"),T+="<td>",T+=R.data.reduce(function(X,W){return X+W.toString(16).padStart(2,"0")},"0x"),T+="</td></tr>"}}return T+="</tbody></table>",T};var d=e.readUint8();for(r=0;r<d;r++){var _=[];this.nalu_arrays.push(_),c=e.readUint8(),_.completeness=(c&128)>>7,_.nalu_type=c&63;var m=e.readUint16();for(s=0;s<m;s++){var A={};_.push(A);var B=e.readUint16();A.data=e.readUint8Array(B)}}}),o.createBoxCtor("lsel","LayerSelectorProperty",function(e){this.layer_id=e.readUint16()}),o.createBoxCtor("maxr","hintmaxrate",function(e){this.period=e.readUint32(),this.bytes=e.readUint32()});function g(e,r){this.x=e,this.y=r}g.prototype.toString=function(){return"("+this.x+","+this.y+")"},o.createBoxCtor("mdcv","MasteringDisplayColourVolumeBox",function(e){this.display_primaries=[],this.display_primaries[0]=new g(e.readUint16(),e.readUint16()),this.display_primaries[1]=new g(e.readUint16(),e.readUint16()),this.display_primaries[2]=new g(e.readUint16(),e.readUint16()),this.white_point=new g(e.readUint16(),e.readUint16()),this.max_display_mastering_luminance=e.readUint32(),this.min_display_mastering_luminance=e.readUint32()}),o.createFullBoxCtor("mdhd","MediaHeaderBox",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.parseLanguage(e),e.readUint16()}),o.createFullBoxCtor("mehd","MovieExtendsHeaderBox",function(e){this.flags&1&&(n.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.version==1?this.fragment_duration=e.readUint64():this.fragment_duration=e.readUint32()}),o.createFullBoxCtor("meta","MetaBox",function(e){this.boxes=[],o.ContainerBox.prototype.parse.call(this,e)}),o.createFullBoxCtor("mfhd","MovieFragmentHeaderBox",function(e){this.sequence_number=e.readUint32()}),o.createFullBoxCtor("mfro","MovieFragmentRandomAccessOffsetBox",function(e){this._size=e.readUint32()}),o.createFullBoxCtor("mskC","MaskConfigurationProperty",function(e){this.bits_per_pixel=e.readUint8()}),o.createFullBoxCtor("mvhd","MovieHeaderBox",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.timescale=e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.timescale=e.readUint32(),this.duration=e.readUint32()),this.rate=e.readUint32(),this.volume=e.readUint16()>>8,e.readUint16(),e.readUint32Array(2),this.matrix=e.readUint32Array(9),e.readUint32Array(6),this.next_track_id=e.readUint32()}),o.createBoxCtor("npck","hintPacketsSent",function(e){this.packetssent=e.readUint32()}),o.createBoxCtor("nump","hintPacketsSent",function(e){this.packetssent=e.readUint64()}),o.createFullBoxCtor("padb","PaddingBitsBox",function(e){var r=e.readUint32();this.padbits=[];for(var s=0;s<Math.floor((r+1)/2);s++)this.padbits=e.readUint8()}),o.createBoxCtor("pasp","PixelAspectRatioBox",function(e){this.hSpacing=e.readUint32(),this.vSpacing=e.readUint32()}),o.createBoxCtor("payl","CuePayloadBox",function(e){this.text=e.readString(this.size-this.hdr_size)}),o.createBoxCtor("payt","hintpayloadID",function(e){this.payloadID=e.readUint32();var r=e.readUint8();this.rtpmap_string=e.readString(r)}),o.createFullBoxCtor("pdin","ProgressiveDownloadInfoBox",function(e){var r=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var s=0;s<r;s++)this.rate[s]=e.readUint32(),this.initial_delay[s]=e.readUint32()}),o.createFullBoxCtor("pitm","PrimaryItemBox",function(e){this.version===0?this.item_id=e.readUint16():this.item_id=e.readUint32()}),o.createFullBoxCtor("pixi","PixelInformationProperty",function(e){var r;for(this.num_channels=e.readUint8(),this.bits_per_channels=[],r=0;r<this.num_channels;r++)this.bits_per_channels[r]=e.readUint8()}),o.createBoxCtor("pmax","hintlargestpacket",function(e){this.bytes=e.readUint32()}),o.createFullBoxCtor("prdi","ProgressiveDerivedImageItemInformationProperty",function(e){if(this.step_count=e.readUint16(),this.item_count=[],this.flags&2)for(var r=0;r<this.step_count;r++)this.item_count[r]=e.readUint16()}),o.createFullBoxCtor("prft","ProducerReferenceTimeBox",function(e){this.ref_track_id=e.readUint32(),this.ntp_timestamp=e.readUint64(),this.version===0?this.media_time=e.readUint32():this.media_time=e.readUint64()}),o.createFullBoxCtor("pssh","ProtectionSystemSpecificHeaderBox",function(e){if(this.system_id=o.parseHex16(e),this.version>0){var r=e.readUint32();this.kid=[];for(var s=0;s<r;s++)this.kid[s]=o.parseHex16(e)}var c=e.readUint32();c>0&&(this.data=e.readUint8Array(c))}),o.createFullBoxCtor("clef","TrackCleanApertureDimensionsBox",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createFullBoxCtor("enof","TrackEncodedPixelsDimensionsBox",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createFullBoxCtor("prof","TrackProductionApertureDimensionsBox",function(e){this.width=e.readUint32(),this.height=e.readUint32()}),o.createContainerBoxCtor("tapt","TrackApertureModeDimensionsBox",null,["clef","prof","enof"]),o.createBoxCtor("rtp ","rtpmoviehintinformation",function(e){this.descriptionformat=e.readString(4),this.sdptext=e.readString(this.size-this.hdr_size-4)}),o.createFullBoxCtor("saio","SampleAuxiliaryInformationOffsetsBox",function(e){this.flags&1&&(this.aux_info_type=e.readString(4),this.aux_info_type_parameter=e.readUint32());var r=e.readUint32();this.offset=[];for(var s=0;s<r;s++)this.version===0?this.offset[s]=e.readUint32():this.offset[s]=e.readUint64()}),o.createFullBoxCtor("saiz","SampleAuxiliaryInformationSizesBox",function(e){if(this.flags&1&&(this.aux_info_type=e.readString(4),this.aux_info_type_parameter=e.readUint32()),this.default_sample_info_size=e.readUint8(),this.sample_count=e.readUint32(),this.sample_info_size=[],this.default_sample_info_size===0)for(var r=0;r<this.sample_count;r++)this.sample_info_size[r]=e.readUint8()}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"mett",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"metx",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",function(e){this.parseHeader(e),this.namespace=e.readCString(),this.schema_location=e.readCString(),this.auxiliary_mime_types=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",function(e){this.parseHeader(e),this.content_encoding=e.readCString(),this.mime_format=e.readCString(),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",function(e){this.parseHeader(e),this.displayFlags=e.readUint32(),this.horizontal_justification=e.readInt8(),this.vertical_justification=e.readInt8(),this.bg_color_rgba=e.readUint8Array(4),this.box_record=e.readInt16Array(4),this.style_record=e.readUint8Array(12),this.parseFooter(e)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",function(e){this.parseHeader(e),this.parseFooter(e)}),o.createSampleGroupCtor("alst",function(e){var r,s=e.readUint16();for(this.first_output_sample=e.readUint16(),this.sample_offset=[],r=0;r<s;r++)this.sample_offset[r]=e.readUint32();var c=this.description_length-4-4*s;for(this.num_output_samples=[],this.num_total_samples=[],r=0;r<c/4;r++)this.num_output_samples[r]=e.readUint16(),this.num_total_samples[r]=e.readUint16()}),o.createSampleGroupCtor("avll",function(e){this.layerNumber=e.readUint8(),this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()}),o.createSampleGroupCtor("avss",function(e){this.subSequenceIdentifier=e.readUint16(),this.layerNumber=e.readUint8();var r=e.readUint8();this.durationFlag=r>>7,this.avgRateFlag=r>>6&1,this.durationFlag&&(this.duration=e.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=e.readUint8(),this.avgBitRate=e.readUint16(),this.avgFrameRate=e.readUint16()),this.dependency=[];for(var s=e.readUint8(),c=0;c<s;c++){var d={};this.dependency.push(d),d.subSeqDirectionFlag=e.readUint8(),d.layerNumber=e.readUint8(),d.subSequenceIdentifier=e.readUint16()}}),o.createSampleGroupCtor("dtrt",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("mvif",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("prol",function(e){this.roll_distance=e.readInt16()}),o.createSampleGroupCtor("rap ",function(e){var r=e.readUint8();this.num_leading_samples_known=r>>7,this.num_leading_samples=r&127}),o.createSampleGroupCtor("rash",function(e){if(this.operation_point_count=e.readUint16(),this.description_length!==2+(this.operation_point_count===1?2:this.operation_point_count*6)+9)n.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=e.readUint8Array(this.description_length-2);else{if(this.operation_point_count===1)this.target_rate_share=e.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var r=0;r<this.operation_point_count;r++)this.available_bitrate[r]=e.readUint32(),this.target_rate_share[r]=e.readUint16()}this.maximum_bitrate=e.readUint32(),this.minimum_bitrate=e.readUint32(),this.discard_priority=e.readUint8()}}),o.createSampleGroupCtor("roll",function(e){this.roll_distance=e.readInt16()}),o.SampleGroupEntry.prototype.parse=function(e){n.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=e.readUint8Array(this.description_length)},o.createSampleGroupCtor("scif",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("scnm",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("seig",function(e){this.reserved=e.readUint8();var r=e.readUint8();this.crypt_byte_block=r>>4,this.skip_byte_block=r&15,this.isProtected=e.readUint8(),this.Per_Sample_IV_Size=e.readUint8(),this.KID=o.parseHex16(e),this.constant_IV_size=0,this.constant_IV=0,this.isProtected===1&&this.Per_Sample_IV_Size===0&&(this.constant_IV_size=e.readUint8(),this.constant_IV=e.readUint8Array(this.constant_IV_size))}),o.createSampleGroupCtor("stsa",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("sync",function(e){var r=e.readUint8();this.NAL_unit_type=r&63}),o.createSampleGroupCtor("tele",function(e){var r=e.readUint8();this.level_independently_decodable=r>>7}),o.createSampleGroupCtor("tsas",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("tscl",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("vipr",function(e){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createFullBoxCtor("sbgp","SampleToGroupBox",function(e){this.grouping_type=e.readString(4),this.version===1?this.grouping_type_parameter=e.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var r=e.readUint32(),s=0;s<r;s++){var c={};this.entries.push(c),c.sample_count=e.readInt32(),c.group_description_index=e.readInt32()}});function y(e,r){this.bad_pixel_row=e,this.bad_pixel_column=r}y.prototype.toString=function(){return"[row: "+this.bad_pixel_row+", column: "+this.bad_pixel_column+"]"},o.createFullBoxCtor("sbpm","SensorBadPixelsMapBox",function(e){var r;for(this.component_count=e.readUint16(),this.component_index=[],r=0;r<this.component_count;r++)this.component_index.push(e.readUint16());var s=e.readUint8();for(this.correction_applied=(s&128)==128,this.num_bad_rows=e.readUint32(),this.num_bad_cols=e.readUint32(),this.num_bad_pixels=e.readUint32(),this.bad_rows=[],this.bad_columns=[],this.bad_pixels=[],r=0;r<this.num_bad_rows;r++)this.bad_rows.push(e.readUint32());for(r=0;r<this.num_bad_cols;r++)this.bad_columns.push(e.readUint32());for(r=0;r<this.num_bad_pixels;r++){var c=e.readUint32(),d=e.readUint32();this.bad_pixels.push(new y(c,d))}}),o.createFullBoxCtor("schm","SchemeTypeBox",function(e){this.scheme_type=e.readString(4),this.scheme_version=e.readUint32(),this.flags&1&&(this.scheme_uri=e.readString(this.size-this.hdr_size-8))}),o.createBoxCtor("sdp ","rtptracksdphintinformation",function(e){this.sdptext=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("sdtp","SampleDependencyTypeBox",function(e){var r,s=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var c=0;c<s;c++)r=e.readUint8(),this.is_leading[c]=r>>6,this.sample_depends_on[c]=r>>4&3,this.sample_is_depended_on[c]=r>>2&3,this.sample_has_redundancy[c]=r&3}),o.createFullBoxCtor("senc","SampleEncryptionBox"),o.createFullBoxCtor("sgpd","SampleGroupDescriptionBox",function(e){this.grouping_type=e.readString(4),n.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.version===1?this.default_length=e.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=e.readUint32()),this.entries=[];for(var r=e.readUint32(),s=0;s<r;s++){var c;o[this.grouping_type+"SampleGroupEntry"]?c=new o[this.grouping_type+"SampleGroupEntry"](this.grouping_type):c=new o.SampleGroupEntry(this.grouping_type),this.entries.push(c),this.version===1?this.default_length===0?c.description_length=e.readUint32():c.description_length=this.default_length:c.description_length=this.default_length,c.write===o.SampleGroupEntry.prototype.write&&(n.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),c.data=e.readUint8Array(c.description_length),e.position-=c.description_length),c.parse(e)}}),o.createFullBoxCtor("sidx","CompressedSegmentIndexBox",function(e){this.reference_ID=e.readUint32(),this.timescale=e.readUint32(),this.version===0?(this.earliest_presentation_time=e.readUint32(),this.first_offset=e.readUint32()):(this.earliest_presentation_time=e.readUint64(),this.first_offset=e.readUint64()),e.readUint16(),this.references=[];for(var r=e.readUint16(),s=0;s<r;s++){var c={};this.references.push(c);var d=e.readUint32();c.reference_type=d>>31&1,c.referenced_size=d&2147483647,c.subsegment_duration=e.readUint32(),d=e.readUint32(),c.starts_with_SAP=d>>31&1,c.SAP_type=d>>28&7,c.SAP_delta_time=d&268435455}}),o.SingleItemTypeReferenceBox=function(e,r,s,c){o.Box.call(this,e,r),this.hdr_size=s,this.start=c},o.SingleItemTypeReferenceBox.prototype=new o.Box,o.SingleItemTypeReferenceBox.prototype.parse=function(e){this.from_item_ID=e.readUint16();var r=e.readUint16();this.references=[];for(var s=0;s<r;s++)this.references[s]={},this.references[s].to_item_ID=e.readUint16()},o.SingleItemTypeReferenceBoxLarge=function(e,r,s,c){o.Box.call(this,e,r),this.hdr_size=s,this.start=c},o.SingleItemTypeReferenceBoxLarge.prototype=new o.Box,o.SingleItemTypeReferenceBoxLarge.prototype.parse=function(e){this.from_item_ID=e.readUint32();var r=e.readUint16();this.references=[];for(var s=0;s<r;s++)this.references[s]={},this.references[s].to_item_ID=e.readUint32()},o.createFullBoxCtor("SmDm","SMPTE2086MasteringDisplayMetadataBox",function(e){this.primaryRChromaticity_x=e.readUint16(),this.primaryRChromaticity_y=e.readUint16(),this.primaryGChromaticity_x=e.readUint16(),this.primaryGChromaticity_y=e.readUint16(),this.primaryBChromaticity_x=e.readUint16(),this.primaryBChromaticity_y=e.readUint16(),this.whitePointChromaticity_x=e.readUint16(),this.whitePointChromaticity_y=e.readUint16(),this.luminanceMax=e.readUint32(),this.luminanceMin=e.readUint32()}),o.createFullBoxCtor("smhd","SoundMediaHeaderBox",function(e){this.balance=e.readUint16(),e.readUint16()}),o.createFullBoxCtor("ssix","CompressedSubsegmentIndexBox",function(e){this.subsegments=[];for(var r=e.readUint32(),s=0;s<r;s++){var c={};this.subsegments.push(c),c.ranges=[];for(var d=e.readUint32(),_=0;_<d;_++){var m={};c.ranges.push(m),m.level=e.readUint8(),m.range_size=e.readUint24()}}}),o.createFullBoxCtor("stco","ChunkOffsetBox",function(e){var r;if(r=e.readUint32(),this.chunk_offsets=[],this.version===0)for(var s=0;s<r;s++)this.chunk_offsets.push(e.readUint32())}),o.createFullBoxCtor("stdp","DegradationPriorityBox",function(e){var r=(this.size-this.hdr_size)/2;this.priority=[];for(var s=0;s<r;s++)this.priority[s]=e.readUint16()}),o.createFullBoxCtor("sthd","SubtitleMediaHeaderBox"),o.createFullBoxCtor("stri","SubTrackInformationBox",function(e){this.switch_group=e.readUint16(),this.alternate_group=e.readUint16(),this.sub_track_id=e.readUint32();var r=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var s=0;s<r;s++)this.attribute_list[s]=e.readUint32()}),o.createFullBoxCtor("stsc","SampleToChunkBox",function(e){var r,s;if(r=e.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],this.version===0)for(s=0;s<r;s++)this.first_chunk.push(e.readUint32()),this.samples_per_chunk.push(e.readUint32()),this.sample_description_index.push(e.readUint32())}),o.createFullBoxCtor("stsd","SampleDescriptionBox",function(e){var r,s,c,d;for(this.entries=[],c=e.readUint32(),r=1;r<=c;r++)if(s=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),s.code===o.OK)o[s.type+"SampleEntry"]?(d=new o[s.type+"SampleEntry"](s.size),d.hdr_size=s.hdr_size,d.start=s.start):(n.warn("BoxParser","Unknown sample entry type: "+s.type),d=new o.SampleEntry(s.type,s.size,s.hdr_size,s.start)),d.write===o.SampleEntry.prototype.write&&(n.info("BoxParser","SampleEntry "+d.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),d.parseDataAndRewind(e)),d.parse(e),this.entries.push(d);else return}),o.createFullBoxCtor("stsg","SubTrackSampleGroupBox",function(e){this.grouping_type=e.readUint32();var r=e.readUint16();this.group_description_index=[];for(var s=0;s<r;s++)this.group_description_index[s]=e.readUint32()}),o.createFullBoxCtor("stsh","ShadowSyncSampleBox",function(e){var r,s;if(r=e.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],this.version===0)for(s=0;s<r;s++)this.shadowed_sample_numbers.push(e.readUint32()),this.sync_sample_numbers.push(e.readUint32())}),o.createFullBoxCtor("stss","SyncSampleBox",function(e){var r,s;if(s=e.readUint32(),this.version===0)for(this.sample_numbers=[],r=0;r<s;r++)this.sample_numbers.push(e.readUint32())}),o.createFullBoxCtor("stsz","SampleSizeBox",function(e){var r;if(this.sample_sizes=[],this.version===0)for(this.sample_size=e.readUint32(),this.sample_count=e.readUint32(),r=0;r<this.sample_count;r++)this.sample_size===0?this.sample_sizes.push(e.readUint32()):this.sample_sizes[r]=this.sample_size}),o.createFullBoxCtor("stts","TimeToSampleBox",function(e){var r,s,c;if(r=e.readUint32(),this.sample_counts=[],this.sample_deltas=[],this.version===0)for(s=0;s<r;s++)this.sample_counts.push(e.readUint32()),c=e.readInt32(),c<0&&(n.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),c=1),this.sample_deltas.push(c)}),o.createFullBoxCtor("stvi","StereoVideoBox",function(e){var r=e.readUint32();this.single_view_allowed=r&3,this.stereo_scheme=e.readUint32();var s=e.readUint32();this.stereo_indication_type=e.readString(s);var c,d;for(this.boxes=[];e.getPosition()<this.start+this.size;)if(c=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),c.code===o.OK)d=c.box,this.boxes.push(d),this[d.type]=d;else return}),o.createBoxCtor("styp","SegmentTypeBox",function(e){o.ftypBox.prototype.parse.call(this,e)}),o.createFullBoxCtor("stz2","CompactSampleSizeBox",function(e){var r,s;if(this.sample_sizes=[],this.version===0)if(this.reserved=e.readUint24(),this.field_size=e.readUint8(),s=e.readUint32(),this.field_size===4)for(r=0;r<s;r+=2){var c=e.readUint8();this.sample_sizes[r]=c>>4&15,this.sample_sizes[r+1]=c&15}else if(this.field_size===8)for(r=0;r<s;r++)this.sample_sizes[r]=e.readUint8();else if(this.field_size===16)for(r=0;r<s;r++)this.sample_sizes[r]=e.readUint16();else n.error("BoxParser","Error in length field in stz2 box")}),o.createFullBoxCtor("subs","SubSampleInformationBox",function(e){var r,s,c,d;for(c=e.readUint32(),this.entries=[],r=0;r<c;r++){var _={};if(this.entries[r]=_,_.sample_delta=e.readUint32(),_.subsamples=[],d=e.readUint16(),d>0)for(s=0;s<d;s++){var m={};_.subsamples.push(m),this.version==1?m.size=e.readUint32():m.size=e.readUint16(),m.priority=e.readUint8(),m.discardable=e.readUint8(),m.codec_specific_parameters=e.readUint32()}}}),o.createFullBoxCtor("tenc","TrackEncryptionBox",function(e){if(e.readUint8(),this.version===0)e.readUint8();else{var r=e.readUint8();this.default_crypt_byte_block=r>>4&15,this.default_skip_byte_block=r&15}this.default_isProtected=e.readUint8(),this.default_Per_Sample_IV_Size=e.readUint8(),this.default_KID=o.parseHex16(e),this.default_isProtected===1&&this.default_Per_Sample_IV_Size===0&&(this.default_constant_IV_size=e.readUint8(),this.default_constant_IV=e.readUint8Array(this.default_constant_IV_size))}),o.createFullBoxCtor("tfdt","TrackFragmentBaseMediaDecodeTimeBox",function(e){this.version==1?this.baseMediaDecodeTime=e.readUint64():this.baseMediaDecodeTime=e.readUint32()}),o.createFullBoxCtor("tfhd","TrackFragmentHeaderBox",function(e){var r=0;this.track_id=e.readUint32(),this.size-this.hdr_size>r&&this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=e.readUint64(),r+=8):this.base_data_offset=0,this.size-this.hdr_size>r&&this.flags&o.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=e.readUint32(),r+=4):this.default_sample_description_index=0,this.size-this.hdr_size>r&&this.flags&o.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=e.readUint32(),r+=4):this.default_sample_duration=0,this.size-this.hdr_size>r&&this.flags&o.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=e.readUint32(),r+=4):this.default_sample_size=0,this.size-this.hdr_size>r&&this.flags&o.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=e.readUint32(),r+=4):this.default_sample_flags=0}),o.createFullBoxCtor("tfra","TrackFragmentRandomAccessBox",function(e){this.track_ID=e.readUint32(),e.readUint24();var r=e.readUint8();this.length_size_of_traf_num=r>>4&3,this.length_size_of_trun_num=r>>2&3,this.length_size_of_sample_num=r&3,this.entries=[];for(var s=e.readUint32(),c=0;c<s;c++)this.version===1?(this.time=e.readUint64(),this.moof_offset=e.readUint64()):(this.time=e.readUint32(),this.moof_offset=e.readUint32()),this.traf_number=e["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=e["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=e["readUint"+8*(this.length_size_of_sample_num+1)]()}),o.createFullBoxCtor("tkhd","TrackHeaderBox",function(e){this.version==1?(this.creation_time=e.readUint64(),this.modification_time=e.readUint64(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint64()):(this.creation_time=e.readUint32(),this.modification_time=e.readUint32(),this.track_id=e.readUint32(),e.readUint32(),this.duration=e.readUint32()),e.readUint32Array(2),this.layer=e.readInt16(),this.alternate_group=e.readInt16(),this.volume=e.readInt16()>>8,e.readUint16(),this.matrix=e.readInt32Array(9),this.width=e.readUint32(),this.height=e.readUint32()}),o.createBoxCtor("tmax","hintmaxrelativetime",function(e){this.time=e.readUint32()}),o.createBoxCtor("tmin","hintminrelativetime",function(e){this.time=e.readUint32()}),o.createBoxCtor("totl","hintBytesSent",function(e){this.bytessent=e.readUint32()}),o.createBoxCtor("tpay","hintBytesSent",function(e){this.bytessent=e.readUint32()}),o.createBoxCtor("tpyl","hintBytesSent",function(e){this.bytessent=e.readUint64()}),o.TrackGroupTypeBox.prototype.parse=function(e){this.parseFullHeader(e),this.track_group_id=e.readUint32()},o.createTrackGroupCtor("msrc"),o.TrackReferenceTypeBox=function(e,r,s,c){o.Box.call(this,e,r),this.hdr_size=s,this.start=c},o.TrackReferenceTypeBox.prototype=new o.Box,o.TrackReferenceTypeBox.prototype.parse=function(e){this.track_ids=e.readUint32Array((this.size-this.hdr_size)/4)},o.trefBox.prototype.parse=function(e){for(var r,s;e.getPosition()<this.start+this.size;)if(r=o.parseOneBox(e,!0,this.size-(e.getPosition()-this.start)),r.code===o.OK)s=new o.TrackReferenceTypeBox(r.type,r.size,r.hdr_size,r.start),s.write===o.Box.prototype.write&&s.type!=="mdat"&&(n.info("BoxParser","TrackReference "+s.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),s.parseDataAndRewind(e)),s.parse(e),this.boxes.push(s);else return},o.createFullBoxCtor("trep","TrackExtensionPropertiesBox",function(e){for(this.track_ID=e.readUint32(),this.boxes=[];e.getPosition()<this.start+this.size;)if(ret=o.parseOneBox(e,!1,this.size-(e.getPosition()-this.start)),ret.code===o.OK)box=ret.box,this.boxes.push(box);else return}),o.createFullBoxCtor("trex","TrackExtendsBox",function(e){this.track_id=e.readUint32(),this.default_sample_description_index=e.readUint32(),this.default_sample_duration=e.readUint32(),this.default_sample_size=e.readUint32(),this.default_sample_flags=e.readUint32()}),o.createBoxCtor("trpy","hintBytesSent",function(e){this.bytessent=e.readUint64()}),o.createFullBoxCtor("trun","TrackRunBox",function(e){var r=0;if(this.sample_count=e.readUint32(),r+=4,this.size-this.hdr_size>r&&this.flags&o.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=e.readInt32(),r+=4):this.data_offset=0,this.size-this.hdr_size>r&&this.flags&o.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=e.readUint32(),r+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>r)for(var s=0;s<this.sample_count;s++)this.flags&o.TRUN_FLAGS_DURATION&&(this.sample_duration[s]=e.readUint32()),this.flags&o.TRUN_FLAGS_SIZE&&(this.sample_size[s]=e.readUint32()),this.flags&o.TRUN_FLAGS_FLAGS&&(this.sample_flags[s]=e.readUint32()),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?this.sample_composition_time_offset[s]=e.readUint32():this.sample_composition_time_offset[s]=e.readInt32())}),o.createFullBoxCtor("tsel","TrackSelectionBox",function(e){this.switch_group=e.readUint32();var r=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var s=0;s<r;s++)this.attribute_list[s]=e.readUint32()}),o.createFullBoxCtor("txtC","TextConfigBox",function(e){this.config=e.readCString()}),o.createBoxCtor("tyco","TypeCombinationBox",function(e){var r=(this.size-this.hdr_size)/4;this.compatible_brands=[];for(var s=0;s<r;s++)this.compatible_brands[s]=e.readString(4)}),o.createFullBoxCtor("udes","UserDescriptionProperty",function(e){this.lang=e.readCString(),this.name=e.readCString(),this.description=e.readCString(),this.tags=e.readCString()}),o.createFullBoxCtor("uncC","UncompressedFrameConfigBox",function(e){var r;if(this.profile=e.readString(4),this.version!=1){if(this.version==0){for(this.component_count=e.readUint32(),this.component_index=[],this.component_bit_depth_minus_one=[],this.component_format=[],this.component_align_size=[],r=0;r<this.component_count;r++)this.component_index.push(e.readUint16()),this.component_bit_depth_minus_one.push(e.readUint8()),this.component_format.push(e.readUint8()),this.component_align_size.push(e.readUint8());this.sampling_type=e.readUint8(),this.interleave_type=e.readUint8(),this.block_size=e.readUint8();var s=e.readUint8();this.component_little_endian=s>>7&1,this.block_pad_lsb=s>>6&1,this.block_little_endian=s>>5&1,this.block_reversed=s>>4&1,this.pad_unknown=s>>3&1,this.pixel_size=e.readUint32(),this.row_align_size=e.readUint32(),this.tile_align_size=e.readUint32(),this.num_tile_cols_minus_one=e.readUint32(),this.num_tile_rows_minus_one=e.readUint32()}}}),o.createFullBoxCtor("url ","DataEntryUrlBox",function(e){this.flags!==1&&(this.location=e.readCString())}),o.createFullBoxCtor("urn ","DataEntryUrnBox",function(e){this.name=e.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=e.readCString())}),o.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66","LiveServerManifestBox",!0,!1,function(e){this.LiveServerManifest=e.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),o.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3","PiffProtectionSystemSpecificHeaderBox",!0,!1,function(e){this.system_id=o.parseHex16(e);var r=e.readUint32();r>0&&(this.data=e.readUint8Array(r))}),o.createUUIDBox("a2394f525a9b4f14a2446c427c648df4","PiffSampleEncryptionBox",!0,!1),o.createUUIDBox("8974dbce7be74c5184f97148f9882554","PiffTrackEncryptionBox",!0,!1,function(e){this.default_AlgorithmID=e.readUint24(),this.default_IV_size=e.readUint8(),this.default_KID=o.parseHex16(e)}),o.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f","TfrfBox",!0,!1,function(e){this.fragment_count=e.readUint8(),this.entries=[];for(var r=0;r<this.fragment_count;r++){var s={},c=0,d=0;this.version===1?(c=e.readUint64(),d=e.readUint64()):(c=e.readUint32(),d=e.readUint32()),s.absolute_time=c,s.absolute_duration=d,this.entries.push(s)}}),o.createUUIDBox("6d1d9b0542d544e680e2141daff757b2","TfxdBox",!0,!1,function(e){this.version===1?(this.absolute_time=e.readUint64(),this.duration=e.readUint64()):(this.absolute_time=e.readUint32(),this.duration=e.readUint32())}),o.createFullBoxCtor("vmhd","VideoMediaHeaderBox",function(e){this.graphicsmode=e.readUint16(),this.opcolor=e.readUint16Array(3)}),o.createFullBoxCtor("vpcC","VPCodecConfigurationRecord",function(e){var r;this.version===1?(this.profile=e.readUint8(),this.level=e.readUint8(),r=e.readUint8(),this.bitDepth=r>>4,this.chromaSubsampling=r>>1&7,this.videoFullRangeFlag=r&1,this.colourPrimaries=e.readUint8(),this.transferCharacteristics=e.readUint8(),this.matrixCoefficients=e.readUint8(),this.codecIntializationDataSize=e.readUint16(),this.codecIntializationData=e.readUint8Array(this.codecIntializationDataSize)):(this.profile=e.readUint8(),this.level=e.readUint8(),r=e.readUint8(),this.bitDepth=r>>4&15,this.colorSpace=r&15,r=e.readUint8(),this.chromaSubsampling=r>>4&15,this.transferFunction=r>>1&7,this.videoFullRangeFlag=r&1,this.codecIntializationDataSize=e.readUint16(),this.codecIntializationData=e.readUint8Array(this.codecIntializationDataSize))}),o.createBoxCtor("vttC","WebVTTConfigurationBox",function(e){this.text=e.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("vvcC","VvcConfigurationBox",function(e){var r,s,c={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(R){this.held_bits=R.readUint8(),this.num_held_bits=8},stream_read_2_bytes:function(R){this.held_bits=R.readUint16(),this.num_held_bits=16},extract_bits:function(R){var X=this.held_bits>>this.num_held_bits-R&(1<<R)-1;return this.num_held_bits-=R,X}};if(c.stream_read_1_bytes(e),c.extract_bits(5),this.lengthSizeMinusOne=c.extract_bits(2),this.ptl_present_flag=c.extract_bits(1),this.ptl_present_flag){c.stream_read_2_bytes(e),this.ols_idx=c.extract_bits(9),this.num_sublayers=c.extract_bits(3),this.constant_frame_rate=c.extract_bits(2),this.chroma_format_idc=c.extract_bits(2),c.stream_read_1_bytes(e),this.bit_depth_minus8=c.extract_bits(3),c.extract_bits(5);{if(c.stream_read_2_bytes(e),c.extract_bits(2),this.num_bytes_constraint_info=c.extract_bits(6),this.general_profile_idc=c.extract_bits(7),this.general_tier_flag=c.extract_bits(1),this.general_level_idc=e.readUint8(),c.stream_read_1_bytes(e),this.ptl_frame_only_constraint_flag=c.extract_bits(1),this.ptl_multilayer_enabled_flag=c.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(r=0;r<this.num_bytes_constraint_info-1;r++){var d=c.extract_bits(6);c.stream_read_1_bytes(e);var _=c.extract_bits(2);this.general_constraint_info[r]=d<<2|_}this.general_constraint_info[this.num_bytes_constraint_info-1]=c.extract_bits(6)}else c.extract_bits(6);if(this.num_sublayers>1){for(c.stream_read_1_bytes(e),this.ptl_sublayer_present_mask=0,s=this.num_sublayers-2;s>=0;--s){var m=c.extract_bits(1);this.ptl_sublayer_present_mask|=m<<s}for(s=this.num_sublayers;s<=8&&this.num_sublayers>1;++s)c.extract_bits(1);for(this.sublayer_level_idc=[],s=this.num_sublayers-2;s>=0;--s)this.ptl_sublayer_present_mask&1<<s&&(this.sublayer_level_idc[s]=e.readUint8())}if(this.ptl_num_sub_profiles=e.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(r=0;r<this.ptl_num_sub_profiles;r++)this.general_sub_profile_idc.push(e.readUint32())}this.max_picture_width=e.readUint16(),this.max_picture_height=e.readUint16(),this.avg_frame_rate=e.readUint16()}var A=12,B=13;this.nalu_arrays=[];var T=e.readUint8();for(r=0;r<T;r++){var C=[];this.nalu_arrays.push(C),c.stream_read_1_bytes(e),C.completeness=c.extract_bits(1),c.extract_bits(2),C.nalu_type=c.extract_bits(5);var P=1;for(C.nalu_type!=B&&C.nalu_type!=A&&(P=e.readUint16()),s=0;s<P;s++){var L=e.readUint16();C.push({data:e.readUint8Array(L),length:L})}}}),o.createFullBoxCtor("vvnC","VvcNALUConfigBox",function(e){var r=strm.readUint8();this.lengthSizeMinusOne=r&3}),o.SampleEntry.prototype.isVideo=function(){return!1},o.SampleEntry.prototype.isAudio=function(){return!1},o.SampleEntry.prototype.isSubtitle=function(){return!1},o.SampleEntry.prototype.isMetadata=function(){return!1},o.SampleEntry.prototype.isHint=function(){return!1},o.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},o.SampleEntry.prototype.getWidth=function(){return""},o.SampleEntry.prototype.getHeight=function(){return""},o.SampleEntry.prototype.getChannelCount=function(){return""},o.SampleEntry.prototype.getSampleRate=function(){return""},o.SampleEntry.prototype.getSampleSize=function(){return""},o.VisualSampleEntry.prototype.isVideo=function(){return!0},o.VisualSampleEntry.prototype.getWidth=function(){return this.width},o.VisualSampleEntry.prototype.getHeight=function(){return this.height},o.AudioSampleEntry.prototype.isAudio=function(){return!0},o.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},o.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},o.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},o.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},o.MetadataSampleEntry.prototype.isMetadata=function(){return!0},o.decimalToHex=function(e,r){var s=Number(e).toString(16);for(r=typeof r>"u"||r===null?r=2:r;s.length<r;)s="0"+s;return s},o.avc1SampleEntry.prototype.getCodec=o.avc2SampleEntry.prototype.getCodec=o.avc3SampleEntry.prototype.getCodec=o.avc4SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);return this.avcC?e+"."+o.decimalToHex(this.avcC.AVCProfileIndication)+o.decimalToHex(this.avcC.profile_compatibility)+o.decimalToHex(this.avcC.AVCLevelIndication):e},o.hev1SampleEntry.prototype.getCodec=o.hvc1SampleEntry.prototype.getCodec=function(){var e,r=o.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(r+=".",this.hvcC.general_profile_space){case 0:r+="";break;case 1:r+="A";break;case 2:r+="B";break;case 3:r+="C";break}r+=this.hvcC.general_profile_idc,r+=".";var s=this.hvcC.general_profile_compatibility,c=0;for(e=0;e<32&&(c|=s&1,e!=31);e++)c<<=1,s>>=1;r+=o.decimalToHex(c,0),r+=".",this.hvcC.general_tier_flag===0?r+="L":r+="H",r+=this.hvcC.general_level_idc;var d=!1,_="";for(e=5;e>=0;e--)(this.hvcC.general_constraint_indicator[e]||d)&&(_="."+o.decimalToHex(this.hvcC.general_constraint_indicator[e],0)+_,d=!0);r+=_}return r},o.vvc1SampleEntry.prototype.getCodec=o.vvi1SampleEntry.prototype.getCodec=function(){var e,r=o.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){r+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?r+=".H":r+=".L",r+=this.vvcC.general_level_idc;var s="";if(this.vvcC.general_constraint_info){var c=[],d=0;d|=this.vvcC.ptl_frame_only_constraint<<7,d|=this.vvcC.ptl_multilayer_enabled<<6;var _;for(e=0;e<this.vvcC.general_constraint_info.length;++e)d|=this.vvcC.general_constraint_info[e]>>2&63,c.push(d),d&&(_=e),d=this.vvcC.general_constraint_info[e]>>2&3;if(_===void 0)s=".CA";else{s=".C";var m="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",A=0,B=0;for(e=0;e<=_;++e)for(A=A<<8|c[e],B+=8;B>=5;){var T=A>>B-5&31;s+=m[T],B-=5,A&=(1<<B)-1}B&&(A<<=5-B,s+=m[A&31])}}r+=s}return r},o.mp4aSampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var r=this.esds.esd.getOTI(),s=this.esds.esd.getAudioConfig();return e+"."+o.decimalToHex(r)+(s?"."+s:"")}else return e},o.stxtSampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this);return this.mime_format?e+"."+this.mime_format:e},o.vp08SampleEntry.prototype.getCodec=o.vp09SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this),r=this.vpcC.level;r==0&&(r="00");var s=this.vpcC.bitDepth;return s==8&&(s="08"),e+".0"+this.vpcC.profile+"."+r+"."+s},o.av01SampleEntry.prototype.getCodec=function(){var e=o.SampleEntry.prototype.getCodec.call(this),r=this.av1C.seq_level_idx_0;r<10&&(r="0"+r);var s;return this.av1C.seq_profile===2&&this.av1C.high_bitdepth===1?s=this.av1C.twelve_bit===1?"12":"10":this.av1C.seq_profile<=2&&(s=this.av1C.high_bitdepth===1?"10":"08"),e+"."+this.av1C.seq_profile+"."+r+(this.av1C.seq_tier_0?"H":"M")+"."+s},o.Box.prototype.writeHeader=function(e,r){this.size+=8,this.size>f&&(this.size+=8),this.type==="uuid"&&(this.size+=16),n.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+e.getPosition()+(r||"")),this.size>f?e.writeUint32(1):(this.sizePosition=e.getPosition(),e.writeUint32(this.size)),e.writeString(this.type,null,4),this.type==="uuid"&&e.writeUint8Array(this.uuid),this.size>f&&e.writeUint64(this.size)},o.FullBox.prototype.writeHeader=function(e){this.size+=4,o.Box.prototype.writeHeader.call(this,e," v="+this.version+" f="+this.flags),e.writeUint8(this.version),e.writeUint24(this.flags)},o.Box.prototype.write=function(e){this.type==="mdat"?this.data&&(this.size=this.data.length,this.writeHeader(e),e.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(e),this.data&&e.writeUint8Array(this.data))},o.ContainerBox.prototype.write=function(e){this.size=0,this.writeHeader(e);for(var r=0;r<this.boxes.length;r++)this.boxes[r]&&(this.boxes[r].write(e),this.size+=this.boxes[r].size);n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.TrackReferenceTypeBox.prototype.write=function(e){this.size=this.track_ids.length*4,this.writeHeader(e),e.writeUint32Array(this.track_ids)},o.avcCBox.prototype.write=function(e){var r;for(this.size=7,r=0;r<this.SPS.length;r++)this.size+=2+this.SPS[r].length;for(r=0;r<this.PPS.length;r++)this.size+=2+this.PPS[r].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(e),e.writeUint8(this.configurationVersion),e.writeUint8(this.AVCProfileIndication),e.writeUint8(this.profile_compatibility),e.writeUint8(this.AVCLevelIndication),e.writeUint8(this.lengthSizeMinusOne+252),e.writeUint8(this.SPS.length+224),r=0;r<this.SPS.length;r++)e.writeUint16(this.SPS[r].length),e.writeUint8Array(this.SPS[r].nalu);for(e.writeUint8(this.PPS.length),r=0;r<this.PPS.length;r++)e.writeUint16(this.PPS[r].length),e.writeUint8Array(this.PPS[r].nalu);this.ext&&e.writeUint8Array(this.ext)},o.co64Box.prototype.write=function(e){var r;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),r=0;r<this.chunk_offsets.length;r++)e.writeUint64(this.chunk_offsets[r])},o.cslgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(e),e.writeInt32(this.compositionToDTSShift),e.writeInt32(this.leastDecodeToDisplayDelta),e.writeInt32(this.greatestDecodeToDisplayDelta),e.writeInt32(this.compositionStartTime),e.writeInt32(this.compositionEndTime)},o.cttsBox.prototype.write=function(e){var r;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),r=0;r<this.sample_counts.length;r++)e.writeUint32(this.sample_counts[r]),this.version===1?e.writeInt32(this.sample_offsets[r]):e.writeUint32(this.sample_offsets[r])},o.drefBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.entries.length);for(var r=0;r<this.entries.length;r++)this.entries[r].write(e),this.size+=this.entries[r].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.elngBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(e),e.writeString(this.extended_language)},o.elstBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(e),e.writeUint32(this.entries.length);for(var r=0;r<this.entries.length;r++){var s=this.entries[r];e.writeUint32(s.segment_duration),e.writeInt32(s.media_time),e.writeInt16(s.media_rate_integer),e.writeInt16(s.media_rate_fraction)}},o.emsgBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(e),e.writeCString(this.scheme_id_uri),e.writeCString(this.value),e.writeUint32(this.timescale),e.writeUint32(this.presentation_time_delta),e.writeUint32(this.event_duration),e.writeUint32(this.id),e.writeUint8Array(this.message_data)},o.ftypBox.prototype.write=function(e){this.size=8+4*this.compatible_brands.length,this.writeHeader(e),e.writeString(this.major_brand,null,4),e.writeUint32(this.minor_version);for(var r=0;r<this.compatible_brands.length;r++)e.writeString(this.compatible_brands[r],null,4)},o.hdlrBox.prototype.write=function(e){this.size=5*4+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(e),e.writeUint32(0),e.writeString(this.handler,null,4),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeCString(this.name)},o.hvcCBox.prototype.write=function(e){var r,s;for(this.size=23,r=0;r<this.nalu_arrays.length;r++)for(this.size+=3,s=0;s<this.nalu_arrays[r].length;s++)this.size+=2+this.nalu_arrays[r][s].data.length;for(this.writeHeader(e),e.writeUint8(this.configurationVersion),e.writeUint8((this.general_profile_space<<6)+(this.general_tier_flag<<5)+this.general_profile_idc),e.writeUint32(this.general_profile_compatibility),e.writeUint8Array(this.general_constraint_indicator),e.writeUint8(this.general_level_idc),e.writeUint16(this.min_spatial_segmentation_idc+(15<<24)),e.writeUint8(this.parallelismType+252),e.writeUint8(this.chroma_format_idc+252),e.writeUint8(this.bit_depth_luma_minus8+248),e.writeUint8(this.bit_depth_chroma_minus8+248),e.writeUint16(this.avgFrameRate),e.writeUint8((this.constantFrameRate<<6)+(this.numTemporalLayers<<3)+(this.temporalIdNested<<2)+this.lengthSizeMinusOne),e.writeUint8(this.nalu_arrays.length),r=0;r<this.nalu_arrays.length;r++)for(e.writeUint8((this.nalu_arrays[r].completeness<<7)+this.nalu_arrays[r].nalu_type),e.writeUint16(this.nalu_arrays[r].length),s=0;s<this.nalu_arrays[r].length;s++)e.writeUint16(this.nalu_arrays[r][s].data.length),e.writeUint8Array(this.nalu_arrays[r][s].data)},o.kindBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(e),e.writeCString(this.schemeURI),e.writeCString(this.value)},o.mdhdBox.prototype.write=function(e){this.size=4*4+2*2,this.flags=0,this.version=0,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint16(this.language),e.writeUint16(0)},o.mehdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.fragment_duration)},o.mfhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4,this.writeHeader(e),e.writeUint32(this.sequence_number)},o.mvhdBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=23*4+2*2,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.timescale),e.writeUint32(this.duration),e.writeUint32(this.rate),e.writeUint16(this.volume<<8),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32Array(this.matrix),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(this.next_track_id)},o.SampleEntry.prototype.writeHeader=function(e){this.size=8,o.Box.prototype.writeHeader.call(this,e),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint8(0),e.writeUint16(this.data_reference_index)},o.SampleEntry.prototype.writeFooter=function(e){for(var r=0;r<this.boxes.length;r++)this.boxes[r].write(e),this.size+=this.boxes[r].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.SampleEntry.prototype.write=function(e){this.writeHeader(e),e.writeUint8Array(this.data),this.size+=this.data.length,n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.VisualSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=2*7+6*4+32,e.writeUint16(0),e.writeUint16(0),e.writeUint32(0),e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.width),e.writeUint16(this.height),e.writeUint32(this.horizresolution),e.writeUint32(this.vertresolution),e.writeUint32(0),e.writeUint16(this.frame_count),e.writeUint8(Math.min(31,this.compressorname.length)),e.writeString(this.compressorname,null,31),e.writeUint16(this.depth),e.writeInt16(-1),this.writeFooter(e)},o.AudioSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=2*4+3*4,e.writeUint32(0),e.writeUint32(0),e.writeUint16(this.channel_count),e.writeUint16(this.samplesize),e.writeUint16(0),e.writeUint16(0),e.writeUint32(this.samplerate<<16),this.writeFooter(e)},o.stppSampleEntry.prototype.write=function(e){this.writeHeader(e),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,e.writeCString(this.namespace),e.writeCString(this.schema_location),e.writeCString(this.auxiliary_mime_types),this.writeFooter(e)},o.SampleGroupEntry.prototype.write=function(e){e.writeUint8Array(this.data)},o.sbgpBox.prototype.write=function(e){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(e),e.writeString(this.grouping_type,null,4),e.writeUint32(this.grouping_type_parameter),e.writeUint32(this.entries.length);for(var r=0;r<this.entries.length;r++){var s=this.entries[r];e.writeInt32(s.sample_count),e.writeInt32(s.group_description_index)}},o.sgpdBox.prototype.write=function(e){var r,s;for(this.flags=0,this.size=12,r=0;r<this.entries.length;r++)s=this.entries[r],this.version===1&&(this.default_length===0&&(this.size+=4),this.size+=s.data.length);for(this.writeHeader(e),e.writeString(this.grouping_type,null,4),this.version===1&&e.writeUint32(this.default_length),this.version>=2&&e.writeUint32(this.default_sample_description_index),e.writeUint32(this.entries.length),r=0;r<this.entries.length;r++)s=this.entries[r],this.version===1&&this.default_length===0&&e.writeUint32(s.description_length),s.write(e)},o.sidxBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*4+2+2+12*this.references.length,this.writeHeader(e),e.writeUint32(this.reference_ID),e.writeUint32(this.timescale),e.writeUint32(this.earliest_presentation_time),e.writeUint32(this.first_offset),e.writeUint16(0),e.writeUint16(this.references.length);for(var r=0;r<this.references.length;r++){var s=this.references[r];e.writeUint32(s.reference_type<<31|s.referenced_size),e.writeUint32(s.subsegment_duration),e.writeUint32(s.starts_with_SAP<<31|s.SAP_type<<28|s.SAP_delta_time)}},o.smhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=4,this.writeHeader(e),e.writeUint16(this.balance),e.writeUint16(0)},o.stcoBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(e),e.writeUint32(this.chunk_offsets.length),e.writeUint32Array(this.chunk_offsets)},o.stscBox.prototype.write=function(e){var r;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(e),e.writeUint32(this.first_chunk.length),r=0;r<this.first_chunk.length;r++)e.writeUint32(this.first_chunk[r]),e.writeUint32(this.samples_per_chunk[r]),e.writeUint32(this.sample_description_index[r])},o.stsdBox.prototype.write=function(e){var r;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(e),e.writeUint32(this.entries.length),this.size+=4,r=0;r<this.entries.length;r++)this.entries[r].write(e),this.size+=this.entries[r].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),e.adjustUint32(this.sizePosition,this.size)},o.stshBox.prototype.write=function(e){var r;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(e),e.writeUint32(this.shadowed_sample_numbers.length),r=0;r<this.shadowed_sample_numbers.length;r++)e.writeUint32(this.shadowed_sample_numbers[r]),e.writeUint32(this.sync_sample_numbers[r])},o.stssBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(e),e.writeUint32(this.sample_numbers.length),e.writeUint32Array(this.sample_numbers)},o.stszBox.prototype.write=function(e){var r,s=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(r=0;r+1<this.sample_sizes.length;)if(this.sample_sizes[r+1]!==this.sample_sizes[0]){s=!1;break}else r++;else s=!1;this.size=8,s||(this.size+=4*this.sample_sizes.length),this.writeHeader(e),s?e.writeUint32(this.sample_sizes[0]):e.writeUint32(0),e.writeUint32(this.sample_sizes.length),s||e.writeUint32Array(this.sample_sizes)},o.sttsBox.prototype.write=function(e){var r;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(e),e.writeUint32(this.sample_counts.length),r=0;r<this.sample_counts.length;r++)e.writeUint32(this.sample_counts[r]),e.writeUint32(this.sample_deltas[r])},o.tfdtBox.prototype.write=function(e){var r=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>r?1:0,this.flags=0,this.size=4,this.version===1&&(this.size+=4),this.writeHeader(e),this.version===1?e.writeUint64(this.baseMediaDecodeTime):e.writeUint32(this.baseMediaDecodeTime)},o.tfhdBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(e),e.writeUint32(this.track_id),this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&e.writeUint64(this.base_data_offset),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&e.writeUint32(this.default_sample_description_index),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&e.writeUint32(this.default_sample_duration),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&e.writeUint32(this.default_sample_size),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&e.writeUint32(this.default_sample_flags)},o.tkhdBox.prototype.write=function(e){this.version=0,this.size=4*18+2*4,this.writeHeader(e),e.writeUint32(this.creation_time),e.writeUint32(this.modification_time),e.writeUint32(this.track_id),e.writeUint32(0),e.writeUint32(this.duration),e.writeUint32(0),e.writeUint32(0),e.writeInt16(this.layer),e.writeInt16(this.alternate_group),e.writeInt16(this.volume<<8),e.writeUint16(0),e.writeInt32Array(this.matrix),e.writeUint32(this.width),e.writeUint32(this.height)},o.trexBox.prototype.write=function(e){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(e),e.writeUint32(this.track_id),e.writeUint32(this.default_sample_description_index),e.writeUint32(this.default_sample_duration),e.writeUint32(this.default_sample_size),e.writeUint32(this.default_sample_flags)},o.trunBox.prototype.write=function(e){this.version=0,this.size=4,this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&o.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&o.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&o.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(e),e.writeUint32(this.sample_count),this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=e.getPosition(),e.writeInt32(this.data_offset)),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&e.writeUint32(this.first_sample_flags);for(var r=0;r<this.sample_count;r++)this.flags&o.TRUN_FLAGS_DURATION&&e.writeUint32(this.sample_duration[r]),this.flags&o.TRUN_FLAGS_SIZE&&e.writeUint32(this.sample_size[r]),this.flags&o.TRUN_FLAGS_FLAGS&&e.writeUint32(this.sample_flags[r]),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?e.writeUint32(this.sample_composition_time_offset[r]):e.writeInt32(this.sample_composition_time_offset[r]))},o["url Box"].prototype.write=function(e){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(e),this.location&&e.writeCString(this.location)},o["urn Box"].prototype.write=function(e){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(e),e.writeCString(this.name),this.location&&e.writeCString(this.location)},o.vmhdBox.prototype.write=function(e){this.version=0,this.flags=1,this.size=8,this.writeHeader(e),e.writeUint16(this.graphicsmode),e.writeUint16Array(this.opcolor)},o.cttsBox.prototype.unpack=function(e){var r,s,c;for(c=0,r=0;r<this.sample_counts.length;r++)for(s=0;s<this.sample_counts[r];s++)e[c].pts=e[c].dts+this.sample_offsets[r],c++},o.sttsBox.prototype.unpack=function(e){var r,s,c;for(c=0,r=0;r<this.sample_counts.length;r++)for(s=0;s<this.sample_counts[r];s++)c===0?e[c].dts=0:e[c].dts=e[c-1].dts+this.sample_deltas[r],c++},o.stcoBox.prototype.unpack=function(e){var r;for(r=0;r<this.chunk_offsets.length;r++)e[r].offset=this.chunk_offsets[r]},o.stscBox.prototype.unpack=function(e){var r,s,c,d,_;for(d=0,_=0,r=0;r<this.first_chunk.length;r++)for(s=0;s<(r+1<this.first_chunk.length?this.first_chunk[r+1]:1/0);s++)for(_++,c=0;c<this.samples_per_chunk[r];c++){if(e[d])e[d].description_index=this.sample_description_index[r],e[d].chunk_index=_;else return;d++}},o.stszBox.prototype.unpack=function(e){var r;for(r=0;r<this.sample_sizes.length;r++)e[r].size=this.sample_sizes[r]},o.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],o.boxEqualFields=function(e,r){if(e&&!r)return!1;var s;for(s in e)if(!(o.DIFF_BOXES_PROP_NAMES.indexOf(s)>-1)){if(e[s]instanceof o.Box||r[s]instanceof o.Box)continue;if(typeof e[s]>"u"||typeof r[s]>"u")continue;if(typeof e[s]=="function"||typeof r[s]=="function")continue;if(e.subBoxNames&&e.subBoxNames.indexOf(s.slice(0,4))>-1||r.subBoxNames&&r.subBoxNames.indexOf(s.slice(0,4))>-1)continue;if(s==="data"||s==="start"||s==="size"||s==="creation_time"||s==="modification_time")continue;if(o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(s)>-1)continue;if(e[s]!==r[s])return!1}return!0},o.boxEqual=function(e,r){if(!o.boxEqualFields(e,r))return!1;for(var s=0;s<o.DIFF_BOXES_PROP_NAMES.length;s++){var c=o.DIFF_BOXES_PROP_NAMES[s];if(e[c]&&r[c]&&!o.boxEqual(e[c],r[c]))return!1}return!0};var v=function(){};v.prototype.parseSample=function(e){var r,s,c=new a(e.buffer);for(r=[];!c.isEos();)s=o.parseOneBox(c,!1),s.code===o.OK&&s.box.type==="vttc"&&r.push(s.box);return r},v.prototype.getText=function(e,r,s){function c(T,C,P){return P=P||"0",T=T+"",T.length>=C?T:new Array(C-T.length+1).join(P)+T}function d(T){var C=Math.floor(T/3600),P=Math.floor((T-C*3600)/60),L=Math.floor(T-C*3600-P*60),R=Math.floor((T-C*3600-P*60-L)*1e3);return""+c(C,2)+":"+c(P,2)+":"+c(L,2)+"."+c(R,3)}for(var _=this.parseSample(s),m="",A=0;A<_.length;A++){var B=_[A];m+=d(e)+" --> "+d(r)+`\r
`,m+=B.payl.text}return m};var S=function(){};S.prototype.parseSample=function(e){var r={},s;r.resources=[];var c=new a(e.data.buffer);if(!e.subsamples||e.subsamples.length===0)r.documentString=c.readString(e.data.length);else if(r.documentString=c.readString(e.subsamples[0].size),e.subsamples.length>1)for(s=1;s<e.subsamples.length;s++)r.resources[s]=c.readUint8Array(e.subsamples[s].size);return typeof DOMParser<"u"&&(r.document=new DOMParser().parseFromString(r.documentString,"application/xml")),r};var U=function(){};U.prototype.parseSample=function(e){var r,s=new a(e.data.buffer);return r=s.readString(e.data.length),r},U.prototype.parseConfig=function(e){var r,s=new a(e.buffer);return s.readUint32(),r=s.readCString(),r},t.VTTin4Parser=v,t.XMLSubtitlein4Parser=S,t.Textin4Parser=U;var b=function(e){this.stream=e||new u,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.items=[],this.entity_groups=[],this.onSidx=null,this.sidxSent=!1};b.prototype.setSegmentOptions=function(e,r,s){var c=this.getTrackById(e);if(c){var d={};this.fragmentedTracks.push(d),d.id=e,d.user=r,d.trak=c,c.nextSample=0,d.segmentStream=null,d.nb_samples=1e3,d.rapAlignement=!0,s&&(s.nbSamples&&(d.nb_samples=s.nbSamples),s.rapAlignement&&(d.rapAlignement=s.rapAlignement))}},b.prototype.unsetSegmentOptions=function(e){for(var r=-1,s=0;s<this.fragmentedTracks.length;s++){var c=this.fragmentedTracks[s];c.id==e&&(r=s)}r>-1&&this.fragmentedTracks.splice(r,1)},b.prototype.setExtractionOptions=function(e,r,s){var c=this.getTrackById(e);if(c){var d={};this.extractedTracks.push(d),d.id=e,d.user=r,d.trak=c,c.nextSample=0,d.nb_samples=1e3,d.samples=[],s&&s.nbSamples&&(d.nb_samples=s.nbSamples)}},b.prototype.unsetExtractionOptions=function(e){for(var r=-1,s=0;s<this.extractedTracks.length;s++){var c=this.extractedTracks[s];c.id==e&&(r=s)}r>-1&&this.extractedTracks.splice(r,1)},b.prototype.parse=function(){var e,r,s=!1;if(!(this.restoreParsePosition&&!this.restoreParsePosition()))for(;;)if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}else if(this.saveParsePosition&&this.saveParsePosition(),e=o.parseOneBox(this.stream,s),e.code===o.ERR_NOT_ENOUGH_DATA)if(this.processIncompleteBox){if(this.processIncompleteBox(e))continue;return}else return;else{var c;switch(r=e.box,c=r.type!=="uuid"?r.type:r.uuid,this.boxes.push(r),c){case"mdat":this.mdats.push(r);break;case"moof":this.moofs.push(r);break;case"moov":this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0);default:this[c]!==void 0&&n.warn("ISOFile","Duplicate Box of type: "+c+", overriding previous occurrence"),this[c]=r;break}this.updateUsedBytes&&this.updateUsedBytes(r,e)}},b.prototype.checkBuffer=function(e){if(e==null)throw"Buffer must be defined and non empty";if(e.fileStart===void 0)throw"Buffer must have a fileStart property";return e.byteLength===0?(n.warn("ISOFile","Ignoring empty buffer (fileStart: "+e.fileStart+")"),this.stream.logBufferLevel(),!1):(n.info("ISOFile","Processing buffer (fileStart: "+e.fileStart+")"),e.usedBytes=0,this.stream.insertBuffer(e),this.stream.logBufferLevel(),this.stream.initialized()?!0:(n.warn("ISOFile","Not ready to start parsing"),!1))},b.prototype.appendBuffer=function(e,r){var s;if(this.checkBuffer(e))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(r),this.nextSeekPosition?(s=this.nextSeekPosition,this.nextSeekPosition=void 0):s=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(s=this.stream.getEndFilePositionAfter(s))):this.nextParsePosition?s=this.nextParsePosition:s=0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(n.info("ISOFile","Done processing buffer (fileStart: "+e.fileStart+") - next buffer to fetch should have a fileStart position of "+s),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),s},b.prototype.getInfo=function(){var e,r,s={},c,d,_,m,A=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(s.hasMoov=!0,s.duration=this.moov.mvhd.duration,s.timescale=this.moov.mvhd.timescale,s.isFragmented=this.moov.mvex!=null,s.isFragmented&&this.moov.mvex.mehd&&(s.fragment_duration=this.moov.mvex.mehd.fragment_duration),s.isProgressive=this.isProgressive,s.hasIOD=this.moov.iods!=null,s.brands=[],s.brands.push(this.ftyp.major_brand),s.brands=s.brands.concat(this.ftyp.compatible_brands),s.created=new Date(A+this.moov.mvhd.creation_time*1e3),s.modified=new Date(A+this.moov.mvhd.modification_time*1e3),s.tracks=[],s.audioTracks=[],s.videoTracks=[],s.subtitleTracks=[],s.metadataTracks=[],s.hintTracks=[],s.otherTracks=[],e=0;e<this.moov.traks.length;e++){if(c=this.moov.traks[e],m=c.mdia.minf.stbl.stsd.entries[0],d={},s.tracks.push(d),d.id=c.tkhd.track_id,d.name=c.mdia.hdlr.name,d.references=[],c.tref)for(r=0;r<c.tref.boxes.length;r++)_={},d.references.push(_),_.type=c.tref.boxes[r].type,_.track_ids=c.tref.boxes[r].track_ids;c.edts&&(d.edits=c.edts.elst.entries),d.created=new Date(A+c.tkhd.creation_time*1e3),d.modified=new Date(A+c.tkhd.modification_time*1e3),d.movie_duration=c.tkhd.duration,d.movie_timescale=s.timescale,d.layer=c.tkhd.layer,d.alternate_group=c.tkhd.alternate_group,d.volume=c.tkhd.volume,d.matrix=c.tkhd.matrix,d.track_width=c.tkhd.width/65536,d.track_height=c.tkhd.height/65536,d.timescale=c.mdia.mdhd.timescale,d.cts_shift=c.mdia.minf.stbl.cslg,d.duration=c.mdia.mdhd.duration,d.samples_duration=c.samples_duration,d.codec=m.getCodec(),d.kind=c.udta&&c.udta.kinds.length?c.udta.kinds[0]:{schemeURI:"",value:""},d.language=c.mdia.elng?c.mdia.elng.extended_language:c.mdia.mdhd.languageString,d.nb_samples=c.samples.length,d.size=c.samples_size,d.bitrate=d.size*8*d.timescale/d.samples_duration,m.isAudio()?(d.type="audio",s.audioTracks.push(d),d.audio={},d.audio.sample_rate=m.getSampleRate(),d.audio.channel_count=m.getChannelCount(),d.audio.sample_size=m.getSampleSize()):m.isVideo()?(d.type="video",s.videoTracks.push(d),d.video={},d.video.width=m.getWidth(),d.video.height=m.getHeight()):m.isSubtitle()?(d.type="subtitles",s.subtitleTracks.push(d)):m.isHint()?(d.type="metadata",s.hintTracks.push(d)):m.isMetadata()?(d.type="metadata",s.metadataTracks.push(d)):(d.type="metadata",s.otherTracks.push(d))}else s.hasMoov=!1;if(s.mime="",s.hasMoov&&s.tracks){for(s.videoTracks&&s.videoTracks.length>0?s.mime+='video/mp4; codecs="':s.audioTracks&&s.audioTracks.length>0?s.mime+='audio/mp4; codecs="':s.mime+='application/mp4; codecs="',e=0;e<s.tracks.length;e++)e!==0&&(s.mime+=","),s.mime+=s.tracks[e].codec;s.mime+='"; profiles="',s.mime+=this.ftyp.compatible_brands.join(),s.mime+='"'}return s},b.prototype.setNextSeekPositionFromSample=function(e){e&&(this.nextSeekPosition?this.nextSeekPosition=Math.min(e.offset+e.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=e.offset+e.alreadyRead)},b.prototype.processSamples=function(e){var r,s;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&this.onSegment!==null)for(r=0;r<this.fragmentedTracks.length;r++){var c=this.fragmentedTracks[r];for(s=c.trak;s.nextSample<s.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Creating media fragment on track #"+c.id+" for sample "+s.nextSample);var d=this.createFragment(c.id,s.nextSample,c.segmentStream);if(d)c.segmentStream=d,s.nextSample++;else break;if((s.nextSample%c.nb_samples===0||e||s.nextSample>=s.samples.length)&&(n.info("ISOFile","Sending fragmented data on track #"+c.id+" for samples ["+Math.max(0,s.nextSample-c.nb_samples)+","+(s.nextSample-1)+"]"),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(c.id,c.user,c.segmentStream.buffer,s.nextSample,e||s.nextSample>=s.samples.length),c.segmentStream=null,c!==this.fragmentedTracks[r]))break}}if(this.onSamples!==null)for(r=0;r<this.extractedTracks.length;r++){var _=this.extractedTracks[r];for(s=_.trak;s.nextSample<s.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Exporting on track #"+_.id+" sample #"+s.nextSample);var m=this.getSample(s,s.nextSample);if(m)s.nextSample++,_.samples.push(m);else{this.setNextSeekPositionFromSample(s.samples[s.nextSample]);break}if((s.nextSample%_.nb_samples===0||s.nextSample>=s.samples.length)&&(n.debug("ISOFile","Sending samples on track #"+_.id+" for sample "+s.nextSample),this.onSamples&&this.onSamples(_.id,_.user,_.samples),_.samples=[],_!==this.extractedTracks[r]))break}}}},b.prototype.getBox=function(e){var r=this.getBoxes(e,!0);return r.length?r[0]:null},b.prototype.getBoxes=function(e,r){var s=[];return b._sweep.call(this,e,s,r),s},b._sweep=function(e,r,s){this.type&&this.type==e&&r.push(this);for(var c in this.boxes){if(r.length&&s)return;b._sweep.call(this.boxes[c],e,r,s)}},b.prototype.getTrackSamplesInfo=function(e){var r=this.getTrackById(e);if(r)return r.samples},b.prototype.getTrackSample=function(e,r){var s=this.getTrackById(e),c=this.getSample(s,r);return c},b.prototype.releaseUsedSamples=function(e,r){var s=0,c=this.getTrackById(e);c.lastValidSample||(c.lastValidSample=0);for(var d=c.lastValidSample;d<r;d++)s+=this.releaseSample(c,d);n.info("ISOFile","Track #"+e+" released samples up to "+r+" (released size: "+s+", remaining: "+this.samplesDataSize+")"),c.lastValidSample=r},b.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},b.prototype.stop=function(){this.sampleProcessingStarted=!1},b.prototype.flush=function(){n.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},b.prototype.seekTrack=function(e,r,s){var c,d,_=1/0,m=0,A=0,B;if(s.samples.length===0)return n.info("ISOFile","No sample in track, cannot seek! Using time "+n.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(c=0;c<s.samples.length;c++){if(d=s.samples[c],c===0)A=0,B=d.timescale;else if(d.cts>e*d.timescale){A=c-1;break}r&&d.is_sync&&(m=c)}for(r&&(A=m),e=s.samples[A].cts,s.nextSample=A;s.samples[A].alreadyRead===s.samples[A].size&&s.samples[A+1];)A++;return _=s.samples[A].offset+s.samples[A].alreadyRead,n.info("ISOFile","Seeking to "+(r?"RAP":"")+" sample #"+s.nextSample+" on track "+s.tkhd.track_id+", time "+n.getDurationString(e,B)+" and offset: "+_),{offset:_,time:e/B}},b.prototype.getTrackDuration=function(e){var r;return e.samples?(r=e.samples[e.samples.length-1],(r.cts+r.duration)/r.timescale):1/0},b.prototype.seek=function(e,r){var s=this.moov,c,d,_,m={offset:1/0,time:1/0};if(this.moov){for(_=0;_<s.traks.length;_++)c=s.traks[_],!(e>this.getTrackDuration(c))&&(d=this.seekTrack(e,r,c),d.offset<m.offset&&(m.offset=d.offset),d.time<m.time&&(m.time=d.time));return n.info("ISOFile","Seeking at time "+n.getDurationString(m.time,1)+" needs a buffer with a fileStart position of "+m.offset),m.offset===1/0?m={offset:this.nextParsePosition,time:0}:m.offset=this.stream.getEndFilePositionAfter(m.offset),n.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+m.offset),m}else throw"Cannot seek: moov not received!"},b.prototype.equal=function(e){for(var r=0;r<this.boxes.length&&r<e.boxes.length;){var s=this.boxes[r],c=e.boxes[r];if(!o.boxEqual(s,c))return!1;r++}return!0},t.ISOFile=b,b.prototype.lastBoxStartPosition=0,b.prototype.parsingMdat=null,b.prototype.nextParsePosition=0,b.prototype.discardMdatData=!1,b.prototype.processIncompleteBox=function(e){var r,s,c;return e.type==="mdat"?(r=new o[e.type+"Box"](e.size),this.parsingMdat=r,this.boxes.push(r),this.mdats.push(r),r.start=e.start,r.hdr_size=e.hdr_size,this.stream.addUsedBytes(r.hdr_size),this.lastBoxStartPosition=r.start+r.size,c=this.stream.seek(r.start+r.size,!1,this.discardMdatData),c?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=r.start+r.size,!1)):(e.type==="moov"&&(this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0)),s=this.stream.mergeNextBuffer?this.stream.mergeNextBuffer():!1,s?(this.nextParsePosition=this.stream.getEndPosition(),!0):(e.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+e.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},b.prototype.hasIncompleteMdat=function(){return this.parsingMdat!==null},b.prototype.processIncompleteMdat=function(){var e,r;return e=this.parsingMdat,r=this.stream.seek(e.start+e.size,!1,this.discardMdatData),r?(n.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},b.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},b.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},b.prototype.updateUsedBytes=function(e,r){this.stream.addUsedBytes&&(e.type==="mdat"?(this.stream.addUsedBytes(e.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(e.size-e.hdr_size)):this.stream.addUsedBytes(e.size))},b.prototype.add=o.Box.prototype.add,b.prototype.addBox=o.Box.prototype.addBox,b.prototype.init=function(e){var r=e||{};this.add("ftyp").set("major_brand",r.brands&&r.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",r.brands||["iso4"]);var s=this.add("moov");return s.add("mvhd").set("timescale",r.timescale||600).set("rate",r.rate||65536).set("creation_time",0).set("modification_time",0).set("duration",r.duration||0).set("volume",r.width?0:256).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("next_track_id",1),s.add("mvex"),this},b.prototype.addTrack=function(e){this.moov||this.init(e);var r=e||{};r.width=r.width||320,r.height=r.height||320,r.id=r.id||this.moov.mvhd.next_track_id,r.type=r.type||"avc1";var s=this.moov.add("trak");this.moov.mvhd.next_track_id=r.id+1,s.add("tkhd").set("flags",o.TKHD_FLAG_ENABLED|o.TKHD_FLAG_IN_MOVIE|o.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",r.id).set("duration",r.duration||0).set("layer",r.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("width",r.width<<16).set("height",r.height<<16);var c=s.add("mdia");c.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",r.timescale||1).set("duration",r.media_duration||0).set("language",r.language||"und"),c.add("hdlr").set("handler",r.hdlr||"vide").set("name",r.name||"Track created with MP4Box.js"),c.add("elng").set("extended_language",r.language||"fr-FR");var d=c.add("minf");if(o[r.type+"SampleEntry"]!==void 0){var _=new o[r.type+"SampleEntry"];_.data_reference_index=1;var m="";for(var A in o.sampleEntryCodes)for(var B=o.sampleEntryCodes[A],T=0;T<B.length;T++)if(B.indexOf(r.type)>-1){m=A;break}switch(m){case"Visual":if(d.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),_.set("width",r.width).set("height",r.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",r.type+" Compressor").set("depth",24),r.avcDecoderConfigRecord){var C=new o.avcCBox;C.parse(new a(r.avcDecoderConfigRecord)),_.addBox(C)}else if(r.hevcDecoderConfigRecord){var P=new o.hvcCBox;P.parse(new a(r.hevcDecoderConfigRecord)),_.addBox(P)}break;case"Audio":d.add("smhd").set("balance",r.balance||0),_.set("channel_count",r.channel_count||2).set("samplesize",r.samplesize||16).set("samplerate",r.samplerate||65536);break;case"Hint":d.add("hmhd");break;case"Subtitle":switch(d.add("sthd"),r.type){case"stpp":_.set("namespace",r.namespace||"nonamespace").set("schema_location",r.schema_location||"").set("auxiliary_mime_types",r.auxiliary_mime_types||"");break}break;case"Metadata":d.add("nmhd");break;case"System":d.add("nmhd");break;default:d.add("nmhd");break}r.description&&_.addBox(r.description),r.description_boxes&&r.description_boxes.forEach(function(R){_.addBox(R)}),d.add("dinf").add("dref").addEntry(new o["url Box"]().set("flags",1));var L=d.add("stbl");return L.add("stsd").addEntry(_),L.add("stts").set("sample_counts",[]).set("sample_deltas",[]),L.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),L.add("stco").set("chunk_offsets",[]),L.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",r.id).set("default_sample_description_index",r.default_sample_description_index||1).set("default_sample_duration",r.default_sample_duration||0).set("default_sample_size",r.default_sample_size||0).set("default_sample_flags",r.default_sample_flags||0),this.buildTrakSampleLists(s),r.id}},o.Box.prototype.computeSize=function(e){var r=e||new l;r.endianness=l.BIG_ENDIAN,this.write(r)},b.prototype.addSample=function(e,r,s){var c=s||{},d={},_=this.getTrackById(e);if(_!==null){d.number=_.samples.length,d.track_id=_.tkhd.track_id,d.timescale=_.mdia.mdhd.timescale,d.description_index=c.sample_description_index?c.sample_description_index-1:0,d.description=_.mdia.minf.stbl.stsd.entries[d.description_index],d.data=r,d.size=r.byteLength,d.alreadyRead=d.size,d.duration=c.duration||1,d.cts=c.cts||0,d.dts=c.dts||0,d.is_sync=c.is_sync||!1,d.is_leading=c.is_leading||0,d.depends_on=c.depends_on||0,d.is_depended_on=c.is_depended_on||0,d.has_redundancy=c.has_redundancy||0,d.degradation_priority=c.degradation_priority||0,d.offset=0,d.subsamples=c.subsamples,_.samples.push(d),_.samples_size+=d.size,_.samples_duration+=d.duration,_.first_dts===void 0&&(_.first_dts=c.dts),this.processSamples();var m=this.createSingleSampleMoof(d);return this.addBox(m),m.computeSize(),m.trafs[0].truns[0].data_offset=m.size+8,this.add("mdat").data=new Uint8Array(r),d}},b.prototype.createSingleSampleMoof=function(e){var r=0;e.is_sync?r=1<<25:r=65536;var s=new o.moofBox;s.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var c=s.add("traf"),d=this.getTrackById(e.track_id);return c.add("tfhd").set("track_id",e.track_id).set("flags",o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),c.add("tfdt").set("baseMediaDecodeTime",e.dts-(d.first_dts||0)),c.add("trun").set("flags",o.TRUN_FLAGS_DATA_OFFSET|o.TRUN_FLAGS_DURATION|o.TRUN_FLAGS_SIZE|o.TRUN_FLAGS_FLAGS|o.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[e.duration]).set("sample_size",[e.size]).set("sample_flags",[r]).set("sample_composition_time_offset",[e.cts-e.dts]),s},b.prototype.lastMoofIndex=0,b.prototype.samplesDataSize=0,b.prototype.resetTables=function(){var e,r,s,c,d,_,m,A;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,e=0;e<this.moov.traks.length;e++){r=this.moov.traks[e],r.tkhd.duration=0,r.mdia.mdhd.duration=0,s=r.mdia.minf.stbl.stco||r.mdia.minf.stbl.co64,s.chunk_offsets=[],c=r.mdia.minf.stbl.stsc,c.first_chunk=[],c.samples_per_chunk=[],c.sample_description_index=[],d=r.mdia.minf.stbl.stsz||r.mdia.minf.stbl.stz2,d.sample_sizes=[],_=r.mdia.minf.stbl.stts,_.sample_counts=[],_.sample_deltas=[],m=r.mdia.minf.stbl.ctts,m&&(m.sample_counts=[],m.sample_offsets=[]),A=r.mdia.minf.stbl.stss;var B=r.mdia.minf.stbl.boxes.indexOf(A);B!=-1&&(r.mdia.minf.stbl.boxes[B]=null)}},b.initSampleGroups=function(e,r,s,c,d){var _,m,A,B;function T(C,P,L){this.grouping_type=C,this.grouping_type_parameter=P,this.sbgp=L,this.last_sample_in_run=-1,this.entry_index=-1}for(r&&(r.sample_groups_info=[]),e.sample_groups_info||(e.sample_groups_info=[]),m=0;m<s.length;m++){for(B=s[m].grouping_type+"/"+s[m].grouping_type_parameter,A=new T(s[m].grouping_type,s[m].grouping_type_parameter,s[m]),r&&(r.sample_groups_info[B]=A),e.sample_groups_info[B]||(e.sample_groups_info[B]=A),_=0;_<c.length;_++)c[_].grouping_type===s[m].grouping_type&&(A.description=c[_],A.description.used=!0);if(d)for(_=0;_<d.length;_++)d[_].grouping_type===s[m].grouping_type&&(A.fragment_description=d[_],A.fragment_description.used=!0,A.is_fragment=!0)}if(r){if(d)for(m=0;m<d.length;m++)!d[m].used&&d[m].version>=2&&(B=d[m].grouping_type+"/0",A=new T(d[m].grouping_type,0),A.is_fragment=!0,r.sample_groups_info[B]||(r.sample_groups_info[B]=A))}else for(m=0;m<c.length;m++)!c[m].used&&c[m].version>=2&&(B=c[m].grouping_type+"/0",A=new T(c[m].grouping_type,0),e.sample_groups_info[B]||(e.sample_groups_info[B]=A))},b.setSampleGroupProperties=function(e,r,s,c){var d,_;r.sample_groups=[];for(d in c)if(r.sample_groups[d]={},r.sample_groups[d].grouping_type=c[d].grouping_type,r.sample_groups[d].grouping_type_parameter=c[d].grouping_type_parameter,s>=c[d].last_sample_in_run&&(c[d].last_sample_in_run<0&&(c[d].last_sample_in_run=0),c[d].entry_index++,c[d].entry_index<=c[d].sbgp.entries.length-1&&(c[d].last_sample_in_run+=c[d].sbgp.entries[c[d].entry_index].sample_count)),c[d].entry_index<=c[d].sbgp.entries.length-1?r.sample_groups[d].group_description_index=c[d].sbgp.entries[c[d].entry_index].group_description_index:r.sample_groups[d].group_description_index=-1,r.sample_groups[d].group_description_index!==0){var m;c[d].fragment_description?m=c[d].fragment_description:m=c[d].description,r.sample_groups[d].group_description_index>0?(r.sample_groups[d].group_description_index>65535?_=(r.sample_groups[d].group_description_index>>16)-1:_=r.sample_groups[d].group_description_index-1,m&&_>=0&&(r.sample_groups[d].description=m.entries[_])):m&&m.version>=2&&m.default_group_description_index>0&&(r.sample_groups[d].description=m.entries[m.default_group_description_index-1])}},b.process_sdtp=function(e,r,s){r&&(e?(r.is_leading=e.is_leading[s],r.depends_on=e.sample_depends_on[s],r.is_depended_on=e.sample_is_depended_on[s],r.has_redundancy=e.sample_has_redundancy[s]):(r.is_leading=0,r.depends_on=0,r.is_depended_on=0,r.has_redundancy=0))},b.prototype.buildSampleLists=function(){var e,r;for(e=0;e<this.moov.traks.length;e++)r=this.moov.traks[e],this.buildTrakSampleLists(r)},b.prototype.buildTrakSampleLists=function(e){var r,s,c,d,_,m,A,B,T,C,P,L,R,X,W,re,O,H,ne,ce,ye,ge,be,Ae;if(e.samples=[],e.samples_duration=0,e.samples_size=0,s=e.mdia.minf.stbl.stco||e.mdia.minf.stbl.co64,c=e.mdia.minf.stbl.stsc,d=e.mdia.minf.stbl.stsz||e.mdia.minf.stbl.stz2,_=e.mdia.minf.stbl.stts,m=e.mdia.minf.stbl.ctts,A=e.mdia.minf.stbl.stss,B=e.mdia.minf.stbl.stsd,T=e.mdia.minf.stbl.subs,L=e.mdia.minf.stbl.stdp,C=e.mdia.minf.stbl.sbgps,P=e.mdia.minf.stbl.sgpds,H=-1,ne=-1,ce=-1,ye=-1,ge=0,be=0,Ae=0,b.initSampleGroups(e,null,C,P),!(typeof d>"u")){for(r=0;r<d.sample_sizes.length;r++){var ee={};ee.number=r,ee.track_id=e.tkhd.track_id,ee.timescale=e.mdia.mdhd.timescale,ee.alreadyRead=0,e.samples[r]=ee,ee.size=d.sample_sizes[r],e.samples_size+=ee.size,r===0?(X=1,R=0,ee.chunk_index=X,ee.chunk_run_index=R,O=c.samples_per_chunk[R],re=0,R+1<c.first_chunk.length?W=c.first_chunk[R+1]-1:W=1/0):r<O?(ee.chunk_index=X,ee.chunk_run_index=R):(X++,ee.chunk_index=X,re=0,X<=W||(R++,R+1<c.first_chunk.length?W=c.first_chunk[R+1]-1:W=1/0),ee.chunk_run_index=R,O+=c.samples_per_chunk[R]),ee.description_index=c.sample_description_index[ee.chunk_run_index]-1,ee.description=B.entries[ee.description_index],ee.offset=s.chunk_offsets[ee.chunk_index-1]+re,re+=ee.size,r>H&&(ne++,H<0&&(H=0),H+=_.sample_counts[ne]),r>0?(e.samples[r-1].duration=_.sample_deltas[ne],e.samples_duration+=e.samples[r-1].duration,ee.dts=e.samples[r-1].dts+e.samples[r-1].duration):ee.dts=0,m?(r>=ce&&(ye++,ce<0&&(ce=0),ce+=m.sample_counts[ye]),ee.cts=e.samples[r].dts+m.sample_offsets[ye]):ee.cts=ee.dts,A?(r==A.sample_numbers[ge]-1?(ee.is_sync=!0,ge++):(ee.is_sync=!1,ee.degradation_priority=0),T&&T.entries[be].sample_delta+Ae==r+1&&(ee.subsamples=T.entries[be].subsamples,Ae+=T.entries[be].sample_delta,be++)):ee.is_sync=!0,b.process_sdtp(e.mdia.minf.stbl.sdtp,ee,ee.number),L?ee.degradation_priority=L.priority[r]:ee.degradation_priority=0,T&&T.entries[be].sample_delta+Ae==r&&(ee.subsamples=T.entries[be].subsamples,Ae+=T.entries[be].sample_delta),(C.length>0||P.length>0)&&b.setSampleGroupProperties(e,ee,r,e.sample_groups_info)}r>0&&(e.samples[r-1].duration=Math.max(e.mdia.mdhd.duration-e.samples[r-1].dts,0),e.samples_duration+=e.samples[r-1].duration)}},b.prototype.updateSampleLists=function(){var e,r,s,c,d,_,m,A,B,T,C,P,L,R,X;if(this.moov!==void 0){for(;this.lastMoofIndex<this.moofs.length;)if(B=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,B.type=="moof")for(T=B,e=0;e<T.trafs.length;e++){for(C=T.trafs[e],P=this.getTrackById(C.tfhd.track_id),L=this.getTrexById(C.tfhd.track_id),C.tfhd.flags&o.TFHD_FLAG_SAMPLE_DESC?c=C.tfhd.default_sample_description_index:c=L?L.default_sample_description_index:1,C.tfhd.flags&o.TFHD_FLAG_SAMPLE_DUR?d=C.tfhd.default_sample_duration:d=L?L.default_sample_duration:0,C.tfhd.flags&o.TFHD_FLAG_SAMPLE_SIZE?_=C.tfhd.default_sample_size:_=L?L.default_sample_size:0,C.tfhd.flags&o.TFHD_FLAG_SAMPLE_FLAGS?m=C.tfhd.default_sample_flags:m=L?L.default_sample_flags:0,C.sample_number=0,C.sbgps.length>0&&b.initSampleGroups(P,C,C.sbgps,P.mdia.minf.stbl.sgpds,C.sgpds),r=0;r<C.truns.length;r++){var W=C.truns[r];for(s=0;s<W.sample_count;s++){R={},R.moof_number=this.lastMoofIndex,R.number_in_traf=C.sample_number,C.sample_number++,R.number=P.samples.length,C.first_sample_index=P.samples.length,P.samples.push(R),R.track_id=P.tkhd.track_id,R.timescale=P.mdia.mdhd.timescale,R.description_index=c-1,R.description=P.mdia.minf.stbl.stsd.entries[R.description_index],R.size=_,W.flags&o.TRUN_FLAGS_SIZE&&(R.size=W.sample_size[s]),P.samples_size+=R.size,R.duration=d,W.flags&o.TRUN_FLAGS_DURATION&&(R.duration=W.sample_duration[s]),P.samples_duration+=R.duration,P.first_traf_merged||s>0?R.dts=P.samples[P.samples.length-2].dts+P.samples[P.samples.length-2].duration:(C.tfdt?R.dts=C.tfdt.baseMediaDecodeTime:R.dts=0,P.first_traf_merged=!0),R.cts=R.dts,W.flags&o.TRUN_FLAGS_CTS_OFFSET&&(R.cts=R.dts+W.sample_composition_time_offset[s]),X=m,W.flags&o.TRUN_FLAGS_FLAGS?X=W.sample_flags[s]:s===0&&W.flags&o.TRUN_FLAGS_FIRST_FLAG&&(X=W.first_sample_flags),R.is_sync=!(X>>16&1),R.is_leading=X>>26&3,R.depends_on=X>>24&3,R.is_depended_on=X>>22&3,R.has_redundancy=X>>20&3,R.degradation_priority=X&65535;var re=!!(C.tfhd.flags&o.TFHD_FLAG_BASE_DATA_OFFSET),O=!!(C.tfhd.flags&o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),H=!!(W.flags&o.TRUN_FLAGS_DATA_OFFSET),ne=0;re?ne=C.tfhd.base_data_offset:O||r===0?ne=T.start:ne=A,r===0&&s===0?H?R.offset=ne+W.data_offset:R.offset=ne:R.offset=A,A=R.offset+R.size,(C.sbgps.length>0||C.sgpds.length>0||P.mdia.minf.stbl.sbgps.length>0||P.mdia.minf.stbl.sgpds.length>0)&&b.setSampleGroupProperties(P,R,R.number_in_traf,C.sample_groups_info)}}if(C.subs){P.has_fragment_subsamples=!0;var ce=C.first_sample_index;for(r=0;r<C.subs.entries.length;r++)ce+=C.subs.entries[r].sample_delta,R=P.samples[ce-1],R.subsamples=C.subs.entries[r].subsamples}}}},b.prototype.getSample=function(e,r){var s,c=e.samples[r];if(!this.moov)return null;if(!c.data)c.data=new Uint8Array(c.size),c.alreadyRead=0,this.samplesDataSize+=c.size,n.debug("ISOFile","Allocating sample #"+r+" on track #"+e.tkhd.track_id+" of size "+c.size+" (total: "+this.samplesDataSize+")");else if(c.alreadyRead==c.size)return c;for(;;){var d=this.stream.findPosition(!0,c.offset+c.alreadyRead,!1);if(d>-1){s=this.stream.buffers[d];var _=s.byteLength-(c.offset+c.alreadyRead-s.fileStart);if(c.size-c.alreadyRead<=_)return n.debug("ISOFile","Getting sample #"+r+" data (alreadyRead: "+c.alreadyRead+" offset: "+(c.offset+c.alreadyRead-s.fileStart)+" read size: "+(c.size-c.alreadyRead)+" full size: "+c.size+")"),l.memcpy(c.data.buffer,c.alreadyRead,s,c.offset+c.alreadyRead-s.fileStart,c.size-c.alreadyRead),s.usedBytes+=c.size-c.alreadyRead,this.stream.logBufferLevel(),c.alreadyRead=c.size,c;if(_===0)return null;n.debug("ISOFile","Getting sample #"+r+" partial data (alreadyRead: "+c.alreadyRead+" offset: "+(c.offset+c.alreadyRead-s.fileStart)+" read size: "+_+" full size: "+c.size+")"),l.memcpy(c.data.buffer,c.alreadyRead,s,c.offset+c.alreadyRead-s.fileStart,_),c.alreadyRead+=_,s.usedBytes+=_,this.stream.logBufferLevel()}else return null}},b.prototype.releaseSample=function(e,r){var s=e.samples[r];return s.data?(this.samplesDataSize-=s.size,s.data=null,s.alreadyRead=0,s.size):0},b.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},b.prototype.getCodecs=function(){var e,r="";for(e=0;e<this.moov.traks.length;e++){var s=this.moov.traks[e];e>0&&(r+=","),r+=s.mdia.minf.stbl.stsd.entries[0].getCodec()}return r},b.prototype.getTrexById=function(e){var r;if(!this.moov||!this.moov.mvex)return null;for(r=0;r<this.moov.mvex.trexs.length;r++){var s=this.moov.mvex.trexs[r];if(s.track_id==e)return s}return null},b.prototype.getTrackById=function(e){if(this.moov===void 0)return null;for(var r=0;r<this.moov.traks.length;r++){var s=this.moov.traks[r];if(s.tkhd.track_id==e)return s}return null},b.prototype.itemsDataSize=0,b.prototype.flattenItemInfo=function(){var e=this.items,r=this.entity_groups,s,c,d,_=this.meta;if(_!=null&&_.hdlr!==void 0&&_.iinf!==void 0){for(s=0;s<_.iinf.item_infos.length;s++)d={},d.id=_.iinf.item_infos[s].item_ID,e[d.id]=d,d.ref_to=[],d.name=_.iinf.item_infos[s].item_name,_.iinf.item_infos[s].protection_index>0&&(d.protection=_.ipro.protections[_.iinf.item_infos[s].protection_index-1]),_.iinf.item_infos[s].item_type?d.type=_.iinf.item_infos[s].item_type:d.type="mime",d.content_type=_.iinf.item_infos[s].content_type,d.content_encoding=_.iinf.item_infos[s].content_encoding,d.item_uri_type=_.iinf.item_infos[s].item_uri_type;if(_.grpl)for(s=0;s<_.grpl.boxes.length;s++)entity_group={},entity_group.id=_.grpl.boxes[s].group_id,entity_group.entity_ids=_.grpl.boxes[s].entity_ids,entity_group.type=_.grpl.boxes[s].type,r[entity_group.id]=entity_group;if(_.iloc)for(s=0;s<_.iloc.items.length;s++){var m=_.iloc.items[s];switch(d=e[m.item_ID],m.data_reference_index!==0&&(n.warn("Item storage with reference to other files: not supported"),d.source=_.dinf.boxes[m.data_reference_index-1]),m.construction_method){case 0:break;case 1:break;case 2:n.warn("Item storage with construction_method : not supported");break}for(d.extents=[],d.size=0,c=0;c<m.extents.length;c++)d.extents[c]={},d.extents[c].offset=m.extents[c].extent_offset+m.base_offset,m.construction_method==1&&(d.extents[c].offset+=_.idat.start+_.idat.hdr_size),d.extents[c].length=m.extents[c].extent_length,d.extents[c].alreadyRead=0,d.size+=d.extents[c].length}if(_.pitm&&(e[_.pitm.item_id].primary=!0),_.iref)for(s=0;s<_.iref.references.length;s++){var A=_.iref.references[s];for(c=0;c<A.references.length;c++)e[A.from_item_ID].ref_to.push({type:A.type,id:A.references[c]})}if(_.iprp)for(var B=0;B<_.iprp.ipmas.length;B++){var T=_.iprp.ipmas[B];for(s=0;s<T.associations.length;s++){var C=T.associations[s];if(d=e[C.id],d||(d=r[C.id]),d)for(d.properties===void 0&&(d.properties={},d.properties.boxes=[]),c=0;c<C.props.length;c++){var P=C.props[c];if(P.property_index>0&&P.property_index-1<_.iprp.ipco.boxes.length){var L=_.iprp.ipco.boxes[P.property_index-1];d.properties[L.type]=L,d.properties.boxes.push(L)}}}}}},b.prototype.getItem=function(e){var r,s;if(!this.meta)return null;if(s=this.items[e],!s.data&&s.size)s.data=new Uint8Array(s.size),s.alreadyRead=0,this.itemsDataSize+=s.size,n.debug("ISOFile","Allocating item #"+e+" of size "+s.size+" (total: "+this.itemsDataSize+")");else if(s.alreadyRead===s.size)return s;for(var c=0;c<s.extents.length;c++){var d=s.extents[c];if(d.alreadyRead!==d.length){var _=this.stream.findPosition(!0,d.offset+d.alreadyRead,!1);if(_>-1){r=this.stream.buffers[_];var m=r.byteLength-(d.offset+d.alreadyRead-r.fileStart);if(d.length-d.alreadyRead<=m)n.debug("ISOFile","Getting item #"+e+" extent #"+c+" data (alreadyRead: "+d.alreadyRead+" offset: "+(d.offset+d.alreadyRead-r.fileStart)+" read size: "+(d.length-d.alreadyRead)+" full extent size: "+d.length+" full item size: "+s.size+")"),l.memcpy(s.data.buffer,s.alreadyRead,r,d.offset+d.alreadyRead-r.fileStart,d.length-d.alreadyRead),r.usedBytes+=d.length-d.alreadyRead,this.stream.logBufferLevel(),s.alreadyRead+=d.length-d.alreadyRead,d.alreadyRead=d.length;else return n.debug("ISOFile","Getting item #"+e+" extent #"+c+" partial data (alreadyRead: "+d.alreadyRead+" offset: "+(d.offset+d.alreadyRead-r.fileStart)+" read size: "+m+" full extent size: "+d.length+" full item size: "+s.size+")"),l.memcpy(s.data.buffer,s.alreadyRead,r,d.offset+d.alreadyRead-r.fileStart,m),d.alreadyRead+=m,s.alreadyRead+=m,r.usedBytes+=m,this.stream.logBufferLevel(),null}else return null}}return s.alreadyRead===s.size?s:null},b.prototype.releaseItem=function(e){var r=this.items[e];if(r.data){this.itemsDataSize-=r.size,r.data=null,r.alreadyRead=0;for(var s=0;s<r.extents.length;s++){var c=r.extents[s];c.alreadyRead=0}return r.size}else return 0},b.prototype.processItems=function(e){for(var r in this.items){var s=this.items[r];this.getItem(s.id),e&&!s.sent&&(e(s),s.sent=!0,s.data=null)}},b.prototype.hasItem=function(e){for(var r in this.items){var s=this.items[r];if(s.name===e)return s.id}return-1},b.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},b.prototype.getPrimaryItem=function(){return!this.meta||!this.meta.pitm?null:this.getItem(this.meta.pitm.item_id)},b.prototype.itemToFragmentedTrackFile=function(e){var r=e||{},s=null;if(r.itemId?s=this.getItem(r.itemId):s=this.getPrimaryItem(),s==null)return null;var c=new b;c.discardMdatData=!1;var d={type:s.type,description_boxes:s.properties.boxes};s.properties.ispe&&(d.width=s.properties.ispe.image_width,d.height=s.properties.ispe.image_height);var _=c.addTrack(d);return _?(c.addSample(_,s.data),c):null},b.prototype.write=function(e){for(var r=0;r<this.boxes.length;r++)this.boxes[r].write(e)},b.prototype.createFragment=function(e,r,s){var c=this.getTrackById(e),d=this.getSample(c,r);if(d==null)return this.setNextSeekPositionFromSample(c.samples[r]),null;var _=s||new l;_.endianness=l.BIG_ENDIAN;var m=this.createSingleSampleMoof(d);m.write(_),m.trafs[0].truns[0].data_offset=m.size+8,n.debug("MP4Box","Adjusting data_offset with new value "+m.trafs[0].truns[0].data_offset),_.adjustUint32(m.trafs[0].truns[0].data_offset_position,m.trafs[0].truns[0].data_offset);var A=new o.mdatBox;return A.data=d.data,A.write(_),_},b.writeInitializationSegment=function(e,r,s,c){var d;n.debug("ISOFile","Generating initialization segment");var _=new l;_.endianness=l.BIG_ENDIAN,e.write(_);var m=r.add("mvex");for(s&&m.add("mehd").set("fragment_duration",s),d=0;d<r.traks.length;d++)m.add("trex").set("track_id",r.traks[d].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",c).set("default_sample_size",0).set("default_sample_flags",65536);return r.write(_),_.buffer},b.prototype.save=function(e){var r=new l;r.endianness=l.BIG_ENDIAN,this.write(r),r.save(e)},b.prototype.getBuffer=function(){var e=new l;return e.endianness=l.BIG_ENDIAN,this.write(e),e.buffer},b.prototype.initializeSegmentation=function(){var e,r,s,c;for(this.onSegment===null&&n.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),r=[],e=0;e<this.fragmentedTracks.length;e++){var d=new o.moovBox;d.mvhd=this.moov.mvhd,d.boxes.push(d.mvhd),s=this.getTrackById(this.fragmentedTracks[e].id),d.boxes.push(s),d.traks.push(s),c={},c.id=s.tkhd.track_id,c.user=this.fragmentedTracks[e].user,c.buffer=b.writeInitializationSegment(this.ftyp,d,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[e].samples.length>0?this.moov.traks[e].samples[0].duration:0),r.push(c)}return r},o.Box.prototype.printHeader=function(e){this.size+=8,this.size>f&&(this.size+=8),this.type==="uuid"&&(this.size+=16),e.log(e.indent+"size:"+this.size),e.log(e.indent+"type:"+this.type)},o.FullBox.prototype.printHeader=function(e){this.size+=4,o.Box.prototype.printHeader.call(this,e),e.log(e.indent+"version:"+this.version),e.log(e.indent+"flags:"+this.flags)},o.Box.prototype.print=function(e){this.printHeader(e)},o.ContainerBox.prototype.print=function(e){this.printHeader(e);for(var r=0;r<this.boxes.length;r++)if(this.boxes[r]){var s=e.indent;e.indent+=" ",this.boxes[r].print(e),e.indent=s}},b.prototype.print=function(e){e.indent="";for(var r=0;r<this.boxes.length;r++)this.boxes[r]&&this.boxes[r].print(e)},o.mvhdBox.prototype.print=function(e){o.FullBox.prototype.printHeader.call(this,e),e.log(e.indent+"creation_time: "+this.creation_time),e.log(e.indent+"modification_time: "+this.modification_time),e.log(e.indent+"timescale: "+this.timescale),e.log(e.indent+"duration: "+this.duration),e.log(e.indent+"rate: "+this.rate),e.log(e.indent+"volume: "+(this.volume>>8)),e.log(e.indent+"matrix: "+this.matrix.join(", ")),e.log(e.indent+"next_track_id: "+this.next_track_id)},o.tkhdBox.prototype.print=function(e){o.FullBox.prototype.printHeader.call(this,e),e.log(e.indent+"creation_time: "+this.creation_time),e.log(e.indent+"modification_time: "+this.modification_time),e.log(e.indent+"track_id: "+this.track_id),e.log(e.indent+"duration: "+this.duration),e.log(e.indent+"volume: "+(this.volume>>8)),e.log(e.indent+"matrix: "+this.matrix.join(", ")),e.log(e.indent+"layer: "+this.layer),e.log(e.indent+"alternate_group: "+this.alternate_group),e.log(e.indent+"width: "+this.width),e.log(e.indent+"height: "+this.height)};var z={};z.createFile=function(e,r){var s=e!==void 0?e:!0,c=new b(r);return c.discardMdatData=!s,c},t.createFile=z.createFile}(Fn)),Fn}var vh=mh();const wh=yh(vh);let Ln=!1;class Is extends Error{constructor(n){super(n),this.name="NotSupportError"}}function xh(){return"5.6.2 Paralogism"}async function Ua(t,n,a=1e6,l=null){let f,u;if(Reflect.has(globalThis,"MediaSource")==!1)throw new Is("MediaSource is not supported in this browser or context.");const h=wh.createFile();let o=null;const p=new Map;let g,y=!1,v,S;const U=new Promise((C,P)=>{v=C,S=P});await async function C(){if(!C.request)return C.request=!0,await new Promise((P,L)=>{o=new MediaSource,t.src=URL.createObjectURL(o),o.addEventListener("sourceopen",()=>{P(),setTimeout(()=>{C.request=!1},1e3)},{once:!0}),o.addEventListener("error",L),setTimeout(L,1e4,new Error("Timeout waiting for sourceopen"))})}();let z=1;const e=function(P){var L=P.id,R=P.codec,X='video/mp4; codecs="'+R+'"',W,re=typeof TrackDefault<"u";MediaSource.isTypeSupported(X)?(f=o.addSourceBuffer(X),p.set(L,f),re&&(f.trackDefaults=new TrackDefaultList([W])),f.addEventListener("error",function(O){}),f.ms=o,f.id=L,h.setSegmentOptions(L,f,{nbSamples:10}),f.pendingAppends=[],v()):S(new Is("Video codec is not supported by the browser"))},r=function C(P){const L=P.target;L.ms.readyState==="open"&&(L.sampleNum=0,L.removeEventListener("updateend",C),L.addEventListener("updateend",s.bind(L,!0,!0)),s.call(L,!1,!0),L.ms.pendingInits--)},s=function C(P,L){if(L===!0&&(this.sampleNum&&(h.releaseUsedSamples(this.id,this.sampleNum),delete this.sampleNum),this.is_last))try{o.readyState==="open"&&(l?.(()=>o.endOfStream()),l&&(l=null))}catch{}if(this.updating===!1&&this.pendingAppends.length>0){if(this.ms.readyState!=="open")return;var R=this.pendingAppends.shift();this.sampleNum=R.sampleNum,this.is_last=R.is_last;try{this.appendBuffer(R.buffer),y&&(t.play(),y=!1)}catch(X){X.name==="QuotaExceededError"&&(this.pendingAppends.splice(0,0,R),setTimeout(()=>{C.apply(this,arguments)},1e3))}}};h.onMoovStart=function(){},h.onReady=function(C){if(o.movieInfo=C,C.isFragmented?o.duration=o.original_duration=C.fragment_duration/C.timescale:o.duration=o.original_duration=C.duration/C.timescale,C){for(const P of C.tracks)e(P);g=h.initializeSegmentation();for(let P=0;P<g.length;P++){const L=g[P].user;P===0&&(L.ms.pendingInits=0),L.addEventListener("updateend",r),L.appendBuffer(g[P].buffer),L.segmentIndex=0,L.ms.pendingInits++}}},h.onSegment=function(C,P,L,R,X){const W=P;W.segmentIndex++,W.pendingAppends.push({id:C,buffer:L,sampleNum:R,is_last:X}),s.call(W,!0,!1)},h.onError=function(){S(new Error("Error in mp4boxfile",{data:arguments}))},h.start();function c(){const C=new Date().getTime();if(C-c.antiTik<100)return;c.antiTik=C;let P,L,R;for(P=0;P<t.buffered.length;P++)if(L=t.buffered.start(P),R=t.buffered.end(P),t.currentTime>=L&&t.currentTime<=R-Math.ceil(11*t.playbackRate))return;const X=h.seek(t.currentTime,!0),W=T(X.offset,X.offset+a);return t.lastSeekTime=t.currentTime,W}c.antiTik=0;function d(){t.lastSeekTime!==t.currentTime&&c()}let _=!1;function m(){(isNaN(m.last_time)||t.currentTime<m.last_time||t.currentTime-m.last_time>Math.ceil(10*t.playbackRate))&&(c(),m.last_time=t.currentTime,_=!1)}t.addEventListener("seeked",d),t.addEventListener("timeupdate",m);function A(){o.original_duration-t.currentTime>1||(t.loop||_?(t.currentTime=0,c(),y=!0,_=!1):(t.pause(),_=!0))}t.addEventListener("waiting",A);const B=()=>{u=!0,t.removeEventListener("seeked",d),t.removeEventListener("timeupdate",m),t.removeEventListener("waiting",A),p.forEach((C,P)=>{try{C.updating&&C.abort(),o.readyState==="open"&&o.removeSourceBuffer(C),C.removeEventListener("updateend",s),h.releaseUsedSamples(P,C.sampleNum)}catch(L){console.warn("Error cleaning up SourceBuffer:",L)}}),p.clear(),h&&(h.flush(),h.onSegment=null,h.onReady=null,h.onMoovStart=null,h.stop()),URL.revokeObjectURL(t.src),t.src="data:null/null,null";try{T.ab?.abort?.()}catch{}};async function T(C,P,L=null,R=0){if(L==null)L=++z,T.ab?.abort?.(),T.ab=null;else if(L!==z)return!0;if(u)return-1;if(R>64)return 3;const X=new AbortController;T.ab=X;try{const W=new Blob([await n(C,P,X)]);if(L!==z)return 2;if(!W.size){const H=new ArrayBuffer(0);return H.fileStart=C,h.appendBuffer(H,!0),h.flush(),1}const re=await W.arrayBuffer();re.fileStart=C;const O=h.appendBuffer(re,!!W.eof);if(h.flush(),O)return await T(O,O+a,L,++R);if(W.eof)return!1}catch{}return null}queueMicrotask(async()=>{await T(0,a)}),B.getMediaSource=()=>o,setTimeout(()=>{S(new Error("Timeout waiting for ready"))},3e4);try{await U}catch(C){throw B(),C}return B}const bh={name:"VideoDecryption",data(){return{ctx:null,file:null,fileUrl:"",password:"",playing:!1,cleanup:null,mode:"local"}},methods:{async getFileSize(t){const n=new AbortController,a=await fetch(t,{signal:n.signal});if(!a.ok)throw new Error(`Failed to fetch file size: ${a.statusText}`);const l=+a.headers.get("Content-Length");if(isNaN(l))throw new Error("Content-Length header is missing or invalid");return n.abort(),l},async playVideo(){if(this.file=this.$refs.filebox.value?.[0],!this.file&&this.mode==="local"){alert("请选择一个视频文件");return}try{this.playing=!0,await this.$nextTick();const t=await va();this.ctx=t;let n=this.mode==="local"?this.file:{size:await this.getFileSize(this.fileUrl)};const a=this.mode==="local"?async(u,h)=>{const o=n.slice(u,h);return new Uint8Array(await o.arrayBuffer())}:async(u,h,o)=>{const p=await fetch(this.fileUrl,{headers:{Range:`bytes=${u}-${h-1}`},method:"GET",signal:o});return new Uint8Array(await p.arrayBuffer())},l=this.password;await ba(t,new xa((u,h,o)=>a(u,h,o),n.size),l);const f=this.$refs.videoPlayer;f.controls=!0,f.playsInline=!0,this.cleanup=await Ua(f,async(u,h,o)=>await Aa(t,u,h,o)),this.$refs.videoDialog.showModal()}catch(t){console.error(t),alert(t),this.playing=!1}},closeDialog(){this.$refs.videoDialog.close()},handleDialogClose(){this.playing=!1,this.cleanup&&(this.cleanup(),this.cleanup=null),wa(this.ctx),this.ctx=null}}},Ah={class:"video-decrypt-container"},Sh={class:"mode-selector"},Uh={key:0,type:"file",ref:"filebox"},Eh=["disabled"],Ch={key:0,ref:"videoPlayer",controls:"",style:{flex:"1"}};function Bh(t,n,a,l,f,u){return xe(),Ue("div",Ah,[G("div",Sh,[G("label",null,[ve(G("input",{type:"radio","onUpdate:modelValue":n[0]||(n[0]=h=>f.mode=h),value:"local"},null,512),[[Ji,f.mode]]),n[7]||(n[7]=nt(" 本地文件 "))]),G("label",null,[ve(G("input",{type:"radio","onUpdate:modelValue":n[1]||(n[1]=h=>f.mode=h),value:"remote"},null,512),[[Ji,f.mode]]),n[8]||(n[8]=nt(" 在线文件 "))])]),f.mode==="local"?(xe(),Ue("input",Uh,null,512)):$e("",!0),f.mode==="remote"?ve((xe(),Ue("input",{key:1,type:"text","onUpdate:modelValue":n[2]||(n[2]=h=>f.fileUrl=h),placeholder:"输入视频URL"},null,512)),[[Ve,f.fileUrl]]):$e("",!0),ve(G("input",{type:"password","onUpdate:modelValue":n[3]||(n[3]=h=>f.password=h),placeholder:"输入解密密码"},null,512),[[Ve,f.password]]),G("button",{onClick:n[4]||(n[4]=(...h)=>u.playVideo&&u.playVideo(...h)),disabled:f.mode==="local"||!f.fileUrl&&f.mode==="remote"||f.playing},"播放视频",8,Eh),G("dialog",{style:{width:"100%",height:"100%",display:"flex","flex-direction":"column"},ref:"videoDialog",onClose:n[6]||(n[6]=(...h)=>u.handleDialogClose&&u.handleDialogClose(...h))},[f.playing?(xe(),Ue("video",Ch,null,512)):$e("",!0),G("button",{onClick:n[5]||(n[5]=(...h)=>u.closeDialog&&u.closeDialog(...h)),style:{"margin-top":"0.5em"}},"关闭")],544)])}const Th=Qt(bh,[["render",Bh],["__scopeId","data-v-6594b9c9"]]);let De;const Ph=()=>{const t=new Map;return{async get(n){return t.get(n)||null},async set(n,a){t.set(n,a)}}};De=Ph();const Ih=t=>{De=t},$n={en:{f2lp:"Failed to load preview",phbdd2ac:"Preview has been disabled due to a configuration.",c2dl:"Click to download the file.",np:"No preview available.",tftl:"The text file is too large, which is not supported to preview directly."},zh:{f2lp:"无法加载预览",phbdd2ac:"预览功能由于某个设置项而被停用。",c2dl:"点击下载文件。",np:"没有预览。",tftl:"文本文件太大，无法直接预览。"},ja:{f2lp:"プレビューの読み込みに失敗しました",phbdd2ac:"設定によりプレビューが無効になっています。",c2dl:"ファイルをダウンロードするにはクリックしてください。",np:"プレビューは利用できません。",tftl:"テキストファイルが大きすぎて、直接プレビューできません。"},ru:{f2lp:"Не удалось загрузить предварительный просмотр",phbdd2ac:"Предварительный просмотр отключен из-за настройки.",c2dl:"Нажмите, чтобы скачать файл.",np:"Предварительный просмотр недоступен.",tftl:"Текстовый файл слишком большой для предварительного просмотра."},fr:{f2lp:"Échec du chargement de l’aperçu",phbdd2ac:"L’aperçu a été désactivé en raison d’une configuration.",c2dl:"Cliquez pour télécharger le fichier.",np:"Aucun aperçu disponible.",tftl:"Le fichier texte est trop volumineux pour être prévisualisé directement."},de:{f2lp:"Vorschau konnte nicht geladen werden",phbdd2ac:"Vorschau wurde aufgrund einer Konfiguration deaktiviert.",c2dl:"Klicken Sie hier, um die Datei herunterzuladen.",np:"Keine Vorschau verfügbar.",tftl:"Die Textdatei ist zu groß, um direkt angezeigt zu werden."},it:{f2lp:"Impossibile caricare l'anteprima",phbdd2ac:"L'anteprima è stata disabilitata a causa di una configurazione.",c2dl:"Clicca per scaricare il file.",np:"Nessuna anteprima disponibile.",tftl:"Il file di testo è troppo grande per essere visualizzato direttamente."},ar:{f2lp:"فشل تحميل المعاينة",phbdd2ac:"تم تعطيل المعاينة بسبب إعداد.",c2dl:"انقر لتنزيل الملف.",np:"لا توجد معاينة متاحة.",tftl:"ملف النص كبير جدًا ولا يمكن معاينته مباشرة."}},Fh=(()=>{const t=navigator.languages;for(const n of t){const a=n.split("-")[0];if(n in $n)return n;if(a in $n)return a}return"en"})();function Tt(t){return $n[Fh]?.[t]??t}class mn extends HTMLElement{static stylesheet=new CSSStyleSheet;#i=!1;#e;constructor(){if(super(),this.attachShadow({mode:"open"}),!this.shadowRoot)throw new Error("Failed to attach shadow root!");this.shadowRoot.adoptedStyleSheets=[mn.stylesheet],this.#e=document.createElement("div"),this.#e.id="app",this.#e.innerText="Loading...",this.shadowRoot.append(this.#e)}connectedCallback(){}disconnectedCallback(){}async init(n,a,l){if(this.#i)throw new Error("HTMLCommonFilePreviewElement has been initialized!");if(!this.#e)throw new Error("HTMLCommonFilePreviewElement is not created properly!");const f=a.split("/"),u=f[0];f[1];const h=await n();let o=!1;switch(u){case"audio":case"video":if(await De.get("DisallowMediaPreview")=="true"||u==="audio"&&await De.get("DisallowAudioPreview")=="true"||u==="video"&&await De.get("DisallowVideoPreview")=="true")o=!0;else{const p=v=>{v.addEventListener("volumechange",async()=>{await De.set("PreferredVolume",String(v.volume))}),queueMicrotask(async()=>{const S=await De.get("PreferredVolume");S&&(v.volume=+S)})},g=document.createElement(u);g.id="app",this.#e.replaceWith(g),g.controls=!0,g instanceof HTMLVideoElement&&(g.playsInline=!0),p(g);let y=document.createElement("source");if(y.src=await n(3600*24),y.type=a,g.appendChild(y),!g.isConnected)break;g.load(),g.play().catch(()=>{});break}case"text":if(await De.get("DisallowTextPreview")!="true"&&u==="text"){this.#e.classList.add("text");try{const g=await(await fetch(h)).blob();if(g.size>1024*1024){this.#e.innerText=Tt("tftl");const y=document.createElement("a");y.href=h,y.target="_blank",y.innerText=Tt("c2dl"),y.rel="noopener noreferrer",y.download="true",this.#e.append(y);break}this.#e.innerText="",this.#e.append(document.createTextNode(await g.text()))}catch(p){this.#e.innerText=`${Tt("f2lp")}: ${p}`}break}else o=!0;case"image":if(!(await De.get("DisallowMediaPreview")=="true"||await De.get("DisallowImagePreview")=="true")&&u==="image"){let p=document.createElement("img");p.id="app",p.src=h,p.alt=l,p.addEventListener("click",()=>{p.classList.toggle("scale")}),this.#e.replaceWith(p);break}else o=!0;default:switch(a){case"application/pdf":if(await De.get("DisallowPdfPreview")!="true"){fetch(h).then(p=>p.blob()).then(p=>{let g=document.createElement("object");g.id="app",this.#e.replaceWith(g),g.data=URL.createObjectURL(p),g.type=a}).catch(p=>this.#e.innerText=`${Tt("f2lp")}: ${p}`);break}else o=!0;default:switch(l.includes(".")?l.split(".").pop()?.toLowerCase():""){case"doc":case"docx":case"xls":case"xlsx":case"ppt":case"pptx":if(await De.get("DisallowOnlineOfficeFilePreview")=="true"||await De.get("DisallowOnlinePreview")=="true")o=!0;else{const g=new URL("https://view.officeapps.live.com/op/embed.aspx");g.searchParams.set("src",h);const y=document.createElement("iframe");y.setAttribute("style","width: 100%; height: 100%; border: 0; box-sizing: border-box;"),y.src=g.href,this.#e.replaceWith(y);break}default:{this.#e.innerText="",this.#e.classList.add("text");const g=document.createElement("a");g.href=h,g.target="_blank",g.innerText=Tt("c2dl"),g.rel="noopener noreferrer",g.download="true",this.#e.append(Tt(o?"phbdd2ac":"np"),g)}}}}"image/audio/video".split("/").includes(u)&&!o&&this.classList.add("media"),o&&(this.dataset.excludeBindmove="true"),this.#i=!0}}mn.stylesheet.replace(`
:host {
    width: 100%;
    height: 100%;
    overflow: auto;
    border: 0;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
}
:host(.media) {
    background-color: black;
}

* {
    box-sizing: border-box;
}

a {
    color: blue;
    text-decoration: none;
}

a:hover {
    text-decoration: underline;
}

#app.text {
    padding: 10px;
    white-space: pre;
    font-family: Consolas, monospace;
}

img#app {
    cursor: zoom-in;
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    width: fit-content;
    height: fit-content;
    margin: auto;
}

img#app.scale {
    max-width: unset;
    max-height: unset;
    cursor: zoom-out;
}

video#app, object#app {
    width: 100%;
    height: 100%;
}

audio#app {
    margin: auto;
}
`);customElements.define("common-file-preview",mn);class Lh extends HTMLElement{#i;#e;#t;#n;constructor(){super(),this.#i=this.attachShadow({mode:"open"}),this.#e=document.createElement("common-file-preview"),this.#i.appendChild(this.#e);const n=document.createElement("style");n.textContent=`
            :host {
                display: block;
                box-sizing: border-box;
                overflow: hidden;
            }
            common-file-preview, video {
                width: 100%;
                height: 100%;
            }
            common-file-preview {
                overflow: auto;
            }
            video {
                object-fit: contain;
                background-color: #000;
            }
        `,this.#i.appendChild(n)}connectedCallback(){}disconnectedCallback(){this.#t&&this.#t!==!0&&wa(this.#t),this.#n&&this.#n()}async load(n,a,l,f,u){if(this.#t)throw new Error("already loaded");if(f!=="video"){const p=new Blob([await n(0,l)]),g=new Blob([await _u(p,a)],{type:f}),y=URL.createObjectURL(g);this.#e.init(()=>y,f,u),this.#t=!0,this.#n=()=>{URL.revokeObjectURL(y)};return}const h=document.createElement("video");h.controls=!0,h.playsInline=!0,this.#e.replaceWith(h),this.#e=h,this.#t=await va();const o=new xa(n,l);await ba(this.#t,o,a),this.#n=await Ua(h,async(p,g,y)=>await Aa(this.#t,p,g,y))}}customElements.define("simple-data-crypto-file-preview",Lh);console.log("play-video-streamed version:",xh());const kh={data(){return{file:null,fileUrl:"",password:"",mode:"local",type:"text/plain",shouldCreate:!1}},methods:{guessFileType(t=""){if(!t)return"text/plain";t.endsWith(".enc")&&(t=t.slice(0,-4));const n=t.split(".").pop().toLowerCase();switch(n){case"txt":return"text/plain";case"jpg":case"jpeg":case"png":case"gif":case"bmp":case"webp":return"image";case"mp4":return"video";case"mp3":case"wav":return"audio/"+n;case"pdf":return"application/pdf";case"docx":return"docx";default:return"text/plain"}},updateGuessedType(){if(this.mode==="local")this.type=this.guessFileType(this.$refs.filebox?.files?.[0]?.name);else if(this.mode==="remote")try{const t=new URL(this.fileUrl);this.type=this.guessFileType(t.pathname)}catch{}},async getFileSize(t){const n=new AbortController,a=await fetch(t,{signal:n.signal});if(!a.ok)throw new Error(`Failed to fetch file size: ${a.statusText}`);const l=+a.headers.get("Content-Length");if(isNaN(l))throw new Error("Content-Length header is missing or invalid");return n.abort(),l},async doPreview(){if(this.file=this.mode==="local"&&this.$refs.filebox.files?.[0],!this.file&&this.mode==="local"){alert("请选择一个文件");return}try{this.$refs.dlg.showModal(),this.shouldCreate=!0;const t=this.mode==="local"?async(a,l)=>{const f=this.file.slice(a,l);return new Uint8Array(await f.arrayBuffer())}:async(a,l,f)=>{const u=await fetch(this.fileUrl,{headers:{Range:`bytes=${a}-${l-1}`},method:"GET",signal:f});return new Uint8Array(await u.arrayBuffer())};await new Promise((a,l)=>{this.$nextTick(()=>this.$nextTick(a))});const n=this.type==="docx"?"File.docx":"File";await this.$refs.preview.load(t,this.password,this.mode==="local"?this.file.size:await this.getFileSize(this.fileUrl),this.type,n)}catch(t){console.error(t),alert(t),this.$refs.dlg.close(),this.shouldCreate=!1}},closeDialog(){this.$refs.dlg.close(),this.shouldCreate=!1},handleDialogClose(){}}},Rh={class:"mode-selector"},zh={key:0,type:"file",ref:"filebox"},Mh=["disabled"],Dh={key:0,ref:"preview",style:{flex:"1"}};function Oh(t,n,a,l,f,u){return xe(),Ue("div",{class:"file-preview",onChange:n[10]||(n[10]=(...h)=>u.updateGuessedType&&u.updateGuessedType(...h))},[G("div",Rh,[G("label",null,[ve(G("input",{type:"radio","onUpdate:modelValue":n[0]||(n[0]=h=>f.mode=h),value:"local"},null,512),[[Ji,f.mode]]),n[11]||(n[11]=nt(" 本地文件 "))]),G("label",null,[ve(G("input",{type:"radio","onUpdate:modelValue":n[1]||(n[1]=h=>f.mode=h),value:"remote"},null,512),[[Ji,f.mode]]),n[12]||(n[12]=nt(" 在线文件 "))])]),f.mode==="local"?(xe(),Ue("input",zh,null,512)):$e("",!0),f.mode==="remote"?ve((xe(),Ue("input",{key:1,type:"text","onUpdate:modelValue":n[2]||(n[2]=h=>f.fileUrl=h),placeholder:"输入文件URL"},null,512)),[[Ve,f.fileUrl]]):$e("",!0),ve(G("input",{type:"password","onUpdate:modelValue":n[3]||(n[3]=h=>f.password=h),placeholder:"输入解密密码",onChange:n[4]||(n[4]=fs(()=>{},["stop"]))},null,544),[[Ve,f.password]]),ve(G("select",{"onUpdate:modelValue":n[5]||(n[5]=h=>f.type=h),onChange:n[6]||(n[6]=fs(()=>{},["stop"]))},n[13]||(n[13]=[dr('<option value="text/plain" data-v-299644be>文本</option><option value="image" data-v-299644be>图片</option><option value="video" data-v-299644be>视频</option><option value="audio/mp3" data-v-299644be>音频</option><option value="application/pdf" data-v-299644be>PDF</option><option value="docx" data-v-299644be>Microsoft Office 文档</option>',6)]),544),[[Gf,f.type]]),G("button",{onClick:n[7]||(n[7]=(...h)=>u.doPreview&&u.doPreview(...h)),disabled:!f.fileUrl&&f.mode==="remote"},"预览",8,Mh),G("dialog",{style:{width:"100%",height:"100%",display:"flex","flex-direction":"column",overflow:"hidden"},ref:"dlg",onClose:n[9]||(n[9]=(...h)=>u.handleDialogClose&&u.handleDialogClose(...h))},[f.shouldCreate?(xe(),Ue("simple-data-crypto-file-preview",Dh,null,512)):$e("",!0),G("button",{onClick:n[8]||(n[8]=(...h)=>u.closeDialog&&u.closeDialog(...h)),style:{"margin-top":"0.5em"}},"关闭")],544)],32)}const Nh=Qt(kh,[["render",Oh],["__scopeId","data-v-299644be"]]),Hh=[{path:"/message",name:"message",component:Fu},{path:"/file",name:"file",component:Ju},{path:"/file-classic",name:"file-classic",component:gh},{path:"/preview",name:"FilePreview",component:Nh},{path:"/video-decrypt",name:"video-decrypt",component:Th},{path:"/",redirect:"/message"}],Vh=nu({history:Fc(),routes:Hh});Ih({async get(t){return localStorage.getItem("MyEncryptionApp::preview::preference::"+t)||null},async set(t,n){localStorage.setItem("MyEncryptionApp::preview::preference::"+t,n)}});$f(ec).use(Vh).mount("#app");
//# sourceMappingURL=index-C1cTsYT4.js.map
