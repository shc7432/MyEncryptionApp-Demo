import{decrypt_data as ao,encrypt_data as lo,change_file_password as ks,decrypt_file as Ms,encrypt_file as Ds,crypt_context_destroy as fo,crypt_context_create as co,decrypt_stream_init as uo,Stream as ho,decrypt_stream as po}from"simple-web-encryption";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function a(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerPolicy&&(u.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?u.credentials="include":c.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function l(c){if(c.ep)return;c.ep=!0;const u=a(c);fetch(c.href,u)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function mn(e){const n=Object.create(null);for(const a of e.split(","))n[a]=1;return a=>a in n}const ft={},Te=[],Zt=()=>{},_o=()=>!1,Ii=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),vn=e=>e.startsWith("onUpdate:"),St=Object.assign,xn=(e,n)=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)},go=Object.prototype.hasOwnProperty,ot=(e,n)=>go.call(e,n),$=Array.isArray,Pe=e=>li(e)==="[object Map]",Os=e=>li(e)==="[object Set]",Nn=e=>li(e)==="[object Date]",Z=e=>typeof e=="function",gt=e=>typeof e=="string",Jt=e=>typeof e=="symbol",dt=e=>e!==null&&typeof e=="object",Ns=e=>(dt(e)||Z(e))&&Z(e.then)&&Z(e.catch),Hs=Object.prototype.toString,li=e=>Hs.call(e),yo=e=>li(e).slice(8,-1),Gs=e=>li(e)==="[object Object]",bn=e=>gt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ke=mn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Li=e=>{const n=Object.create(null);return a=>n[a]||(n[a]=e(a))},mo=/-(\w)/g,Nt=Li(e=>e.replace(mo,(n,a)=>a?a.toUpperCase():"")),vo=/\B([A-Z])/g,Ee=Li(e=>e.replace(vo,"-$1").toLowerCase()),zi=Li(e=>e.charAt(0).toUpperCase()+e.slice(1)),Vi=Li(e=>e?`on${zi(e)}`:""),de=(e,n)=>!Object.is(e,n),gi=(e,...n)=>{for(let a=0;a<e.length;a++)e[a](...n)},Vs=(e,n,a,l=!1)=>{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:l,value:a})},nn=e=>{const n=parseFloat(e);return isNaN(n)?e:n};let Hn;const Ri=()=>Hn||(Hn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Sn(e){if($(e)){const n={};for(let a=0;a<e.length;a++){const l=e[a],c=gt(l)?wo(l):Sn(l);if(c)for(const u in c)n[u]=c[u]}return n}else if(gt(e)||dt(e))return e}const xo=/;(?![^(]*\))/g,bo=/:([^]+)/,So=/\/\*[^]*?\*\//g;function wo(e){const n={};return e.replace(So,"").split(xo).forEach(a=>{if(a){const l=a.split(bo);l.length>1&&(n[l[0].trim()]=l[1].trim())}}),n}function wn(e){let n="";if(gt(e))n=e;else if($(e))for(let a=0;a<e.length;a++){const l=wn(e[a]);l&&(n+=l+" ")}else if(dt(e))for(const a in e)e[a]&&(n+=a+" ");return n.trim()}const Uo="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Eo=mn(Uo);function Ys(e){return!!e||e===""}function Bo(e,n){if(e.length!==n.length)return!1;let a=!0;for(let l=0;a&&l<e.length;l++)a=Si(e[l],n[l]);return a}function Si(e,n){if(e===n)return!0;let a=Nn(e),l=Nn(n);if(a||l)return a&&l?e.getTime()===n.getTime():!1;if(a=Jt(e),l=Jt(n),a||l)return e===n;if(a=$(e),l=$(n),a||l)return a&&l?Bo(e,n):!1;if(a=dt(e),l=dt(n),a||l){if(!a||!l)return!1;const c=Object.keys(e).length,u=Object.keys(n).length;if(c!==u)return!1;for(const d in e){const o=e.hasOwnProperty(d),p=n.hasOwnProperty(d);if(o&&!p||!o&&p||!Si(e[d],n[d]))return!1}}return String(e)===String(n)}const js=e=>!!(e&&e.__v_isRef===!0),Re=e=>gt(e)?e:e==null?"":$(e)||dt(e)&&(e.toString===Hs||!Z(e.toString))?js(e)?Re(e.value):JSON.stringify(e,Ks,2):String(e),Ks=(e,n)=>js(n)?Ks(e,n.value):Pe(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((a,[l,c],u)=>(a[Yi(l,u)+" =>"]=c,a),{})}:Os(n)?{[`Set(${n.size})`]:[...n.values()].map(a=>Yi(a))}:Jt(n)?Yi(n):dt(n)&&!$(n)&&!Gs(n)?String(n):n,Yi=(e,n="")=>{var a;return Jt(e)?`Symbol(${(a=e.description)!=null?a:n})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let zt;class Co{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=zt,!n&&zt&&(this.index=(zt.scopes||(zt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let n,a;if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].pause();for(n=0,a=this.effects.length;n<a;n++)this.effects[n].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let n,a;if(this.scopes)for(n=0,a=this.scopes.length;n<a;n++)this.scopes[n].resume();for(n=0,a=this.effects.length;n<a;n++)this.effects[n].resume()}}run(n){if(this._active){const a=zt;try{return zt=this,n()}finally{zt=a}}}on(){zt=this}off(){zt=this.parent}stop(n){if(this._active){this._active=!1;let a,l;for(a=0,l=this.effects.length;a<l;a++)this.effects[a].stop();for(this.effects.length=0,a=0,l=this.cleanups.length;a<l;a++)this.cleanups[a]();if(this.cleanups.length=0,this.scopes){for(a=0,l=this.scopes.length;a<l;a++)this.scopes[a].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!n){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0}}}function Ao(){return zt}let ut;const ji=new WeakSet;class Ws{constructor(n){this.fn=n,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,zt&&zt.active&&zt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,ji.has(this)&&(ji.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||$s(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Gn(this),Xs(this);const n=ut,a=Gt;ut=this,Gt=!0;try{return this.fn()}finally{Zs(this),ut=n,Gt=a,this.flags&=-3}}stop(){if(this.flags&1){for(let n=this.deps;n;n=n.nextDep)Bn(n);this.deps=this.depsTail=void 0,Gn(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?ji.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){sn(this)&&this.run()}get dirty(){return sn(this)}}let qs=0,We,qe;function $s(e,n=!1){if(e.flags|=8,n){e.next=qe,qe=e;return}e.next=We,We=e}function Un(){qs++}function En(){if(--qs>0)return;if(qe){let n=qe;for(qe=void 0;n;){const a=n.next;n.next=void 0,n.flags&=-9,n=a}}let e;for(;We;){let n=We;for(We=void 0;n;){const a=n.next;if(n.next=void 0,n.flags&=-9,n.flags&1)try{n.trigger()}catch(l){e||(e=l)}n=a}}if(e)throw e}function Xs(e){for(let n=e.deps;n;n=n.nextDep)n.version=-1,n.prevActiveLink=n.dep.activeLink,n.dep.activeLink=n}function Zs(e){let n,a=e.depsTail,l=a;for(;l;){const c=l.prevDep;l.version===-1?(l===a&&(a=c),Bn(l),To(l)):n=l,l.dep.activeLink=l.prevActiveLink,l.prevActiveLink=void 0,l=c}e.deps=n,e.depsTail=a}function sn(e){for(let n=e.deps;n;n=n.nextDep)if(n.dep.version!==n.version||n.dep.computed&&(Qs(n.dep.computed)||n.dep.version!==n.version))return!0;return!!e._dirty}function Qs(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===ei))return;e.globalVersion=ei;const n=e.dep;if(e.flags|=2,n.version>0&&!e.isSSR&&e.deps&&!sn(e)){e.flags&=-3;return}const a=ut,l=Gt;ut=e,Gt=!0;try{Xs(e);const c=e.fn(e._value);(n.version===0||de(c,e._value))&&(e._value=c,n.version++)}catch(c){throw n.version++,c}finally{ut=a,Gt=l,Zs(e),e.flags&=-3}}function Bn(e,n=!1){const{dep:a,prevSub:l,nextSub:c}=e;if(l&&(l.nextSub=c,e.prevSub=void 0),c&&(c.prevSub=l,e.nextSub=void 0),a.subs===e&&(a.subs=l,!l&&a.computed)){a.computed.flags&=-5;for(let u=a.computed.deps;u;u=u.nextDep)Bn(u,!0)}!n&&!--a.sc&&a.map&&a.map.delete(a.key)}function To(e){const{prevDep:n,nextDep:a}=e;n&&(n.nextDep=a,e.prevDep=void 0),a&&(a.prevDep=n,e.nextDep=void 0)}let Gt=!0;const Js=[];function _e(){Js.push(Gt),Gt=!1}function ge(){const e=Js.pop();Gt=e===void 0?!0:e}function Gn(e){const{cleanup:n}=e;if(e.cleanup=void 0,n){const a=ut;ut=void 0;try{n()}finally{ut=a}}}let ei=0;class Po{constructor(n,a){this.sub=n,this.dep=a,this.version=a.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Cn{constructor(n){this.computed=n,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(n){if(!ut||!Gt||ut===this.computed)return;let a=this.activeLink;if(a===void 0||a.sub!==ut)a=this.activeLink=new Po(ut,this),ut.deps?(a.prevDep=ut.depsTail,ut.depsTail.nextDep=a,ut.depsTail=a):ut.deps=ut.depsTail=a,tr(a);else if(a.version===-1&&(a.version=this.version,a.nextDep)){const l=a.nextDep;l.prevDep=a.prevDep,a.prevDep&&(a.prevDep.nextDep=l),a.prevDep=ut.depsTail,a.nextDep=void 0,ut.depsTail.nextDep=a,ut.depsTail=a,ut.deps===a&&(ut.deps=l)}return a}trigger(n){this.version++,ei++,this.notify(n)}notify(n){Un();try{for(let a=this.subs;a;a=a.prevSub)a.sub.notify()&&a.sub.dep.notify()}finally{En()}}}function tr(e){if(e.dep.sc++,e.sub.flags&4){const n=e.dep.computed;if(n&&!e.dep.subs){n.flags|=20;for(let l=n.deps;l;l=l.nextDep)tr(l)}const a=e.dep.subs;a!==e&&(e.prevSub=a,a&&(a.nextSub=e)),e.dep.subs=e}}const rn=new WeakMap,Se=Symbol(""),on=Symbol(""),ii=Symbol("");function vt(e,n,a){if(Gt&&ut){let l=rn.get(e);l||rn.set(e,l=new Map);let c=l.get(a);c||(l.set(a,c=new Cn),c.map=l,c.key=a),c.track()}}function re(e,n,a,l,c,u){const d=rn.get(e);if(!d){ei++;return}const o=p=>{p&&p.trigger()};if(Un(),n==="clear")d.forEach(o);else{const p=$(e),S=p&&bn(a);if(p&&a==="length"){const v=Number(l);d.forEach((b,E)=>{(E==="length"||E===ii||!Jt(E)&&E>=v)&&o(b)})}else switch((a!==void 0||d.has(void 0))&&o(d.get(a)),S&&o(d.get(ii)),n){case"add":p?S&&o(d.get("length")):(o(d.get(Se)),Pe(e)&&o(d.get(on)));break;case"delete":p||(o(d.get(Se)),Pe(e)&&o(d.get(on)));break;case"set":Pe(e)&&o(d.get(Se));break}}En()}function Be(e){const n=rt(e);return n===e?n:(vt(n,"iterate",ii),Vt(e)?n:n.map(Bt))}function An(e){return vt(e=rt(e),"iterate",ii),e}const Fo={__proto__:null,[Symbol.iterator](){return Ki(this,Symbol.iterator,Bt)},concat(...e){return Be(this).concat(...e.map(n=>$(n)?Be(n):n))},entries(){return Ki(this,"entries",e=>(e[1]=Bt(e[1]),e))},every(e,n){return ee(this,"every",e,n,void 0,arguments)},filter(e,n){return ee(this,"filter",e,n,a=>a.map(Bt),arguments)},find(e,n){return ee(this,"find",e,n,Bt,arguments)},findIndex(e,n){return ee(this,"findIndex",e,n,void 0,arguments)},findLast(e,n){return ee(this,"findLast",e,n,Bt,arguments)},findLastIndex(e,n){return ee(this,"findLastIndex",e,n,void 0,arguments)},forEach(e,n){return ee(this,"forEach",e,n,void 0,arguments)},includes(...e){return Wi(this,"includes",e)},indexOf(...e){return Wi(this,"indexOf",e)},join(e){return Be(this).join(e)},lastIndexOf(...e){return Wi(this,"lastIndexOf",e)},map(e,n){return ee(this,"map",e,n,void 0,arguments)},pop(){return Ne(this,"pop")},push(...e){return Ne(this,"push",e)},reduce(e,...n){return Vn(this,"reduce",e,n)},reduceRight(e,...n){return Vn(this,"reduceRight",e,n)},shift(){return Ne(this,"shift")},some(e,n){return ee(this,"some",e,n,void 0,arguments)},splice(...e){return Ne(this,"splice",e)},toReversed(){return Be(this).toReversed()},toSorted(e){return Be(this).toSorted(e)},toSpliced(...e){return Be(this).toSpliced(...e)},unshift(...e){return Ne(this,"unshift",e)},values(){return Ki(this,"values",Bt)}};function Ki(e,n,a){const l=An(e),c=l[n]();return l!==e&&!Vt(e)&&(c._next=c.next,c.next=()=>{const u=c._next();return u.value&&(u.value=a(u.value)),u}),c}const Io=Array.prototype;function ee(e,n,a,l,c,u){const d=An(e),o=d!==e&&!Vt(e),p=d[n];if(p!==Io[n]){const b=p.apply(e,u);return o?Bt(b):b}let S=a;d!==e&&(o?S=function(b,E){return a.call(this,Bt(b),E,e)}:a.length>2&&(S=function(b,E){return a.call(this,b,E,e)}));const v=p.call(d,S,l);return o&&c?c(v):v}function Vn(e,n,a,l){const c=An(e);let u=a;return c!==e&&(Vt(e)?a.length>3&&(u=function(d,o,p){return a.call(this,d,o,p,e)}):u=function(d,o,p){return a.call(this,d,Bt(o),p,e)}),c[n](u,...l)}function Wi(e,n,a){const l=rt(e);vt(l,"iterate",ii);const c=l[n](...a);return(c===-1||c===!1)&&Fn(a[0])?(a[0]=rt(a[0]),l[n](...a)):c}function Ne(e,n,a=[]){_e(),Un();const l=rt(e)[n].apply(e,a);return En(),ge(),l}const Lo=mn("__proto__,__v_isRef,__isVue"),er=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Jt));function zo(e){Jt(e)||(e=String(e));const n=rt(this);return vt(n,"has",e),n.hasOwnProperty(e)}class ir{constructor(n=!1,a=!1){this._isReadonly=n,this._isShallow=a}get(n,a,l){if(a==="__v_skip")return n.__v_skip;const c=this._isReadonly,u=this._isShallow;if(a==="__v_isReactive")return!c;if(a==="__v_isReadonly")return c;if(a==="__v_isShallow")return u;if(a==="__v_raw")return l===(c?u?Yo:or:u?rr:sr).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(l)?n:void 0;const d=$(n);if(!c){let p;if(d&&(p=Fo[a]))return p;if(a==="hasOwnProperty")return zo}const o=Reflect.get(n,a,bt(n)?n:l);return(Jt(a)?er.has(a):Lo(a))||(c||vt(n,"get",a),u)?o:bt(o)?d&&bn(a)?o:o.value:dt(o)?c?lr(o):ki(o):o}}class nr extends ir{constructor(n=!1){super(!1,n)}set(n,a,l,c){let u=n[a];if(!this._isShallow){const p=we(u);if(!Vt(l)&&!we(l)&&(u=rt(u),l=rt(l)),!$(n)&&bt(u)&&!bt(l))return p?!1:(u.value=l,!0)}const d=$(n)&&bn(a)?Number(a)<n.length:ot(n,a),o=Reflect.set(n,a,l,bt(n)?n:c);return n===rt(c)&&(d?de(l,u)&&re(n,"set",a,l):re(n,"add",a,l)),o}deleteProperty(n,a){const l=ot(n,a);n[a];const c=Reflect.deleteProperty(n,a);return c&&l&&re(n,"delete",a,void 0),c}has(n,a){const l=Reflect.has(n,a);return(!Jt(a)||!er.has(a))&&vt(n,"has",a),l}ownKeys(n){return vt(n,"iterate",$(n)?"length":Se),Reflect.ownKeys(n)}}class Ro extends ir{constructor(n=!1){super(!0,n)}set(n,a){return!0}deleteProperty(n,a){return!0}}const ko=new nr,Mo=new Ro,Do=new nr(!0);const an=e=>e,hi=e=>Reflect.getPrototypeOf(e);function Oo(e,n,a){return function(...l){const c=this.__v_raw,u=rt(c),d=Pe(u),o=e==="entries"||e===Symbol.iterator&&d,p=e==="keys"&&d,S=c[e](...l),v=a?an:n?ln:Bt;return!n&&vt(u,"iterate",p?on:Se),{next(){const{value:b,done:E}=S.next();return E?{value:b,done:E}:{value:o?[v(b[0]),v(b[1])]:v(b),done:E}},[Symbol.iterator](){return this}}}}function di(e){return function(...n){return e==="delete"?!1:e==="clear"?void 0:this}}function No(e,n){const a={get(c){const u=this.__v_raw,d=rt(u),o=rt(c);e||(de(c,o)&&vt(d,"get",c),vt(d,"get",o));const{has:p}=hi(d),S=n?an:e?ln:Bt;if(p.call(d,c))return S(u.get(c));if(p.call(d,o))return S(u.get(o));u!==d&&u.get(c)},get size(){const c=this.__v_raw;return!e&&vt(rt(c),"iterate",Se),Reflect.get(c,"size",c)},has(c){const u=this.__v_raw,d=rt(u),o=rt(c);return e||(de(c,o)&&vt(d,"has",c),vt(d,"has",o)),c===o?u.has(c):u.has(c)||u.has(o)},forEach(c,u){const d=this,o=d.__v_raw,p=rt(o),S=n?an:e?ln:Bt;return!e&&vt(p,"iterate",Se),o.forEach((v,b)=>c.call(u,S(v),S(b),d))}};return St(a,e?{add:di("add"),set:di("set"),delete:di("delete"),clear:di("clear")}:{add(c){!n&&!Vt(c)&&!we(c)&&(c=rt(c));const u=rt(this);return hi(u).has.call(u,c)||(u.add(c),re(u,"add",c,c)),this},set(c,u){!n&&!Vt(u)&&!we(u)&&(u=rt(u));const d=rt(this),{has:o,get:p}=hi(d);let S=o.call(d,c);S||(c=rt(c),S=o.call(d,c));const v=p.call(d,c);return d.set(c,u),S?de(u,v)&&re(d,"set",c,u):re(d,"add",c,u),this},delete(c){const u=rt(this),{has:d,get:o}=hi(u);let p=d.call(u,c);p||(c=rt(c),p=d.call(u,c)),o&&o.call(u,c);const S=u.delete(c);return p&&re(u,"delete",c,void 0),S},clear(){const c=rt(this),u=c.size!==0,d=c.clear();return u&&re(c,"clear",void 0,void 0),d}}),["keys","values","entries",Symbol.iterator].forEach(c=>{a[c]=Oo(c,e,n)}),a}function Tn(e,n){const a=No(e,n);return(l,c,u)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?l:Reflect.get(ot(a,c)&&c in l?a:l,c,u)}const Ho={get:Tn(!1,!1)},Go={get:Tn(!1,!0)},Vo={get:Tn(!0,!1)};const sr=new WeakMap,rr=new WeakMap,or=new WeakMap,Yo=new WeakMap;function jo(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ko(e){return e.__v_skip||!Object.isExtensible(e)?0:jo(yo(e))}function ki(e){return we(e)?e:Pn(e,!1,ko,Ho,sr)}function ar(e){return Pn(e,!1,Do,Go,rr)}function lr(e){return Pn(e,!0,Mo,Vo,or)}function Pn(e,n,a,l,c){if(!dt(e)||e.__v_raw&&!(n&&e.__v_isReactive))return e;const u=c.get(e);if(u)return u;const d=Ko(e);if(d===0)return e;const o=new Proxy(e,d===2?l:a);return c.set(e,o),o}function $e(e){return we(e)?$e(e.__v_raw):!!(e&&e.__v_isReactive)}function we(e){return!!(e&&e.__v_isReadonly)}function Vt(e){return!!(e&&e.__v_isShallow)}function Fn(e){return e?!!e.__v_raw:!1}function rt(e){const n=e&&e.__v_raw;return n?rt(n):e}function Wo(e){return!ot(e,"__v_skip")&&Object.isExtensible(e)&&Vs(e,"__v_skip",!0),e}const Bt=e=>dt(e)?ki(e):e,ln=e=>dt(e)?lr(e):e;function bt(e){return e?e.__v_isRef===!0:!1}function qo(e){return fr(e,!1)}function $o(e){return fr(e,!0)}function fr(e,n){return bt(e)?e:new Xo(e,n)}class Xo{constructor(n,a){this.dep=new Cn,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=a?n:rt(n),this._value=a?n:Bt(n),this.__v_isShallow=a}get value(){return this.dep.track(),this._value}set value(n){const a=this._rawValue,l=this.__v_isShallow||Vt(n)||we(n);n=l?n:rt(n),de(n,a)&&(this._rawValue=n,this._value=l?n:Bt(n),this.dep.trigger())}}function Fe(e){return bt(e)?e.value:e}const Zo={get:(e,n,a)=>n==="__v_raw"?e:Fe(Reflect.get(e,n,a)),set:(e,n,a,l)=>{const c=e[n];return bt(c)&&!bt(a)?(c.value=a,!0):Reflect.set(e,n,a,l)}};function cr(e){return $e(e)?e:new Proxy(e,Zo)}class Qo{constructor(n,a,l){this.fn=n,this.setter=a,this._value=void 0,this.dep=new Cn(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=ei-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!a,this.isSSR=l}notify(){if(this.flags|=16,!(this.flags&8)&&ut!==this)return $s(this,!0),!0}get value(){const n=this.dep.track();return Qs(this),n&&(n.version=this.dep.version),this._value}set value(n){this.setter&&this.setter(n)}}function Jo(e,n,a=!1){let l,c;return Z(e)?l=e:(l=e.get,c=e.set),new Qo(l,c,a)}const pi={},wi=new WeakMap;let ve;function ta(e,n=!1,a=ve){if(a){let l=wi.get(a);l||wi.set(a,l=[]),l.push(e)}}function ea(e,n,a=ft){const{immediate:l,deep:c,once:u,scheduler:d,augmentJob:o,call:p}=a,S=h=>c?h:Vt(h)||c===!1||c===0?oe(h,1):oe(h);let v,b,E,C,B=!1,H=!1;if(bt(e)?(b=()=>e.value,B=Vt(e)):$e(e)?(b=()=>S(e),B=!0):$(e)?(H=!0,B=e.some(h=>$e(h)||Vt(h)),b=()=>e.map(h=>{if(bt(h))return h.value;if($e(h))return S(h);if(Z(h))return p?p(h,2):h()})):Z(e)?n?b=p?()=>p(e,2):e:b=()=>{if(E){_e();try{E()}finally{ge()}}const h=ve;ve=v;try{return p?p(e,3,[C]):e(C)}finally{ve=h}}:b=Zt,n&&c){const h=b,_=c===!0?1/0:c;b=()=>oe(h(),_)}const t=Ao(),s=()=>{v.stop(),t&&t.active&&xn(t.effects,v)};if(u&&n){const h=n;n=(..._)=>{h(..._),s()}}let r=H?new Array(e.length).fill(pi):pi;const f=h=>{if(!(!(v.flags&1)||!v.dirty&&!h))if(n){const _=v.run();if(c||B||(H?_.some((g,x)=>de(g,r[x])):de(_,r))){E&&E();const g=ve;ve=v;try{const x=[_,r===pi?void 0:H&&r[0]===pi?[]:r,C];p?p(n,3,x):n(...x),r=_}finally{ve=g}}}else v.run()};return o&&o(f),v=new Ws(b),v.scheduler=d?()=>d(f,!1):f,C=h=>ta(h,!1,v),E=v.onStop=()=>{const h=wi.get(v);if(h){if(p)p(h,4);else for(const _ of h)_();wi.delete(v)}},n?l?f(!0):r=v.run():d?d(f.bind(null,!0),!0):v.run(),s.pause=v.pause.bind(v),s.resume=v.resume.bind(v),s.stop=s,s}function oe(e,n=1/0,a){if(n<=0||!dt(e)||e.__v_skip||(a=a||new Set,a.has(e)))return e;if(a.add(e),n--,bt(e))oe(e.value,n,a);else if($(e))for(let l=0;l<e.length;l++)oe(e[l],n,a);else if(Os(e)||Pe(e))e.forEach(l=>{oe(l,n,a)});else if(Gs(e)){for(const l in e)oe(e[l],n,a);for(const l of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,l)&&oe(e[l],n,a)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fi(e,n,a,l){try{return l?e(...l):e()}catch(c){Mi(c,n,a)}}function te(e,n,a,l){if(Z(e)){const c=fi(e,n,a,l);return c&&Ns(c)&&c.catch(u=>{Mi(u,n,a)}),c}if($(e)){const c=[];for(let u=0;u<e.length;u++)c.push(te(e[u],n,a,l));return c}}function Mi(e,n,a,l=!0){const c=n?n.vnode:null,{errorHandler:u,throwUnhandledErrorInProduction:d}=n&&n.appContext.config||ft;if(n){let o=n.parent;const p=n.proxy,S=`https://vuejs.org/error-reference/#runtime-${a}`;for(;o;){const v=o.ec;if(v){for(let b=0;b<v.length;b++)if(v[b](e,p,S)===!1)return}o=o.parent}if(u){_e(),fi(u,null,10,[e,p,S]),ge();return}}ia(e,a,c,l,d)}function ia(e,n,a,l=!0,c=!1){if(c)throw e;console.error(e)}const Ct=[];let $t=-1;const Ie=[];let ce=null,Ce=0;const ur=Promise.resolve();let Ui=null;function hr(e){const n=Ui||ur;return e?n.then(this?e.bind(this):e):n}function na(e){let n=$t+1,a=Ct.length;for(;n<a;){const l=n+a>>>1,c=Ct[l],u=ni(c);u<e||u===e&&c.flags&2?n=l+1:a=l}return n}function In(e){if(!(e.flags&1)){const n=ni(e),a=Ct[Ct.length-1];!a||!(e.flags&2)&&n>=ni(a)?Ct.push(e):Ct.splice(na(n),0,e),e.flags|=1,dr()}}function dr(){Ui||(Ui=ur.then(_r))}function sa(e){$(e)?Ie.push(...e):ce&&e.id===-1?ce.splice(Ce+1,0,e):e.flags&1||(Ie.push(e),e.flags|=1),dr()}function Yn(e,n,a=$t+1){for(;a<Ct.length;a++){const l=Ct[a];if(l&&l.flags&2){if(e&&l.id!==e.uid)continue;Ct.splice(a,1),a--,l.flags&4&&(l.flags&=-2),l(),l.flags&4||(l.flags&=-2)}}}function pr(e){if(Ie.length){const n=[...new Set(Ie)].sort((a,l)=>ni(a)-ni(l));if(Ie.length=0,ce){ce.push(...n);return}for(ce=n,Ce=0;Ce<ce.length;Ce++){const a=ce[Ce];a.flags&4&&(a.flags&=-2),a.flags&8||a(),a.flags&=-2}ce=null,Ce=0}}const ni=e=>e.id==null?e.flags&2?-1:1/0:e.id;function _r(e){try{for($t=0;$t<Ct.length;$t++){const n=Ct[$t];n&&!(n.flags&8)&&(n.flags&4&&(n.flags&=-2),fi(n,n.i,n.i?15:14),n.flags&4||(n.flags&=-2))}}finally{for(;$t<Ct.length;$t++){const n=Ct[$t];n&&(n.flags&=-2)}$t=-1,Ct.length=0,pr(),Ui=null,(Ct.length||Ie.length)&&_r()}}let Rt=null,gr=null;function Ei(e){const n=Rt;return Rt=e,gr=e&&e.type.__scopeId||null,n}function Ye(e,n=Rt,a){if(!n||e._n)return e;const l=(...c)=>{l._d&&es(-1);const u=Ei(n);let d;try{d=e(...c)}finally{Ei(u),l._d&&es(1)}return d};return l._n=!0,l._c=!0,l._d=!0,l}function Tt(e,n){if(Rt===null)return e;const a=Hi(Rt),l=e.dirs||(e.dirs=[]);for(let c=0;c<n.length;c++){let[u,d,o,p=ft]=n[c];u&&(Z(u)&&(u={mounted:u,updated:u}),u.deep&&oe(d),l.push({dir:u,instance:a,value:d,oldValue:void 0,arg:o,modifiers:p}))}return e}function ye(e,n,a,l){const c=e.dirs,u=n&&n.dirs;for(let d=0;d<c.length;d++){const o=c[d];u&&(o.oldValue=u[d].value);let p=o.dir[l];p&&(_e(),te(p,a,8,[e.el,o,e,n]),ge())}}const ra=Symbol("_vte"),oa=e=>e.__isTeleport;function Ln(e,n){e.shapeFlag&6&&e.component?(e.transition=n,Ln(e.component.subTree,n)):e.shapeFlag&128?(e.ssContent.transition=n.clone(e.ssContent),e.ssFallback.transition=n.clone(e.ssFallback)):e.transition=n}/*! #__NO_SIDE_EFFECTS__ */function yr(e,n){return Z(e)?St({name:e.name},n,{setup:e}):e}function mr(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function Bi(e,n,a,l,c=!1){if($(e)){e.forEach((B,H)=>Bi(B,n&&($(n)?n[H]:n),a,l,c));return}if(Xe(l)&&!c){l.shapeFlag&512&&l.type.__asyncResolved&&l.component.subTree.component&&Bi(e,n,a,l.component.subTree);return}const u=l.shapeFlag&4?Hi(l.component):l.el,d=c?null:u,{i:o,r:p}=e,S=n&&n.r,v=o.refs===ft?o.refs={}:o.refs,b=o.setupState,E=rt(b),C=b===ft?()=>!1:B=>ot(E,B);if(S!=null&&S!==p&&(gt(S)?(v[S]=null,C(S)&&(b[S]=null)):bt(S)&&(S.value=null)),Z(p))fi(p,o,12,[d,v]);else{const B=gt(p),H=bt(p);if(B||H){const t=()=>{if(e.f){const s=B?C(p)?b[p]:v[p]:p.value;c?$(s)&&xn(s,u):$(s)?s.includes(u)||s.push(u):B?(v[p]=[u],C(p)&&(b[p]=v[p])):(p.value=[u],e.k&&(v[e.k]=p.value))}else B?(v[p]=d,C(p)&&(b[p]=d)):H&&(p.value=d,e.k&&(v[e.k]=d))};d?(t.id=-1,Lt(t,a)):t()}}}Ri().requestIdleCallback;Ri().cancelIdleCallback;const Xe=e=>!!e.type.__asyncLoader,vr=e=>e.type.__isKeepAlive;function aa(e,n){xr(e,"a",n)}function la(e,n){xr(e,"da",n)}function xr(e,n,a=xt){const l=e.__wdc||(e.__wdc=()=>{let c=a;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(Di(n,l,a),a){let c=a.parent;for(;c&&c.parent;)vr(c.parent.vnode)&&fa(l,n,a,c),c=c.parent}}function fa(e,n,a,l){const c=Di(n,e,l,!0);br(()=>{xn(l[n],c)},a)}function Di(e,n,a=xt,l=!1){if(a){const c=a[e]||(a[e]=[]),u=n.__weh||(n.__weh=(...d)=>{_e();const o=ci(a),p=te(n,a,e,d);return o(),ge(),p});return l?c.unshift(u):c.push(u),u}}const le=e=>(n,a=xt)=>{(!ri||e==="sp")&&Di(e,(...l)=>n(...l),a)},ca=le("bm"),ua=le("m"),ha=le("bu"),da=le("u"),pa=le("bum"),br=le("um"),_a=le("sp"),ga=le("rtg"),ya=le("rtc");function ma(e,n=xt){Di("ec",e,n)}const va="components";function jn(e,n){return ba(va,e,!0,n)||e}const xa=Symbol.for("v-ndc");function ba(e,n,a=!0,l=!1){const c=Rt||xt;if(c){const u=c.type;{const o=ll(u,!1);if(o&&(o===n||o===Nt(n)||o===zi(Nt(n))))return u}const d=Kn(c[e]||u[e],n)||Kn(c.appContext[e],n);return!d&&l?u:d}}function Kn(e,n){return e&&(e[n]||e[Nt(n)]||e[zi(Nt(n))])}const fn=e=>e?Vr(e)?Hi(e):fn(e.parent):null,Ze=St(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>fn(e.parent),$root:e=>fn(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>wr(e),$forceUpdate:e=>e.f||(e.f=()=>{In(e.update)}),$nextTick:e=>e.n||(e.n=hr.bind(e.proxy)),$watch:e=>Ga.bind(e)}),qi=(e,n)=>e!==ft&&!e.__isScriptSetup&&ot(e,n),Sa={get({_:e},n){if(n==="__v_skip")return!0;const{ctx:a,setupState:l,data:c,props:u,accessCache:d,type:o,appContext:p}=e;let S;if(n[0]!=="$"){const C=d[n];if(C!==void 0)switch(C){case 1:return l[n];case 2:return c[n];case 4:return a[n];case 3:return u[n]}else{if(qi(l,n))return d[n]=1,l[n];if(c!==ft&&ot(c,n))return d[n]=2,c[n];if((S=e.propsOptions[0])&&ot(S,n))return d[n]=3,u[n];if(a!==ft&&ot(a,n))return d[n]=4,a[n];cn&&(d[n]=0)}}const v=Ze[n];let b,E;if(v)return n==="$attrs"&&vt(e.attrs,"get",""),v(e);if((b=o.__cssModules)&&(b=b[n]))return b;if(a!==ft&&ot(a,n))return d[n]=4,a[n];if(E=p.config.globalProperties,ot(E,n))return E[n]},set({_:e},n,a){const{data:l,setupState:c,ctx:u}=e;return qi(c,n)?(c[n]=a,!0):l!==ft&&ot(l,n)?(l[n]=a,!0):ot(e.props,n)||n[0]==="$"&&n.slice(1)in e?!1:(u[n]=a,!0)},has({_:{data:e,setupState:n,accessCache:a,ctx:l,appContext:c,propsOptions:u}},d){let o;return!!a[d]||e!==ft&&ot(e,d)||qi(n,d)||(o=u[0])&&ot(o,d)||ot(l,d)||ot(Ze,d)||ot(c.config.globalProperties,d)},defineProperty(e,n,a){return a.get!=null?e._.accessCache[n]=0:ot(a,"value")&&this.set(e,n,a.value,null),Reflect.defineProperty(e,n,a)}};function Wn(e){return $(e)?e.reduce((n,a)=>(n[a]=null,n),{}):e}let cn=!0;function wa(e){const n=wr(e),a=e.proxy,l=e.ctx;cn=!1,n.beforeCreate&&qn(n.beforeCreate,e,"bc");const{data:c,computed:u,methods:d,watch:o,provide:p,inject:S,created:v,beforeMount:b,mounted:E,beforeUpdate:C,updated:B,activated:H,deactivated:t,beforeDestroy:s,beforeUnmount:r,destroyed:f,unmounted:h,render:_,renderTracked:g,renderTriggered:x,errorCaptured:w,serverPrefetch:A,expose:T,inheritAttrs:z,components:j,directives:k,filters:it}=n;if(S&&Ua(S,l,null),d)for(const tt in d){const J=d[tt];Z(J)&&(l[tt]=J.bind(a))}if(c){const tt=c.call(a,a);dt(tt)&&(e.data=ki(tt))}if(cn=!0,u)for(const tt in u){const J=u[tt],pt=Z(J)?J.bind(a,a):Z(J.get)?J.get.bind(a,a):Zt,mt=!Z(J)&&Z(J.set)?J.set.bind(a):Zt,wt=Ht({get:pt,set:mt});Object.defineProperty(l,tt,{enumerable:!0,configurable:!0,get:()=>wt.value,set:yt=>wt.value=yt})}if(o)for(const tt in o)Sr(o[tt],l,a,tt);if(p){const tt=Z(p)?p.call(a):p;Reflect.ownKeys(tt).forEach(J=>{yi(J,tt[J])})}v&&qn(v,e,"c");function ht(tt,J){$(J)?J.forEach(pt=>tt(pt.bind(a))):J&&tt(J.bind(a))}if(ht(ca,b),ht(ua,E),ht(ha,C),ht(da,B),ht(aa,H),ht(la,t),ht(ma,w),ht(ya,g),ht(ga,x),ht(pa,r),ht(br,h),ht(_a,A),$(T))if(T.length){const tt=e.exposed||(e.exposed={});T.forEach(J=>{Object.defineProperty(tt,J,{get:()=>a[J],set:pt=>a[J]=pt})})}else e.exposed||(e.exposed={});_&&e.render===Zt&&(e.render=_),z!=null&&(e.inheritAttrs=z),j&&(e.components=j),k&&(e.directives=k),A&&mr(e)}function Ua(e,n,a=Zt){$(e)&&(e=un(e));for(const l in e){const c=e[l];let u;dt(c)?"default"in c?u=ae(c.from||l,c.default,!0):u=ae(c.from||l):u=ae(c),bt(u)?Object.defineProperty(n,l,{enumerable:!0,configurable:!0,get:()=>u.value,set:d=>u.value=d}):n[l]=u}}function qn(e,n,a){te($(e)?e.map(l=>l.bind(n.proxy)):e.bind(n.proxy),n,a)}function Sr(e,n,a,l){let c=l.includes(".")?Mr(a,l):()=>a[l];if(gt(e)){const u=n[e];Z(u)&&mi(c,u)}else if(Z(e))mi(c,e.bind(a));else if(dt(e))if($(e))e.forEach(u=>Sr(u,n,a,l));else{const u=Z(e.handler)?e.handler.bind(a):n[e.handler];Z(u)&&mi(c,u,e)}}function wr(e){const n=e.type,{mixins:a,extends:l}=n,{mixins:c,optionsCache:u,config:{optionMergeStrategies:d}}=e.appContext,o=u.get(n);let p;return o?p=o:!c.length&&!a&&!l?p=n:(p={},c.length&&c.forEach(S=>Ci(p,S,d,!0)),Ci(p,n,d)),dt(n)&&u.set(n,p),p}function Ci(e,n,a,l=!1){const{mixins:c,extends:u}=n;u&&Ci(e,u,a,!0),c&&c.forEach(d=>Ci(e,d,a,!0));for(const d in n)if(!(l&&d==="expose")){const o=Ea[d]||a&&a[d];e[d]=o?o(e[d],n[d]):n[d]}return e}const Ea={data:$n,props:Xn,emits:Xn,methods:je,computed:je,beforeCreate:Et,created:Et,beforeMount:Et,mounted:Et,beforeUpdate:Et,updated:Et,beforeDestroy:Et,beforeUnmount:Et,destroyed:Et,unmounted:Et,activated:Et,deactivated:Et,errorCaptured:Et,serverPrefetch:Et,components:je,directives:je,watch:Ca,provide:$n,inject:Ba};function $n(e,n){return n?e?function(){return St(Z(e)?e.call(this,this):e,Z(n)?n.call(this,this):n)}:n:e}function Ba(e,n){return je(un(e),un(n))}function un(e){if($(e)){const n={};for(let a=0;a<e.length;a++)n[e[a]]=e[a];return n}return e}function Et(e,n){return e?[...new Set([].concat(e,n))]:n}function je(e,n){return e?St(Object.create(null),e,n):n}function Xn(e,n){return e?$(e)&&$(n)?[...new Set([...e,...n])]:St(Object.create(null),Wn(e),Wn(n??{})):n}function Ca(e,n){if(!e)return n;if(!n)return e;const a=St(Object.create(null),e);for(const l in n)a[l]=Et(e[l],n[l]);return a}function Ur(){return{app:null,config:{isNativeTag:_o,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Aa=0;function Ta(e,n){return function(l,c=null){Z(l)||(l=St({},l)),c!=null&&!dt(c)&&(c=null);const u=Ur(),d=new WeakSet,o=[];let p=!1;const S=u.app={_uid:Aa++,_component:l,_props:c,_container:null,_context:u,_instance:null,version:cl,get config(){return u.config},set config(v){},use(v,...b){return d.has(v)||(v&&Z(v.install)?(d.add(v),v.install(S,...b)):Z(v)&&(d.add(v),v(S,...b))),S},mixin(v){return u.mixins.includes(v)||u.mixins.push(v),S},component(v,b){return b?(u.components[v]=b,S):u.components[v]},directive(v,b){return b?(u.directives[v]=b,S):u.directives[v]},mount(v,b,E){if(!p){const C=S._ceVNode||_t(l,c);return C.appContext=u,E===!0?E="svg":E===!1&&(E=void 0),e(C,v,E),p=!0,S._container=v,v.__vue_app__=S,Hi(C.component)}},onUnmount(v){o.push(v)},unmount(){p&&(te(o,S._instance,16),e(null,S._container),delete S._container.__vue_app__)},provide(v,b){return u.provides[v]=b,S},runWithContext(v){const b=Le;Le=S;try{return v()}finally{Le=b}}};return S}}let Le=null;function yi(e,n){if(xt){let a=xt.provides;const l=xt.parent&&xt.parent.provides;l===a&&(a=xt.provides=Object.create(l)),a[e]=n}}function ae(e,n,a=!1){const l=xt||Rt;if(l||Le){const c=Le?Le._context.provides:l?l.parent==null?l.vnode.appContext&&l.vnode.appContext.provides:l.parent.provides:void 0;if(c&&e in c)return c[e];if(arguments.length>1)return a&&Z(n)?n.call(l&&l.proxy):n}}const Er={},Br=()=>Object.create(Er),Cr=e=>Object.getPrototypeOf(e)===Er;function Pa(e,n,a,l=!1){const c={},u=Br();e.propsDefaults=Object.create(null),Ar(e,n,c,u);for(const d in e.propsOptions[0])d in c||(c[d]=void 0);a?e.props=l?c:ar(c):e.type.props?e.props=c:e.props=u,e.attrs=u}function Fa(e,n,a,l){const{props:c,attrs:u,vnode:{patchFlag:d}}=e,o=rt(c),[p]=e.propsOptions;let S=!1;if((l||d>0)&&!(d&16)){if(d&8){const v=e.vnode.dynamicProps;for(let b=0;b<v.length;b++){let E=v[b];if(Oi(e.emitsOptions,E))continue;const C=n[E];if(p)if(ot(u,E))C!==u[E]&&(u[E]=C,S=!0);else{const B=Nt(E);c[B]=hn(p,o,B,C,e,!1)}else C!==u[E]&&(u[E]=C,S=!0)}}}else{Ar(e,n,c,u)&&(S=!0);let v;for(const b in o)(!n||!ot(n,b)&&((v=Ee(b))===b||!ot(n,v)))&&(p?a&&(a[b]!==void 0||a[v]!==void 0)&&(c[b]=hn(p,o,b,void 0,e,!0)):delete c[b]);if(u!==o)for(const b in u)(!n||!ot(n,b))&&(delete u[b],S=!0)}S&&re(e.attrs,"set","")}function Ar(e,n,a,l){const[c,u]=e.propsOptions;let d=!1,o;if(n)for(let p in n){if(Ke(p))continue;const S=n[p];let v;c&&ot(c,v=Nt(p))?!u||!u.includes(v)?a[v]=S:(o||(o={}))[v]=S:Oi(e.emitsOptions,p)||(!(p in l)||S!==l[p])&&(l[p]=S,d=!0)}if(u){const p=rt(a),S=o||ft;for(let v=0;v<u.length;v++){const b=u[v];a[b]=hn(c,p,b,S[b],e,!ot(S,b))}}return d}function hn(e,n,a,l,c,u){const d=e[a];if(d!=null){const o=ot(d,"default");if(o&&l===void 0){const p=d.default;if(d.type!==Function&&!d.skipFactory&&Z(p)){const{propsDefaults:S}=c;if(a in S)l=S[a];else{const v=ci(c);l=S[a]=p.call(null,n),v()}}else l=p;c.ce&&c.ce._setProp(a,l)}d[0]&&(u&&!o?l=!1:d[1]&&(l===""||l===Ee(a))&&(l=!0))}return l}const Ia=new WeakMap;function Tr(e,n,a=!1){const l=a?Ia:n.propsCache,c=l.get(e);if(c)return c;const u=e.props,d={},o=[];let p=!1;if(!Z(e)){const v=b=>{p=!0;const[E,C]=Tr(b,n,!0);St(d,E),C&&o.push(...C)};!a&&n.mixins.length&&n.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}if(!u&&!p)return dt(e)&&l.set(e,Te),Te;if($(u))for(let v=0;v<u.length;v++){const b=Nt(u[v]);Zn(b)&&(d[b]=ft)}else if(u)for(const v in u){const b=Nt(v);if(Zn(b)){const E=u[v],C=d[b]=$(E)||Z(E)?{type:E}:St({},E),B=C.type;let H=!1,t=!0;if($(B))for(let s=0;s<B.length;++s){const r=B[s],f=Z(r)&&r.name;if(f==="Boolean"){H=!0;break}else f==="String"&&(t=!1)}else H=Z(B)&&B.name==="Boolean";C[0]=H,C[1]=t,(H||ot(C,"default"))&&o.push(b)}}const S=[d,o];return dt(e)&&l.set(e,S),S}function Zn(e){return e[0]!=="$"&&!Ke(e)}const Pr=e=>e[0]==="_"||e==="$stable",zn=e=>$(e)?e.map(Xt):[Xt(e)],La=(e,n,a)=>{if(n._n)return n;const l=Ye((...c)=>zn(n(...c)),a);return l._c=!1,l},Fr=(e,n,a)=>{const l=e._ctx;for(const c in e){if(Pr(c))continue;const u=e[c];if(Z(u))n[c]=La(c,u,l);else if(u!=null){const d=zn(u);n[c]=()=>d}}},Ir=(e,n)=>{const a=zn(n);e.slots.default=()=>a},Lr=(e,n,a)=>{for(const l in n)(a||l!=="_")&&(e[l]=n[l])},za=(e,n,a)=>{const l=e.slots=Br();if(e.vnode.shapeFlag&32){const c=n._;c?(Lr(l,n,a),a&&Vs(l,"_",c,!0)):Fr(n,l)}else n&&Ir(e,n)},Ra=(e,n,a)=>{const{vnode:l,slots:c}=e;let u=!0,d=ft;if(l.shapeFlag&32){const o=n._;o?a&&o===1?u=!1:Lr(c,n,a):(u=!n.$stable,Fr(n,c)),d=n}else n&&(Ir(e,n),d={default:1});if(u)for(const o in c)!Pr(o)&&d[o]==null&&delete c[o]},Lt=$a;function ka(e){return Ma(e)}function Ma(e,n){const a=Ri();a.__VUE__=!0;const{insert:l,remove:c,patchProp:u,createElement:d,createText:o,createComment:p,setText:S,setElementText:v,parentNode:b,nextSibling:E,setScopeId:C=Zt,insertStaticContent:B}=e,H=(y,m,U,P=null,L=null,I=null,O=void 0,D=null,M=!!m.dynamicChildren)=>{if(y===m)return;y&&!He(y,m)&&(P=F(y),yt(y,L,I,!0),y=null),m.patchFlag===-2&&(M=!1,m.dynamicChildren=null);const{type:R,ref:q,shapeFlag:G}=m;switch(R){case Ni:t(y,m,U,P);break;case Ue:s(y,m,U,P);break;case vi:y==null&&r(m,U,P,O);break;case se:j(y,m,U,P,L,I,O,D,M);break;default:G&1?_(y,m,U,P,L,I,O,D,M):G&6?k(y,m,U,P,L,I,O,D,M):(G&64||G&128)&&R.process(y,m,U,P,L,I,O,D,M,K)}q!=null&&L&&Bi(q,y&&y.ref,I,m||y,!m)},t=(y,m,U,P)=>{if(y==null)l(m.el=o(m.children),U,P);else{const L=m.el=y.el;m.children!==y.children&&S(L,m.children)}},s=(y,m,U,P)=>{y==null?l(m.el=p(m.children||""),U,P):m.el=y.el},r=(y,m,U,P)=>{[y.el,y.anchor]=B(y.children,m,U,P,y.el,y.anchor)},f=({el:y,anchor:m},U,P)=>{let L;for(;y&&y!==m;)L=E(y),l(y,U,P),y=L;l(m,U,P)},h=({el:y,anchor:m})=>{let U;for(;y&&y!==m;)U=E(y),c(y),y=U;c(m)},_=(y,m,U,P,L,I,O,D,M)=>{m.type==="svg"?O="svg":m.type==="math"&&(O="mathml"),y==null?g(m,U,P,L,I,O,D,M):A(y,m,L,I,O,D,M)},g=(y,m,U,P,L,I,O,D)=>{let M,R;const{props:q,shapeFlag:G,transition:W,dirs:X}=y;if(M=y.el=d(y.type,I,q&&q.is,q),G&8?v(M,y.children):G&16&&w(y.children,M,null,P,L,$i(y,I),O,D),X&&ye(y,null,P,"created"),x(M,y,y.scopeId,O,P),q){for(const ct in q)ct!=="value"&&!Ke(ct)&&u(M,ct,null,q[ct],I,P);"value"in q&&u(M,"value",null,q.value,I),(R=q.onVnodeBeforeMount)&&qt(R,P,y)}X&&ye(y,null,P,"beforeMount");const et=Da(L,W);et&&W.beforeEnter(M),l(M,m,U),((R=q&&q.onVnodeMounted)||et||X)&&Lt(()=>{R&&qt(R,P,y),et&&W.enter(M),X&&ye(y,null,P,"mounted")},L)},x=(y,m,U,P,L)=>{if(U&&C(y,U),P)for(let I=0;I<P.length;I++)C(y,P[I]);if(L){let I=L.subTree;if(m===I||Or(I.type)&&(I.ssContent===m||I.ssFallback===m)){const O=L.vnode;x(y,O,O.scopeId,O.slotScopeIds,L.parent)}}},w=(y,m,U,P,L,I,O,D,M=0)=>{for(let R=M;R<y.length;R++){const q=y[R]=D?ue(y[R]):Xt(y[R]);H(null,q,m,U,P,L,I,O,D)}},A=(y,m,U,P,L,I,O)=>{const D=m.el=y.el;let{patchFlag:M,dynamicChildren:R,dirs:q}=m;M|=y.patchFlag&16;const G=y.props||ft,W=m.props||ft;let X;if(U&&me(U,!1),(X=W.onVnodeBeforeUpdate)&&qt(X,U,m,y),q&&ye(m,y,U,"beforeUpdate"),U&&me(U,!0),(G.innerHTML&&W.innerHTML==null||G.textContent&&W.textContent==null)&&v(D,""),R?T(y.dynamicChildren,R,D,U,P,$i(m,L),I):O||J(y,m,D,null,U,P,$i(m,L),I,!1),M>0){if(M&16)z(D,G,W,U,L);else if(M&2&&G.class!==W.class&&u(D,"class",null,W.class,L),M&4&&u(D,"style",G.style,W.style,L),M&8){const et=m.dynamicProps;for(let ct=0;ct<et.length;ct++){const at=et[ct],Ft=G[at],At=W[at];(At!==Ft||at==="value")&&u(D,at,Ft,At,L,U)}}M&1&&y.children!==m.children&&v(D,m.children)}else!O&&R==null&&z(D,G,W,U,L);((X=W.onVnodeUpdated)||q)&&Lt(()=>{X&&qt(X,U,m,y),q&&ye(m,y,U,"updated")},P)},T=(y,m,U,P,L,I,O)=>{for(let D=0;D<m.length;D++){const M=y[D],R=m[D],q=M.el&&(M.type===se||!He(M,R)||M.shapeFlag&70)?b(M.el):U;H(M,R,q,null,P,L,I,O,!0)}},z=(y,m,U,P,L)=>{if(m!==U){if(m!==ft)for(const I in m)!Ke(I)&&!(I in U)&&u(y,I,m[I],null,L,P);for(const I in U){if(Ke(I))continue;const O=U[I],D=m[I];O!==D&&I!=="value"&&u(y,I,D,O,L,P)}"value"in U&&u(y,"value",m.value,U.value,L)}},j=(y,m,U,P,L,I,O,D,M)=>{const R=m.el=y?y.el:o(""),q=m.anchor=y?y.anchor:o("");let{patchFlag:G,dynamicChildren:W,slotScopeIds:X}=m;X&&(D=D?D.concat(X):X),y==null?(l(R,U,P),l(q,U,P),w(m.children||[],U,q,L,I,O,D,M)):G>0&&G&64&&W&&y.dynamicChildren?(T(y.dynamicChildren,W,U,L,I,O,D),(m.key!=null||L&&m===L.subTree)&&zr(y,m,!0)):J(y,m,U,q,L,I,O,D,M)},k=(y,m,U,P,L,I,O,D,M)=>{m.slotScopeIds=D,y==null?m.shapeFlag&512?L.ctx.activate(m,U,P,O,M):it(m,U,P,L,I,O,M):nt(y,m,M)},it=(y,m,U,P,L,I,O)=>{const D=y.component=nl(y,P,L);if(vr(y)&&(D.ctx.renderer=K),sl(D,!1,O),D.asyncDep){if(L&&L.registerDep(D,ht,O),!y.el){const M=D.subTree=_t(Ue);s(null,M,m,U)}}else ht(D,y,m,U,L,I,O)},nt=(y,m,U)=>{const P=m.component=y.component;if(Wa(y,m,U))if(P.asyncDep&&!P.asyncResolved){tt(P,m,U);return}else P.next=m,P.update();else m.el=y.el,P.vnode=m},ht=(y,m,U,P,L,I,O)=>{const D=()=>{if(y.isMounted){let{next:G,bu:W,u:X,parent:et,vnode:ct}=y;{const Kt=Rr(y);if(Kt){G&&(G.el=ct.el,tt(y,G,O)),Kt.asyncDep.then(()=>{y.isUnmounted||D()});return}}let at=G,Ft;me(y,!1),G?(G.el=ct.el,tt(y,G,O)):G=ct,W&&gi(W),(Ft=G.props&&G.props.onVnodeBeforeUpdate)&&qt(Ft,et,G,ct),me(y,!0);const At=Jn(y),jt=y.subTree;y.subTree=At,H(jt,At,b(jt.el),F(jt),y,L,I),G.el=At.el,at===null&&qa(y,At.el),X&&Lt(X,L),(Ft=G.props&&G.props.onVnodeUpdated)&&Lt(()=>qt(Ft,et,G,ct),L)}else{let G;const{el:W,props:X}=m,{bm:et,m:ct,parent:at,root:Ft,type:At}=y,jt=Xe(m);me(y,!1),et&&gi(et),!jt&&(G=X&&X.onVnodeBeforeMount)&&qt(G,at,m),me(y,!0);{Ft.ce&&Ft.ce._injectChildStyle(At);const Kt=y.subTree=Jn(y);H(null,Kt,U,P,y,L,I),m.el=Kt.el}if(ct&&Lt(ct,L),!jt&&(G=X&&X.onVnodeMounted)){const Kt=m;Lt(()=>qt(G,at,Kt),L)}(m.shapeFlag&256||at&&Xe(at.vnode)&&at.vnode.shapeFlag&256)&&y.a&&Lt(y.a,L),y.isMounted=!0,m=U=P=null}};y.scope.on();const M=y.effect=new Ws(D);y.scope.off();const R=y.update=M.run.bind(M),q=y.job=M.runIfDirty.bind(M);q.i=y,q.id=y.uid,M.scheduler=()=>In(q),me(y,!0),R()},tt=(y,m,U)=>{m.component=y;const P=y.vnode.props;y.vnode=m,y.next=null,Fa(y,m.props,P,U),Ra(y,m.children,U),_e(),Yn(y),ge()},J=(y,m,U,P,L,I,O,D,M=!1)=>{const R=y&&y.children,q=y?y.shapeFlag:0,G=m.children,{patchFlag:W,shapeFlag:X}=m;if(W>0){if(W&128){mt(R,G,U,P,L,I,O,D,M);return}else if(W&256){pt(R,G,U,P,L,I,O,D,M);return}}X&8?(q&16&&Ot(R,L,I),G!==R&&v(U,G)):q&16?X&16?mt(R,G,U,P,L,I,O,D,M):Ot(R,L,I,!0):(q&8&&v(U,""),X&16&&w(G,U,P,L,I,O,D,M))},pt=(y,m,U,P,L,I,O,D,M)=>{y=y||Te,m=m||Te;const R=y.length,q=m.length,G=Math.min(R,q);let W;for(W=0;W<G;W++){const X=m[W]=M?ue(m[W]):Xt(m[W]);H(y[W],X,U,null,L,I,O,D,M)}R>q?Ot(y,L,I,!0,!1,G):w(m,U,P,L,I,O,D,M,G)},mt=(y,m,U,P,L,I,O,D,M)=>{let R=0;const q=m.length;let G=y.length-1,W=q-1;for(;R<=G&&R<=W;){const X=y[R],et=m[R]=M?ue(m[R]):Xt(m[R]);if(He(X,et))H(X,et,U,null,L,I,O,D,M);else break;R++}for(;R<=G&&R<=W;){const X=y[G],et=m[W]=M?ue(m[W]):Xt(m[W]);if(He(X,et))H(X,et,U,null,L,I,O,D,M);else break;G--,W--}if(R>G){if(R<=W){const X=W+1,et=X<q?m[X].el:P;for(;R<=W;)H(null,m[R]=M?ue(m[R]):Xt(m[R]),U,et,L,I,O,D,M),R++}}else if(R>W)for(;R<=G;)yt(y[R],L,I,!0),R++;else{const X=R,et=R,ct=new Map;for(R=et;R<=W;R++){const It=m[R]=M?ue(m[R]):Xt(m[R]);It.key!=null&&ct.set(It.key,R)}let at,Ft=0;const At=W-et+1;let jt=!1,Kt=0;const Oe=new Array(At);for(R=0;R<At;R++)Oe[R]=0;for(R=X;R<=G;R++){const It=y[R];if(Ft>=At){yt(It,L,I,!0);continue}let Wt;if(It.key!=null)Wt=ct.get(It.key);else for(at=et;at<=W;at++)if(Oe[at-et]===0&&He(It,m[at])){Wt=at;break}Wt===void 0?yt(It,L,I,!0):(Oe[Wt-et]=R+1,Wt>=Kt?Kt=Wt:jt=!0,H(It,m[Wt],U,null,L,I,O,D,M),Ft++)}const Dn=jt?Oa(Oe):Te;for(at=Dn.length-1,R=At-1;R>=0;R--){const It=et+R,Wt=m[It],On=It+1<q?m[It+1].el:P;Oe[R]===0?H(null,Wt,U,On,L,I,O,D,M):jt&&(at<0||R!==Dn[at]?wt(Wt,U,On,2):at--)}}},wt=(y,m,U,P,L=null)=>{const{el:I,type:O,transition:D,children:M,shapeFlag:R}=y;if(R&6){wt(y.component.subTree,m,U,P);return}if(R&128){y.suspense.move(m,U,P);return}if(R&64){O.move(y,m,U,K);return}if(O===se){l(I,m,U);for(let G=0;G<M.length;G++)wt(M[G],m,U,P);l(y.anchor,m,U);return}if(O===vi){f(y,m,U);return}if(P!==2&&R&1&&D)if(P===0)D.beforeEnter(I),l(I,m,U),Lt(()=>D.enter(I),L);else{const{leave:G,delayLeave:W,afterLeave:X}=D,et=()=>l(I,m,U),ct=()=>{G(I,()=>{et(),X&&X()})};W?W(I,et,ct):ct()}else l(I,m,U)},yt=(y,m,U,P=!1,L=!1)=>{const{type:I,props:O,ref:D,children:M,dynamicChildren:R,shapeFlag:q,patchFlag:G,dirs:W,cacheIndex:X}=y;if(G===-2&&(L=!1),D!=null&&Bi(D,null,U,y,!0),X!=null&&(m.renderCache[X]=void 0),q&256){m.ctx.deactivate(y);return}const et=q&1&&W,ct=!Xe(y);let at;if(ct&&(at=O&&O.onVnodeBeforeUnmount)&&qt(at,m,y),q&6)Q(y.component,U,P);else{if(q&128){y.suspense.unmount(U,P);return}et&&ye(y,null,m,"beforeUnmount"),q&64?y.type.remove(y,m,U,K,P):R&&!R.hasOnce&&(I!==se||G>0&&G&64)?Ot(R,m,U,!1,!0):(I===se&&G&384||!L&&q&16)&&Ot(M,m,U),P&&Ut(y)}(ct&&(at=O&&O.onVnodeUnmounted)||et)&&Lt(()=>{at&&qt(at,m,y),et&&ye(y,null,m,"unmounted")},U)},Ut=y=>{const{type:m,el:U,anchor:P,transition:L}=y;if(m===se){Dt(U,P);return}if(m===vi){h(y);return}const I=()=>{c(U),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(y.shapeFlag&1&&L&&!L.persisted){const{leave:O,delayLeave:D}=L,M=()=>O(U,I);D?D(y.el,I,M):M()}else I()},Dt=(y,m)=>{let U;for(;y!==m;)U=E(y),c(y),y=U;c(m)},Q=(y,m,U)=>{const{bum:P,scope:L,job:I,subTree:O,um:D,m:M,a:R}=y;Qn(M),Qn(R),P&&gi(P),L.stop(),I&&(I.flags|=8,yt(O,y,m,U)),D&&Lt(D,m),Lt(()=>{y.isUnmounted=!0},m),m&&m.pendingBranch&&!m.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===m.pendingId&&(m.deps--,m.deps===0&&m.resolve())},Ot=(y,m,U,P=!1,L=!1,I=0)=>{for(let O=I;O<y.length;O++)yt(y[O],m,U,P,L)},F=y=>{if(y.shapeFlag&6)return F(y.component.subTree);if(y.shapeFlag&128)return y.suspense.next();const m=E(y.anchor||y.el),U=m&&m[ra];return U?E(U):m};let V=!1;const N=(y,m,U)=>{y==null?m._vnode&&yt(m._vnode,null,null,!0):H(m._vnode||null,y,m,null,null,null,U),m._vnode=y,V||(V=!0,Yn(),pr(),V=!1)},K={p:H,um:yt,m:wt,r:Ut,mt:it,mc:w,pc:J,pbc:T,n:F,o:e};return{render:N,hydrate:void 0,createApp:Ta(N)}}function $i({type:e,props:n},a){return a==="svg"&&e==="foreignObject"||a==="mathml"&&e==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:a}function me({effect:e,job:n},a){a?(e.flags|=32,n.flags|=4):(e.flags&=-33,n.flags&=-5)}function Da(e,n){return(!e||e&&!e.pendingBranch)&&n&&!n.persisted}function zr(e,n,a=!1){const l=e.children,c=n.children;if($(l)&&$(c))for(let u=0;u<l.length;u++){const d=l[u];let o=c[u];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=c[u]=ue(c[u]),o.el=d.el),!a&&o.patchFlag!==-2&&zr(d,o)),o.type===Ni&&(o.el=d.el)}}function Oa(e){const n=e.slice(),a=[0];let l,c,u,d,o;const p=e.length;for(l=0;l<p;l++){const S=e[l];if(S!==0){if(c=a[a.length-1],e[c]<S){n[l]=c,a.push(l);continue}for(u=0,d=a.length-1;u<d;)o=u+d>>1,e[a[o]]<S?u=o+1:d=o;S<e[a[u]]&&(u>0&&(n[l]=a[u-1]),a[u]=l)}}for(u=a.length,d=a[u-1];u-- >0;)a[u]=d,d=n[d];return a}function Rr(e){const n=e.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:Rr(n)}function Qn(e){if(e)for(let n=0;n<e.length;n++)e[n].flags|=8}const Na=Symbol.for("v-scx"),Ha=()=>ae(Na);function mi(e,n,a){return kr(e,n,a)}function kr(e,n,a=ft){const{immediate:l,deep:c,flush:u,once:d}=a,o=St({},a),p=n&&l||!n&&u!=="post";let S;if(ri){if(u==="sync"){const C=Ha();S=C.__watcherHandles||(C.__watcherHandles=[])}else if(!p){const C=()=>{};return C.stop=Zt,C.resume=Zt,C.pause=Zt,C}}const v=xt;o.call=(C,B,H)=>te(C,v,B,H);let b=!1;u==="post"?o.scheduler=C=>{Lt(C,v&&v.suspense)}:u!=="sync"&&(b=!0,o.scheduler=(C,B)=>{B?C():In(C)}),o.augmentJob=C=>{n&&(C.flags|=4),b&&(C.flags|=2,v&&(C.id=v.uid,C.i=v))};const E=ea(e,n,o);return ri&&(S?S.push(E):p&&E()),E}function Ga(e,n,a){const l=this.proxy,c=gt(e)?e.includes(".")?Mr(l,e):()=>l[e]:e.bind(l,l);let u;Z(n)?u=n:(u=n.handler,a=n);const d=ci(this),o=kr(c,u.bind(l),a);return d(),o}function Mr(e,n){const a=n.split(".");return()=>{let l=e;for(let c=0;c<a.length&&l;c++)l=l[a[c]];return l}}const Va=(e,n)=>n==="modelValue"||n==="model-value"?e.modelModifiers:e[`${n}Modifiers`]||e[`${Nt(n)}Modifiers`]||e[`${Ee(n)}Modifiers`];function Ya(e,n,...a){if(e.isUnmounted)return;const l=e.vnode.props||ft;let c=a;const u=n.startsWith("update:"),d=u&&Va(l,n.slice(7));d&&(d.trim&&(c=a.map(v=>gt(v)?v.trim():v)),d.number&&(c=a.map(nn)));let o,p=l[o=Vi(n)]||l[o=Vi(Nt(n))];!p&&u&&(p=l[o=Vi(Ee(n))]),p&&te(p,e,6,c);const S=l[o+"Once"];if(S){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,te(S,e,6,c)}}function Dr(e,n,a=!1){const l=n.emitsCache,c=l.get(e);if(c!==void 0)return c;const u=e.emits;let d={},o=!1;if(!Z(e)){const p=S=>{const v=Dr(S,n,!0);v&&(o=!0,St(d,v))};!a&&n.mixins.length&&n.mixins.forEach(p),e.extends&&p(e.extends),e.mixins&&e.mixins.forEach(p)}return!u&&!o?(dt(e)&&l.set(e,null),null):($(u)?u.forEach(p=>d[p]=null):St(d,u),dt(e)&&l.set(e,d),d)}function Oi(e,n){return!e||!Ii(n)?!1:(n=n.slice(2).replace(/Once$/,""),ot(e,n[0].toLowerCase()+n.slice(1))||ot(e,Ee(n))||ot(e,n))}function Jn(e){const{type:n,vnode:a,proxy:l,withProxy:c,propsOptions:[u],slots:d,attrs:o,emit:p,render:S,renderCache:v,props:b,data:E,setupState:C,ctx:B,inheritAttrs:H}=e,t=Ei(e);let s,r;try{if(a.shapeFlag&4){const h=c||l,_=h;s=Xt(S.call(_,h,v,b,C,E,B)),r=o}else{const h=n;s=Xt(h.length>1?h(b,{attrs:o,slots:d,emit:p}):h(b,null)),r=n.props?o:ja(o)}}catch(h){Qe.length=0,Mi(h,e,1),s=_t(Ue)}let f=s;if(r&&H!==!1){const h=Object.keys(r),{shapeFlag:_}=f;h.length&&_&7&&(u&&h.some(vn)&&(r=Ka(r,u)),f=ke(f,r,!1,!0))}return a.dirs&&(f=ke(f,null,!1,!0),f.dirs=f.dirs?f.dirs.concat(a.dirs):a.dirs),a.transition&&Ln(f,a.transition),s=f,Ei(t),s}const ja=e=>{let n;for(const a in e)(a==="class"||a==="style"||Ii(a))&&((n||(n={}))[a]=e[a]);return n},Ka=(e,n)=>{const a={};for(const l in e)(!vn(l)||!(l.slice(9)in n))&&(a[l]=e[l]);return a};function Wa(e,n,a){const{props:l,children:c,component:u}=e,{props:d,children:o,patchFlag:p}=n,S=u.emitsOptions;if(n.dirs||n.transition)return!0;if(a&&p>=0){if(p&1024)return!0;if(p&16)return l?ts(l,d,S):!!d;if(p&8){const v=n.dynamicProps;for(let b=0;b<v.length;b++){const E=v[b];if(d[E]!==l[E]&&!Oi(S,E))return!0}}}else return(c||o)&&(!o||!o.$stable)?!0:l===d?!1:l?d?ts(l,d,S):!0:!!d;return!1}function ts(e,n,a){const l=Object.keys(n);if(l.length!==Object.keys(e).length)return!0;for(let c=0;c<l.length;c++){const u=l[c];if(n[u]!==e[u]&&!Oi(a,u))return!0}return!1}function qa({vnode:e,parent:n},a){for(;n;){const l=n.subTree;if(l.suspense&&l.suspense.activeBranch===e&&(l.el=e.el),l===e)(e=n.vnode).el=a,n=n.parent;else break}}const Or=e=>e.__isSuspense;function $a(e,n){n&&n.pendingBranch?$(e)?n.effects.push(...e):n.effects.push(e):sa(e)}const se=Symbol.for("v-fgt"),Ni=Symbol.for("v-txt"),Ue=Symbol.for("v-cmt"),vi=Symbol.for("v-stc"),Qe=[];let kt=null;function Pt(e=!1){Qe.push(kt=e?null:[])}function Xa(){Qe.pop(),kt=Qe[Qe.length-1]||null}let si=1;function es(e,n=!1){si+=e,e<0&&kt&&n&&(kt.hasOnce=!0)}function Nr(e){return e.dynamicChildren=si>0?kt||Te:null,Xa(),si>0&&kt&&kt.push(e),e}function Mt(e,n,a,l,c,u){return Nr(Y(e,n,a,l,c,u,!0))}function Za(e,n,a,l,c){return Nr(_t(e,n,a,l,c,!0))}function Ai(e){return e?e.__v_isVNode===!0:!1}function He(e,n){return e.type===n.type&&e.key===n.key}const Hr=({key:e})=>e??null,xi=({ref:e,ref_key:n,ref_for:a})=>(typeof e=="number"&&(e=""+e),e!=null?gt(e)||bt(e)||Z(e)?{i:Rt,r:e,k:n,f:!!a}:e:null);function Y(e,n=null,a=null,l=0,c=null,u=e===se?0:1,d=!1,o=!1){const p={__v_isVNode:!0,__v_skip:!0,type:e,props:n,key:n&&Hr(n),ref:n&&xi(n),scopeId:gr,slotScopeIds:null,children:a,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:l,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:Rt};return o?(Rn(p,a),u&128&&e.normalize(p)):a&&(p.shapeFlag|=gt(a)?8:16),si>0&&!d&&kt&&(p.patchFlag>0||u&6)&&p.patchFlag!==32&&kt.push(p),p}const _t=Qa;function Qa(e,n=null,a=null,l=0,c=null,u=!1){if((!e||e===xa)&&(e=Ue),Ai(e)){const o=ke(e,n,!0);return a&&Rn(o,a),si>0&&!u&&kt&&(o.shapeFlag&6?kt[kt.indexOf(e)]=o:kt.push(o)),o.patchFlag=-2,o}if(fl(e)&&(e=e.__vccOpts),n){n=Ja(n);let{class:o,style:p}=n;o&&!gt(o)&&(n.class=wn(o)),dt(p)&&(Fn(p)&&!$(p)&&(p=St({},p)),n.style=Sn(p))}const d=gt(e)?1:Or(e)?128:oa(e)?64:dt(e)?4:Z(e)?2:0;return Y(e,n,a,l,c,d,u,!0)}function Ja(e){return e?Fn(e)||Cr(e)?St({},e):e:null}function ke(e,n,a=!1,l=!1){const{props:c,ref:u,patchFlag:d,children:o,transition:p}=e,S=n?tl(c||{},n):c,v={__v_isVNode:!0,__v_skip:!0,type:e.type,props:S,key:S&&Hr(S),ref:n&&n.ref?a&&u?$(u)?u.concat(xi(n)):[u,xi(n)]:xi(n):u,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:n&&e.type!==se?d===-1?16:d|16:d,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:p,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ke(e.ssContent),ssFallback:e.ssFallback&&ke(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return p&&l&&Ln(v,p.clone(v)),v}function be(e=" ",n=0){return _t(Ni,null,e,n)}function Gr(e,n){const a=_t(vi,null,e);return a.staticCount=n,a}function pe(e="",n=!1){return n?(Pt(),Za(Ue,null,e)):_t(Ue,null,e)}function Xt(e){return e==null||typeof e=="boolean"?_t(Ue):$(e)?_t(se,null,e.slice()):Ai(e)?ue(e):_t(Ni,null,String(e))}function ue(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:ke(e)}function Rn(e,n){let a=0;const{shapeFlag:l}=e;if(n==null)n=null;else if($(n))a=16;else if(typeof n=="object")if(l&65){const c=n.default;c&&(c._c&&(c._d=!1),Rn(e,c()),c._c&&(c._d=!0));return}else{a=32;const c=n._;!c&&!Cr(n)?n._ctx=Rt:c===3&&Rt&&(Rt.slots._===1?n._=1:(n._=2,e.patchFlag|=1024))}else Z(n)?(n={default:n,_ctx:Rt},a=32):(n=String(n),l&64?(a=16,n=[be(n)]):a=8);e.children=n,e.shapeFlag|=a}function tl(...e){const n={};for(let a=0;a<e.length;a++){const l=e[a];for(const c in l)if(c==="class")n.class!==l.class&&(n.class=wn([n.class,l.class]));else if(c==="style")n.style=Sn([n.style,l.style]);else if(Ii(c)){const u=n[c],d=l[c];d&&u!==d&&!($(u)&&u.includes(d))&&(n[c]=u?[].concat(u,d):d)}else c!==""&&(n[c]=l[c])}return n}function qt(e,n,a,l=null){te(e,n,7,[a,l])}const el=Ur();let il=0;function nl(e,n,a){const l=e.type,c=(n?n.appContext:e.appContext)||el,u={uid:il++,vnode:e,type:l,parent:n,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Co(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(c.provides),ids:n?n.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Tr(l,c),emitsOptions:Dr(l,c),emit:null,emitted:null,propsDefaults:ft,inheritAttrs:l.inheritAttrs,ctx:ft,data:ft,props:ft,attrs:ft,slots:ft,refs:ft,setupState:ft,setupContext:null,suspense:a,suspenseId:a?a.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx={_:u},u.root=n?n.root:u,u.emit=Ya.bind(null,u),e.ce&&e.ce(u),u}let xt=null,Ti,dn;{const e=Ri(),n=(a,l)=>{let c;return(c=e[a])||(c=e[a]=[]),c.push(l),u=>{c.length>1?c.forEach(d=>d(u)):c[0](u)}};Ti=n("__VUE_INSTANCE_SETTERS__",a=>xt=a),dn=n("__VUE_SSR_SETTERS__",a=>ri=a)}const ci=e=>{const n=xt;return Ti(e),e.scope.on(),()=>{e.scope.off(),Ti(n)}},is=()=>{xt&&xt.scope.off(),Ti(null)};function Vr(e){return e.vnode.shapeFlag&4}let ri=!1;function sl(e,n=!1,a=!1){n&&dn(n);const{props:l,children:c}=e.vnode,u=Vr(e);Pa(e,l,u,n),za(e,c,a);const d=u?rl(e,n):void 0;return n&&dn(!1),d}function rl(e,n){const a=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Sa);const{setup:l}=a;if(l){_e();const c=e.setupContext=l.length>1?al(e):null,u=ci(e),d=fi(l,e,0,[e.props,c]),o=Ns(d);if(ge(),u(),(o||e.sp)&&!Xe(e)&&mr(e),o){if(d.then(is,is),n)return d.then(p=>{ns(e,p)}).catch(p=>{Mi(p,e,0)});e.asyncDep=d}else ns(e,d)}else Yr(e)}function ns(e,n,a){Z(n)?e.type.__ssrInlineRender?e.ssrRender=n:e.render=n:dt(n)&&(e.setupState=cr(n)),Yr(e)}function Yr(e,n,a){const l=e.type;e.render||(e.render=l.render||Zt);{const c=ci(e);_e();try{wa(e)}finally{ge(),c()}}}const ol={get(e,n){return vt(e,"get",""),e[n]}};function al(e){const n=a=>{e.exposed=a||{}};return{attrs:new Proxy(e.attrs,ol),slots:e.slots,emit:e.emit,expose:n}}function Hi(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(cr(Wo(e.exposed)),{get(n,a){if(a in n)return n[a];if(a in Ze)return Ze[a](e)},has(n,a){return a in n||a in Ze}})):e.proxy}function ll(e,n=!0){return Z(e)?e.displayName||e.name:e.name||n&&e.__name}function fl(e){return Z(e)&&"__vccOpts"in e}const Ht=(e,n)=>Jo(e,n,ri);function jr(e,n,a){const l=arguments.length;return l===2?dt(n)&&!$(n)?Ai(n)?_t(e,null,[n]):_t(e,n):_t(e,null,n):(l>3?a=Array.prototype.slice.call(arguments,2):l===3&&Ai(a)&&(a=[a]),_t(e,n,a))}const cl="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let pn;const ss=typeof window<"u"&&window.trustedTypes;if(ss)try{pn=ss.createPolicy("vue",{createHTML:e=>e})}catch{}const Kr=pn?e=>pn.createHTML(e):e=>e,ul="http://www.w3.org/2000/svg",hl="http://www.w3.org/1998/Math/MathML",ne=typeof document<"u"?document:null,rs=ne&&ne.createElement("template"),dl={insert:(e,n,a)=>{n.insertBefore(e,a||null)},remove:e=>{const n=e.parentNode;n&&n.removeChild(e)},createElement:(e,n,a,l)=>{const c=n==="svg"?ne.createElementNS(ul,e):n==="mathml"?ne.createElementNS(hl,e):a?ne.createElement(e,{is:a}):ne.createElement(e);return e==="select"&&l&&l.multiple!=null&&c.setAttribute("multiple",l.multiple),c},createText:e=>ne.createTextNode(e),createComment:e=>ne.createComment(e),setText:(e,n)=>{e.nodeValue=n},setElementText:(e,n)=>{e.textContent=n},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ne.querySelector(e),setScopeId(e,n){e.setAttribute(n,"")},insertStaticContent(e,n,a,l,c,u){const d=a?a.previousSibling:n.lastChild;if(c&&(c===u||c.nextSibling))for(;n.insertBefore(c.cloneNode(!0),a),!(c===u||!(c=c.nextSibling)););else{rs.innerHTML=Kr(l==="svg"?`<svg>${e}</svg>`:l==="mathml"?`<math>${e}</math>`:e);const o=rs.content;if(l==="svg"||l==="mathml"){const p=o.firstChild;for(;p.firstChild;)o.appendChild(p.firstChild);o.removeChild(p)}n.insertBefore(o,a)}return[d?d.nextSibling:n.firstChild,a?a.previousSibling:n.lastChild]}},pl=Symbol("_vtc");function _l(e,n,a){const l=e[pl];l&&(n=(n?[n,...l]:[...l]).join(" ")),n==null?e.removeAttribute("class"):a?e.setAttribute("class",n):e.className=n}const Pi=Symbol("_vod"),Wr=Symbol("_vsh"),os={beforeMount(e,{value:n},{transition:a}){e[Pi]=e.style.display==="none"?"":e.style.display,a&&n?a.beforeEnter(e):Ge(e,n)},mounted(e,{value:n},{transition:a}){a&&n&&a.enter(e)},updated(e,{value:n,oldValue:a},{transition:l}){!n!=!a&&(l?n?(l.beforeEnter(e),Ge(e,!0),l.enter(e)):l.leave(e,()=>{Ge(e,!1)}):Ge(e,n))},beforeUnmount(e,{value:n}){Ge(e,n)}};function Ge(e,n){e.style.display=n?e[Pi]:"none",e[Wr]=!n}const gl=Symbol(""),yl=/(^|;)\s*display\s*:/;function ml(e,n,a){const l=e.style,c=gt(a);let u=!1;if(a&&!c){if(n)if(gt(n))for(const d of n.split(";")){const o=d.slice(0,d.indexOf(":")).trim();a[o]==null&&bi(l,o,"")}else for(const d in n)a[d]==null&&bi(l,d,"");for(const d in a)d==="display"&&(u=!0),bi(l,d,a[d])}else if(c){if(n!==a){const d=l[gl];d&&(a+=";"+d),l.cssText=a,u=yl.test(a)}}else n&&e.removeAttribute("style");Pi in e&&(e[Pi]=u?l.display:"",e[Wr]&&(l.display="none"))}const as=/\s*!important$/;function bi(e,n,a){if($(a))a.forEach(l=>bi(e,n,l));else if(a==null&&(a=""),n.startsWith("--"))e.setProperty(n,a);else{const l=vl(e,n);as.test(a)?e.setProperty(Ee(l),a.replace(as,""),"important"):e[l]=a}}const ls=["Webkit","Moz","ms"],Xi={};function vl(e,n){const a=Xi[n];if(a)return a;let l=Nt(n);if(l!=="filter"&&l in e)return Xi[n]=l;l=zi(l);for(let c=0;c<ls.length;c++){const u=ls[c]+l;if(u in e)return Xi[n]=u}return n}const fs="http://www.w3.org/1999/xlink";function cs(e,n,a,l,c,u=Eo(n)){l&&n.startsWith("xlink:")?a==null?e.removeAttributeNS(fs,n.slice(6,n.length)):e.setAttributeNS(fs,n,a):a==null||u&&!Ys(a)?e.removeAttribute(n):e.setAttribute(n,u?"":Jt(a)?String(a):a)}function us(e,n,a,l,c){if(n==="innerHTML"||n==="textContent"){a!=null&&(e[n]=n==="innerHTML"?Kr(a):a);return}const u=e.tagName;if(n==="value"&&u!=="PROGRESS"&&!u.includes("-")){const o=u==="OPTION"?e.getAttribute("value")||"":e.value,p=a==null?e.type==="checkbox"?"on":"":String(a);(o!==p||!("_value"in e))&&(e.value=p),a==null&&e.removeAttribute(n),e._value=a;return}let d=!1;if(a===""||a==null){const o=typeof e[n];o==="boolean"?a=Ys(a):a==null&&o==="string"?(a="",d=!0):o==="number"&&(a=0,d=!0)}try{e[n]=a}catch{}d&&e.removeAttribute(c||n)}function xe(e,n,a,l){e.addEventListener(n,a,l)}function xl(e,n,a,l){e.removeEventListener(n,a,l)}const hs=Symbol("_vei");function bl(e,n,a,l,c=null){const u=e[hs]||(e[hs]={}),d=u[n];if(l&&d)d.value=l;else{const[o,p]=Sl(n);if(l){const S=u[n]=El(l,c);xe(e,o,S,p)}else d&&(xl(e,o,d,p),u[n]=void 0)}}const ds=/(?:Once|Passive|Capture)$/;function Sl(e){let n;if(ds.test(e)){n={};let l;for(;l=e.match(ds);)e=e.slice(0,e.length-l[0].length),n[l[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Ee(e.slice(2)),n]}let Zi=0;const wl=Promise.resolve(),Ul=()=>Zi||(wl.then(()=>Zi=0),Zi=Date.now());function El(e,n){const a=l=>{if(!l._vts)l._vts=Date.now();else if(l._vts<=a.attached)return;te(Bl(l,a.value),n,5,[l])};return a.value=e,a.attached=Ul(),a}function Bl(e,n){if($(n)){const a=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{a.call(e),e._stopped=!0},n.map(l=>c=>!c._stopped&&l&&l(c))}else return n}const ps=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,Cl=(e,n,a,l,c,u)=>{const d=c==="svg";n==="class"?_l(e,l,d):n==="style"?ml(e,a,l):Ii(n)?vn(n)||bl(e,n,a,l,u):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):Al(e,n,l,d))?(us(e,n,l),!e.tagName.includes("-")&&(n==="value"||n==="checked"||n==="selected")&&cs(e,n,l,d,u,n!=="value")):e._isVueCE&&(/[A-Z]/.test(n)||!gt(l))?us(e,Nt(n),l,u,n):(n==="true-value"?e._trueValue=l:n==="false-value"&&(e._falseValue=l),cs(e,n,l,d))};function Al(e,n,a,l){if(l)return!!(n==="innerHTML"||n==="textContent"||n in e&&ps(n)&&Z(a));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&e.tagName==="INPUT"||n==="type"&&e.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const c=e.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return ps(n)&&gt(a)?!1:n in e}const Fi=e=>{const n=e.props["onUpdate:modelValue"]||!1;return $(n)?a=>gi(n,a):n};function Tl(e){e.target.composing=!0}function _s(e){const n=e.target;n.composing&&(n.composing=!1,n.dispatchEvent(new Event("input")))}const ze=Symbol("_assign"),Qt={created(e,{modifiers:{lazy:n,trim:a,number:l}},c){e[ze]=Fi(c);const u=l||c.props&&c.props.type==="number";xe(e,n?"change":"input",d=>{if(d.target.composing)return;let o=e.value;a&&(o=o.trim()),u&&(o=nn(o)),e[ze](o)}),a&&xe(e,"change",()=>{e.value=e.value.trim()}),n||(xe(e,"compositionstart",Tl),xe(e,"compositionend",_s),xe(e,"change",_s))},mounted(e,{value:n}){e.value=n??""},beforeUpdate(e,{value:n,oldValue:a,modifiers:{lazy:l,trim:c,number:u}},d){if(e[ze]=Fi(d),e.composing)return;const o=(u||e.type==="number")&&!/^0\d/.test(e.value)?nn(e.value):e.value,p=n??"";o!==p&&(document.activeElement===e&&e.type!=="range"&&(l&&n===a||c&&e.value.trim()===p)||(e.value=p))}},gs={created(e,{value:n},a){e.checked=Si(n,a.props.value),e[ze]=Fi(a),xe(e,"change",()=>{e[ze](Pl(e))})},beforeUpdate(e,{value:n,oldValue:a},l){e[ze]=Fi(l),n!==a&&(e.checked=Si(n,l.props.value))}};function Pl(e){return"_value"in e?e._value:e.value}const Fl=St({patchProp:Cl},dl);let ys;function Il(){return ys||(ys=ka(Fl))}const Ll=(...e)=>{const n=Il().createApp(...e),{mount:a}=n;return n.mount=l=>{const c=Rl(l);if(!c)return;const u=n._component;!Z(u)&&!u.render&&!u.template&&(u.template=c.innerHTML),c.nodeType===1&&(c.textContent="");const d=a(c,!1,zl(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),d},n};function zl(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function Rl(e){return gt(e)?document.querySelector(e):e}const ui=(e,n)=>{const a=e.__vccOpts||e;for(const[l,c]of n)a[l]=c;return a},kl={name:"App",computed:{supportsFileAPI(){return"showSaveFilePicker"in window}}},Ml={id:"app"};function Dl(e,n,a,l,c,u){const d=jn("router-link"),o=jn("router-view");return Pt(),Mt("div",Ml,[Y("nav",null,[_t(d,{to:"/message"},{default:Ye(()=>n[0]||(n[0]=[be("消息")])),_:1}),Tt(_t(d,{to:"/file"},{default:Ye(()=>n[1]||(n[1]=[be("文件")])),_:1},512),[[os,u.supportsFileAPI]]),Tt(_t(d,{to:"/file-classic"},{default:Ye(()=>n[2]||(n[2]=[be("文件2")])),_:1},512),[[os,!u.supportsFileAPI]]),_t(d,{to:"/video-decrypt"},{default:Ye(()=>n[3]||(n[3]=[be("视频解密")])),_:1})]),_t(o)])}const Ol=ui(kl,[["render",Dl]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Ae=typeof document<"u";function qr(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Nl(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&qr(e.default)}const st=Object.assign;function Qi(e,n){const a={};for(const l in n){const c=n[l];a[l]=Yt(c)?c.map(e):e(c)}return a}const Je=()=>{},Yt=Array.isArray,$r=/#/g,Hl=/&/g,Gl=/\//g,Vl=/=/g,Yl=/\?/g,Xr=/\+/g,jl=/%5B/g,Kl=/%5D/g,Zr=/%5E/g,Wl=/%60/g,Qr=/%7B/g,ql=/%7C/g,Jr=/%7D/g,$l=/%20/g;function kn(e){return encodeURI(""+e).replace(ql,"|").replace(jl,"[").replace(Kl,"]")}function Xl(e){return kn(e).replace(Qr,"{").replace(Jr,"}").replace(Zr,"^")}function _n(e){return kn(e).replace(Xr,"%2B").replace($l,"+").replace($r,"%23").replace(Hl,"%26").replace(Wl,"`").replace(Qr,"{").replace(Jr,"}").replace(Zr,"^")}function Zl(e){return _n(e).replace(Vl,"%3D")}function Ql(e){return kn(e).replace($r,"%23").replace(Yl,"%3F")}function Jl(e){return e==null?"":Ql(e).replace(Gl,"%2F")}function oi(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const tf=/\/$/,ef=e=>e.replace(tf,"");function Ji(e,n,a="/"){let l,c={},u="",d="";const o=n.indexOf("#");let p=n.indexOf("?");return o<p&&o>=0&&(p=-1),p>-1&&(l=n.slice(0,p),u=n.slice(p+1,o>-1?o:n.length),c=e(u)),o>-1&&(l=l||n.slice(0,o),d=n.slice(o,n.length)),l=of(l??n,a),{fullPath:l+(u&&"?")+u+d,path:l,query:c,hash:oi(d)}}function nf(e,n){const a=n.query?e(n.query):"";return n.path+(a&&"?")+a+(n.hash||"")}function ms(e,n){return!n||!e.toLowerCase().startsWith(n.toLowerCase())?e:e.slice(n.length)||"/"}function sf(e,n,a){const l=n.matched.length-1,c=a.matched.length-1;return l>-1&&l===c&&Me(n.matched[l],a.matched[c])&&to(n.params,a.params)&&e(n.query)===e(a.query)&&n.hash===a.hash}function Me(e,n){return(e.aliasOf||e)===(n.aliasOf||n)}function to(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const a in e)if(!rf(e[a],n[a]))return!1;return!0}function rf(e,n){return Yt(e)?vs(e,n):Yt(n)?vs(n,e):e===n}function vs(e,n){return Yt(n)?e.length===n.length&&e.every((a,l)=>a===n[l]):e.length===1&&e[0]===n}function of(e,n){if(e.startsWith("/"))return e;if(!e)return n;const a=n.split("/"),l=e.split("/"),c=l[l.length-1];(c===".."||c===".")&&l.push("");let u=a.length-1,d,o;for(d=0;d<l.length;d++)if(o=l[d],o!==".")if(o==="..")u>1&&u--;else break;return a.slice(0,u).join("/")+"/"+l.slice(d).join("/")}const fe={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var ai;(function(e){e.pop="pop",e.push="push"})(ai||(ai={}));var ti;(function(e){e.back="back",e.forward="forward",e.unknown=""})(ti||(ti={}));function af(e){if(!e)if(Ae){const n=document.querySelector("base");e=n&&n.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),ef(e)}const lf=/^[^#]+#/;function ff(e,n){return e.replace(lf,"#")+n}function cf(e,n){const a=document.documentElement.getBoundingClientRect(),l=e.getBoundingClientRect();return{behavior:n.behavior,left:l.left-a.left-(n.left||0),top:l.top-a.top-(n.top||0)}}const Gi=()=>({left:window.scrollX,top:window.scrollY});function uf(e){let n;if("el"in e){const a=e.el,l=typeof a=="string"&&a.startsWith("#"),c=typeof a=="string"?l?document.getElementById(a.slice(1)):document.querySelector(a):a;if(!c)return;n=cf(c,e)}else n=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(n):window.scrollTo(n.left!=null?n.left:window.scrollX,n.top!=null?n.top:window.scrollY)}function xs(e,n){return(history.state?history.state.position-n:-1)+e}const gn=new Map;function hf(e,n){gn.set(e,n)}function df(e){const n=gn.get(e);return gn.delete(e),n}let pf=()=>location.protocol+"//"+location.host;function eo(e,n){const{pathname:a,search:l,hash:c}=n,u=e.indexOf("#");if(u>-1){let o=c.includes(e.slice(u))?e.slice(u).length:1,p=c.slice(o);return p[0]!=="/"&&(p="/"+p),ms(p,"")}return ms(a,e)+l+c}function _f(e,n,a,l){let c=[],u=[],d=null;const o=({state:E})=>{const C=eo(e,location),B=a.value,H=n.value;let t=0;if(E){if(a.value=C,n.value=E,d&&d===B){d=null;return}t=H?E.position-H.position:0}else l(C);c.forEach(s=>{s(a.value,B,{delta:t,type:ai.pop,direction:t?t>0?ti.forward:ti.back:ti.unknown})})};function p(){d=a.value}function S(E){c.push(E);const C=()=>{const B=c.indexOf(E);B>-1&&c.splice(B,1)};return u.push(C),C}function v(){const{history:E}=window;E.state&&E.replaceState(st({},E.state,{scroll:Gi()}),"")}function b(){for(const E of u)E();u=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",v)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",v,{passive:!0}),{pauseListeners:p,listen:S,destroy:b}}function bs(e,n,a,l=!1,c=!1){return{back:e,current:n,forward:a,replaced:l,position:window.history.length,scroll:c?Gi():null}}function gf(e){const{history:n,location:a}=window,l={value:eo(e,a)},c={value:n.state};c.value||u(l.value,{back:null,current:l.value,forward:null,position:n.length-1,replaced:!0,scroll:null},!0);function u(p,S,v){const b=e.indexOf("#"),E=b>-1?(a.host&&document.querySelector("base")?e:e.slice(b))+p:pf()+e+p;try{n[v?"replaceState":"pushState"](S,"",E),c.value=S}catch(C){console.error(C),a[v?"replace":"assign"](E)}}function d(p,S){const v=st({},n.state,bs(c.value.back,p,c.value.forward,!0),S,{position:c.value.position});u(p,v,!0),l.value=p}function o(p,S){const v=st({},c.value,n.state,{forward:p,scroll:Gi()});u(v.current,v,!0);const b=st({},bs(l.value,p,null),{position:v.position+1},S);u(p,b,!1),l.value=p}return{location:l,state:c,push:o,replace:d}}function yf(e){e=af(e);const n=gf(e),a=_f(e,n.state,n.location,n.replace);function l(u,d=!0){d||a.pauseListeners(),history.go(u)}const c=st({location:"",base:e,go:l,createHref:ff.bind(null,e)},n,a);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>n.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>n.state.value}),c}function mf(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),yf(e)}function vf(e){return typeof e=="string"||e&&typeof e=="object"}function io(e){return typeof e=="string"||typeof e=="symbol"}const no=Symbol("");var Ss;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Ss||(Ss={}));function De(e,n){return st(new Error,{type:e,[no]:!0},n)}function ie(e,n){return e instanceof Error&&no in e&&(n==null||!!(e.type&n))}const ws="[^/]+?",xf={sensitive:!1,strict:!1,start:!0,end:!0},bf=/[.+*?^${}()[\]/\\]/g;function Sf(e,n){const a=st({},xf,n),l=[];let c=a.start?"^":"";const u=[];for(const S of e){const v=S.length?[]:[90];a.strict&&!S.length&&(c+="/");for(let b=0;b<S.length;b++){const E=S[b];let C=40+(a.sensitive?.25:0);if(E.type===0)b||(c+="/"),c+=E.value.replace(bf,"\\$&"),C+=40;else if(E.type===1){const{value:B,repeatable:H,optional:t,regexp:s}=E;u.push({name:B,repeatable:H,optional:t});const r=s||ws;if(r!==ws){C+=10;try{new RegExp(`(${r})`)}catch(h){throw new Error(`Invalid custom RegExp for param "${B}" (${r}): `+h.message)}}let f=H?`((?:${r})(?:/(?:${r}))*)`:`(${r})`;b||(f=t&&S.length<2?`(?:/${f})`:"/"+f),t&&(f+="?"),c+=f,C+=20,t&&(C+=-8),H&&(C+=-20),r===".*"&&(C+=-50)}v.push(C)}l.push(v)}if(a.strict&&a.end){const S=l.length-1;l[S][l[S].length-1]+=.7000000000000001}a.strict||(c+="/?"),a.end?c+="$":a.strict&&!c.endsWith("/")&&(c+="(?:/|$)");const d=new RegExp(c,a.sensitive?"":"i");function o(S){const v=S.match(d),b={};if(!v)return null;for(let E=1;E<v.length;E++){const C=v[E]||"",B=u[E-1];b[B.name]=C&&B.repeatable?C.split("/"):C}return b}function p(S){let v="",b=!1;for(const E of e){(!b||!v.endsWith("/"))&&(v+="/"),b=!1;for(const C of E)if(C.type===0)v+=C.value;else if(C.type===1){const{value:B,repeatable:H,optional:t}=C,s=B in S?S[B]:"";if(Yt(s)&&!H)throw new Error(`Provided param "${B}" is an array but it is not repeatable (* or + modifiers)`);const r=Yt(s)?s.join("/"):s;if(!r)if(t)E.length<2&&(v.endsWith("/")?v=v.slice(0,-1):b=!0);else throw new Error(`Missing required param "${B}"`);v+=r}}return v||"/"}return{re:d,score:l,keys:u,parse:o,stringify:p}}function wf(e,n){let a=0;for(;a<e.length&&a<n.length;){const l=n[a]-e[a];if(l)return l;a++}return e.length<n.length?e.length===1&&e[0]===80?-1:1:e.length>n.length?n.length===1&&n[0]===80?1:-1:0}function so(e,n){let a=0;const l=e.score,c=n.score;for(;a<l.length&&a<c.length;){const u=wf(l[a],c[a]);if(u)return u;a++}if(Math.abs(c.length-l.length)===1){if(Us(l))return 1;if(Us(c))return-1}return c.length-l.length}function Us(e){const n=e[e.length-1];return e.length>0&&n[n.length-1]<0}const Uf={type:0,value:""},Ef=/[a-zA-Z0-9_]/;function Bf(e){if(!e)return[[]];if(e==="/")return[[Uf]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function n(C){throw new Error(`ERR (${a})/"${S}": ${C}`)}let a=0,l=a;const c=[];let u;function d(){u&&c.push(u),u=[]}let o=0,p,S="",v="";function b(){S&&(a===0?u.push({type:0,value:S}):a===1||a===2||a===3?(u.length>1&&(p==="*"||p==="+")&&n(`A repeatable param (${S}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:S,regexp:v,repeatable:p==="*"||p==="+",optional:p==="*"||p==="?"})):n("Invalid state to consume buffer"),S="")}function E(){S+=p}for(;o<e.length;){if(p=e[o++],p==="\\"&&a!==2){l=a,a=4;continue}switch(a){case 0:p==="/"?(S&&b(),d()):p===":"?(b(),a=1):E();break;case 4:E(),a=l;break;case 1:p==="("?a=2:Ef.test(p)?E():(b(),a=0,p!=="*"&&p!=="?"&&p!=="+"&&o--);break;case 2:p===")"?v[v.length-1]=="\\"?v=v.slice(0,-1)+p:a=3:v+=p;break;case 3:b(),a=0,p!=="*"&&p!=="?"&&p!=="+"&&o--,v="";break;default:n("Unknown state");break}}return a===2&&n(`Unfinished custom RegExp for param "${S}"`),b(),d(),c}function Cf(e,n,a){const l=Sf(Bf(e.path),a),c=st(l,{record:e,parent:n,children:[],alias:[]});return n&&!c.record.aliasOf==!n.record.aliasOf&&n.children.push(c),c}function Af(e,n){const a=[],l=new Map;n=As({strict:!1,end:!0,sensitive:!1},n);function c(b){return l.get(b)}function u(b,E,C){const B=!C,H=Bs(b);H.aliasOf=C&&C.record;const t=As(n,b),s=[H];if("alias"in b){const h=typeof b.alias=="string"?[b.alias]:b.alias;for(const _ of h)s.push(Bs(st({},H,{components:C?C.record.components:H.components,path:_,aliasOf:C?C.record:H})))}let r,f;for(const h of s){const{path:_}=h;if(E&&_[0]!=="/"){const g=E.record.path,x=g[g.length-1]==="/"?"":"/";h.path=E.record.path+(_&&x+_)}if(r=Cf(h,E,t),C?C.alias.push(r):(f=f||r,f!==r&&f.alias.push(r),B&&b.name&&!Cs(r)&&d(b.name)),ro(r)&&p(r),H.children){const g=H.children;for(let x=0;x<g.length;x++)u(g[x],r,C&&C.children[x])}C=C||r}return f?()=>{d(f)}:Je}function d(b){if(io(b)){const E=l.get(b);E&&(l.delete(b),a.splice(a.indexOf(E),1),E.children.forEach(d),E.alias.forEach(d))}else{const E=a.indexOf(b);E>-1&&(a.splice(E,1),b.record.name&&l.delete(b.record.name),b.children.forEach(d),b.alias.forEach(d))}}function o(){return a}function p(b){const E=Ff(b,a);a.splice(E,0,b),b.record.name&&!Cs(b)&&l.set(b.record.name,b)}function S(b,E){let C,B={},H,t;if("name"in b&&b.name){if(C=l.get(b.name),!C)throw De(1,{location:b});t=C.record.name,B=st(Es(E.params,C.keys.filter(f=>!f.optional).concat(C.parent?C.parent.keys.filter(f=>f.optional):[]).map(f=>f.name)),b.params&&Es(b.params,C.keys.map(f=>f.name))),H=C.stringify(B)}else if(b.path!=null)H=b.path,C=a.find(f=>f.re.test(H)),C&&(B=C.parse(H),t=C.record.name);else{if(C=E.name?l.get(E.name):a.find(f=>f.re.test(E.path)),!C)throw De(1,{location:b,currentLocation:E});t=C.record.name,B=st({},E.params,b.params),H=C.stringify(B)}const s=[];let r=C;for(;r;)s.unshift(r.record),r=r.parent;return{name:t,path:H,params:B,matched:s,meta:Pf(s)}}e.forEach(b=>u(b));function v(){a.length=0,l.clear()}return{addRoute:u,resolve:S,removeRoute:d,clearRoutes:v,getRoutes:o,getRecordMatcher:c}}function Es(e,n){const a={};for(const l of n)l in e&&(a[l]=e[l]);return a}function Bs(e){const n={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:Tf(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(n,"mods",{value:{}}),n}function Tf(e){const n={},a=e.props||!1;if("component"in e)n.default=a;else for(const l in e.components)n[l]=typeof a=="object"?a[l]:a;return n}function Cs(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Pf(e){return e.reduce((n,a)=>st(n,a.meta),{})}function As(e,n){const a={};for(const l in e)a[l]=l in n?n[l]:e[l];return a}function Ff(e,n){let a=0,l=n.length;for(;a!==l;){const u=a+l>>1;so(e,n[u])<0?l=u:a=u+1}const c=If(e);return c&&(l=n.lastIndexOf(c,l-1)),l}function If(e){let n=e;for(;n=n.parent;)if(ro(n)&&so(e,n)===0)return n}function ro({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function Lf(e){const n={};if(e===""||e==="?")return n;const l=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<l.length;++c){const u=l[c].replace(Xr," "),d=u.indexOf("="),o=oi(d<0?u:u.slice(0,d)),p=d<0?null:oi(u.slice(d+1));if(o in n){let S=n[o];Yt(S)||(S=n[o]=[S]),S.push(p)}else n[o]=p}return n}function Ts(e){let n="";for(let a in e){const l=e[a];if(a=Zl(a),l==null){l!==void 0&&(n+=(n.length?"&":"")+a);continue}(Yt(l)?l.map(u=>u&&_n(u)):[l&&_n(l)]).forEach(u=>{u!==void 0&&(n+=(n.length?"&":"")+a,u!=null&&(n+="="+u))})}return n}function zf(e){const n={};for(const a in e){const l=e[a];l!==void 0&&(n[a]=Yt(l)?l.map(c=>c==null?null:""+c):l==null?l:""+l)}return n}const Rf=Symbol(""),Ps=Symbol(""),Mn=Symbol(""),oo=Symbol(""),yn=Symbol("");function Ve(){let e=[];function n(l){return e.push(l),()=>{const c=e.indexOf(l);c>-1&&e.splice(c,1)}}function a(){e=[]}return{add:n,list:()=>e.slice(),reset:a}}function he(e,n,a,l,c,u=d=>d()){const d=l&&(l.enterCallbacks[c]=l.enterCallbacks[c]||[]);return()=>new Promise((o,p)=>{const S=E=>{E===!1?p(De(4,{from:a,to:n})):E instanceof Error?p(E):vf(E)?p(De(2,{from:n,to:E})):(d&&l.enterCallbacks[c]===d&&typeof E=="function"&&d.push(E),o())},v=u(()=>e.call(l&&l.instances[c],n,a,S));let b=Promise.resolve(v);e.length<3&&(b=b.then(S)),b.catch(E=>p(E))})}function tn(e,n,a,l,c=u=>u()){const u=[];for(const d of e)for(const o in d.components){let p=d.components[o];if(!(n!=="beforeRouteEnter"&&!d.instances[o]))if(qr(p)){const v=(p.__vccOpts||p)[n];v&&u.push(he(v,a,l,d,o,c))}else{let S=p();u.push(()=>S.then(v=>{if(!v)throw new Error(`Couldn't resolve component "${o}" at "${d.path}"`);const b=Nl(v)?v.default:v;d.mods[o]=v,d.components[o]=b;const C=(b.__vccOpts||b)[n];return C&&he(C,a,l,d,o,c)()}))}}return u}function Fs(e){const n=ae(Mn),a=ae(oo),l=Ht(()=>{const p=Fe(e.to);return n.resolve(p)}),c=Ht(()=>{const{matched:p}=l.value,{length:S}=p,v=p[S-1],b=a.matched;if(!v||!b.length)return-1;const E=b.findIndex(Me.bind(null,v));if(E>-1)return E;const C=Is(p[S-2]);return S>1&&Is(v)===C&&b[b.length-1].path!==C?b.findIndex(Me.bind(null,p[S-2])):E}),u=Ht(()=>c.value>-1&&Nf(a.params,l.value.params)),d=Ht(()=>c.value>-1&&c.value===a.matched.length-1&&to(a.params,l.value.params));function o(p={}){if(Of(p)){const S=n[Fe(e.replace)?"replace":"push"](Fe(e.to)).catch(Je);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>S),S}return Promise.resolve()}return{route:l,href:Ht(()=>l.value.href),isActive:u,isExactActive:d,navigate:o}}function kf(e){return e.length===1?e[0]:e}const Mf=yr({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Fs,setup(e,{slots:n}){const a=ki(Fs(e)),{options:l}=ae(Mn),c=Ht(()=>({[Ls(e.activeClass,l.linkActiveClass,"router-link-active")]:a.isActive,[Ls(e.exactActiveClass,l.linkExactActiveClass,"router-link-exact-active")]:a.isExactActive}));return()=>{const u=n.default&&kf(n.default(a));return e.custom?u:jr("a",{"aria-current":a.isExactActive?e.ariaCurrentValue:null,href:a.href,onClick:a.navigate,class:c.value},u)}}}),Df=Mf;function Of(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}function Nf(e,n){for(const a in n){const l=n[a],c=e[a];if(typeof l=="string"){if(l!==c)return!1}else if(!Yt(c)||c.length!==l.length||l.some((u,d)=>u!==c[d]))return!1}return!0}function Is(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ls=(e,n,a)=>e??n??a,Hf=yr({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:n,slots:a}){const l=ae(yn),c=Ht(()=>e.route||l.value),u=ae(Ps,0),d=Ht(()=>{let S=Fe(u);const{matched:v}=c.value;let b;for(;(b=v[S])&&!b.components;)S++;return S}),o=Ht(()=>c.value.matched[d.value]);yi(Ps,Ht(()=>d.value+1)),yi(Rf,o),yi(yn,c);const p=qo();return mi(()=>[p.value,o.value,e.name],([S,v,b],[E,C,B])=>{v&&(v.instances[b]=S,C&&C!==v&&S&&S===E&&(v.leaveGuards.size||(v.leaveGuards=C.leaveGuards),v.updateGuards.size||(v.updateGuards=C.updateGuards))),S&&v&&(!C||!Me(v,C)||!E)&&(v.enterCallbacks[b]||[]).forEach(H=>H(S))},{flush:"post"}),()=>{const S=c.value,v=e.name,b=o.value,E=b&&b.components[v];if(!E)return zs(a.default,{Component:E,route:S});const C=b.props[v],B=C?C===!0?S.params:typeof C=="function"?C(S):C:null,t=jr(E,st({},B,n,{onVnodeUnmounted:s=>{s.component.isUnmounted&&(b.instances[v]=null)},ref:p}));return zs(a.default,{Component:t,route:S})||t}}});function zs(e,n){if(!e)return null;const a=e(n);return a.length===1?a[0]:a}const Gf=Hf;function Vf(e){const n=Af(e.routes,e),a=e.parseQuery||Lf,l=e.stringifyQuery||Ts,c=e.history,u=Ve(),d=Ve(),o=Ve(),p=$o(fe);let S=fe;Ae&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const v=Qi.bind(null,F=>""+F),b=Qi.bind(null,Jl),E=Qi.bind(null,oi);function C(F,V){let N,K;return io(F)?(N=n.getRecordMatcher(F),K=V):K=F,n.addRoute(K,N)}function B(F){const V=n.getRecordMatcher(F);V&&n.removeRoute(V)}function H(){return n.getRoutes().map(F=>F.record)}function t(F){return!!n.getRecordMatcher(F)}function s(F,V){if(V=st({},V||p.value),typeof F=="string"){const U=Ji(a,F,V.path),P=n.resolve({path:U.path},V),L=c.createHref(U.fullPath);return st(U,P,{params:E(P.params),hash:oi(U.hash),redirectedFrom:void 0,href:L})}let N;if(F.path!=null)N=st({},F,{path:Ji(a,F.path,V.path).path});else{const U=st({},F.params);for(const P in U)U[P]==null&&delete U[P];N=st({},F,{params:b(U)}),V.params=b(V.params)}const K=n.resolve(N,V),lt=F.hash||"";K.params=v(E(K.params));const y=nf(l,st({},F,{hash:Xl(lt),path:K.path})),m=c.createHref(y);return st({fullPath:y,hash:lt,query:l===Ts?zf(F.query):F.query||{}},K,{redirectedFrom:void 0,href:m})}function r(F){return typeof F=="string"?Ji(a,F,p.value.path):st({},F)}function f(F,V){if(S!==F)return De(8,{from:V,to:F})}function h(F){return x(F)}function _(F){return h(st(r(F),{replace:!0}))}function g(F){const V=F.matched[F.matched.length-1];if(V&&V.redirect){const{redirect:N}=V;let K=typeof N=="function"?N(F):N;return typeof K=="string"&&(K=K.includes("?")||K.includes("#")?K=r(K):{path:K},K.params={}),st({query:F.query,hash:F.hash,params:K.path!=null?{}:F.params},K)}}function x(F,V){const N=S=s(F),K=p.value,lt=F.state,y=F.force,m=F.replace===!0,U=g(N);if(U)return x(st(r(U),{state:typeof U=="object"?st({},lt,U.state):lt,force:y,replace:m}),V||N);const P=N;P.redirectedFrom=V;let L;return!y&&sf(l,K,N)&&(L=De(16,{to:P,from:K}),wt(K,K,!0,!1)),(L?Promise.resolve(L):T(P,K)).catch(I=>ie(I)?ie(I,2)?I:mt(I):J(I,P,K)).then(I=>{if(I){if(ie(I,2))return x(st({replace:m},r(I.to),{state:typeof I.to=="object"?st({},lt,I.to.state):lt,force:y}),V||P)}else I=j(P,K,!0,m,lt);return z(P,K,I),I})}function w(F,V){const N=f(F,V);return N?Promise.reject(N):Promise.resolve()}function A(F){const V=Dt.values().next().value;return V&&typeof V.runWithContext=="function"?V.runWithContext(F):F()}function T(F,V){let N;const[K,lt,y]=Yf(F,V);N=tn(K.reverse(),"beforeRouteLeave",F,V);for(const U of K)U.leaveGuards.forEach(P=>{N.push(he(P,F,V))});const m=w.bind(null,F,V);return N.push(m),Ot(N).then(()=>{N=[];for(const U of u.list())N.push(he(U,F,V));return N.push(m),Ot(N)}).then(()=>{N=tn(lt,"beforeRouteUpdate",F,V);for(const U of lt)U.updateGuards.forEach(P=>{N.push(he(P,F,V))});return N.push(m),Ot(N)}).then(()=>{N=[];for(const U of y)if(U.beforeEnter)if(Yt(U.beforeEnter))for(const P of U.beforeEnter)N.push(he(P,F,V));else N.push(he(U.beforeEnter,F,V));return N.push(m),Ot(N)}).then(()=>(F.matched.forEach(U=>U.enterCallbacks={}),N=tn(y,"beforeRouteEnter",F,V,A),N.push(m),Ot(N))).then(()=>{N=[];for(const U of d.list())N.push(he(U,F,V));return N.push(m),Ot(N)}).catch(U=>ie(U,8)?U:Promise.reject(U))}function z(F,V,N){o.list().forEach(K=>A(()=>K(F,V,N)))}function j(F,V,N,K,lt){const y=f(F,V);if(y)return y;const m=V===fe,U=Ae?history.state:{};N&&(K||m?c.replace(F.fullPath,st({scroll:m&&U&&U.scroll},lt)):c.push(F.fullPath,lt)),p.value=F,wt(F,V,N,m),mt()}let k;function it(){k||(k=c.listen((F,V,N)=>{if(!Q.listening)return;const K=s(F),lt=g(K);if(lt){x(st(lt,{replace:!0,force:!0}),K).catch(Je);return}S=K;const y=p.value;Ae&&hf(xs(y.fullPath,N.delta),Gi()),T(K,y).catch(m=>ie(m,12)?m:ie(m,2)?(x(st(r(m.to),{force:!0}),K).then(U=>{ie(U,20)&&!N.delta&&N.type===ai.pop&&c.go(-1,!1)}).catch(Je),Promise.reject()):(N.delta&&c.go(-N.delta,!1),J(m,K,y))).then(m=>{m=m||j(K,y,!1),m&&(N.delta&&!ie(m,8)?c.go(-N.delta,!1):N.type===ai.pop&&ie(m,20)&&c.go(-1,!1)),z(K,y,m)}).catch(Je)}))}let nt=Ve(),ht=Ve(),tt;function J(F,V,N){mt(F);const K=ht.list();return K.length?K.forEach(lt=>lt(F,V,N)):console.error(F),Promise.reject(F)}function pt(){return tt&&p.value!==fe?Promise.resolve():new Promise((F,V)=>{nt.add([F,V])})}function mt(F){return tt||(tt=!F,it(),nt.list().forEach(([V,N])=>F?N(F):V()),nt.reset()),F}function wt(F,V,N,K){const{scrollBehavior:lt}=e;if(!Ae||!lt)return Promise.resolve();const y=!N&&df(xs(F.fullPath,0))||(K||!N)&&history.state&&history.state.scroll||null;return hr().then(()=>lt(F,V,y)).then(m=>m&&uf(m)).catch(m=>J(m,F,V))}const yt=F=>c.go(F);let Ut;const Dt=new Set,Q={currentRoute:p,listening:!0,addRoute:C,removeRoute:B,clearRoutes:n.clearRoutes,hasRoute:t,getRoutes:H,resolve:s,options:e,push:h,replace:_,go:yt,back:()=>yt(-1),forward:()=>yt(1),beforeEach:u.add,beforeResolve:d.add,afterEach:o.add,onError:ht.add,isReady:pt,install(F){const V=this;F.component("RouterLink",Df),F.component("RouterView",Gf),F.config.globalProperties.$router=V,Object.defineProperty(F.config.globalProperties,"$route",{enumerable:!0,get:()=>Fe(p)}),Ae&&!Ut&&p.value===fe&&(Ut=!0,h(c.location).catch(lt=>{}));const N={};for(const lt in fe)Object.defineProperty(N,lt,{get:()=>p.value[lt],enumerable:!0});F.provide(Mn,V),F.provide(oo,ar(N)),F.provide(yn,p);const K=F.unmount;Dt.add(F),F.unmount=function(){Dt.delete(F),Dt.size<1&&(S=fe,k&&k(),k=null,p.value=fe,Ut=!1,tt=!1),K()}}};function Ot(F){return F.reduce((V,N)=>V.then(()=>A(N)),Promise.resolve())}return Q}function Yf(e,n){const a=[],l=[],c=[],u=Math.max(n.matched.length,e.matched.length);for(let d=0;d<u;d++){const o=n.matched[d];o&&(e.matched.find(S=>Me(S,o))?l.push(o):a.push(o));const p=e.matched[d];p&&(n.matched.find(S=>Me(S,p))||c.push(p))}return[a,l,c]}const jf={name:"MessagePage",data(){return{inputText:"",password:"",outputText:"",copyButtonText:"复制结果",isLoading:!1}},methods:{async encryptText(){if(!this.inputText||!this.password){this.outputText="请输入消息和密码";return}try{this.isLoading=!0,this.outputText="加密中...",this.outputText=await lo(this.inputText,this.password)}catch(e){this.outputText="加密失败: "+e.message}finally{this.isLoading=!1}},async decryptText(){if(!this.inputText||!this.password){this.outputText="请输入密文和密码";return}try{this.isLoading=!0,this.outputText="解密中...",this.outputText=await ao(this.inputText,this.password)}catch(e){this.outputText="解密失败: "+e.message}finally{this.isLoading=!1}},clearAll(){this.inputText="",this.password="",this.outputText=""},async copyToClipboard(){if(!this.outputText)return;const e=this.copyButtonText;try{await navigator.clipboard.writeText(this.outputText),this.copyButtonText="复制成功!"}catch{this.copyButtonText="复制失败!"}setTimeout(()=>{this.copyButtonText=e},1500)}}},Kf={class:"message-page"},Wf={class:"input-section"},qf={class:"button-group"},$f=["disabled"],Xf=["disabled"],Zf=["disabled"],Qf={class:"output-section"},Jf={class:"output-box"};function tc(e,n,a,l,c,u){return Pt(),Mt("div",Kf,[n[7]||(n[7]=Y("h2",null,"消息加密/解密",-1)),Y("div",Wf,[Tt(Y("textarea",{"onUpdate:modelValue":n[0]||(n[0]=d=>c.inputText=d),placeholder:"输入要加密的消息或要解密的密文"},null,512),[[Qt,c.inputText]]),Tt(Y("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=d=>c.password=d),placeholder:"输入密码"},null,512),[[Qt,c.password]]),Y("div",qf,[Y("button",{onClick:n[2]||(n[2]=(...d)=>u.encryptText&&u.encryptText(...d)),disabled:c.isLoading},"加密",8,$f),Y("button",{onClick:n[3]||(n[3]=(...d)=>u.decryptText&&u.decryptText(...d)),disabled:c.isLoading},"解密",8,Xf),Y("button",{onClick:n[4]||(n[4]=(...d)=>u.clearAll&&u.clearAll(...d)),disabled:c.isLoading},"清空",8,Zf)])]),Y("div",Qf,[n[6]||(n[6]=Y("h3",null,"结果:",-1)),Y("div",Jf,Re(c.outputText),1),c.outputText?(Pt(),Mt("button",{key:0,onClick:n[5]||(n[5]=(...d)=>u.copyToClipboard&&u.copyToClipboard(...d)),class:"copy-button"},Re(c.copyButtonText),1)):pe("",!0)])])}const ec=ui(jf,[["render",tc],["__scopeId","data-v-a73d2066"]]),ic={name:"FilePage",data(){return{selectedFileHandle:null,selectedFile:null,password:"",chunkSize:32,statusMessage:"",isLoading:!1,showPasswordChange:!1,newPassword:""}},methods:{async selectFile(){try{const[e]=await window.showOpenFilePicker({writable:!0,multiple:!1});this.selectedFileHandle=e,this.selectedFile=await e.getFile(),this.statusMessage=`已选择文件: ${this.selectedFile.name}`}catch(e){this.statusMessage="文件选择取消或出错: "+e.message}},async encryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}if(!(!this.password&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const e=`${this.selectedFile.name}.enc`,a=await(await window.showSaveFilePicker({suggestedName:e})).createWritable(),l=this.chunkSize*1024*1024;await Ds(async(c,u)=>{const d=await this.selectedFile.slice(c,u).arrayBuffer();return new Uint8Array(d)},c=>a.write(c),this.password,c=>{const u=Number(c/this.selectedFile.size*100);c>=this.selectedFile.size||u===100||u.toFixed(2)==="100.00"?this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。":this.statusMessage=`加密中... ${u.toFixed(2)}%`},null,null,l),await a.close(),this.statusMessage=`文件加密成功: ${e}`}catch(e){this.statusMessage="加密失败: "+e.message}finally{this.isLoading=!1}}},async decryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.isLoading=!0;try{const e=this.selectedFile.name.endsWith(".enc")?this.selectedFile.name.slice(0,-4):`decrypted_${this.selectedFile.name}`,a=await(await window.showSaveFilePicker({suggestedName:e})).createWritable();await Ms(async(l,c)=>{const u=await this.selectedFile.slice(l,c).arrayBuffer();return new Uint8Array(u)},l=>a.write(l),this.password,l=>{const c=Number(l/this.selectedFile.size*100);l>=this.selectedFile.size||c===100||c.toFixed(2)==="100.00"?this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。":this.statusMessage=`解密中... ${c.toFixed(2)}%`}),await a.close(),this.statusMessage=`文件解密成功: ${e}`}catch(e){this.statusMessage="解密失败: "+e.message}finally{this.isLoading=!1}},clearAll(){this.selectedFile=null,this.password="",this.statusMessage=""},changePassword(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.showPasswordChange=!0,this.newPassword="",this.confirmPassword=""},cancelPasswordChange(){this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},async confirmPasswordChange(){if(!(!this.newPassword&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{this.statusMessage="正在处理...";const e=this.selectedFileHandle,a=this.selectedFile.slice(0,5e3);this.statusMessage="正在更改密码，请稍候...";const l=await ks(a,this.password,this.newPassword);this.statusMessage="正在保存文件，请稍候...这可能需要一些时间。";const c=await e.createWritable({keepExistingData:!0});await c.write(l),await c.close(),this.statusMessage="密码更改成功",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""}catch(e){this.statusMessage="密码更改失败: "+e.message}finally{this.isLoading=!1}}}}},nc={class:"file-page"},sc={class:"input-section"},rc={class:"file-select-group"},oc={class:"file-name"},ac={class:"chunk-size-group"},lc={class:"chunk-size-header"},fc={class:"button-group",style:{"margin-top":"0.5em"}},cc=["disabled"],uc=["disabled"],hc=["disabled"],dc=["disabled"],pc={key:0,class:"password-change-section"},_c={class:"button-group"},gc=["disabled"],yc=["disabled"],mc={key:1,class:"status-section"},vc={class:"status-box"};function xc(e,n,a,l,c,u){return Pt(),Mt("div",nc,[n[14]||(n[14]=Y("h2",null,"文件加密/解密",-1)),Y("div",sc,[Y("div",rc,[Y("button",{onClick:n[0]||(n[0]=(...d)=>u.selectFile&&u.selectFile(...d)),style:{flex:"unset",padding:"10px 20px"}},"选择文件"),Y("div",oc,Re(c.selectedFile?.name||"没有选择文件"),1)]),Tt(Y("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=d=>c.password=d),placeholder:"输入密码"},null,512),[[Qt,c.password]]),Y("div",ac,[Y("div",lc,[n[10]||(n[10]=Y("label",null,"分块大小(MiB):",-1)),Tt(Y("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=d=>c.chunkSize=d),min:"1",max:"128"},null,512),[[Qt,c.chunkSize,void 0,{number:!0}]])]),n[11]||(n[11]=Gr('<details class="hint-box" open data-v-3f6cbc91><summary class="hint-title" data-v-3f6cbc91>分块大小建议:</summary><ul class="hint-list" data-v-3f6cbc91><li data-v-3f6cbc91><strong data-v-3f6cbc91>大文件(32MiB)</strong>: 整体文件处理，提高性能</li><li data-v-3f6cbc91><strong data-v-3f6cbc91>视频文件(5-32MiB)</strong>: 增强随机读取性能</li><li data-v-3f6cbc91><strong data-v-3f6cbc91>一般视频(5MiB)</strong>: 适合大多数视频文件</li><li data-v-3f6cbc91><strong data-v-3f6cbc91>较大视频(16-32MiB)</strong>: 适合高清/4K视频</li></ul><div class="warning-text" data-v-3f6cbc91> ⚠️ 注意: 分块太小会导致文件被分成过多块，可能产生大量请求次数，造成额外费用。 请根据文件类型和大小选择合适的分块大小。 </div></details>',1))]),Y("div",fc,[Y("button",{onClick:n[3]||(n[3]=(...d)=>u.encryptFile&&u.encryptFile(...d)),disabled:c.isLoading},"加密",8,cc),Y("button",{onClick:n[4]||(n[4]=(...d)=>u.decryptFile&&u.decryptFile(...d)),disabled:c.isLoading},"解密",8,uc),Y("button",{onClick:n[5]||(n[5]=(...d)=>u.changePassword&&u.changePassword(...d)),disabled:c.isLoading},"改密",8,hc),Y("button",{onClick:n[6]||(n[6]=(...d)=>u.clearAll&&u.clearAll(...d)),disabled:c.isLoading},"清除",8,dc)])]),c.showPasswordChange?(Pt(),Mt("div",pc,[n[12]||(n[12]=Y("h3",null,"更改密码",-1)),Tt(Y("input",{type:"password","onUpdate:modelValue":n[7]||(n[7]=d=>c.newPassword=d),placeholder:"输入新密码"},null,512),[[Qt,c.newPassword]]),Y("div",_c,[Y("button",{onClick:n[8]||(n[8]=(...d)=>u.confirmPasswordChange&&u.confirmPasswordChange(...d)),disabled:c.isLoading},"确认更改",8,gc),Y("button",{onClick:n[9]||(n[9]=(...d)=>u.cancelPasswordChange&&u.cancelPasswordChange(...d)),disabled:c.isLoading},"取消",8,yc)])])):pe("",!0),c.statusMessage?(Pt(),Mt("div",mc,[n[13]||(n[13]=Y("h3",null,"状态:",-1)),Y("div",vc,Re(c.statusMessage),1)])):pe("",!0)])}const bc=ui(ic,[["render",xc],["__scopeId","data-v-3f6cbc91"]]),Sc={name:"FileClassicPage",data(){return{selectedFile:null,password:"",chunkSize:32,statusMessage:"",isLoading:!1,showPasswordChange:!1,newPassword:"",confirmPassword:""}},methods:{handleFileChange(e){this.selectedFile=e.target.files[0],this.selectedFile&&(this.statusMessage=`已选择文件: ${this.selectedFile.name}`)},async encryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}if(!(!this.password&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const e=`${this.selectedFile.name}.enc`,n=document.createElement("a");n.style.display="none",document.body.appendChild(n);const a=this.chunkSize*1024*1024,l=[];await Ds(async(d,o)=>{const p=await this.selectedFile.slice(d,o).arrayBuffer();return new Uint8Array(p)},d=>{l.push(d)},this.password,d=>{const o=(d/this.selectedFile.size*100).toFixed(2);this.statusMessage=`加密中... ${o}%`},null,null,a);const c=new Blob(l,{type:"application/octet-stream"}),u=URL.createObjectURL(c);n.href=u,n.download=e,n.click(),URL.revokeObjectURL(u),document.body.removeChild(n),this.statusMessage=`文件加密成功: ${e}`}catch(e){this.statusMessage="加密失败: "+e.message}finally{this.isLoading=!1}}},async decryptFile(){if(!this.selectedFile){this.statusMessage="请选择文件";return}this.isLoading=!0;try{const e=this.selectedFile.name.endsWith(".enc")?this.selectedFile.name.slice(0,-4):`decrypted_${this.selectedFile.name}`,n=document.createElement("a");n.style.display="none",document.body.appendChild(n);const a=[];await Ms(async(u,d)=>{const o=await this.selectedFile.slice(u,d).arrayBuffer();return new Uint8Array(o)},u=>{a.push(u)},this.password,u=>{const d=(u/this.selectedFile.size*100).toFixed(2);this.statusMessage=`解密中... ${d}%`});const l=new Blob(a,{type:"application/octet-stream"}),c=URL.createObjectURL(l);n.href=c,n.download=e,n.click(),URL.revokeObjectURL(c),document.body.removeChild(n),this.statusMessage=`文件解密成功: ${e}`}catch(e){this.statusMessage="解密失败: "+e.message}finally{this.isLoading=!1}},clearAll(){this.$refs.fileInput.value="",this.selectedFile=null,this.password="",this.statusMessage="",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},changePassword(){if(!this.selectedFile){this.statusMessage="请选择文件并输入当前密码";return}this.showPasswordChange=!0,this.newPassword="",this.confirmPassword=""},cancelPasswordChange(){this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""},async confirmPasswordChange(){if(!(!this.newPassword&&!confirm("确定要使用空密码？这非常不安全！"))){this.isLoading=!0;try{const e=this.selectedFile.slice(0,5e3),n=await ks(e,this.password,this.newPassword),a=document.createElement("a");a.style.display="none",document.body.appendChild(a);const l=URL.createObjectURL(new Blob([n,this.selectedFile.slice(n.size)],{type:"application/octet-stream"}));a.href=l,a.download=this.selectedFile.name,a.click(),URL.revokeObjectURL(l),document.body.removeChild(a),this.statusMessage="密码更改成功",this.showPasswordChange=!1,this.newPassword="",this.confirmPassword=""}catch(e){this.statusMessage="密码更改失败: "+e.message}finally{this.isLoading=!1}}}}},wc={class:"file-page"},Uc={class:"input-section"},Ec={class:"chunk-size-group"},Bc={class:"chunk-size-header"},Cc={class:"button-group",style:{"margin-top":"0.5em"}},Ac=["disabled"],Tc=["disabled"],Pc=["disabled"],Fc=["disabled"],Ic={key:0,class:"password-change-section"},Lc={class:"button-group"},zc=["disabled"],Rc=["disabled"],kc={key:0,class:"status-section"},Mc={class:"status-box"};function Dc(e,n,a,l,c,u){return Pt(),Mt("div",wc,[n[14]||(n[14]=Y("h2",null,"文件加密/解密(兼容版)",-1)),Y("div",Uc,[Y("input",{type:"file",ref:"fileInput",onChange:n[0]||(n[0]=(...d)=>u.handleFileChange&&u.handleFileChange(...d))},null,544),Tt(Y("input",{type:"password","onUpdate:modelValue":n[1]||(n[1]=d=>c.password=d),placeholder:"输入密码"},null,512),[[Qt,c.password]]),Y("div",Ec,[Y("div",Bc,[n[10]||(n[10]=Y("label",null,"分块大小(MiB):",-1)),Tt(Y("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=d=>c.chunkSize=d),min:"1",max:"128"},null,512),[[Qt,c.chunkSize,void 0,{number:!0}]])]),n[11]||(n[11]=Gr('<details class="hint-box" open data-v-229e1619><summary class="hint-title" data-v-229e1619>分块大小建议:</summary><ul class="hint-list" data-v-229e1619><li data-v-229e1619><strong data-v-229e1619>大文件(32MiB)</strong>: 整体文件处理，提高性能</li><li data-v-229e1619><strong data-v-229e1619>视频文件(5-32MiB)</strong>: 增强随机读取性能</li><li data-v-229e1619><strong data-v-229e1619>一般视频(5MiB)</strong>: 适合大多数视频文件</li><li data-v-229e1619><strong data-v-229e1619>较大视频(16-32MiB)</strong>: 适合高清/4K视频</li></ul><div class="warning-text" data-v-229e1619> ⚠️ 注意: 分块太小会导致文件被分成过多块，可能产生大量请求次数，造成额外费用。 请根据文件类型和大小选择合适的分块大小。 </div></details>',1))]),Y("div",Cc,[Y("button",{onClick:n[3]||(n[3]=(...d)=>u.encryptFile&&u.encryptFile(...d)),disabled:c.isLoading},"加密",8,Ac),Y("button",{onClick:n[4]||(n[4]=(...d)=>u.decryptFile&&u.decryptFile(...d)),disabled:c.isLoading},"解密",8,Tc),Y("button",{onClick:n[5]||(n[5]=(...d)=>u.changePassword&&u.changePassword(...d)),disabled:c.isLoading},"改密",8,Pc),Y("button",{onClick:n[6]||(n[6]=(...d)=>u.clearAll&&u.clearAll(...d)),disabled:c.isLoading},"清除",8,Fc)]),c.showPasswordChange?(Pt(),Mt("div",Ic,[n[12]||(n[12]=Y("h3",null,"更改密码",-1)),Tt(Y("input",{type:"password","onUpdate:modelValue":n[7]||(n[7]=d=>c.newPassword=d),placeholder:"输入新密码"},null,512),[[Qt,c.newPassword]]),Y("div",Lc,[Y("button",{onClick:n[8]||(n[8]=(...d)=>u.confirmPasswordChange&&u.confirmPasswordChange(...d)),disabled:c.isLoading},"确认更改",8,zc),Y("button",{onClick:n[9]||(n[9]=(...d)=>u.cancelPasswordChange&&u.cancelPasswordChange(...d)),disabled:c.isLoading},"取消",8,Rc)])])):pe("",!0)]),c.statusMessage?(Pt(),Mt("div",kc,[n[13]||(n[13]=Y("h3",null,"状态:",-1)),Y("div",Mc,Re(c.statusMessage),1)])):pe("",!0)])}const Oc=ui(Sc,[["render",Dc],["__scopeId","data-v-229e1619"]]);function Nc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var en={},Rs;function Hc(){return Rs||(Rs=1,function(e){var n=function(){var t=new Date,s=4,r=3,f=2,h=1,_=s,g={setLogLevel:function(x){x==this.debug?_=h:x==this.info?_=f:x==this.warn?_=r:(x==this.error,_=s)},debug:function(x,w){console.debug===void 0&&(console.debug=console.log),h>=_&&console.debug("["+n.getDurationString(new Date-t,1e3)+"]","["+x+"]",w)},log:function(x,w){this.debug(x.msg)},info:function(x,w){f>=_&&console.info("["+n.getDurationString(new Date-t,1e3)+"]","["+x+"]",w)},warn:function(x,w){r>=_&&console.warn("["+n.getDurationString(new Date-t,1e3)+"]","["+x+"]",w)},error:function(x,w){s>=_&&console.error("["+n.getDurationString(new Date-t,1e3)+"]","["+x+"]",w)}};return g}();n.getDurationString=function(t,s){var r;function f(A,T){for(var z=""+A,j=z.split(".");j[0].length<T;)j[0]="0"+j[0];return j.join(".")}t<0?(r=!0,t=-t):r=!1;var h=s||1,_=t/h,g=Math.floor(_/3600);_-=g*3600;var x=Math.floor(_/60);_-=x*60;var w=_*1e3;return _=Math.floor(_),w-=_*1e3,w=Math.floor(w),(r?"-":"")+g+":"+f(x,2)+":"+f(_,2)+"."+f(w,3)},n.printRanges=function(t){var s=t.length;if(s>0){for(var r="",f=0;f<s;f++)f>0&&(r+=","),r+="["+n.getDurationString(t.start(f))+","+n.getDurationString(t.end(f))+"]";return r}else return"(empty)"},e.Log=n;var a=function(t){if(t instanceof ArrayBuffer)this.buffer=t,this.dataview=new DataView(t);else throw"Needs an array buffer";this.position=0};a.prototype.getPosition=function(){return this.position},a.prototype.getEndPosition=function(){return this.buffer.byteLength},a.prototype.getLength=function(){return this.buffer.byteLength},a.prototype.seek=function(t){var s=Math.max(0,Math.min(this.buffer.byteLength,t));return this.position=isNaN(s)||!isFinite(s)?0:s,!0},a.prototype.isEos=function(){return this.getPosition()>=this.getEndPosition()},a.prototype.readAnyInt=function(t,s){var r=0;if(this.position+t<=this.buffer.byteLength){switch(t){case 1:s?r=this.dataview.getInt8(this.position):r=this.dataview.getUint8(this.position);break;case 2:s?r=this.dataview.getInt16(this.position):r=this.dataview.getUint16(this.position);break;case 3:if(s)throw"No method for reading signed 24 bits values";r=this.dataview.getUint8(this.position)<<16,r|=this.dataview.getUint8(this.position+1)<<8,r|=this.dataview.getUint8(this.position+2);break;case 4:s?r=this.dataview.getInt32(this.position):r=this.dataview.getUint32(this.position);break;case 8:if(s)throw"No method for reading signed 64 bits values";r=this.dataview.getUint32(this.position)<<32,r|=this.dataview.getUint32(this.position+4);break;default:throw"readInt method not implemented for size: "+t}return this.position+=t,r}else throw"Not enough bytes in buffer"},a.prototype.readUint8=function(){return this.readAnyInt(1,!1)},a.prototype.readUint16=function(){return this.readAnyInt(2,!1)},a.prototype.readUint24=function(){return this.readAnyInt(3,!1)},a.prototype.readUint32=function(){return this.readAnyInt(4,!1)},a.prototype.readUint64=function(){return this.readAnyInt(8,!1)},a.prototype.readString=function(t){if(this.position+t<=this.buffer.byteLength){for(var s="",r=0;r<t;r++)s+=String.fromCharCode(this.readUint8());return s}else throw"Not enough bytes in buffer"},a.prototype.readCString=function(){for(var t=[];;){var s=this.readUint8();if(s!==0)t.push(s);else break}return String.fromCharCode.apply(null,t)},a.prototype.readInt8=function(){return this.readAnyInt(1,!0)},a.prototype.readInt16=function(){return this.readAnyInt(2,!0)},a.prototype.readInt32=function(){return this.readAnyInt(4,!0)},a.prototype.readInt64=function(){return this.readAnyInt(8,!1)},a.prototype.readUint8Array=function(t){for(var s=new Uint8Array(t),r=0;r<t;r++)s[r]=this.readUint8();return s},a.prototype.readInt16Array=function(t){for(var s=new Int16Array(t),r=0;r<t;r++)s[r]=this.readInt16();return s},a.prototype.readUint16Array=function(t){for(var s=new Int16Array(t),r=0;r<t;r++)s[r]=this.readUint16();return s},a.prototype.readUint32Array=function(t){for(var s=new Uint32Array(t),r=0;r<t;r++)s[r]=this.readUint32();return s},a.prototype.readInt32Array=function(t){for(var s=new Int32Array(t),r=0;r<t;r++)s[r]=this.readInt32();return s},e.MP4BoxStream=a;var l=function(t,s,r){this._byteOffset=s||0,t instanceof ArrayBuffer?this.buffer=t:typeof t=="object"?(this.dataView=t,s&&(this._byteOffset+=s)):this.buffer=new ArrayBuffer(t||0),this.position=0,this.endianness=r??l.LITTLE_ENDIAN};l.prototype={},l.prototype.getPosition=function(){return this.position},l.prototype._realloc=function(t){if(this._dynamicSize){var s=this._byteOffset+this.position+t,r=this._buffer.byteLength;if(s<=r){s>this._byteLength&&(this._byteLength=s);return}for(r<1&&(r=1);s>r;)r*=2;var f=new ArrayBuffer(r),h=new Uint8Array(this._buffer),_=new Uint8Array(f,0,h.length);_.set(h),this.buffer=f,this._byteLength=s}},l.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var t=new ArrayBuffer(this._byteLength),s=new Uint8Array(t),r=new Uint8Array(this._buffer,0,s.length);s.set(r),this.buffer=t}},l.BIG_ENDIAN=!1,l.LITTLE_ENDIAN=!0,l.prototype._byteLength=0,Object.defineProperty(l.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(l.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(t){this._buffer=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(l.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(t){this._byteOffset=t,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(l.prototype,"dataView",{get:function(){return this._dataView},set:function(t){this._byteOffset=t.byteOffset,this._buffer=t.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+t.byteLength}}),l.prototype.seek=function(t){var s=Math.max(0,Math.min(this.byteLength,t));this.position=isNaN(s)||!isFinite(s)?0:s},l.prototype.isEof=function(){return this.position>=this._byteLength},l.prototype.mapUint8Array=function(t){this._realloc(t*1);var s=new Uint8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=t*1,s},l.prototype.readInt32Array=function(t,s){t=t??this.byteLength-this.position/4;var r=new Int32Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readInt16Array=function(t,s){t=t??this.byteLength-this.position/2;var r=new Int16Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readInt8Array=function(t){t=t??this.byteLength-this.position;var s=new Int8Array(t);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,t*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},l.prototype.readUint32Array=function(t,s){t=t??this.byteLength-this.position/4;var r=new Uint32Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readUint16Array=function(t,s){t=t??this.byteLength-this.position/2;var r=new Uint16Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readUint8Array=function(t){t=t??this.byteLength-this.position;var s=new Uint8Array(t);return l.memcpy(s.buffer,0,this.buffer,this.byteOffset+this.position,t*s.BYTES_PER_ELEMENT),this.position+=s.byteLength,s},l.prototype.readFloat64Array=function(t,s){t=t??this.byteLength-this.position/8;var r=new Float64Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readFloat32Array=function(t,s){t=t??this.byteLength-this.position/4;var r=new Float32Array(t);return l.memcpy(r.buffer,0,this.buffer,this.byteOffset+this.position,t*r.BYTES_PER_ELEMENT),l.arrayToNative(r,s??this.endianness),this.position+=r.byteLength,r},l.prototype.readInt32=function(t){var s=this._dataView.getInt32(this.position,t??this.endianness);return this.position+=4,s},l.prototype.readInt16=function(t){var s=this._dataView.getInt16(this.position,t??this.endianness);return this.position+=2,s},l.prototype.readInt8=function(){var t=this._dataView.getInt8(this.position);return this.position+=1,t},l.prototype.readUint32=function(t){var s=this._dataView.getUint32(this.position,t??this.endianness);return this.position+=4,s},l.prototype.readUint16=function(t){var s=this._dataView.getUint16(this.position,t??this.endianness);return this.position+=2,s},l.prototype.readUint8=function(){var t=this._dataView.getUint8(this.position);return this.position+=1,t},l.prototype.readFloat32=function(t){var s=this._dataView.getFloat32(this.position,t??this.endianness);return this.position+=4,s},l.prototype.readFloat64=function(t){var s=this._dataView.getFloat64(this.position,t??this.endianness);return this.position+=8,s},l.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,l.memcpy=function(t,s,r,f,h){var _=new Uint8Array(t,s,h),g=new Uint8Array(r,f,h);_.set(g)},l.arrayToNative=function(t,s){return s==this.endianness?t:this.flipArrayEndianness(t)},l.nativeToEndian=function(t,s){return this.endianness==s?t:this.flipArrayEndianness(t)},l.flipArrayEndianness=function(t){for(var s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r=0;r<t.byteLength;r+=t.BYTES_PER_ELEMENT)for(var f=r+t.BYTES_PER_ELEMENT-1,h=r;f>h;f--,h++){var _=s[h];s[h]=s[f],s[f]=_}return t},l.prototype.failurePosition=0,String.fromCharCodeUint8=function(t){for(var s=[],r=0;r<t.length;r++)s[r]=t[r];return String.fromCharCode.apply(null,s)},l.prototype.readString=function(t,s){return s==null||s=="ASCII"?String.fromCharCodeUint8.apply(null,[this.mapUint8Array(t??this.byteLength-this.position)]):new TextDecoder(s).decode(this.mapUint8Array(t))},l.prototype.readCString=function(t){var s=this.byteLength-this.position,r=new Uint8Array(this._buffer,this._byteOffset+this.position),f=s;t!=null&&(f=Math.min(t,s));for(var h=0;h<f&&r[h]!==0;h++);var _=String.fromCharCodeUint8.apply(null,[this.mapUint8Array(h)]);return t!=null?this.position+=f-h:h!=s&&(this.position+=1),_};var c=Math.pow(2,32);l.prototype.readInt64=function(){return this.readInt32()*c+this.readUint32()},l.prototype.readUint64=function(){return this.readUint32()*c+this.readUint32()},l.prototype.readInt64=function(){return this.readUint32()*c+this.readUint32()},l.prototype.readUint24=function(){return(this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8()},e.DataStream=l,l.prototype.save=function(t){var s=new Blob([this.buffer]);if(window.URL&&URL.createObjectURL){var r=window.URL.createObjectURL(s),f=document.createElement("a");document.body.appendChild(f),f.setAttribute("href",r),f.setAttribute("download",t),f.setAttribute("target","_self"),f.click(),window.URL.revokeObjectURL(r)}else throw"DataStream.save: Can't create object URL."},l.prototype._dynamicSize=!0,Object.defineProperty(l.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(t){t||this._trimAlloc(),this._dynamicSize=t}}),l.prototype.shift=function(t){var s=new ArrayBuffer(this._byteLength-t),r=new Uint8Array(s),f=new Uint8Array(this._buffer,t,r.length);r.set(f),this.buffer=s,this.position-=t},l.prototype.writeInt32Array=function(t,s){if(this._realloc(t.length*4),t instanceof Int32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt32Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeInt32(t[r],s)},l.prototype.writeInt16Array=function(t,s){if(this._realloc(t.length*2),t instanceof Int16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt16Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeInt16(t[r],s)},l.prototype.writeInt8Array=function(t){if(this._realloc(t.length*1),t instanceof Int8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapInt8Array(t.length);else for(var s=0;s<t.length;s++)this.writeInt8(t[s])},l.prototype.writeUint32Array=function(t,s){if(this._realloc(t.length*4),t instanceof Uint32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint32Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeUint32(t[r],s)},l.prototype.writeUint16Array=function(t,s){if(this._realloc(t.length*2),t instanceof Uint16Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint16Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeUint16(t[r],s)},l.prototype.writeUint8Array=function(t){if(this._realloc(t.length*1),t instanceof Uint8Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapUint8Array(t.length);else for(var s=0;s<t.length;s++)this.writeUint8(t[s])},l.prototype.writeFloat64Array=function(t,s){if(this._realloc(t.length*8),t instanceof Float64Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat64Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeFloat64(t[r],s)},l.prototype.writeFloat32Array=function(t,s){if(this._realloc(t.length*4),t instanceof Float32Array&&this.byteOffset+this.position%t.BYTES_PER_ELEMENT===0)l.memcpy(this._buffer,this.byteOffset+this.position,t.buffer,0,t.byteLength),this.mapFloat32Array(t.length,s);else for(var r=0;r<t.length;r++)this.writeFloat32(t[r],s)},l.prototype.writeInt32=function(t,s){this._realloc(4),this._dataView.setInt32(this.position,t,s??this.endianness),this.position+=4},l.prototype.writeInt16=function(t,s){this._realloc(2),this._dataView.setInt16(this.position,t,s??this.endianness),this.position+=2},l.prototype.writeInt8=function(t){this._realloc(1),this._dataView.setInt8(this.position,t),this.position+=1},l.prototype.writeUint32=function(t,s){this._realloc(4),this._dataView.setUint32(this.position,t,s??this.endianness),this.position+=4},l.prototype.writeUint16=function(t,s){this._realloc(2),this._dataView.setUint16(this.position,t,s??this.endianness),this.position+=2},l.prototype.writeUint8=function(t){this._realloc(1),this._dataView.setUint8(this.position,t),this.position+=1},l.prototype.writeFloat32=function(t,s){this._realloc(4),this._dataView.setFloat32(this.position,t,s??this.endianness),this.position+=4},l.prototype.writeFloat64=function(t,s){this._realloc(8),this._dataView.setFloat64(this.position,t,s??this.endianness),this.position+=8},l.prototype.writeUCS2String=function(t,s,r){r==null&&(r=t.length);for(var f=0;f<t.length&&f<r;f++)this.writeUint16(t.charCodeAt(f),s);for(;f<r;f++)this.writeUint16(0)},l.prototype.writeString=function(t,s,r){var f=0;if(s==null||s=="ASCII")if(r!=null){var h=Math.min(t.length,r);for(f=0;f<h;f++)this.writeUint8(t.charCodeAt(f));for(;f<r;f++)this.writeUint8(0)}else for(f=0;f<t.length;f++)this.writeUint8(t.charCodeAt(f));else this.writeUint8Array(new TextEncoder(s).encode(t.substring(0,r)))},l.prototype.writeCString=function(t,s){var r=0;if(s!=null){var f=Math.min(t.length,s);for(r=0;r<f;r++)this.writeUint8(t.charCodeAt(r));for(;r<s;r++)this.writeUint8(0)}else{for(r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));this.writeUint8(0)}},l.prototype.writeStruct=function(t,s){for(var r=0;r<t.length;r+=2){var f=t[r+1];this.writeType(f,s[t[r]],s)}},l.prototype.writeType=function(t,s,r){var f;if(typeof t=="function")return t(this,s);if(typeof t=="object"&&!(t instanceof Array))return t.set(this,s,r);var h=null,_="ASCII",g=this.position;switch(typeof t=="string"&&/:/.test(t)&&(f=t.split(":"),t=f[0],h=parseInt(f[1])),typeof t=="string"&&/,/.test(t)&&(f=t.split(","),t=f[0],_=parseInt(f[1])),t){case"uint8":this.writeUint8(s);break;case"int8":this.writeInt8(s);break;case"uint16":this.writeUint16(s,this.endianness);break;case"int16":this.writeInt16(s,this.endianness);break;case"uint32":this.writeUint32(s,this.endianness);break;case"int32":this.writeInt32(s,this.endianness);break;case"float32":this.writeFloat32(s,this.endianness);break;case"float64":this.writeFloat64(s,this.endianness);break;case"uint16be":this.writeUint16(s,l.BIG_ENDIAN);break;case"int16be":this.writeInt16(s,l.BIG_ENDIAN);break;case"uint32be":this.writeUint32(s,l.BIG_ENDIAN);break;case"int32be":this.writeInt32(s,l.BIG_ENDIAN);break;case"float32be":this.writeFloat32(s,l.BIG_ENDIAN);break;case"float64be":this.writeFloat64(s,l.BIG_ENDIAN);break;case"uint16le":this.writeUint16(s,l.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(s,l.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(s,l.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(s,l.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(s,l.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(s,l.LITTLE_ENDIAN);break;case"cstring":this.writeCString(s,h);break;case"string":this.writeString(s,_,h);break;case"u16string":this.writeUCS2String(s,this.endianness,h);break;case"u16stringle":this.writeUCS2String(s,l.LITTLE_ENDIAN,h);break;case"u16stringbe":this.writeUCS2String(s,l.BIG_ENDIAN,h);break;default:if(t.length==3){for(var x=t[1],w=0;w<s.length;w++)this.writeType(x,s[w]);break}else{this.writeStruct(t,s);break}}h!=null&&(this.position=g,this._realloc(h),this.position=g+h)},l.prototype.writeUint64=function(t){var s=Math.floor(t/c);this.writeUint32(s),this.writeUint32(t&4294967295)},l.prototype.writeUint24=function(t){this.writeUint8((t&16711680)>>16),this.writeUint8((t&65280)>>8),this.writeUint8(t&255)},l.prototype.adjustUint32=function(t,s){var r=this.position;this.seek(t),this.writeUint32(s),this.seek(r)},l.prototype.mapInt32Array=function(t,s){this._realloc(t*4);var r=new Int32Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*4,r},l.prototype.mapInt16Array=function(t,s){this._realloc(t*2);var r=new Int16Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*2,r},l.prototype.mapInt8Array=function(t){this._realloc(t*1);var s=new Int8Array(this._buffer,this.byteOffset+this.position,t);return this.position+=t*1,s},l.prototype.mapUint32Array=function(t,s){this._realloc(t*4);var r=new Uint32Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*4,r},l.prototype.mapUint16Array=function(t,s){this._realloc(t*2);var r=new Uint16Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*2,r},l.prototype.mapFloat64Array=function(t,s){this._realloc(t*8);var r=new Float64Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*8,r},l.prototype.mapFloat32Array=function(t,s){this._realloc(t*4);var r=new Float32Array(this._buffer,this.byteOffset+this.position,t);return l.arrayToNative(r,s??this.endianness),this.position+=t*4,r};var u=function(t){this.buffers=[],this.bufferIndex=-1,t&&(this.insertBuffer(t),this.bufferIndex=0)};u.prototype=new l(new ArrayBuffer,0,l.BIG_ENDIAN),u.prototype.initialized=function(){var t;return this.bufferIndex>-1?!0:this.buffers.length>0?(t=this.buffers[0],t.fileStart===0?(this.buffer=t,this.bufferIndex=0,n.debug("MultiBufferStream","Stream ready for parsing"),!0):(n.warn("MultiBufferStream","The first buffer should have a fileStart of 0"),this.logBufferLevel(),!1)):(n.warn("MultiBufferStream","No buffer to start parsing from"),this.logBufferLevel(),!1)},ArrayBuffer.concat=function(t,s){n.debug("ArrayBuffer","Trying to create a new buffer of size: "+(t.byteLength+s.byteLength));var r=new Uint8Array(t.byteLength+s.byteLength);return r.set(new Uint8Array(t),0),r.set(new Uint8Array(s),t.byteLength),r.buffer},u.prototype.reduceBuffer=function(t,s,r){var f;return f=new Uint8Array(r),f.set(new Uint8Array(t,s,r)),f.buffer.fileStart=t.fileStart+s,f.buffer.usedBytes=0,f.buffer},u.prototype.insertBuffer=function(t){for(var s=!0,r=0;r<this.buffers.length;r++){var f=this.buffers[r];if(t.fileStart<=f.fileStart){if(t.fileStart===f.fileStart)if(t.byteLength>f.byteLength){this.buffers.splice(r,1),r--;continue}else n.warn("MultiBufferStream","Buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+") already appended, ignoring");else t.fileStart+t.byteLength<=f.fileStart||(t=this.reduceBuffer(t,0,f.fileStart-t.fileStart)),n.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.splice(r,0,t),r===0&&(this.buffer=t);s=!1;break}else if(t.fileStart<f.fileStart+f.byteLength){var h=f.fileStart+f.byteLength-t.fileStart,_=t.byteLength-h;if(_>0)t=this.reduceBuffer(t,h,_);else{s=!1;break}}}s&&(n.debug("MultiBufferStream","Appending new buffer (fileStart: "+t.fileStart+" - Length: "+t.byteLength+")"),this.buffers.push(t),r===0&&(this.buffer=t))},u.prototype.logBufferLevel=function(t){var s,r,f,h,_=[],g,x="";for(f=0,h=0,s=0;s<this.buffers.length;s++)r=this.buffers[s],s===0?(g={},_.push(g),g.start=r.fileStart,g.end=r.fileStart+r.byteLength,x+="["+g.start+"-"):g.end===r.fileStart?g.end=r.fileStart+r.byteLength:(g={},g.start=r.fileStart,x+=_[_.length-1].end-1+"], ["+g.start+"-",g.end=r.fileStart+r.byteLength,_.push(g)),f+=r.usedBytes,h+=r.byteLength;_.length>0&&(x+=g.end-1+"]");var w=t?n.info:n.debug;this.buffers.length===0?w("MultiBufferStream","No more buffer in memory"):w("MultiBufferStream",""+this.buffers.length+" stored buffer(s) ("+f+"/"+h+" bytes), continuous ranges: "+x)},u.prototype.cleanBuffers=function(){var t,s;for(t=0;t<this.buffers.length;t++)s=this.buffers[t],s.usedBytes===s.byteLength&&(n.debug("MultiBufferStream","Removing buffer #"+t),this.buffers.splice(t,1),t--)},u.prototype.mergeNextBuffer=function(){var t;if(this.bufferIndex+1<this.buffers.length)if(t=this.buffers[this.bufferIndex+1],t.fileStart===this.buffer.fileStart+this.buffer.byteLength){var s=this.buffer.byteLength,r=this.buffer.usedBytes,f=this.buffer.fileStart;return this.buffers[this.bufferIndex]=ArrayBuffer.concat(this.buffer,t),this.buffer=this.buffers[this.bufferIndex],this.buffers.splice(this.bufferIndex+1,1),this.buffer.usedBytes=r,this.buffer.fileStart=f,n.debug("ISOFile","Concatenating buffer for box parsing (length: "+s+"->"+this.buffer.byteLength+")"),!0}else return!1;else return!1},u.prototype.findPosition=function(t,s,r){var f,h=null,_=-1;for(t===!0?f=0:f=this.bufferIndex;f<this.buffers.length&&(h=this.buffers[f],h.fileStart<=s);){_=f,r&&(h.fileStart+h.byteLength<=s?h.usedBytes=h.byteLength:h.usedBytes=s-h.fileStart,this.logBufferLevel());f++}return _!==-1?(h=this.buffers[_],h.fileStart+h.byteLength>=s?(n.debug("MultiBufferStream","Found position in existing buffer #"+_),_):-1):-1},u.prototype.findEndContiguousBuf=function(t){var s,r,f,h=t!==void 0?t:this.bufferIndex;if(r=this.buffers[h],this.buffers.length>h+1)for(s=h+1;s<this.buffers.length&&(f=this.buffers[s],f.fileStart===r.fileStart+r.byteLength);s++)r=f;return r.fileStart+r.byteLength},u.prototype.getEndFilePositionAfter=function(t){var s=this.findPosition(!0,t,!1);return s!==-1?this.findEndContiguousBuf(s):t},u.prototype.addUsedBytes=function(t){this.buffer.usedBytes+=t,this.logBufferLevel()},u.prototype.setAllUsedBytes=function(){this.buffer.usedBytes=this.buffer.byteLength,this.logBufferLevel()},u.prototype.seek=function(t,s,r){var f;return f=this.findPosition(s,t,r),f!==-1?(this.buffer=this.buffers[f],this.bufferIndex=f,this.position=t-this.buffer.fileStart,n.debug("MultiBufferStream","Repositioning parser at buffer position: "+this.position),!0):(n.debug("MultiBufferStream","Position "+t+" not found in buffered data"),!1)},u.prototype.getPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.position},u.prototype.getLength=function(){return this.byteLength},u.prototype.getEndPosition=function(){if(this.bufferIndex===-1||this.buffers[this.bufferIndex]===null)throw"Error accessing position in the MultiBufferStream";return this.buffers[this.bufferIndex].fileStart+this.byteLength},e.MultiBufferStream=u;var d=function(){var t=3,s=4,r=5,f=6,h=[];h[t]="ES_Descriptor",h[s]="DecoderConfigDescriptor",h[r]="DecoderSpecificInfo",h[f]="SLConfigDescriptor",this.getDescriptorName=function(x){return h[x]};var _=this,g={};return this.parseOneDescriptor=function(x){var w=0,A,T,z;for(A=x.readUint8(),z=x.readUint8();z&128;)w=(w<<7)+(z&127),z=x.readUint8();return w=(w<<7)+(z&127),n.debug("MPEG4DescriptorParser","Found "+(h[A]||"Descriptor "+A)+", size "+w+" at position "+x.getPosition()),h[A]?T=new g[h[A]](w):T=new g.Descriptor(w),T.parse(x),T},g.Descriptor=function(x,w){this.tag=x,this.size=w,this.descs=[]},g.Descriptor.prototype.parse=function(x){this.data=x.readUint8Array(this.size)},g.Descriptor.prototype.findDescriptor=function(x){for(var w=0;w<this.descs.length;w++)if(this.descs[w].tag==x)return this.descs[w];return null},g.Descriptor.prototype.parseRemainingDescriptors=function(x){for(var w=x.position;x.position<w+this.size;){var A=_.parseOneDescriptor(x);this.descs.push(A)}},g.ES_Descriptor=function(x){g.Descriptor.call(this,t,x)},g.ES_Descriptor.prototype=new g.Descriptor,g.ES_Descriptor.prototype.parse=function(x){if(this.ES_ID=x.readUint16(),this.flags=x.readUint8(),this.size-=3,this.flags&128?(this.dependsOn_ES_ID=x.readUint16(),this.size-=2):this.dependsOn_ES_ID=0,this.flags&64){var w=x.readUint8();this.URL=x.readString(w),this.size-=w+1}else this.URL="";this.flags&32?(this.OCR_ES_ID=x.readUint16(),this.size-=2):this.OCR_ES_ID=0,this.parseRemainingDescriptors(x)},g.ES_Descriptor.prototype.getOTI=function(x){var w=this.findDescriptor(s);return w?w.oti:0},g.ES_Descriptor.prototype.getAudioConfig=function(x){var w=this.findDescriptor(s);if(!w)return null;var A=w.findDescriptor(r);if(A&&A.data){var T=(A.data[0]&248)>>3;return T===31&&A.data.length>=2&&(T=32+((A.data[0]&7)<<3)+((A.data[1]&224)>>5)),T}else return null},g.DecoderConfigDescriptor=function(x){g.Descriptor.call(this,s,x)},g.DecoderConfigDescriptor.prototype=new g.Descriptor,g.DecoderConfigDescriptor.prototype.parse=function(x){this.oti=x.readUint8(),this.streamType=x.readUint8(),this.upStream=(this.streamType>>1&1)!==0,this.streamType=this.streamType>>>2,this.bufferSize=x.readUint24(),this.maxBitrate=x.readUint32(),this.avgBitrate=x.readUint32(),this.size-=13,this.parseRemainingDescriptors(x)},g.DecoderSpecificInfo=function(x){g.Descriptor.call(this,r,x)},g.DecoderSpecificInfo.prototype=new g.Descriptor,g.SLConfigDescriptor=function(x){g.Descriptor.call(this,f,x)},g.SLConfigDescriptor.prototype=new g.Descriptor,this};e.MPEG4DescriptorParser=d;var o={ERR_INVALID_DATA:-1,ERR_NOT_ENOUGH_DATA:0,OK:1,BASIC_BOXES:[{type:"mdat",name:"MediaDataBox"},{type:"idat",name:"ItemDataBox"},{type:"free",name:"FreeSpaceBox"},{type:"skip",name:"FreeSpaceBox"},{type:"meco",name:"AdditionalMetadataContainerBox"},{type:"strk",name:"SubTrackBox"}],FULL_BOXES:[{type:"hmhd",name:"HintMediaHeaderBox"},{type:"nmhd",name:"NullMediaHeaderBox"},{type:"iods",name:"ObjectDescriptorBox"},{type:"xml ",name:"XMLBox"},{type:"bxml",name:"BinaryXMLBox"},{type:"ipro",name:"ItemProtectionBox"},{type:"mere",name:"MetaboxRelationBox"}],CONTAINER_BOXES:[[{type:"moov",name:"CompressedMovieBox"},["trak","pssh"]],[{type:"trak",name:"TrackBox"}],[{type:"edts",name:"EditBox"}],[{type:"mdia",name:"MediaBox"}],[{type:"minf",name:"MediaInformationBox"}],[{type:"dinf",name:"DataInformationBox"}],[{type:"stbl",name:"SampleTableBox"},["sgpd","sbgp"]],[{type:"mvex",name:"MovieExtendsBox"},["trex"]],[{type:"moof",name:"CompressedMovieFragmentBox"},["traf"]],[{type:"traf",name:"TrackFragmentBox"},["trun","sgpd","sbgp"]],[{type:"vttc",name:"VTTCueBox"}],[{type:"tref",name:"TrackReferenceBox"}],[{type:"iref",name:"ItemReferenceBox"}],[{type:"mfra",name:"MovieFragmentRandomAccessBox"},["tfra"]],[{type:"meco",name:"AdditionalMetadataContainerBox"}],[{type:"hnti",name:"trackhintinformation"}],[{type:"hinf",name:"hintstatisticsbox"}],[{type:"strk",name:"SubTrackBox"}],[{type:"strd",name:"SubTrackDefinitionBox"}],[{type:"sinf",name:"ProtectionSchemeInfoBox"}],[{type:"rinf",name:"RestrictedSchemeInfoBox"}],[{type:"schi",name:"SchemeInformationBox"}],[{type:"trgr",name:"TrackGroupBox"}],[{type:"udta",name:"UserDataBox"},["kind"]],[{type:"iprp",name:"ItemPropertiesBox"},["ipma"]],[{type:"ipco",name:"ItemPropertyContainerBox"}],[{type:"grpl",name:"GroupsListBox"}],[{type:"j2kH",name:"J2KHeaderInfoBox"}],[{type:"etyp",name:"ExtendedTypeBox"},["tyco"]]],boxCodes:[],fullBoxCodes:[],containerBoxCodes:[],sampleEntryCodes:{},sampleGroupEntryCodes:[],trackGroupTypes:[],UUIDBoxes:{},UUIDs:[],initialize:function(){o.FullBox.prototype=new o.Box,o.ContainerBox.prototype=new o.Box,o.SampleEntry.prototype=new o.Box,o.TrackGroupTypeBox.prototype=new o.FullBox,o.BASIC_BOXES.forEach(function(t){o.createBoxCtor(t.type,t.name)}),o.FULL_BOXES.forEach(function(t){o.createFullBoxCtor(t.type,t.name)}),o.CONTAINER_BOXES.forEach(function(t){o.createContainerBoxCtor(t[0].type,t[0].name,null,t[1])})},Box:function(t,s,r,f){this.type=t,this.box_name=r,this.size=s,this.uuid=f},FullBox:function(t,s,r,f){o.Box.call(this,t,s,r,f),this.flags=0,this.version=0},ContainerBox:function(t,s,r,f){o.Box.call(this,t,s,r,f),this.boxes=[]},SampleEntry:function(t,s,r,f){o.ContainerBox.call(this,t,s),this.hdr_size=r,this.start=f},SampleGroupEntry:function(t){this.grouping_type=t},TrackGroupTypeBox:function(t,s){o.FullBox.call(this,t,s)},createBoxCtor:function(t,s,r){o.boxCodes.push(t),o[t+"Box"]=function(f){o.Box.call(this,t,f,s)},o[t+"Box"].prototype=new o.Box,r&&(o[t+"Box"].prototype.parse=r)},createFullBoxCtor:function(t,s,r){o[t+"Box"]=function(f){o.FullBox.call(this,t,f,s)},o[t+"Box"].prototype=new o.FullBox,o[t+"Box"].prototype.parse=function(f){this.parseFullHeader(f),r&&r.call(this,f)}},addSubBoxArrays:function(t){if(t){this.subBoxNames=t;for(var s=t.length,r=0;r<s;r++)this[t[r]+"s"]=[]}},createContainerBoxCtor:function(t,s,r,f){o[t+"Box"]=function(h){o.ContainerBox.call(this,t,h,s),o.addSubBoxArrays.call(this,f)},o[t+"Box"].prototype=new o.ContainerBox,r&&(o[t+"Box"].prototype.parse=r)},createMediaSampleEntryCtor:function(t,s,r){o.sampleEntryCodes[t]=[],o[t+"SampleEntry"]=function(f,h){o.SampleEntry.call(this,f,h),o.addSubBoxArrays.call(this,r)},o[t+"SampleEntry"].prototype=new o.SampleEntry,s&&(o[t+"SampleEntry"].prototype.parse=s)},createSampleEntryCtor:function(t,s,r,f){o.sampleEntryCodes[t].push(s),o[s+"SampleEntry"]=function(h){o[t+"SampleEntry"].call(this,s,h),o.addSubBoxArrays.call(this,f)},o[s+"SampleEntry"].prototype=new o[t+"SampleEntry"],r&&(o[s+"SampleEntry"].prototype.parse=r)},createEncryptedSampleEntryCtor:function(t,s,r){o.createSampleEntryCtor.call(this,t,s,r,["sinf"])},createSampleGroupCtor:function(t,s){o[t+"SampleGroupEntry"]=function(r){o.SampleGroupEntry.call(this,t,r)},o[t+"SampleGroupEntry"].prototype=new o.SampleGroupEntry,s&&(o[t+"SampleGroupEntry"].prototype.parse=s)},createTrackGroupCtor:function(t,s){o[t+"TrackGroupTypeBox"]=function(r){o.TrackGroupTypeBox.call(this,t,r)},o[t+"TrackGroupTypeBox"].prototype=new o.TrackGroupTypeBox,s&&(o[t+"TrackGroupTypeBox"].prototype.parse=s)},createUUIDBox:function(t,s,r,f,h){o.UUIDs.push(t),o.UUIDBoxes[t]=function(_){r?o.FullBox.call(this,"uuid",_,s,t):f?o.ContainerBox.call(this,"uuid",_,s,t):o.Box.call(this,"uuid",_,s,t)},o.UUIDBoxes[t].prototype=r?new o.FullBox:f?new o.ContainerBox:new o.Box,h&&(r?o.UUIDBoxes[t].prototype.parse=function(_){this.parseFullHeader(_),h&&h.call(this,_)}:o.UUIDBoxes[t].prototype.parse=h)}};o.initialize(),o.TKHD_FLAG_ENABLED=1,o.TKHD_FLAG_IN_MOVIE=2,o.TKHD_FLAG_IN_PREVIEW=4,o.TFHD_FLAG_BASE_DATA_OFFSET=1,o.TFHD_FLAG_SAMPLE_DESC=2,o.TFHD_FLAG_SAMPLE_DUR=8,o.TFHD_FLAG_SAMPLE_SIZE=16,o.TFHD_FLAG_SAMPLE_FLAGS=32,o.TFHD_FLAG_DUR_EMPTY=65536,o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF=131072,o.TRUN_FLAGS_DATA_OFFSET=1,o.TRUN_FLAGS_FIRST_FLAG=4,o.TRUN_FLAGS_DURATION=256,o.TRUN_FLAGS_SIZE=512,o.TRUN_FLAGS_FLAGS=1024,o.TRUN_FLAGS_CTS_OFFSET=2048,o.Box.prototype.add=function(t){return this.addBox(new o[t+"Box"])},o.Box.prototype.addBox=function(t){return this.boxes.push(t),this[t.type+"s"]?this[t.type+"s"].push(t):this[t.type]=t,t},o.Box.prototype.set=function(t,s){return this[t]=s,this},o.Box.prototype.addEntry=function(t,s){var r=s||"entries";return this[r]||(this[r]=[]),this[r].push(t),this},e.BoxParser=o,o.parseUUID=function(t){return o.parseHex16(t)},o.parseHex16=function(t){for(var s="",r=0;r<16;r++){var f=t.readUint8().toString(16);s+=f.length===1?"0"+f:f}return s},o.parseOneBox=function(t,s,r){var f,h=t.getPosition(),_=0,g,x;if(t.getEndPosition()-h<8)return n.debug("BoxParser","Not enough data in stream to parse the type and size of the box"),{code:o.ERR_NOT_ENOUGH_DATA};if(r&&r<8)return n.debug("BoxParser","Not enough bytes left in the parent box to parse a new box"),{code:o.ERR_NOT_ENOUGH_DATA};var w=t.readUint32(),A=t.readString(4),T=A;if(n.debug("BoxParser","Found box of type '"+A+"' and size "+w+" at position "+h),_=8,A=="uuid"){if(t.getEndPosition()-t.getPosition()<16||r-_<16)return t.seek(h),n.debug("BoxParser","Not enough bytes left in the parent box to parse a UUID box"),{code:o.ERR_NOT_ENOUGH_DATA};x=o.parseUUID(t),_+=16,T=x}if(w==1){if(t.getEndPosition()-t.getPosition()<8||r&&r-_<8)return t.seek(h),n.warn("BoxParser",'Not enough data in stream to parse the extended size of the "'+A+'" box'),{code:o.ERR_NOT_ENOUGH_DATA};w=t.readUint64(),_+=8}else if(w===0){if(r)w=r;else if(A!=="mdat")return n.error("BoxParser","Unlimited box size not supported for type: '"+A+"'"),f=new o.Box(A,w),{code:o.OK,box:f,size:f.size}}return w!==0&&w<_?(n.error("BoxParser","Box of type "+A+" has an invalid size "+w+" (too small to be a box)"),{code:o.ERR_NOT_ENOUGH_DATA,type:A,size:w,hdr_size:_,start:h}):w!==0&&r&&w>r?(n.error("BoxParser","Box of type '"+A+"' has a size "+w+" greater than its container size "+r),{code:o.ERR_NOT_ENOUGH_DATA,type:A,size:w,hdr_size:_,start:h}):w!==0&&h+w>t.getEndPosition()?(t.seek(h),n.info("BoxParser","Not enough data in stream to parse the entire '"+A+"' box"),{code:o.ERR_NOT_ENOUGH_DATA,type:A,size:w,hdr_size:_,start:h}):s?{code:o.OK,type:A,size:w,hdr_size:_,start:h}:(o[A+"Box"]?f=new o[A+"Box"](w):A!=="uuid"?(n.warn("BoxParser","Unknown box type: '"+A+"'"),f=new o.Box(A,w),f.has_unparsed_data=!0):o.UUIDBoxes[x]?f=new o.UUIDBoxes[x](w):(n.warn("BoxParser","Unknown uuid type: '"+x+"'"),f=new o.Box(A,w),f.uuid=x,f.has_unparsed_data=!0),f.hdr_size=_,f.start=h,f.write===o.Box.prototype.write&&f.type!=="mdat"&&(n.info("BoxParser","'"+T+"' box writing not yet implemented, keeping unparsed data in memory for later write"),f.parseDataAndRewind(t)),f.parse(t),g=t.getPosition()-(f.start+f.size),g<0?(n.warn("BoxParser","Parsing of box '"+T+"' did not read the entire indicated box data size (missing "+-g+" bytes), seeking forward"),t.seek(f.start+f.size)):g>0&&(n.error("BoxParser","Parsing of box '"+T+"' read "+g+" more bytes than the indicated box data size, seeking backwards"),f.size!==0&&t.seek(f.start+f.size)),{code:o.OK,box:f,size:f.size})},o.Box.prototype.parse=function(t){this.type!="mdat"?this.data=t.readUint8Array(this.size-this.hdr_size):this.size===0?t.seek(t.getEndPosition()):t.seek(this.start+this.size)},o.Box.prototype.parseDataAndRewind=function(t){this.data=t.readUint8Array(this.size-this.hdr_size),t.position-=this.size-this.hdr_size},o.FullBox.prototype.parseDataAndRewind=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=4,t.position-=this.size-this.hdr_size},o.FullBox.prototype.parseFullHeader=function(t){this.version=t.readUint8(),this.flags=t.readUint24(),this.hdr_size+=4},o.FullBox.prototype.parse=function(t){this.parseFullHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},o.ContainerBox.prototype.parse=function(t){for(var s,r;t.getPosition()<this.start+this.size;)if(s=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),s.code===o.OK)if(r=s.box,this.boxes.push(r),this.subBoxNames&&this.subBoxNames.indexOf(r.type)!=-1)this[this.subBoxNames[this.subBoxNames.indexOf(r.type)]+"s"].push(r);else{var f=r.type!=="uuid"?r.type:r.uuid;this[f]?n.warn("Box of type "+f+" already stored in field of this type"):this[f]=r}else return},o.Box.prototype.parseLanguage=function(t){this.language=t.readUint16();var s=[];s[0]=this.language>>10&31,s[1]=this.language>>5&31,s[2]=this.language&31,this.languageString=String.fromCharCode(s[0]+96,s[1]+96,s[2]+96)},o.SAMPLE_ENTRY_TYPE_VISUAL="Visual",o.SAMPLE_ENTRY_TYPE_AUDIO="Audio",o.SAMPLE_ENTRY_TYPE_HINT="Hint",o.SAMPLE_ENTRY_TYPE_METADATA="Metadata",o.SAMPLE_ENTRY_TYPE_SUBTITLE="Subtitle",o.SAMPLE_ENTRY_TYPE_SYSTEM="System",o.SAMPLE_ENTRY_TYPE_TEXT="Text",o.SampleEntry.prototype.parseHeader=function(t){t.readUint8Array(6),this.data_reference_index=t.readUint16(),this.hdr_size+=8},o.SampleEntry.prototype.parse=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size)},o.SampleEntry.prototype.parseDataAndRewind=function(t){this.parseHeader(t),this.data=t.readUint8Array(this.size-this.hdr_size),this.hdr_size-=8,t.position-=this.size-this.hdr_size},o.SampleEntry.prototype.parseFooter=function(t){o.ContainerBox.prototype.parse.call(this,t)},o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_HINT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,function(t){var s;this.parseHeader(t),t.readUint16(),t.readUint16(),t.readUint32Array(3),this.width=t.readUint16(),this.height=t.readUint16(),this.horizresolution=t.readUint32(),this.vertresolution=t.readUint32(),t.readUint32(),this.frame_count=t.readUint16(),s=Math.min(31,t.readUint8()),this.compressorname=t.readString(s),s<31&&t.readString(31-s),this.depth=t.readUint16(),t.readUint16(),this.parseFooter(t)}),o.createMediaSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,function(t){this.parseHeader(t),t.readUint32Array(2),this.channel_count=t.readUint16(),this.samplesize=t.readUint16(),t.readUint16(),t.readUint16(),this.samplerate=t.readUint32()/65536,this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avc4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"av01"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dav1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hev1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"hvt1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"lhe1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dvh1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"dvhe"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvc1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvi1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvs1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vvcN"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp08"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"vp09"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"avs3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"j2ki"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"mjp2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"mjpg"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"uncv"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mp4a"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ac-4"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"ec-3"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"Opus"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mha1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mha2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mhm1"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"mhm2"),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"fLaC"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_VISUAL,"encv"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_AUDIO,"enca"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"encu"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SYSTEM,"encs"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_TEXT,"enct"),o.createEncryptedSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"encm"),o.createBoxCtor("a1lx","AV1LayeredImageIndexingProperty",function(t){var s=t.readUint8()&1,r=((s&1)+1)*16;this.layer_size=[];for(var f=0;f<3;f++)r==16?this.layer_size[f]=t.readUint16():this.layer_size[f]=t.readUint32()}),o.createBoxCtor("a1op","OperatingPointSelectorProperty",function(t){this.op_index=t.readUint8()}),o.createFullBoxCtor("auxC","AuxiliaryTypeProperty",function(t){this.aux_type=t.readCString();var s=this.size-this.hdr_size-(this.aux_type.length+1);this.aux_subtype=t.readUint8Array(s)}),o.createBoxCtor("av1C","AV1CodecConfigurationBox",function(t){var s=t.readUint8();if((s>>7&1)!==1){n.error("av1C marker problem");return}if(this.version=s&127,this.version!==1){n.error("av1C version "+this.version+" not supported");return}if(s=t.readUint8(),this.seq_profile=s>>5&7,this.seq_level_idx_0=s&31,s=t.readUint8(),this.seq_tier_0=s>>7&1,this.high_bitdepth=s>>6&1,this.twelve_bit=s>>5&1,this.monochrome=s>>4&1,this.chroma_subsampling_x=s>>3&1,this.chroma_subsampling_y=s>>2&1,this.chroma_sample_position=s&3,s=t.readUint8(),this.reserved_1=s>>5&7,this.reserved_1!==0){n.error("av1C reserved_1 parsing problem");return}if(this.initial_presentation_delay_present=s>>4&1,this.initial_presentation_delay_present===1)this.initial_presentation_delay_minus_one=s&15;else if(this.reserved_2=s&15,this.reserved_2!==0){n.error("av1C reserved_2 parsing problem");return}var r=this.size-this.hdr_size-4;this.configOBUs=t.readUint8Array(r)});function p(t){var s="<table class='inner-table'>";s+="<thead><tr><th>length</th><th>nalu_data</th></tr></thead>",s+="<tbody>";for(var r=0;r<t.length;r++){var f=t[r];s+="<tr>",s+="<td>"+f.length+"</td>",s+="<td>",s+=f.nalu.reduce(function(h,_){return h+_.toString(16).padStart(2,"0")},"0x"),s+="</td></tr>"}return s+="</tbody></table>",s}o.createBoxCtor("avcC","AVCConfigurationBox",function(t){var s,r;for(this.configurationVersion=t.readUint8(),this.AVCProfileIndication=t.readUint8(),this.profile_compatibility=t.readUint8(),this.AVCLevelIndication=t.readUint8(),this.lengthSizeMinusOne=t.readUint8()&3,this.nb_SPS_nalus=t.readUint8()&31,r=this.size-this.hdr_size-6,this.SPS=[],this.SPS.toString=function(){return p(this)},s=0;s<this.nb_SPS_nalus;s++)this.SPS[s]={},this.SPS[s].length=t.readUint16(),this.SPS[s].nalu=t.readUint8Array(this.SPS[s].length),r-=2+this.SPS[s].length;for(this.nb_PPS_nalus=t.readUint8(),r--,this.PPS=[],this.PPS.toString=function(){return p(this)},s=0;s<this.nb_PPS_nalus;s++)this.PPS[s]={},this.PPS[s].length=t.readUint16(),this.PPS[s].nalu=t.readUint8Array(this.PPS[s].length),r-=2+this.PPS[s].length;r>0&&(this.ext=t.readUint8Array(r))}),o.createBoxCtor("btrt","BitRateBox",function(t){this.bufferSizeDB=t.readUint32(),this.maxBitrate=t.readUint32(),this.avgBitrate=t.readUint32()}),o.createFullBoxCtor("ccst","CodingConstraintsBox",function(t){var s=t.readUint8();this.all_ref_pics_intra=(s&128)==128,this.intra_pred_used=(s&64)==64,this.max_ref_per_pic=(s&63)>>2,t.readUint24()}),o.createBoxCtor("cdef","ComponentDefinitionBox",function(t){var s;for(this.channel_count=t.readUint16(),this.channel_indexes=[],this.channel_types=[],this.channel_associations=[],s=0;s<this.channel_count;s++)this.channel_indexes.push(t.readUint16()),this.channel_types.push(t.readUint16()),this.channel_associations.push(t.readUint16())}),o.createBoxCtor("clap","CleanApertureBox",function(t){this.cleanApertureWidthN=t.readUint32(),this.cleanApertureWidthD=t.readUint32(),this.cleanApertureHeightN=t.readUint32(),this.cleanApertureHeightD=t.readUint32(),this.horizOffN=t.readUint32(),this.horizOffD=t.readUint32(),this.vertOffN=t.readUint32(),this.vertOffD=t.readUint32()}),o.createBoxCtor("clli","ContentLightLevelBox",function(t){this.max_content_light_level=t.readUint16(),this.max_pic_average_light_level=t.readUint16()}),o.createFullBoxCtor("cmex","CameraExtrinsicMatrixProperty",function(t){this.flags&1&&(this.pos_x=t.readInt32()),this.flags&2&&(this.pos_y=t.readInt32()),this.flags&4&&(this.pos_z=t.readInt32()),this.flags&8&&(this.version==0?this.flags&16?(this.quat_x=t.readInt32(),this.quat_y=t.readInt32(),this.quat_z=t.readInt32()):(this.quat_x=t.readInt16(),this.quat_y=t.readInt16(),this.quat_z=t.readInt16()):this.version==1),this.flags&32&&(this.id=t.readUint32())}),o.createFullBoxCtor("cmin","CameraIntrinsicMatrixProperty",function(t){this.focal_length_x=t.readInt32(),this.principal_point_x=t.readInt32(),this.principal_point_y=t.readInt32(),this.flags&1&&(this.focal_length_y=t.readInt32(),this.skew_factor=t.readInt32())}),o.createBoxCtor("cmpd","ComponentDefinitionBox",function(t){for(this.component_count=t.readUint32(),this.component_types=[],this.component_type_urls=[],i=0;i<this.component_count;i++){var s=t.readUint16();this.component_types.push(s),s>=32768&&this.component_type_urls.push(t.readCString())}}),o.createFullBoxCtor("co64","ChunkLargeOffsetBox",function(t){var s,r;if(s=t.readUint32(),this.chunk_offsets=[],this.version===0)for(r=0;r<s;r++)this.chunk_offsets.push(t.readUint64())}),o.createFullBoxCtor("CoLL","ContentLightLevelBox",function(t){this.maxCLL=t.readUint16(),this.maxFALL=t.readUint16()}),o.createBoxCtor("colr","ColourInformationBox",function(t){if(this.colour_type=t.readString(4),this.colour_type==="nclx"){this.colour_primaries=t.readUint16(),this.transfer_characteristics=t.readUint16(),this.matrix_coefficients=t.readUint16();var s=t.readUint8();this.full_range_flag=s>>7}else this.colour_type==="rICC"?this.ICC_profile=t.readUint8Array(this.size-4):this.colour_type==="prof"&&(this.ICC_profile=t.readUint8Array(this.size-4))}),o.createFullBoxCtor("cprt","CopyrightBox",function(t){this.parseLanguage(t),this.notice=t.readCString()}),o.createFullBoxCtor("cslg","CompositionToDecodeBox",function(t){this.version===0&&(this.compositionToDTSShift=t.readInt32(),this.leastDecodeToDisplayDelta=t.readInt32(),this.greatestDecodeToDisplayDelta=t.readInt32(),this.compositionStartTime=t.readInt32(),this.compositionEndTime=t.readInt32())}),o.createFullBoxCtor("ctts","CompositionOffsetBox",function(t){var s,r;if(s=t.readUint32(),this.sample_counts=[],this.sample_offsets=[],this.version===0)for(r=0;r<s;r++){this.sample_counts.push(t.readUint32());var f=t.readInt32();f<0&&n.warn("BoxParser","ctts box uses negative values without using version 1"),this.sample_offsets.push(f)}else if(this.version==1)for(r=0;r<s;r++)this.sample_counts.push(t.readUint32()),this.sample_offsets.push(t.readInt32())}),o.createBoxCtor("dac3","AC3SpecificBox",function(t){var s=t.readUint8(),r=t.readUint8(),f=t.readUint8();this.fscod=s>>6,this.bsid=s>>1&31,this.bsmod=(s&1)<<2|r>>6&3,this.acmod=r>>3&7,this.lfeon=r>>2&1,this.bit_rate_code=r&3|f>>5&7}),o.createBoxCtor("dec3","EC3SpecificBox",function(t){var s=t.readUint16();this.data_rate=s>>3,this.num_ind_sub=s&7,this.ind_subs=[];for(var r=0;r<this.num_ind_sub+1;r++){var f={};this.ind_subs.push(f);var h=t.readUint8(),_=t.readUint8(),g=t.readUint8();f.fscod=h>>6,f.bsid=h>>1&31,f.bsmod=(h&1)<<4|_>>4&15,f.acmod=_>>1&7,f.lfeon=_&1,f.num_dep_sub=g>>1&15,f.num_dep_sub>0&&(f.chan_loc=(g&1)<<8|t.readUint8())}}),o.createFullBoxCtor("dfLa","FLACSpecificBox",function(t){var s=127,r=128,f=[],h=["STREAMINFO","PADDING","APPLICATION","SEEKTABLE","VORBIS_COMMENT","CUESHEET","PICTURE","RESERVED"];do{var _=t.readUint8(),g=Math.min(_&s,h.length-1);if(g?t.readUint8Array(t.readUint24()):(t.readUint8Array(13),this.samplerate=t.readUint32()>>12,t.readUint8Array(20)),f.push(h[g]),_&r)break}while(!0);this.numMetadataBlocks=f.length+" ("+f.join(", ")+")"}),o.createBoxCtor("dimm","hintimmediateBytesSent",function(t){this.bytessent=t.readUint64()}),o.createBoxCtor("dmax","hintlongestpacket",function(t){this.time=t.readUint32()}),o.createBoxCtor("dmed","hintmediaBytesSent",function(t){this.bytessent=t.readUint64()}),o.createBoxCtor("dOps","OpusSpecificBox",function(t){if(this.Version=t.readUint8(),this.OutputChannelCount=t.readUint8(),this.PreSkip=t.readUint16(),this.InputSampleRate=t.readUint32(),this.OutputGain=t.readInt16(),this.ChannelMappingFamily=t.readUint8(),this.ChannelMappingFamily!==0){this.StreamCount=t.readUint8(),this.CoupledCount=t.readUint8(),this.ChannelMapping=[];for(var s=0;s<this.OutputChannelCount;s++)this.ChannelMapping[s]=t.readUint8()}}),o.createFullBoxCtor("dref","DataReferenceBox",function(t){var s,r;this.entries=[];for(var f=t.readUint32(),h=0;h<f;h++)if(s=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),s.code===o.OK)r=s.box,this.entries.push(r);else return}),o.createBoxCtor("drep","hintrepeatedBytesSent",function(t){this.bytessent=t.readUint64()}),o.createFullBoxCtor("elng","ExtendedLanguageBox",function(t){this.extended_language=t.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("elst","EditListBox",function(t){this.entries=[];for(var s=t.readUint32(),r=0;r<s;r++){var f={};this.entries.push(f),this.version===1?(f.segment_duration=t.readUint64(),f.media_time=t.readInt64()):(f.segment_duration=t.readUint32(),f.media_time=t.readInt32()),f.media_rate_integer=t.readInt16(),f.media_rate_fraction=t.readInt16()}}),o.createFullBoxCtor("emsg","EventMessageBox",function(t){this.version==1?(this.timescale=t.readUint32(),this.presentation_time=t.readUint64(),this.event_duration=t.readUint32(),this.id=t.readUint32(),this.scheme_id_uri=t.readCString(),this.value=t.readCString()):(this.scheme_id_uri=t.readCString(),this.value=t.readCString(),this.timescale=t.readUint32(),this.presentation_time_delta=t.readUint32(),this.event_duration=t.readUint32(),this.id=t.readUint32());var s=this.size-this.hdr_size-(4*4+(this.scheme_id_uri.length+1)+(this.value.length+1));this.version==1&&(s-=4),this.message_data=t.readUint8Array(s)}),o.createEntityToGroupCtor=function(t,s){o[t+"Box"]=function(r){o.FullBox.call(this,t,r)},o[t+"Box"].prototype=new o.FullBox,o[t+"Box"].prototype.parse=function(r){if(this.parseFullHeader(r),s)s.call(this,r);else for(this.group_id=r.readUint32(),this.num_entities_in_group=r.readUint32(),this.entity_ids=[],i=0;i<this.num_entities_in_group;i++){var f=r.readUint32();this.entity_ids.push(f)}}},o.createEntityToGroupCtor("aebr"),o.createEntityToGroupCtor("afbr"),o.createEntityToGroupCtor("albc"),o.createEntityToGroupCtor("altr"),o.createEntityToGroupCtor("brst"),o.createEntityToGroupCtor("dobr"),o.createEntityToGroupCtor("eqiv"),o.createEntityToGroupCtor("favc"),o.createEntityToGroupCtor("fobr"),o.createEntityToGroupCtor("iaug"),o.createEntityToGroupCtor("pano"),o.createEntityToGroupCtor("slid"),o.createEntityToGroupCtor("ster"),o.createEntityToGroupCtor("tsyn"),o.createEntityToGroupCtor("wbbr"),o.createEntityToGroupCtor("prgr"),o.createEntityToGroupCtor("pymd",function(t){this.group_id=t.readUint32(),this.num_entities_in_group=t.readUint32(),this.entity_ids=[];for(var s=0;s<this.num_entities_in_group;s++){var r=t.readUint32();this.entity_ids.push(r)}for(this.tile_size_x=t.readUint16(),this.tile_size_y=t.readUint16(),this.layer_binning=[],this.tiles_in_layer_column_minus1=[],this.tiles_in_layer_row_minus1=[],s=0;s<this.num_entities_in_group;s++)this.layer_binning[s]=t.readUint16(),this.tiles_in_layer_row_minus1[s]=t.readUint16(),this.tiles_in_layer_column_minus1[s]=t.readUint16()}),o.createFullBoxCtor("esds","ElementaryStreamDescriptorBox",function(t){var s=t.readUint8Array(this.size-this.hdr_size);if(typeof d<"u"){var r=new d;this.esd=r.parseOneDescriptor(new l(s.buffer,0,l.BIG_ENDIAN))}}),o.createBoxCtor("fiel","FieldHandlingBox",function(t){this.fieldCount=t.readUint8(),this.fieldOrdering=t.readUint8()}),o.createBoxCtor("frma","OriginalFormatBox",function(t){this.data_format=t.readString(4)}),o.createBoxCtor("ftyp","FileTypeBox",function(t){var s=this.size-this.hdr_size;this.major_brand=t.readString(4),this.minor_version=t.readUint32(),s-=8,this.compatible_brands=[];for(var r=0;s>=4;)this.compatible_brands[r]=t.readString(4),s-=4,r++}),o.createFullBoxCtor("hdlr","HandlerBox",function(t){this.version===0&&(t.readUint32(),this.handler=t.readString(4),t.readUint32Array(3),this.name=t.readString(this.size-this.hdr_size-20),this.name[this.name.length-1]==="\0"&&(this.name=this.name.slice(0,-1)))}),o.createBoxCtor("hvcC","HEVCConfigurationBox",function(t){var s,r,f,h;this.configurationVersion=t.readUint8(),h=t.readUint8(),this.general_profile_space=h>>6,this.general_tier_flag=(h&32)>>5,this.general_profile_idc=h&31,this.general_profile_compatibility=t.readUint32(),this.general_constraint_indicator=t.readUint8Array(6),this.general_level_idc=t.readUint8(),this.min_spatial_segmentation_idc=t.readUint16()&4095,this.parallelismType=t.readUint8()&3,this.chroma_format_idc=t.readUint8()&3,this.bit_depth_luma_minus8=t.readUint8()&7,this.bit_depth_chroma_minus8=t.readUint8()&7,this.avgFrameRate=t.readUint16(),h=t.readUint8(),this.constantFrameRate=h>>6,this.numTemporalLayers=(h&13)>>3,this.temporalIdNested=(h&4)>>2,this.lengthSizeMinusOne=h&3,this.nalu_arrays=[],this.nalu_arrays.toString=function(){var A="<table class='inner-table'>";A+="<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>",A+="<tbody>";for(var T=0;T<this.length;T++){var z=this[T];A+="<tr>",A+="<td rowspan='"+z.length+"'>"+z.completeness+"</td>",A+="<td rowspan='"+z.length+"'>"+z.nalu_type+"</td>";for(var j=0;j<z.length;j++){var k=z[j];j!==0&&(A+="<tr>"),A+="<td>",A+=k.data.reduce(function(it,nt){return it+nt.toString(16).padStart(2,"0")},"0x"),A+="</td></tr>"}}return A+="</tbody></table>",A};var _=t.readUint8();for(s=0;s<_;s++){var g=[];this.nalu_arrays.push(g),h=t.readUint8(),g.completeness=(h&128)>>7,g.nalu_type=h&63;var x=t.readUint16();for(r=0;r<x;r++){var w={};g.push(w),f=t.readUint16(),w.data=t.readUint8Array(f)}}}),o.createFullBoxCtor("iinf","ItemInfoBox",function(t){var s;this.version===0?this.entry_count=t.readUint16():this.entry_count=t.readUint32(),this.item_infos=[];for(var r=0;r<this.entry_count;r++)if(s=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),s.code===o.OK)s.box.type!=="infe"&&n.error("BoxParser","Expected 'infe' box, got "+s.box.type),this.item_infos[r]=s.box;else return}),o.createFullBoxCtor("iloc","ItemLocationBox",function(t){var s;s=t.readUint8(),this.offset_size=s>>4&15,this.length_size=s&15,s=t.readUint8(),this.base_offset_size=s>>4&15,this.version===1||this.version===2?this.index_size=s&15:this.index_size=0,this.items=[];var r=0;if(this.version<2)r=t.readUint16();else if(this.version===2)r=t.readUint32();else throw"version of iloc box not supported";for(var f=0;f<r;f++){var h={};if(this.items.push(h),this.version<2)h.item_ID=t.readUint16();else if(this.version===2)h.item_ID=t.readUint32();else throw"version of iloc box not supported";switch(this.version===1||this.version===2?h.construction_method=t.readUint16()&15:h.construction_method=0,h.data_reference_index=t.readUint16(),this.base_offset_size){case 0:h.base_offset=0;break;case 4:h.base_offset=t.readUint32();break;case 8:h.base_offset=t.readUint64();break;default:throw"Error reading base offset size"}var _=t.readUint16();h.extents=[];for(var g=0;g<_;g++){var x={};if(h.extents.push(x),this.version===1||this.version===2)switch(this.index_size){case 0:x.extent_index=0;break;case 4:x.extent_index=t.readUint32();break;case 8:x.extent_index=t.readUint64();break;default:throw"Error reading extent index"}switch(this.offset_size){case 0:x.extent_offset=0;break;case 4:x.extent_offset=t.readUint32();break;case 8:x.extent_offset=t.readUint64();break;default:throw"Error reading extent index"}switch(this.length_size){case 0:x.extent_length=0;break;case 4:x.extent_length=t.readUint32();break;case 8:x.extent_length=t.readUint64();break;default:throw"Error reading extent index"}}}}),o.createBoxCtor("imir","ImageMirror",function(t){var s=t.readUint8();this.reserved=s>>7,this.axis=s&1}),o.createFullBoxCtor("infe","ItemInfoEntry",function(t){if((this.version===0||this.version===1)&&(this.item_ID=t.readUint16(),this.item_protection_index=t.readUint16(),this.item_name=t.readCString(),this.content_type=t.readCString(),this.content_encoding=t.readCString()),this.version===1){this.extension_type=t.readString(4),n.warn("BoxParser","Cannot parse extension type"),t.seek(this.start+this.size);return}this.version>=2&&(this.version===2?this.item_ID=t.readUint16():this.version===3&&(this.item_ID=t.readUint32()),this.item_protection_index=t.readUint16(),this.item_type=t.readString(4),this.item_name=t.readCString(),this.item_type==="mime"?(this.content_type=t.readCString(),this.content_encoding=t.readCString()):this.item_type==="uri "&&(this.item_uri_type=t.readCString()))}),o.createFullBoxCtor("ipma","ItemPropertyAssociationBox",function(t){var s,r;for(entry_count=t.readUint32(),this.associations=[],s=0;s<entry_count;s++){var f={};this.associations.push(f),this.version<1?f.id=t.readUint16():f.id=t.readUint32();var h=t.readUint8();for(f.props=[],r=0;r<h;r++){var _=t.readUint8(),g={};f.props.push(g),g.essential=(_&128)>>7===1,this.flags&1?g.property_index=(_&127)<<8|t.readUint8():g.property_index=_&127}}}),o.createFullBoxCtor("iref","ItemReferenceBox",function(t){var s,r;for(this.references=[];t.getPosition()<this.start+this.size;)if(s=o.parseOneBox(t,!0,this.size-(t.getPosition()-this.start)),s.code===o.OK)this.version===0?r=new o.SingleItemTypeReferenceBox(s.type,s.size,s.hdr_size,s.start):r=new o.SingleItemTypeReferenceBoxLarge(s.type,s.size,s.hdr_size,s.start),r.write===o.Box.prototype.write&&r.type!=="mdat"&&(n.warn("BoxParser",r.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),r.parseDataAndRewind(t)),r.parse(t),this.references.push(r);else return}),o.createBoxCtor("irot","ImageRotation",function(t){this.angle=t.readUint8()&3}),o.createFullBoxCtor("ispe","ImageSpatialExtentsProperty",function(t){this.image_width=t.readUint32(),this.image_height=t.readUint32()}),o.createFullBoxCtor("kind","KindBox",function(t){this.schemeURI=t.readCString(),this.value=t.readCString()}),o.createFullBoxCtor("leva","LevelAssignmentBox",function(t){var s=t.readUint8();this.levels=[];for(var r=0;r<s;r++){var f={};this.levels[r]=f,f.track_ID=t.readUint32();var h=t.readUint8();switch(f.padding_flag=h>>7,f.assignment_type=h&127,f.assignment_type){case 0:f.grouping_type=t.readString(4);break;case 1:f.grouping_type=t.readString(4),f.grouping_type_parameter=t.readUint32();break;case 2:break;case 3:break;case 4:f.sub_track_id=t.readUint32();break;default:n.warn("BoxParser","Unknown leva assignement type")}}}),o.createBoxCtor("lhvC","LHEVCConfigurationBox",function(t){var s,r,f;this.configurationVersion=t.readUint8(),this.min_spatial_segmentation_idc=t.readUint16()&4095,this.parallelismType=t.readUint8()&3,f=t.readUint8(),this.numTemporalLayers=(f&13)>>3,this.temporalIdNested=(f&4)>>2,this.lengthSizeMinusOne=f&3,this.nalu_arrays=[],this.nalu_arrays.toString=function(){var A="<table class='inner-table'>";A+="<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>",A+="<tbody>";for(var T=0;T<this.length;T++){var z=this[T];A+="<tr>",A+="<td rowspan='"+z.length+"'>"+z.completeness+"</td>",A+="<td rowspan='"+z.length+"'>"+z.nalu_type+"</td>";for(var j=0;j<z.length;j++){var k=z[j];j!==0&&(A+="<tr>"),A+="<td>",A+=k.data.reduce(function(it,nt){return it+nt.toString(16).padStart(2,"0")},"0x"),A+="</td></tr>"}}return A+="</tbody></table>",A};var h=t.readUint8();for(s=0;s<h;s++){var _=[];this.nalu_arrays.push(_),f=t.readUint8(),_.completeness=(f&128)>>7,_.nalu_type=f&63;var g=t.readUint16();for(r=0;r<g;r++){var x={};_.push(x);var w=t.readUint16();x.data=t.readUint8Array(w)}}}),o.createBoxCtor("lsel","LayerSelectorProperty",function(t){this.layer_id=t.readUint16()}),o.createBoxCtor("maxr","hintmaxrate",function(t){this.period=t.readUint32(),this.bytes=t.readUint32()});function S(t,s){this.x=t,this.y=s}S.prototype.toString=function(){return"("+this.x+","+this.y+")"},o.createBoxCtor("mdcv","MasteringDisplayColourVolumeBox",function(t){this.display_primaries=[],this.display_primaries[0]=new S(t.readUint16(),t.readUint16()),this.display_primaries[1]=new S(t.readUint16(),t.readUint16()),this.display_primaries[2]=new S(t.readUint16(),t.readUint16()),this.white_point=new S(t.readUint16(),t.readUint16()),this.max_display_mastering_luminance=t.readUint32(),this.min_display_mastering_luminance=t.readUint32()}),o.createFullBoxCtor("mdhd","MediaHeaderBox",function(t){this.version==1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.parseLanguage(t),t.readUint16()}),o.createFullBoxCtor("mehd","MovieExtendsHeaderBox",function(t){this.flags&1&&(n.warn("BoxParser","mehd box incorrectly uses flags set to 1, converting version to 1"),this.version=1),this.version==1?this.fragment_duration=t.readUint64():this.fragment_duration=t.readUint32()}),o.createFullBoxCtor("meta","MetaBox",function(t){this.boxes=[],o.ContainerBox.prototype.parse.call(this,t)}),o.createFullBoxCtor("mfhd","MovieFragmentHeaderBox",function(t){this.sequence_number=t.readUint32()}),o.createFullBoxCtor("mfro","MovieFragmentRandomAccessOffsetBox",function(t){this._size=t.readUint32()}),o.createFullBoxCtor("mskC","MaskConfigurationProperty",function(t){this.bits_per_pixel=t.readUint8()}),o.createFullBoxCtor("mvhd","MovieHeaderBox",function(t){this.version==1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.timescale=t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.timescale=t.readUint32(),this.duration=t.readUint32()),this.rate=t.readUint32(),this.volume=t.readUint16()>>8,t.readUint16(),t.readUint32Array(2),this.matrix=t.readUint32Array(9),t.readUint32Array(6),this.next_track_id=t.readUint32()}),o.createBoxCtor("npck","hintPacketsSent",function(t){this.packetssent=t.readUint32()}),o.createBoxCtor("nump","hintPacketsSent",function(t){this.packetssent=t.readUint64()}),o.createFullBoxCtor("padb","PaddingBitsBox",function(t){var s=t.readUint32();this.padbits=[];for(var r=0;r<Math.floor((s+1)/2);r++)this.padbits=t.readUint8()}),o.createBoxCtor("pasp","PixelAspectRatioBox",function(t){this.hSpacing=t.readUint32(),this.vSpacing=t.readUint32()}),o.createBoxCtor("payl","CuePayloadBox",function(t){this.text=t.readString(this.size-this.hdr_size)}),o.createBoxCtor("payt","hintpayloadID",function(t){this.payloadID=t.readUint32();var s=t.readUint8();this.rtpmap_string=t.readString(s)}),o.createFullBoxCtor("pdin","ProgressiveDownloadInfoBox",function(t){var s=(this.size-this.hdr_size)/8;this.rate=[],this.initial_delay=[];for(var r=0;r<s;r++)this.rate[r]=t.readUint32(),this.initial_delay[r]=t.readUint32()}),o.createFullBoxCtor("pitm","PrimaryItemBox",function(t){this.version===0?this.item_id=t.readUint16():this.item_id=t.readUint32()}),o.createFullBoxCtor("pixi","PixelInformationProperty",function(t){var s;for(this.num_channels=t.readUint8(),this.bits_per_channels=[],s=0;s<this.num_channels;s++)this.bits_per_channels[s]=t.readUint8()}),o.createBoxCtor("pmax","hintlargestpacket",function(t){this.bytes=t.readUint32()}),o.createFullBoxCtor("prdi","ProgressiveDerivedImageItemInformationProperty",function(t){if(this.step_count=t.readUint16(),this.item_count=[],this.flags&2)for(var s=0;s<this.step_count;s++)this.item_count[s]=t.readUint16()}),o.createFullBoxCtor("prft","ProducerReferenceTimeBox",function(t){this.ref_track_id=t.readUint32(),this.ntp_timestamp=t.readUint64(),this.version===0?this.media_time=t.readUint32():this.media_time=t.readUint64()}),o.createFullBoxCtor("pssh","ProtectionSystemSpecificHeaderBox",function(t){if(this.system_id=o.parseHex16(t),this.version>0){var s=t.readUint32();this.kid=[];for(var r=0;r<s;r++)this.kid[r]=o.parseHex16(t)}var f=t.readUint32();f>0&&(this.data=t.readUint8Array(f))}),o.createFullBoxCtor("clef","TrackCleanApertureDimensionsBox",function(t){this.width=t.readUint32(),this.height=t.readUint32()}),o.createFullBoxCtor("enof","TrackEncodedPixelsDimensionsBox",function(t){this.width=t.readUint32(),this.height=t.readUint32()}),o.createFullBoxCtor("prof","TrackProductionApertureDimensionsBox",function(t){this.width=t.readUint32(),this.height=t.readUint32()}),o.createContainerBoxCtor("tapt","TrackApertureModeDimensionsBox",null,["clef","prof","enof"]),o.createBoxCtor("rtp ","rtpmoviehintinformation",function(t){this.descriptionformat=t.readString(4),this.sdptext=t.readString(this.size-this.hdr_size-4)}),o.createFullBoxCtor("saio","SampleAuxiliaryInformationOffsetsBox",function(t){this.flags&1&&(this.aux_info_type=t.readString(4),this.aux_info_type_parameter=t.readUint32());var s=t.readUint32();this.offset=[];for(var r=0;r<s;r++)this.version===0?this.offset[r]=t.readUint32():this.offset[r]=t.readUint64()}),o.createFullBoxCtor("saiz","SampleAuxiliaryInformationSizesBox",function(t){if(this.flags&1&&(this.aux_info_type=t.readString(4),this.aux_info_type_parameter=t.readUint32()),this.default_sample_info_size=t.readUint8(),this.sample_count=t.readUint32(),this.sample_info_size=[],this.default_sample_info_size===0)for(var s=0;s<this.sample_count;s++)this.sample_info_size[s]=t.readUint8()}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"mett",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"metx",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"sbtt",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stpp",function(t){this.parseHeader(t),this.namespace=t.readCString(),this.schema_location=t.readCString(),this.auxiliary_mime_types=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"stxt",function(t){this.parseHeader(t),this.content_encoding=t.readCString(),this.mime_format=t.readCString(),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_SUBTITLE,"tx3g",function(t){this.parseHeader(t),this.displayFlags=t.readUint32(),this.horizontal_justification=t.readInt8(),this.vertical_justification=t.readInt8(),this.bg_color_rgba=t.readUint8Array(4),this.box_record=t.readInt16Array(4),this.style_record=t.readUint8Array(12),this.parseFooter(t)}),o.createSampleEntryCtor(o.SAMPLE_ENTRY_TYPE_METADATA,"wvtt",function(t){this.parseHeader(t),this.parseFooter(t)}),o.createSampleGroupCtor("alst",function(t){var s,r=t.readUint16();for(this.first_output_sample=t.readUint16(),this.sample_offset=[],s=0;s<r;s++)this.sample_offset[s]=t.readUint32();var f=this.description_length-4-4*r;for(this.num_output_samples=[],this.num_total_samples=[],s=0;s<f/4;s++)this.num_output_samples[s]=t.readUint16(),this.num_total_samples[s]=t.readUint16()}),o.createSampleGroupCtor("avll",function(t){this.layerNumber=t.readUint8(),this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()}),o.createSampleGroupCtor("avss",function(t){this.subSequenceIdentifier=t.readUint16(),this.layerNumber=t.readUint8();var s=t.readUint8();this.durationFlag=s>>7,this.avgRateFlag=s>>6&1,this.durationFlag&&(this.duration=t.readUint32()),this.avgRateFlag&&(this.accurateStatisticsFlag=t.readUint8(),this.avgBitRate=t.readUint16(),this.avgFrameRate=t.readUint16()),this.dependency=[];for(var r=t.readUint8(),f=0;f<r;f++){var h={};this.dependency.push(h),h.subSeqDirectionFlag=t.readUint8(),h.layerNumber=t.readUint8(),h.subSequenceIdentifier=t.readUint16()}}),o.createSampleGroupCtor("dtrt",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("mvif",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("prol",function(t){this.roll_distance=t.readInt16()}),o.createSampleGroupCtor("rap ",function(t){var s=t.readUint8();this.num_leading_samples_known=s>>7,this.num_leading_samples=s&127}),o.createSampleGroupCtor("rash",function(t){if(this.operation_point_count=t.readUint16(),this.description_length!==2+(this.operation_point_count===1?2:this.operation_point_count*6)+9)n.warn("BoxParser","Mismatch in "+this.grouping_type+" sample group length"),this.data=t.readUint8Array(this.description_length-2);else{if(this.operation_point_count===1)this.target_rate_share=t.readUint16();else{this.target_rate_share=[],this.available_bitrate=[];for(var s=0;s<this.operation_point_count;s++)this.available_bitrate[s]=t.readUint32(),this.target_rate_share[s]=t.readUint16()}this.maximum_bitrate=t.readUint32(),this.minimum_bitrate=t.readUint32(),this.discard_priority=t.readUint8()}}),o.createSampleGroupCtor("roll",function(t){this.roll_distance=t.readInt16()}),o.SampleGroupEntry.prototype.parse=function(t){n.warn("BoxParser","Unknown Sample Group type: "+this.grouping_type),this.data=t.readUint8Array(this.description_length)},o.createSampleGroupCtor("scif",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("scnm",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("seig",function(t){this.reserved=t.readUint8();var s=t.readUint8();this.crypt_byte_block=s>>4,this.skip_byte_block=s&15,this.isProtected=t.readUint8(),this.Per_Sample_IV_Size=t.readUint8(),this.KID=o.parseHex16(t),this.constant_IV_size=0,this.constant_IV=0,this.isProtected===1&&this.Per_Sample_IV_Size===0&&(this.constant_IV_size=t.readUint8(),this.constant_IV=t.readUint8Array(this.constant_IV_size))}),o.createSampleGroupCtor("stsa",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("sync",function(t){var s=t.readUint8();this.NAL_unit_type=s&63}),o.createSampleGroupCtor("tele",function(t){var s=t.readUint8();this.level_independently_decodable=s>>7}),o.createSampleGroupCtor("tsas",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("tscl",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createSampleGroupCtor("vipr",function(t){n.warn("BoxParser","Sample Group type: "+this.grouping_type+" not fully parsed")}),o.createFullBoxCtor("sbgp","SampleToGroupBox",function(t){this.grouping_type=t.readString(4),this.version===1?this.grouping_type_parameter=t.readUint32():this.grouping_type_parameter=0,this.entries=[];for(var s=t.readUint32(),r=0;r<s;r++){var f={};this.entries.push(f),f.sample_count=t.readInt32(),f.group_description_index=t.readInt32()}});function v(t,s){this.bad_pixel_row=t,this.bad_pixel_column=s}v.prototype.toString=function(){return"[row: "+this.bad_pixel_row+", column: "+this.bad_pixel_column+"]"},o.createFullBoxCtor("sbpm","SensorBadPixelsMapBox",function(t){var s;for(this.component_count=t.readUint16(),this.component_index=[],s=0;s<this.component_count;s++)this.component_index.push(t.readUint16());var r=t.readUint8();for(this.correction_applied=(r&128)==128,this.num_bad_rows=t.readUint32(),this.num_bad_cols=t.readUint32(),this.num_bad_pixels=t.readUint32(),this.bad_rows=[],this.bad_columns=[],this.bad_pixels=[],s=0;s<this.num_bad_rows;s++)this.bad_rows.push(t.readUint32());for(s=0;s<this.num_bad_cols;s++)this.bad_columns.push(t.readUint32());for(s=0;s<this.num_bad_pixels;s++){var f=t.readUint32(),h=t.readUint32();this.bad_pixels.push(new v(f,h))}}),o.createFullBoxCtor("schm","SchemeTypeBox",function(t){this.scheme_type=t.readString(4),this.scheme_version=t.readUint32(),this.flags&1&&(this.scheme_uri=t.readString(this.size-this.hdr_size-8))}),o.createBoxCtor("sdp ","rtptracksdphintinformation",function(t){this.sdptext=t.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("sdtp","SampleDependencyTypeBox",function(t){var s,r=this.size-this.hdr_size;this.is_leading=[],this.sample_depends_on=[],this.sample_is_depended_on=[],this.sample_has_redundancy=[];for(var f=0;f<r;f++)s=t.readUint8(),this.is_leading[f]=s>>6,this.sample_depends_on[f]=s>>4&3,this.sample_is_depended_on[f]=s>>2&3,this.sample_has_redundancy[f]=s&3}),o.createFullBoxCtor("senc","SampleEncryptionBox"),o.createFullBoxCtor("sgpd","SampleGroupDescriptionBox",function(t){this.grouping_type=t.readString(4),n.debug("BoxParser","Found Sample Groups of type "+this.grouping_type),this.version===1?this.default_length=t.readUint32():this.default_length=0,this.version>=2&&(this.default_group_description_index=t.readUint32()),this.entries=[];for(var s=t.readUint32(),r=0;r<s;r++){var f;o[this.grouping_type+"SampleGroupEntry"]?f=new o[this.grouping_type+"SampleGroupEntry"](this.grouping_type):f=new o.SampleGroupEntry(this.grouping_type),this.entries.push(f),this.version===1?this.default_length===0?f.description_length=t.readUint32():f.description_length=this.default_length:f.description_length=this.default_length,f.write===o.SampleGroupEntry.prototype.write&&(n.info("BoxParser","SampleGroup for type "+this.grouping_type+" writing not yet implemented, keeping unparsed data in memory for later write"),f.data=t.readUint8Array(f.description_length),t.position-=f.description_length),f.parse(t)}}),o.createFullBoxCtor("sidx","CompressedSegmentIndexBox",function(t){this.reference_ID=t.readUint32(),this.timescale=t.readUint32(),this.version===0?(this.earliest_presentation_time=t.readUint32(),this.first_offset=t.readUint32()):(this.earliest_presentation_time=t.readUint64(),this.first_offset=t.readUint64()),t.readUint16(),this.references=[];for(var s=t.readUint16(),r=0;r<s;r++){var f={};this.references.push(f);var h=t.readUint32();f.reference_type=h>>31&1,f.referenced_size=h&2147483647,f.subsegment_duration=t.readUint32(),h=t.readUint32(),f.starts_with_SAP=h>>31&1,f.SAP_type=h>>28&7,f.SAP_delta_time=h&268435455}}),o.SingleItemTypeReferenceBox=function(t,s,r,f){o.Box.call(this,t,s),this.hdr_size=r,this.start=f},o.SingleItemTypeReferenceBox.prototype=new o.Box,o.SingleItemTypeReferenceBox.prototype.parse=function(t){this.from_item_ID=t.readUint16();var s=t.readUint16();this.references=[];for(var r=0;r<s;r++)this.references[r]={},this.references[r].to_item_ID=t.readUint16()},o.SingleItemTypeReferenceBoxLarge=function(t,s,r,f){o.Box.call(this,t,s),this.hdr_size=r,this.start=f},o.SingleItemTypeReferenceBoxLarge.prototype=new o.Box,o.SingleItemTypeReferenceBoxLarge.prototype.parse=function(t){this.from_item_ID=t.readUint32();var s=t.readUint16();this.references=[];for(var r=0;r<s;r++)this.references[r]={},this.references[r].to_item_ID=t.readUint32()},o.createFullBoxCtor("SmDm","SMPTE2086MasteringDisplayMetadataBox",function(t){this.primaryRChromaticity_x=t.readUint16(),this.primaryRChromaticity_y=t.readUint16(),this.primaryGChromaticity_x=t.readUint16(),this.primaryGChromaticity_y=t.readUint16(),this.primaryBChromaticity_x=t.readUint16(),this.primaryBChromaticity_y=t.readUint16(),this.whitePointChromaticity_x=t.readUint16(),this.whitePointChromaticity_y=t.readUint16(),this.luminanceMax=t.readUint32(),this.luminanceMin=t.readUint32()}),o.createFullBoxCtor("smhd","SoundMediaHeaderBox",function(t){this.balance=t.readUint16(),t.readUint16()}),o.createFullBoxCtor("ssix","CompressedSubsegmentIndexBox",function(t){this.subsegments=[];for(var s=t.readUint32(),r=0;r<s;r++){var f={};this.subsegments.push(f),f.ranges=[];for(var h=t.readUint32(),_=0;_<h;_++){var g={};f.ranges.push(g),g.level=t.readUint8(),g.range_size=t.readUint24()}}}),o.createFullBoxCtor("stco","ChunkOffsetBox",function(t){var s;if(s=t.readUint32(),this.chunk_offsets=[],this.version===0)for(var r=0;r<s;r++)this.chunk_offsets.push(t.readUint32())}),o.createFullBoxCtor("stdp","DegradationPriorityBox",function(t){var s=(this.size-this.hdr_size)/2;this.priority=[];for(var r=0;r<s;r++)this.priority[r]=t.readUint16()}),o.createFullBoxCtor("sthd","SubtitleMediaHeaderBox"),o.createFullBoxCtor("stri","SubTrackInformationBox",function(t){this.switch_group=t.readUint16(),this.alternate_group=t.readUint16(),this.sub_track_id=t.readUint32();var s=(this.size-this.hdr_size-8)/4;this.attribute_list=[];for(var r=0;r<s;r++)this.attribute_list[r]=t.readUint32()}),o.createFullBoxCtor("stsc","SampleToChunkBox",function(t){var s,r;if(s=t.readUint32(),this.first_chunk=[],this.samples_per_chunk=[],this.sample_description_index=[],this.version===0)for(r=0;r<s;r++)this.first_chunk.push(t.readUint32()),this.samples_per_chunk.push(t.readUint32()),this.sample_description_index.push(t.readUint32())}),o.createFullBoxCtor("stsd","SampleDescriptionBox",function(t){var s,r,f,h;for(this.entries=[],f=t.readUint32(),s=1;s<=f;s++)if(r=o.parseOneBox(t,!0,this.size-(t.getPosition()-this.start)),r.code===o.OK)o[r.type+"SampleEntry"]?(h=new o[r.type+"SampleEntry"](r.size),h.hdr_size=r.hdr_size,h.start=r.start):(n.warn("BoxParser","Unknown sample entry type: "+r.type),h=new o.SampleEntry(r.type,r.size,r.hdr_size,r.start)),h.write===o.SampleEntry.prototype.write&&(n.info("BoxParser","SampleEntry "+h.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),h.parseDataAndRewind(t)),h.parse(t),this.entries.push(h);else return}),o.createFullBoxCtor("stsg","SubTrackSampleGroupBox",function(t){this.grouping_type=t.readUint32();var s=t.readUint16();this.group_description_index=[];for(var r=0;r<s;r++)this.group_description_index[r]=t.readUint32()}),o.createFullBoxCtor("stsh","ShadowSyncSampleBox",function(t){var s,r;if(s=t.readUint32(),this.shadowed_sample_numbers=[],this.sync_sample_numbers=[],this.version===0)for(r=0;r<s;r++)this.shadowed_sample_numbers.push(t.readUint32()),this.sync_sample_numbers.push(t.readUint32())}),o.createFullBoxCtor("stss","SyncSampleBox",function(t){var s,r;if(r=t.readUint32(),this.version===0)for(this.sample_numbers=[],s=0;s<r;s++)this.sample_numbers.push(t.readUint32())}),o.createFullBoxCtor("stsz","SampleSizeBox",function(t){var s;if(this.sample_sizes=[],this.version===0)for(this.sample_size=t.readUint32(),this.sample_count=t.readUint32(),s=0;s<this.sample_count;s++)this.sample_size===0?this.sample_sizes.push(t.readUint32()):this.sample_sizes[s]=this.sample_size}),o.createFullBoxCtor("stts","TimeToSampleBox",function(t){var s,r,f;if(s=t.readUint32(),this.sample_counts=[],this.sample_deltas=[],this.version===0)for(r=0;r<s;r++)this.sample_counts.push(t.readUint32()),f=t.readInt32(),f<0&&(n.warn("BoxParser","File uses negative stts sample delta, using value 1 instead, sync may be lost!"),f=1),this.sample_deltas.push(f)}),o.createFullBoxCtor("stvi","StereoVideoBox",function(t){var s=t.readUint32();this.single_view_allowed=s&3,this.stereo_scheme=t.readUint32();var r=t.readUint32();this.stereo_indication_type=t.readString(r);var f,h;for(this.boxes=[];t.getPosition()<this.start+this.size;)if(f=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),f.code===o.OK)h=f.box,this.boxes.push(h),this[h.type]=h;else return}),o.createBoxCtor("styp","SegmentTypeBox",function(t){o.ftypBox.prototype.parse.call(this,t)}),o.createFullBoxCtor("stz2","CompactSampleSizeBox",function(t){var s,r;if(this.sample_sizes=[],this.version===0)if(this.reserved=t.readUint24(),this.field_size=t.readUint8(),r=t.readUint32(),this.field_size===4)for(s=0;s<r;s+=2){var f=t.readUint8();this.sample_sizes[s]=f>>4&15,this.sample_sizes[s+1]=f&15}else if(this.field_size===8)for(s=0;s<r;s++)this.sample_sizes[s]=t.readUint8();else if(this.field_size===16)for(s=0;s<r;s++)this.sample_sizes[s]=t.readUint16();else n.error("BoxParser","Error in length field in stz2 box")}),o.createFullBoxCtor("subs","SubSampleInformationBox",function(t){var s,r,f,h;for(f=t.readUint32(),this.entries=[],s=0;s<f;s++){var _={};if(this.entries[s]=_,_.sample_delta=t.readUint32(),_.subsamples=[],h=t.readUint16(),h>0)for(r=0;r<h;r++){var g={};_.subsamples.push(g),this.version==1?g.size=t.readUint32():g.size=t.readUint16(),g.priority=t.readUint8(),g.discardable=t.readUint8(),g.codec_specific_parameters=t.readUint32()}}}),o.createFullBoxCtor("tenc","TrackEncryptionBox",function(t){if(t.readUint8(),this.version===0)t.readUint8();else{var s=t.readUint8();this.default_crypt_byte_block=s>>4&15,this.default_skip_byte_block=s&15}this.default_isProtected=t.readUint8(),this.default_Per_Sample_IV_Size=t.readUint8(),this.default_KID=o.parseHex16(t),this.default_isProtected===1&&this.default_Per_Sample_IV_Size===0&&(this.default_constant_IV_size=t.readUint8(),this.default_constant_IV=t.readUint8Array(this.default_constant_IV_size))}),o.createFullBoxCtor("tfdt","TrackFragmentBaseMediaDecodeTimeBox",function(t){this.version==1?this.baseMediaDecodeTime=t.readUint64():this.baseMediaDecodeTime=t.readUint32()}),o.createFullBoxCtor("tfhd","TrackFragmentHeaderBox",function(t){var s=0;this.track_id=t.readUint32(),this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET?(this.base_data_offset=t.readUint64(),s+=8):this.base_data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DESC?(this.default_sample_description_index=t.readUint32(),s+=4):this.default_sample_description_index=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_DUR?(this.default_sample_duration=t.readUint32(),s+=4):this.default_sample_duration=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_SIZE?(this.default_sample_size=t.readUint32(),s+=4):this.default_sample_size=0,this.size-this.hdr_size>s&&this.flags&o.TFHD_FLAG_SAMPLE_FLAGS?(this.default_sample_flags=t.readUint32(),s+=4):this.default_sample_flags=0}),o.createFullBoxCtor("tfra","TrackFragmentRandomAccessBox",function(t){this.track_ID=t.readUint32(),t.readUint24();var s=t.readUint8();this.length_size_of_traf_num=s>>4&3,this.length_size_of_trun_num=s>>2&3,this.length_size_of_sample_num=s&3,this.entries=[];for(var r=t.readUint32(),f=0;f<r;f++)this.version===1?(this.time=t.readUint64(),this.moof_offset=t.readUint64()):(this.time=t.readUint32(),this.moof_offset=t.readUint32()),this.traf_number=t["readUint"+8*(this.length_size_of_traf_num+1)](),this.trun_number=t["readUint"+8*(this.length_size_of_trun_num+1)](),this.sample_number=t["readUint"+8*(this.length_size_of_sample_num+1)]()}),o.createFullBoxCtor("tkhd","TrackHeaderBox",function(t){this.version==1?(this.creation_time=t.readUint64(),this.modification_time=t.readUint64(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint64()):(this.creation_time=t.readUint32(),this.modification_time=t.readUint32(),this.track_id=t.readUint32(),t.readUint32(),this.duration=t.readUint32()),t.readUint32Array(2),this.layer=t.readInt16(),this.alternate_group=t.readInt16(),this.volume=t.readInt16()>>8,t.readUint16(),this.matrix=t.readInt32Array(9),this.width=t.readUint32(),this.height=t.readUint32()}),o.createBoxCtor("tmax","hintmaxrelativetime",function(t){this.time=t.readUint32()}),o.createBoxCtor("tmin","hintminrelativetime",function(t){this.time=t.readUint32()}),o.createBoxCtor("totl","hintBytesSent",function(t){this.bytessent=t.readUint32()}),o.createBoxCtor("tpay","hintBytesSent",function(t){this.bytessent=t.readUint32()}),o.createBoxCtor("tpyl","hintBytesSent",function(t){this.bytessent=t.readUint64()}),o.TrackGroupTypeBox.prototype.parse=function(t){this.parseFullHeader(t),this.track_group_id=t.readUint32()},o.createTrackGroupCtor("msrc"),o.TrackReferenceTypeBox=function(t,s,r,f){o.Box.call(this,t,s),this.hdr_size=r,this.start=f},o.TrackReferenceTypeBox.prototype=new o.Box,o.TrackReferenceTypeBox.prototype.parse=function(t){this.track_ids=t.readUint32Array((this.size-this.hdr_size)/4)},o.trefBox.prototype.parse=function(t){for(var s,r;t.getPosition()<this.start+this.size;)if(s=o.parseOneBox(t,!0,this.size-(t.getPosition()-this.start)),s.code===o.OK)r=new o.TrackReferenceTypeBox(s.type,s.size,s.hdr_size,s.start),r.write===o.Box.prototype.write&&r.type!=="mdat"&&(n.info("BoxParser","TrackReference "+r.type+" box writing not yet implemented, keeping unparsed data in memory for later write"),r.parseDataAndRewind(t)),r.parse(t),this.boxes.push(r);else return},o.createFullBoxCtor("trep","TrackExtensionPropertiesBox",function(t){for(this.track_ID=t.readUint32(),this.boxes=[];t.getPosition()<this.start+this.size;)if(ret=o.parseOneBox(t,!1,this.size-(t.getPosition()-this.start)),ret.code===o.OK)box=ret.box,this.boxes.push(box);else return}),o.createFullBoxCtor("trex","TrackExtendsBox",function(t){this.track_id=t.readUint32(),this.default_sample_description_index=t.readUint32(),this.default_sample_duration=t.readUint32(),this.default_sample_size=t.readUint32(),this.default_sample_flags=t.readUint32()}),o.createBoxCtor("trpy","hintBytesSent",function(t){this.bytessent=t.readUint64()}),o.createFullBoxCtor("trun","TrackRunBox",function(t){var s=0;if(this.sample_count=t.readUint32(),s+=4,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_DATA_OFFSET?(this.data_offset=t.readInt32(),s+=4):this.data_offset=0,this.size-this.hdr_size>s&&this.flags&o.TRUN_FLAGS_FIRST_FLAG?(this.first_sample_flags=t.readUint32(),s+=4):this.first_sample_flags=0,this.sample_duration=[],this.sample_size=[],this.sample_flags=[],this.sample_composition_time_offset=[],this.size-this.hdr_size>s)for(var r=0;r<this.sample_count;r++)this.flags&o.TRUN_FLAGS_DURATION&&(this.sample_duration[r]=t.readUint32()),this.flags&o.TRUN_FLAGS_SIZE&&(this.sample_size[r]=t.readUint32()),this.flags&o.TRUN_FLAGS_FLAGS&&(this.sample_flags[r]=t.readUint32()),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?this.sample_composition_time_offset[r]=t.readUint32():this.sample_composition_time_offset[r]=t.readInt32())}),o.createFullBoxCtor("tsel","TrackSelectionBox",function(t){this.switch_group=t.readUint32();var s=(this.size-this.hdr_size-4)/4;this.attribute_list=[];for(var r=0;r<s;r++)this.attribute_list[r]=t.readUint32()}),o.createFullBoxCtor("txtC","TextConfigBox",function(t){this.config=t.readCString()}),o.createBoxCtor("tyco","TypeCombinationBox",function(t){var s=(this.size-this.hdr_size)/4;this.compatible_brands=[];for(var r=0;r<s;r++)this.compatible_brands[r]=t.readString(4)}),o.createFullBoxCtor("udes","UserDescriptionProperty",function(t){this.lang=t.readCString(),this.name=t.readCString(),this.description=t.readCString(),this.tags=t.readCString()}),o.createFullBoxCtor("uncC","UncompressedFrameConfigBox",function(t){var s;if(this.profile=t.readString(4),this.version!=1){if(this.version==0){for(this.component_count=t.readUint32(),this.component_index=[],this.component_bit_depth_minus_one=[],this.component_format=[],this.component_align_size=[],s=0;s<this.component_count;s++)this.component_index.push(t.readUint16()),this.component_bit_depth_minus_one.push(t.readUint8()),this.component_format.push(t.readUint8()),this.component_align_size.push(t.readUint8());this.sampling_type=t.readUint8(),this.interleave_type=t.readUint8(),this.block_size=t.readUint8();var r=t.readUint8();this.component_little_endian=r>>7&1,this.block_pad_lsb=r>>6&1,this.block_little_endian=r>>5&1,this.block_reversed=r>>4&1,this.pad_unknown=r>>3&1,this.pixel_size=t.readUint32(),this.row_align_size=t.readUint32(),this.tile_align_size=t.readUint32(),this.num_tile_cols_minus_one=t.readUint32(),this.num_tile_rows_minus_one=t.readUint32()}}}),o.createFullBoxCtor("url ","DataEntryUrlBox",function(t){this.flags!==1&&(this.location=t.readCString())}),o.createFullBoxCtor("urn ","DataEntryUrnBox",function(t){this.name=t.readCString(),this.size-this.hdr_size-this.name.length-1>0&&(this.location=t.readCString())}),o.createUUIDBox("a5d40b30e81411ddba2f0800200c9a66","LiveServerManifestBox",!0,!1,function(t){this.LiveServerManifest=t.readString(this.size-this.hdr_size).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}),o.createUUIDBox("d08a4f1810f34a82b6c832d8aba183d3","PiffProtectionSystemSpecificHeaderBox",!0,!1,function(t){this.system_id=o.parseHex16(t);var s=t.readUint32();s>0&&(this.data=t.readUint8Array(s))}),o.createUUIDBox("a2394f525a9b4f14a2446c427c648df4","PiffSampleEncryptionBox",!0,!1),o.createUUIDBox("8974dbce7be74c5184f97148f9882554","PiffTrackEncryptionBox",!0,!1,function(t){this.default_AlgorithmID=t.readUint24(),this.default_IV_size=t.readUint8(),this.default_KID=o.parseHex16(t)}),o.createUUIDBox("d4807ef2ca3946958e5426cb9e46a79f","TfrfBox",!0,!1,function(t){this.fragment_count=t.readUint8(),this.entries=[];for(var s=0;s<this.fragment_count;s++){var r={},f=0,h=0;this.version===1?(f=t.readUint64(),h=t.readUint64()):(f=t.readUint32(),h=t.readUint32()),r.absolute_time=f,r.absolute_duration=h,this.entries.push(r)}}),o.createUUIDBox("6d1d9b0542d544e680e2141daff757b2","TfxdBox",!0,!1,function(t){this.version===1?(this.absolute_time=t.readUint64(),this.duration=t.readUint64()):(this.absolute_time=t.readUint32(),this.duration=t.readUint32())}),o.createFullBoxCtor("vmhd","VideoMediaHeaderBox",function(t){this.graphicsmode=t.readUint16(),this.opcolor=t.readUint16Array(3)}),o.createFullBoxCtor("vpcC","VPCodecConfigurationRecord",function(t){var s;this.version===1?(this.profile=t.readUint8(),this.level=t.readUint8(),s=t.readUint8(),this.bitDepth=s>>4,this.chromaSubsampling=s>>1&7,this.videoFullRangeFlag=s&1,this.colourPrimaries=t.readUint8(),this.transferCharacteristics=t.readUint8(),this.matrixCoefficients=t.readUint8(),this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize)):(this.profile=t.readUint8(),this.level=t.readUint8(),s=t.readUint8(),this.bitDepth=s>>4&15,this.colorSpace=s&15,s=t.readUint8(),this.chromaSubsampling=s>>4&15,this.transferFunction=s>>1&7,this.videoFullRangeFlag=s&1,this.codecIntializationDataSize=t.readUint16(),this.codecIntializationData=t.readUint8Array(this.codecIntializationDataSize))}),o.createBoxCtor("vttC","WebVTTConfigurationBox",function(t){this.text=t.readString(this.size-this.hdr_size)}),o.createFullBoxCtor("vvcC","VvcConfigurationBox",function(t){var s,r,f={held_bits:void 0,num_held_bits:0,stream_read_1_bytes:function(k){this.held_bits=k.readUint8(),this.num_held_bits=8},stream_read_2_bytes:function(k){this.held_bits=k.readUint16(),this.num_held_bits=16},extract_bits:function(k){var it=this.held_bits>>this.num_held_bits-k&(1<<k)-1;return this.num_held_bits-=k,it}};if(f.stream_read_1_bytes(t),f.extract_bits(5),this.lengthSizeMinusOne=f.extract_bits(2),this.ptl_present_flag=f.extract_bits(1),this.ptl_present_flag){f.stream_read_2_bytes(t),this.ols_idx=f.extract_bits(9),this.num_sublayers=f.extract_bits(3),this.constant_frame_rate=f.extract_bits(2),this.chroma_format_idc=f.extract_bits(2),f.stream_read_1_bytes(t),this.bit_depth_minus8=f.extract_bits(3),f.extract_bits(5);{if(f.stream_read_2_bytes(t),f.extract_bits(2),this.num_bytes_constraint_info=f.extract_bits(6),this.general_profile_idc=f.extract_bits(7),this.general_tier_flag=f.extract_bits(1),this.general_level_idc=t.readUint8(),f.stream_read_1_bytes(t),this.ptl_frame_only_constraint_flag=f.extract_bits(1),this.ptl_multilayer_enabled_flag=f.extract_bits(1),this.general_constraint_info=new Uint8Array(this.num_bytes_constraint_info),this.num_bytes_constraint_info){for(s=0;s<this.num_bytes_constraint_info-1;s++){var h=f.extract_bits(6);f.stream_read_1_bytes(t);var _=f.extract_bits(2);this.general_constraint_info[s]=h<<2|_}this.general_constraint_info[this.num_bytes_constraint_info-1]=f.extract_bits(6)}else f.extract_bits(6);if(this.num_sublayers>1){for(f.stream_read_1_bytes(t),this.ptl_sublayer_present_mask=0,r=this.num_sublayers-2;r>=0;--r){var g=f.extract_bits(1);this.ptl_sublayer_present_mask|=g<<r}for(r=this.num_sublayers;r<=8&&this.num_sublayers>1;++r)f.extract_bits(1);for(this.sublayer_level_idc=[],r=this.num_sublayers-2;r>=0;--r)this.ptl_sublayer_present_mask&1<<r&&(this.sublayer_level_idc[r]=t.readUint8())}if(this.ptl_num_sub_profiles=t.readUint8(),this.general_sub_profile_idc=[],this.ptl_num_sub_profiles)for(s=0;s<this.ptl_num_sub_profiles;s++)this.general_sub_profile_idc.push(t.readUint32())}this.max_picture_width=t.readUint16(),this.max_picture_height=t.readUint16(),this.avg_frame_rate=t.readUint16()}var x=12,w=13;this.nalu_arrays=[];var A=t.readUint8();for(s=0;s<A;s++){var T=[];this.nalu_arrays.push(T),f.stream_read_1_bytes(t),T.completeness=f.extract_bits(1),f.extract_bits(2),T.nalu_type=f.extract_bits(5);var z=1;for(T.nalu_type!=w&&T.nalu_type!=x&&(z=t.readUint16()),r=0;r<z;r++){var j=t.readUint16();T.push({data:t.readUint8Array(j),length:j})}}}),o.createFullBoxCtor("vvnC","VvcNALUConfigBox",function(t){var s=strm.readUint8();this.lengthSizeMinusOne=s&3}),o.SampleEntry.prototype.isVideo=function(){return!1},o.SampleEntry.prototype.isAudio=function(){return!1},o.SampleEntry.prototype.isSubtitle=function(){return!1},o.SampleEntry.prototype.isMetadata=function(){return!1},o.SampleEntry.prototype.isHint=function(){return!1},o.SampleEntry.prototype.getCodec=function(){return this.type.replace(".","")},o.SampleEntry.prototype.getWidth=function(){return""},o.SampleEntry.prototype.getHeight=function(){return""},o.SampleEntry.prototype.getChannelCount=function(){return""},o.SampleEntry.prototype.getSampleRate=function(){return""},o.SampleEntry.prototype.getSampleSize=function(){return""},o.VisualSampleEntry.prototype.isVideo=function(){return!0},o.VisualSampleEntry.prototype.getWidth=function(){return this.width},o.VisualSampleEntry.prototype.getHeight=function(){return this.height},o.AudioSampleEntry.prototype.isAudio=function(){return!0},o.AudioSampleEntry.prototype.getChannelCount=function(){return this.channel_count},o.AudioSampleEntry.prototype.getSampleRate=function(){return this.samplerate},o.AudioSampleEntry.prototype.getSampleSize=function(){return this.samplesize},o.SubtitleSampleEntry.prototype.isSubtitle=function(){return!0},o.MetadataSampleEntry.prototype.isMetadata=function(){return!0},o.decimalToHex=function(t,s){var r=Number(t).toString(16);for(s=typeof s>"u"||s===null?s=2:s;r.length<s;)r="0"+r;return r},o.avc1SampleEntry.prototype.getCodec=o.avc2SampleEntry.prototype.getCodec=o.avc3SampleEntry.prototype.getCodec=o.avc4SampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this);return this.avcC?t+"."+o.decimalToHex(this.avcC.AVCProfileIndication)+o.decimalToHex(this.avcC.profile_compatibility)+o.decimalToHex(this.avcC.AVCLevelIndication):t},o.hev1SampleEntry.prototype.getCodec=o.hvc1SampleEntry.prototype.getCodec=function(){var t,s=o.SampleEntry.prototype.getCodec.call(this);if(this.hvcC){switch(s+=".",this.hvcC.general_profile_space){case 0:s+="";break;case 1:s+="A";break;case 2:s+="B";break;case 3:s+="C";break}s+=this.hvcC.general_profile_idc,s+=".";var r=this.hvcC.general_profile_compatibility,f=0;for(t=0;t<32&&(f|=r&1,t!=31);t++)f<<=1,r>>=1;s+=o.decimalToHex(f,0),s+=".",this.hvcC.general_tier_flag===0?s+="L":s+="H",s+=this.hvcC.general_level_idc;var h=!1,_="";for(t=5;t>=0;t--)(this.hvcC.general_constraint_indicator[t]||h)&&(_="."+o.decimalToHex(this.hvcC.general_constraint_indicator[t],0)+_,h=!0);s+=_}return s},o.vvc1SampleEntry.prototype.getCodec=o.vvi1SampleEntry.prototype.getCodec=function(){var t,s=o.SampleEntry.prototype.getCodec.call(this);if(this.vvcC){s+="."+this.vvcC.general_profile_idc,this.vvcC.general_tier_flag?s+=".H":s+=".L",s+=this.vvcC.general_level_idc;var r="";if(this.vvcC.general_constraint_info){var f=[],h=0;h|=this.vvcC.ptl_frame_only_constraint<<7,h|=this.vvcC.ptl_multilayer_enabled<<6;var _;for(t=0;t<this.vvcC.general_constraint_info.length;++t)h|=this.vvcC.general_constraint_info[t]>>2&63,f.push(h),h&&(_=t),h=this.vvcC.general_constraint_info[t]>>2&3;if(_===void 0)r=".CA";else{r=".C";var g="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",x=0,w=0;for(t=0;t<=_;++t)for(x=x<<8|f[t],w+=8;w>=5;){var A=x>>w-5&31;r+=g[A],w-=5,x&=(1<<w)-1}w&&(x<<=5-w,r+=g[x&31])}}s+=r}return s},o.mp4aSampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this);if(this.esds&&this.esds.esd){var s=this.esds.esd.getOTI(),r=this.esds.esd.getAudioConfig();return t+"."+o.decimalToHex(s)+(r?"."+r:"")}else return t},o.stxtSampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this);return this.mime_format?t+"."+this.mime_format:t},o.vp08SampleEntry.prototype.getCodec=o.vp09SampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this),s=this.vpcC.level;s==0&&(s="00");var r=this.vpcC.bitDepth;return r==8&&(r="08"),t+".0"+this.vpcC.profile+"."+s+"."+r},o.av01SampleEntry.prototype.getCodec=function(){var t=o.SampleEntry.prototype.getCodec.call(this),s=this.av1C.seq_level_idx_0;s<10&&(s="0"+s);var r;return this.av1C.seq_profile===2&&this.av1C.high_bitdepth===1?r=this.av1C.twelve_bit===1?"12":"10":this.av1C.seq_profile<=2&&(r=this.av1C.high_bitdepth===1?"10":"08"),t+"."+this.av1C.seq_profile+"."+s+(this.av1C.seq_tier_0?"H":"M")+"."+r},o.Box.prototype.writeHeader=function(t,s){this.size+=8,this.size>c&&(this.size+=8),this.type==="uuid"&&(this.size+=16),n.debug("BoxWriter","Writing box "+this.type+" of size: "+this.size+" at position "+t.getPosition()+(s||"")),this.size>c?t.writeUint32(1):(this.sizePosition=t.getPosition(),t.writeUint32(this.size)),t.writeString(this.type,null,4),this.type==="uuid"&&t.writeUint8Array(this.uuid),this.size>c&&t.writeUint64(this.size)},o.FullBox.prototype.writeHeader=function(t){this.size+=4,o.Box.prototype.writeHeader.call(this,t," v="+this.version+" f="+this.flags),t.writeUint8(this.version),t.writeUint24(this.flags)},o.Box.prototype.write=function(t){this.type==="mdat"?this.data&&(this.size=this.data.length,this.writeHeader(t),t.writeUint8Array(this.data)):(this.size=this.data?this.data.length:0,this.writeHeader(t),this.data&&t.writeUint8Array(this.data))},o.ContainerBox.prototype.write=function(t){this.size=0,this.writeHeader(t);for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&(this.boxes[s].write(t),this.size+=this.boxes[s].size);n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.TrackReferenceTypeBox.prototype.write=function(t){this.size=this.track_ids.length*4,this.writeHeader(t),t.writeUint32Array(this.track_ids)},o.avcCBox.prototype.write=function(t){var s;for(this.size=7,s=0;s<this.SPS.length;s++)this.size+=2+this.SPS[s].length;for(s=0;s<this.PPS.length;s++)this.size+=2+this.PPS[s].length;for(this.ext&&(this.size+=this.ext.length),this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8(this.AVCProfileIndication),t.writeUint8(this.profile_compatibility),t.writeUint8(this.AVCLevelIndication),t.writeUint8(this.lengthSizeMinusOne+252),t.writeUint8(this.SPS.length+224),s=0;s<this.SPS.length;s++)t.writeUint16(this.SPS[s].length),t.writeUint8Array(this.SPS[s].nalu);for(t.writeUint8(this.PPS.length),s=0;s<this.PPS.length;s++)t.writeUint16(this.PPS[s].length),t.writeUint8Array(this.PPS[s].nalu);this.ext&&t.writeUint8Array(this.ext)},o.co64Box.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),s=0;s<this.chunk_offsets.length;s++)t.writeUint64(this.chunk_offsets[s])},o.cslgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(t),t.writeInt32(this.compositionToDTSShift),t.writeInt32(this.leastDecodeToDisplayDelta),t.writeInt32(this.greatestDecodeToDisplayDelta),t.writeInt32(this.compositionStartTime),t.writeInt32(this.compositionEndTime)},o.cttsBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)t.writeUint32(this.sample_counts[s]),this.version===1?t.writeInt32(this.sample_offsets[s]):t.writeUint32(this.sample_offsets[s])},o.drefBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++)this.entries[s].write(t),this.size+=this.entries[s].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.elngBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.extended_language.length,this.writeHeader(t),t.writeString(this.extended_language)},o.elstBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+12*this.entries.length,this.writeHeader(t),t.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var r=this.entries[s];t.writeUint32(r.segment_duration),t.writeInt32(r.media_time),t.writeInt16(r.media_rate_integer),t.writeInt16(r.media_rate_fraction)}},o.emsgBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1),this.writeHeader(t),t.writeCString(this.scheme_id_uri),t.writeCString(this.value),t.writeUint32(this.timescale),t.writeUint32(this.presentation_time_delta),t.writeUint32(this.event_duration),t.writeUint32(this.id),t.writeUint8Array(this.message_data)},o.ftypBox.prototype.write=function(t){this.size=8+4*this.compatible_brands.length,this.writeHeader(t),t.writeString(this.major_brand,null,4),t.writeUint32(this.minor_version);for(var s=0;s<this.compatible_brands.length;s++)t.writeString(this.compatible_brands[s],null,4)},o.hdlrBox.prototype.write=function(t){this.size=5*4+this.name.length+1,this.version=0,this.flags=0,this.writeHeader(t),t.writeUint32(0),t.writeString(this.handler,null,4),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeCString(this.name)},o.hvcCBox.prototype.write=function(t){var s,r;for(this.size=23,s=0;s<this.nalu_arrays.length;s++)for(this.size+=3,r=0;r<this.nalu_arrays[s].length;r++)this.size+=2+this.nalu_arrays[s][r].data.length;for(this.writeHeader(t),t.writeUint8(this.configurationVersion),t.writeUint8((this.general_profile_space<<6)+(this.general_tier_flag<<5)+this.general_profile_idc),t.writeUint32(this.general_profile_compatibility),t.writeUint8Array(this.general_constraint_indicator),t.writeUint8(this.general_level_idc),t.writeUint16(this.min_spatial_segmentation_idc+(15<<24)),t.writeUint8(this.parallelismType+252),t.writeUint8(this.chroma_format_idc+252),t.writeUint8(this.bit_depth_luma_minus8+248),t.writeUint8(this.bit_depth_chroma_minus8+248),t.writeUint16(this.avgFrameRate),t.writeUint8((this.constantFrameRate<<6)+(this.numTemporalLayers<<3)+(this.temporalIdNested<<2)+this.lengthSizeMinusOne),t.writeUint8(this.nalu_arrays.length),s=0;s<this.nalu_arrays.length;s++)for(t.writeUint8((this.nalu_arrays[s].completeness<<7)+this.nalu_arrays[s].nalu_type),t.writeUint16(this.nalu_arrays[s].length),r=0;r<this.nalu_arrays[s].length;r++)t.writeUint16(this.nalu_arrays[s][r].data.length),t.writeUint8Array(this.nalu_arrays[s][r].data)},o.kindBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=this.schemeURI.length+1+(this.value.length+1),this.writeHeader(t),t.writeCString(this.schemeURI),t.writeCString(this.value)},o.mdhdBox.prototype.write=function(t){this.size=4*4+2*2,this.flags=0,this.version=0,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint16(this.language),t.writeUint16(0)},o.mehdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.fragment_duration)},o.mfhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4,this.writeHeader(t),t.writeUint32(this.sequence_number)},o.mvhdBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=23*4+2*2,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.timescale),t.writeUint32(this.duration),t.writeUint32(this.rate),t.writeUint16(this.volume<<8),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32Array(this.matrix),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(this.next_track_id)},o.SampleEntry.prototype.writeHeader=function(t){this.size=8,o.Box.prototype.writeHeader.call(this,t),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint8(0),t.writeUint16(this.data_reference_index)},o.SampleEntry.prototype.writeFooter=function(t){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(t),this.size+=this.boxes[s].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.SampleEntry.prototype.write=function(t){this.writeHeader(t),t.writeUint8Array(this.data),this.size+=this.data.length,n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.VisualSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=2*7+6*4+32,t.writeUint16(0),t.writeUint16(0),t.writeUint32(0),t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.width),t.writeUint16(this.height),t.writeUint32(this.horizresolution),t.writeUint32(this.vertresolution),t.writeUint32(0),t.writeUint16(this.frame_count),t.writeUint8(Math.min(31,this.compressorname.length)),t.writeString(this.compressorname,null,31),t.writeUint16(this.depth),t.writeInt16(-1),this.writeFooter(t)},o.AudioSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=2*4+3*4,t.writeUint32(0),t.writeUint32(0),t.writeUint16(this.channel_count),t.writeUint16(this.samplesize),t.writeUint16(0),t.writeUint16(0),t.writeUint32(this.samplerate<<16),this.writeFooter(t)},o.stppSampleEntry.prototype.write=function(t){this.writeHeader(t),this.size+=this.namespace.length+1+this.schema_location.length+1+this.auxiliary_mime_types.length+1,t.writeCString(this.namespace),t.writeCString(this.schema_location),t.writeCString(this.auxiliary_mime_types),this.writeFooter(t)},o.SampleGroupEntry.prototype.write=function(t){t.writeUint8Array(this.data)},o.sbgpBox.prototype.write=function(t){this.version=1,this.flags=0,this.size=12+8*this.entries.length,this.writeHeader(t),t.writeString(this.grouping_type,null,4),t.writeUint32(this.grouping_type_parameter),t.writeUint32(this.entries.length);for(var s=0;s<this.entries.length;s++){var r=this.entries[s];t.writeInt32(r.sample_count),t.writeInt32(r.group_description_index)}},o.sgpdBox.prototype.write=function(t){var s,r;for(this.flags=0,this.size=12,s=0;s<this.entries.length;s++)r=this.entries[s],this.version===1&&(this.default_length===0&&(this.size+=4),this.size+=r.data.length);for(this.writeHeader(t),t.writeString(this.grouping_type,null,4),this.version===1&&t.writeUint32(this.default_length),this.version>=2&&t.writeUint32(this.default_sample_description_index),t.writeUint32(this.entries.length),s=0;s<this.entries.length;s++)r=this.entries[s],this.version===1&&this.default_length===0&&t.writeUint32(r.description_length),r.write(t)},o.sidxBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*4+2+2+12*this.references.length,this.writeHeader(t),t.writeUint32(this.reference_ID),t.writeUint32(this.timescale),t.writeUint32(this.earliest_presentation_time),t.writeUint32(this.first_offset),t.writeUint16(0),t.writeUint16(this.references.length);for(var s=0;s<this.references.length;s++){var r=this.references[s];t.writeUint32(r.reference_type<<31|r.referenced_size),t.writeUint32(r.subsegment_duration),t.writeUint32(r.starts_with_SAP<<31|r.SAP_type<<28|r.SAP_delta_time)}},o.smhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=4,this.writeHeader(t),t.writeUint16(this.balance),t.writeUint16(0)},o.stcoBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.chunk_offsets.length,this.writeHeader(t),t.writeUint32(this.chunk_offsets.length),t.writeUint32Array(this.chunk_offsets)},o.stscBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+12*this.first_chunk.length,this.writeHeader(t),t.writeUint32(this.first_chunk.length),s=0;s<this.first_chunk.length;s++)t.writeUint32(this.first_chunk[s]),t.writeUint32(this.samples_per_chunk[s]),t.writeUint32(this.sample_description_index[s])},o.stsdBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=0,this.writeHeader(t),t.writeUint32(this.entries.length),this.size+=4,s=0;s<this.entries.length;s++)this.entries[s].write(t),this.size+=this.entries[s].size;n.debug("BoxWriter","Adjusting box "+this.type+" with new size "+this.size),t.adjustUint32(this.sizePosition,this.size)},o.stshBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.shadowed_sample_numbers.length,this.writeHeader(t),t.writeUint32(this.shadowed_sample_numbers.length),s=0;s<this.shadowed_sample_numbers.length;s++)t.writeUint32(this.shadowed_sample_numbers[s]),t.writeUint32(this.sync_sample_numbers[s])},o.stssBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4+4*this.sample_numbers.length,this.writeHeader(t),t.writeUint32(this.sample_numbers.length),t.writeUint32Array(this.sample_numbers)},o.stszBox.prototype.write=function(t){var s,r=!0;if(this.version=0,this.flags=0,this.sample_sizes.length>0)for(s=0;s+1<this.sample_sizes.length;)if(this.sample_sizes[s+1]!==this.sample_sizes[0]){r=!1;break}else s++;else r=!1;this.size=8,r||(this.size+=4*this.sample_sizes.length),this.writeHeader(t),r?t.writeUint32(this.sample_sizes[0]):t.writeUint32(0),t.writeUint32(this.sample_sizes.length),r||t.writeUint32Array(this.sample_sizes)},o.sttsBox.prototype.write=function(t){var s;for(this.version=0,this.flags=0,this.size=4+8*this.sample_counts.length,this.writeHeader(t),t.writeUint32(this.sample_counts.length),s=0;s<this.sample_counts.length;s++)t.writeUint32(this.sample_counts[s]),t.writeUint32(this.sample_deltas[s])},o.tfdtBox.prototype.write=function(t){var s=Math.pow(2,32)-1;this.version=this.baseMediaDecodeTime>s?1:0,this.flags=0,this.size=4,this.version===1&&(this.size+=4),this.writeHeader(t),this.version===1?t.writeUint64(this.baseMediaDecodeTime):t.writeUint32(this.baseMediaDecodeTime)},o.tfhdBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&(this.size+=8),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&(this.size+=4),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&(this.size+=4),this.writeHeader(t),t.writeUint32(this.track_id),this.flags&o.TFHD_FLAG_BASE_DATA_OFFSET&&t.writeUint64(this.base_data_offset),this.flags&o.TFHD_FLAG_SAMPLE_DESC&&t.writeUint32(this.default_sample_description_index),this.flags&o.TFHD_FLAG_SAMPLE_DUR&&t.writeUint32(this.default_sample_duration),this.flags&o.TFHD_FLAG_SAMPLE_SIZE&&t.writeUint32(this.default_sample_size),this.flags&o.TFHD_FLAG_SAMPLE_FLAGS&&t.writeUint32(this.default_sample_flags)},o.tkhdBox.prototype.write=function(t){this.version=0,this.size=4*18+2*4,this.writeHeader(t),t.writeUint32(this.creation_time),t.writeUint32(this.modification_time),t.writeUint32(this.track_id),t.writeUint32(0),t.writeUint32(this.duration),t.writeUint32(0),t.writeUint32(0),t.writeInt16(this.layer),t.writeInt16(this.alternate_group),t.writeInt16(this.volume<<8),t.writeUint16(0),t.writeInt32Array(this.matrix),t.writeUint32(this.width),t.writeUint32(this.height)},o.trexBox.prototype.write=function(t){this.version=0,this.flags=0,this.size=4*5,this.writeHeader(t),t.writeUint32(this.track_id),t.writeUint32(this.default_sample_description_index),t.writeUint32(this.default_sample_duration),t.writeUint32(this.default_sample_size),t.writeUint32(this.default_sample_flags)},o.trunBox.prototype.write=function(t){this.version=0,this.size=4,this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.size+=4),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&(this.size+=4),this.flags&o.TRUN_FLAGS_DURATION&&(this.size+=4*this.sample_duration.length),this.flags&o.TRUN_FLAGS_SIZE&&(this.size+=4*this.sample_size.length),this.flags&o.TRUN_FLAGS_FLAGS&&(this.size+=4*this.sample_flags.length),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.size+=4*this.sample_composition_time_offset.length),this.writeHeader(t),t.writeUint32(this.sample_count),this.flags&o.TRUN_FLAGS_DATA_OFFSET&&(this.data_offset_position=t.getPosition(),t.writeInt32(this.data_offset)),this.flags&o.TRUN_FLAGS_FIRST_FLAG&&t.writeUint32(this.first_sample_flags);for(var s=0;s<this.sample_count;s++)this.flags&o.TRUN_FLAGS_DURATION&&t.writeUint32(this.sample_duration[s]),this.flags&o.TRUN_FLAGS_SIZE&&t.writeUint32(this.sample_size[s]),this.flags&o.TRUN_FLAGS_FLAGS&&t.writeUint32(this.sample_flags[s]),this.flags&o.TRUN_FLAGS_CTS_OFFSET&&(this.version===0?t.writeUint32(this.sample_composition_time_offset[s]):t.writeInt32(this.sample_composition_time_offset[s]))},o["url Box"].prototype.write=function(t){this.version=0,this.location?(this.flags=0,this.size=this.location.length+1):(this.flags=1,this.size=0),this.writeHeader(t),this.location&&t.writeCString(this.location)},o["urn Box"].prototype.write=function(t){this.version=0,this.flags=0,this.size=this.name.length+1+(this.location?this.location.length+1:0),this.writeHeader(t),t.writeCString(this.name),this.location&&t.writeCString(this.location)},o.vmhdBox.prototype.write=function(t){this.version=0,this.flags=1,this.size=8,this.writeHeader(t),t.writeUint16(this.graphicsmode),t.writeUint16Array(this.opcolor)},o.cttsBox.prototype.unpack=function(t){var s,r,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(r=0;r<this.sample_counts[s];r++)t[f].pts=t[f].dts+this.sample_offsets[s],f++},o.sttsBox.prototype.unpack=function(t){var s,r,f;for(f=0,s=0;s<this.sample_counts.length;s++)for(r=0;r<this.sample_counts[s];r++)f===0?t[f].dts=0:t[f].dts=t[f-1].dts+this.sample_deltas[s],f++},o.stcoBox.prototype.unpack=function(t){var s;for(s=0;s<this.chunk_offsets.length;s++)t[s].offset=this.chunk_offsets[s]},o.stscBox.prototype.unpack=function(t){var s,r,f,h,_;for(h=0,_=0,s=0;s<this.first_chunk.length;s++)for(r=0;r<(s+1<this.first_chunk.length?this.first_chunk[s+1]:1/0);r++)for(_++,f=0;f<this.samples_per_chunk[s];f++){if(t[h])t[h].description_index=this.sample_description_index[s],t[h].chunk_index=_;else return;h++}},o.stszBox.prototype.unpack=function(t){var s;for(s=0;s<this.sample_sizes.length;s++)t[s].size=this.sample_sizes[s]},o.DIFF_BOXES_PROP_NAMES=["boxes","entries","references","subsamples","items","item_infos","extents","associations","subsegments","ranges","seekLists","seekPoints","esd","levels"],o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES=["compatible_brands","matrix","opcolor","sample_counts","sample_deltas","first_chunk","samples_per_chunk","sample_sizes","chunk_offsets","sample_offsets","sample_description_index","sample_duration"],o.boxEqualFields=function(t,s){if(t&&!s)return!1;var r;for(r in t)if(!(o.DIFF_BOXES_PROP_NAMES.indexOf(r)>-1)){if(t[r]instanceof o.Box||s[r]instanceof o.Box)continue;if(typeof t[r]>"u"||typeof s[r]>"u")continue;if(typeof t[r]=="function"||typeof s[r]=="function")continue;if(t.subBoxNames&&t.subBoxNames.indexOf(r.slice(0,4))>-1||s.subBoxNames&&s.subBoxNames.indexOf(r.slice(0,4))>-1)continue;if(r==="data"||r==="start"||r==="size"||r==="creation_time"||r==="modification_time")continue;if(o.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(r)>-1)continue;if(t[r]!==s[r])return!1}return!0},o.boxEqual=function(t,s){if(!o.boxEqualFields(t,s))return!1;for(var r=0;r<o.DIFF_BOXES_PROP_NAMES.length;r++){var f=o.DIFF_BOXES_PROP_NAMES[r];if(t[f]&&s[f]&&!o.boxEqual(t[f],s[f]))return!1}return!0};var b=function(){};b.prototype.parseSample=function(t){var s,r,f=new a(t.buffer);for(s=[];!f.isEos();)r=o.parseOneBox(f,!1),r.code===o.OK&&r.box.type==="vttc"&&s.push(r.box);return s},b.prototype.getText=function(t,s,r){function f(A,T,z){return z=z||"0",A=A+"",A.length>=T?A:new Array(T-A.length+1).join(z)+A}function h(A){var T=Math.floor(A/3600),z=Math.floor((A-T*3600)/60),j=Math.floor(A-T*3600-z*60),k=Math.floor((A-T*3600-z*60-j)*1e3);return""+f(T,2)+":"+f(z,2)+":"+f(j,2)+"."+f(k,3)}for(var _=this.parseSample(r),g="",x=0;x<_.length;x++){var w=_[x];g+=h(t)+" --> "+h(s)+`\r
`,g+=w.payl.text}return g};var E=function(){};E.prototype.parseSample=function(t){var s={},r;s.resources=[];var f=new a(t.data.buffer);if(!t.subsamples||t.subsamples.length===0)s.documentString=f.readString(t.data.length);else if(s.documentString=f.readString(t.subsamples[0].size),t.subsamples.length>1)for(r=1;r<t.subsamples.length;r++)s.resources[r]=f.readUint8Array(t.subsamples[r].size);return typeof DOMParser<"u"&&(s.document=new DOMParser().parseFromString(s.documentString,"application/xml")),s};var C=function(){};C.prototype.parseSample=function(t){var s,r=new a(t.data.buffer);return s=r.readString(t.data.length),s},C.prototype.parseConfig=function(t){var s,r=new a(t.buffer);return r.readUint32(),s=r.readCString(),s},e.VTTin4Parser=b,e.XMLSubtitlein4Parser=E,e.Textin4Parser=C;var B=function(t){this.stream=t||new u,this.boxes=[],this.mdats=[],this.moofs=[],this.isProgressive=!1,this.moovStartFound=!1,this.onMoovStart=null,this.moovStartSent=!1,this.onReady=null,this.readySent=!1,this.onSegment=null,this.onSamples=null,this.onError=null,this.sampleListBuilt=!1,this.fragmentedTracks=[],this.extractedTracks=[],this.isFragmentationInitialized=!1,this.sampleProcessingStarted=!1,this.nextMoofNumber=0,this.itemListBuilt=!1,this.items=[],this.entity_groups=[],this.onSidx=null,this.sidxSent=!1};B.prototype.setSegmentOptions=function(t,s,r){var f=this.getTrackById(t);if(f){var h={};this.fragmentedTracks.push(h),h.id=t,h.user=s,h.trak=f,f.nextSample=0,h.segmentStream=null,h.nb_samples=1e3,h.rapAlignement=!0,r&&(r.nbSamples&&(h.nb_samples=r.nbSamples),r.rapAlignement&&(h.rapAlignement=r.rapAlignement))}},B.prototype.unsetSegmentOptions=function(t){for(var s=-1,r=0;r<this.fragmentedTracks.length;r++){var f=this.fragmentedTracks[r];f.id==t&&(s=r)}s>-1&&this.fragmentedTracks.splice(s,1)},B.prototype.setExtractionOptions=function(t,s,r){var f=this.getTrackById(t);if(f){var h={};this.extractedTracks.push(h),h.id=t,h.user=s,h.trak=f,f.nextSample=0,h.nb_samples=1e3,h.samples=[],r&&r.nbSamples&&(h.nb_samples=r.nbSamples)}},B.prototype.unsetExtractionOptions=function(t){for(var s=-1,r=0;r<this.extractedTracks.length;r++){var f=this.extractedTracks[r];f.id==t&&(s=r)}s>-1&&this.extractedTracks.splice(s,1)},B.prototype.parse=function(){var t,s,r=!1;if(!(this.restoreParsePosition&&!this.restoreParsePosition()))for(;;)if(this.hasIncompleteMdat&&this.hasIncompleteMdat()){if(this.processIncompleteMdat())continue;return}else if(this.saveParsePosition&&this.saveParsePosition(),t=o.parseOneBox(this.stream,r),t.code===o.ERR_NOT_ENOUGH_DATA)if(this.processIncompleteBox){if(this.processIncompleteBox(t))continue;return}else return;else{var f;switch(s=t.box,f=s.type!=="uuid"?s.type:s.uuid,this.boxes.push(s),f){case"mdat":this.mdats.push(s);break;case"moof":this.moofs.push(s);break;case"moov":this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0);default:this[f]!==void 0&&n.warn("ISOFile","Duplicate Box of type: "+f+", overriding previous occurrence"),this[f]=s;break}this.updateUsedBytes&&this.updateUsedBytes(s,t)}},B.prototype.checkBuffer=function(t){if(t==null)throw"Buffer must be defined and non empty";if(t.fileStart===void 0)throw"Buffer must have a fileStart property";return t.byteLength===0?(n.warn("ISOFile","Ignoring empty buffer (fileStart: "+t.fileStart+")"),this.stream.logBufferLevel(),!1):(n.info("ISOFile","Processing buffer (fileStart: "+t.fileStart+")"),t.usedBytes=0,this.stream.insertBuffer(t),this.stream.logBufferLevel(),this.stream.initialized()?!0:(n.warn("ISOFile","Not ready to start parsing"),!1))},B.prototype.appendBuffer=function(t,s){var r;if(this.checkBuffer(t))return this.parse(),this.moovStartFound&&!this.moovStartSent&&(this.moovStartSent=!0,this.onMoovStart&&this.onMoovStart()),this.moov?(this.sampleListBuilt||(this.buildSampleLists(),this.sampleListBuilt=!0),this.updateSampleLists(),this.onReady&&!this.readySent&&(this.readySent=!0,this.onReady(this.getInfo())),this.processSamples(s),this.nextSeekPosition?(r=this.nextSeekPosition,this.nextSeekPosition=void 0):r=this.nextParsePosition,this.stream.getEndFilePositionAfter&&(r=this.stream.getEndFilePositionAfter(r))):this.nextParsePosition?r=this.nextParsePosition:r=0,this.sidx&&this.onSidx&&!this.sidxSent&&(this.onSidx(this.sidx),this.sidxSent=!0),this.meta&&(this.flattenItemInfo&&!this.itemListBuilt&&(this.flattenItemInfo(),this.itemListBuilt=!0),this.processItems&&this.processItems(this.onItem)),this.stream.cleanBuffers&&(n.info("ISOFile","Done processing buffer (fileStart: "+t.fileStart+") - next buffer to fetch should have a fileStart position of "+r),this.stream.logBufferLevel(),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize())),r},B.prototype.getInfo=function(){var t,s,r={},f,h,_,g,x=new Date("1904-01-01T00:00:00Z").getTime();if(this.moov)for(r.hasMoov=!0,r.duration=this.moov.mvhd.duration,r.timescale=this.moov.mvhd.timescale,r.isFragmented=this.moov.mvex!=null,r.isFragmented&&this.moov.mvex.mehd&&(r.fragment_duration=this.moov.mvex.mehd.fragment_duration),r.isProgressive=this.isProgressive,r.hasIOD=this.moov.iods!=null,r.brands=[],r.brands.push(this.ftyp.major_brand),r.brands=r.brands.concat(this.ftyp.compatible_brands),r.created=new Date(x+this.moov.mvhd.creation_time*1e3),r.modified=new Date(x+this.moov.mvhd.modification_time*1e3),r.tracks=[],r.audioTracks=[],r.videoTracks=[],r.subtitleTracks=[],r.metadataTracks=[],r.hintTracks=[],r.otherTracks=[],t=0;t<this.moov.traks.length;t++){if(f=this.moov.traks[t],g=f.mdia.minf.stbl.stsd.entries[0],h={},r.tracks.push(h),h.id=f.tkhd.track_id,h.name=f.mdia.hdlr.name,h.references=[],f.tref)for(s=0;s<f.tref.boxes.length;s++)_={},h.references.push(_),_.type=f.tref.boxes[s].type,_.track_ids=f.tref.boxes[s].track_ids;f.edts&&(h.edits=f.edts.elst.entries),h.created=new Date(x+f.tkhd.creation_time*1e3),h.modified=new Date(x+f.tkhd.modification_time*1e3),h.movie_duration=f.tkhd.duration,h.movie_timescale=r.timescale,h.layer=f.tkhd.layer,h.alternate_group=f.tkhd.alternate_group,h.volume=f.tkhd.volume,h.matrix=f.tkhd.matrix,h.track_width=f.tkhd.width/65536,h.track_height=f.tkhd.height/65536,h.timescale=f.mdia.mdhd.timescale,h.cts_shift=f.mdia.minf.stbl.cslg,h.duration=f.mdia.mdhd.duration,h.samples_duration=f.samples_duration,h.codec=g.getCodec(),h.kind=f.udta&&f.udta.kinds.length?f.udta.kinds[0]:{schemeURI:"",value:""},h.language=f.mdia.elng?f.mdia.elng.extended_language:f.mdia.mdhd.languageString,h.nb_samples=f.samples.length,h.size=f.samples_size,h.bitrate=h.size*8*h.timescale/h.samples_duration,g.isAudio()?(h.type="audio",r.audioTracks.push(h),h.audio={},h.audio.sample_rate=g.getSampleRate(),h.audio.channel_count=g.getChannelCount(),h.audio.sample_size=g.getSampleSize()):g.isVideo()?(h.type="video",r.videoTracks.push(h),h.video={},h.video.width=g.getWidth(),h.video.height=g.getHeight()):g.isSubtitle()?(h.type="subtitles",r.subtitleTracks.push(h)):g.isHint()?(h.type="metadata",r.hintTracks.push(h)):g.isMetadata()?(h.type="metadata",r.metadataTracks.push(h)):(h.type="metadata",r.otherTracks.push(h))}else r.hasMoov=!1;if(r.mime="",r.hasMoov&&r.tracks){for(r.videoTracks&&r.videoTracks.length>0?r.mime+='video/mp4; codecs="':r.audioTracks&&r.audioTracks.length>0?r.mime+='audio/mp4; codecs="':r.mime+='application/mp4; codecs="',t=0;t<r.tracks.length;t++)t!==0&&(r.mime+=","),r.mime+=r.tracks[t].codec;r.mime+='"; profiles="',r.mime+=this.ftyp.compatible_brands.join(),r.mime+='"'}return r},B.prototype.setNextSeekPositionFromSample=function(t){t&&(this.nextSeekPosition?this.nextSeekPosition=Math.min(t.offset+t.alreadyRead,this.nextSeekPosition):this.nextSeekPosition=t.offset+t.alreadyRead)},B.prototype.processSamples=function(t){var s,r;if(this.sampleProcessingStarted){if(this.isFragmentationInitialized&&this.onSegment!==null)for(s=0;s<this.fragmentedTracks.length;s++){var f=this.fragmentedTracks[s];for(r=f.trak;r.nextSample<r.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Creating media fragment on track #"+f.id+" for sample "+r.nextSample);var h=this.createFragment(f.id,r.nextSample,f.segmentStream);if(h)f.segmentStream=h,r.nextSample++;else break;if((r.nextSample%f.nb_samples===0||t||r.nextSample>=r.samples.length)&&(n.info("ISOFile","Sending fragmented data on track #"+f.id+" for samples ["+Math.max(0,r.nextSample-f.nb_samples)+","+(r.nextSample-1)+"]"),n.info("ISOFile","Sample data size in memory: "+this.getAllocatedSampleDataSize()),this.onSegment&&this.onSegment(f.id,f.user,f.segmentStream.buffer,r.nextSample,t||r.nextSample>=r.samples.length),f.segmentStream=null,f!==this.fragmentedTracks[s]))break}}if(this.onSamples!==null)for(s=0;s<this.extractedTracks.length;s++){var _=this.extractedTracks[s];for(r=_.trak;r.nextSample<r.samples.length&&this.sampleProcessingStarted;){n.debug("ISOFile","Exporting on track #"+_.id+" sample #"+r.nextSample);var g=this.getSample(r,r.nextSample);if(g)r.nextSample++,_.samples.push(g);else{this.setNextSeekPositionFromSample(r.samples[r.nextSample]);break}if((r.nextSample%_.nb_samples===0||r.nextSample>=r.samples.length)&&(n.debug("ISOFile","Sending samples on track #"+_.id+" for sample "+r.nextSample),this.onSamples&&this.onSamples(_.id,_.user,_.samples),_.samples=[],_!==this.extractedTracks[s]))break}}}},B.prototype.getBox=function(t){var s=this.getBoxes(t,!0);return s.length?s[0]:null},B.prototype.getBoxes=function(t,s){var r=[];return B._sweep.call(this,t,r,s),r},B._sweep=function(t,s,r){this.type&&this.type==t&&s.push(this);for(var f in this.boxes){if(s.length&&r)return;B._sweep.call(this.boxes[f],t,s,r)}},B.prototype.getTrackSamplesInfo=function(t){var s=this.getTrackById(t);if(s)return s.samples},B.prototype.getTrackSample=function(t,s){var r=this.getTrackById(t),f=this.getSample(r,s);return f},B.prototype.releaseUsedSamples=function(t,s){var r=0,f=this.getTrackById(t);f.lastValidSample||(f.lastValidSample=0);for(var h=f.lastValidSample;h<s;h++)r+=this.releaseSample(f,h);n.info("ISOFile","Track #"+t+" released samples up to "+s+" (released size: "+r+", remaining: "+this.samplesDataSize+")"),f.lastValidSample=s},B.prototype.start=function(){this.sampleProcessingStarted=!0,this.processSamples(!1)},B.prototype.stop=function(){this.sampleProcessingStarted=!1},B.prototype.flush=function(){n.info("ISOFile","Flushing remaining samples"),this.updateSampleLists(),this.processSamples(!0),this.stream.cleanBuffers(),this.stream.logBufferLevel(!0)},B.prototype.seekTrack=function(t,s,r){var f,h,_=1/0,g=0,x=0,w;if(r.samples.length===0)return n.info("ISOFile","No sample in track, cannot seek! Using time "+n.getDurationString(0,1)+" and offset: 0"),{offset:0,time:0};for(f=0;f<r.samples.length;f++){if(h=r.samples[f],f===0)x=0,w=h.timescale;else if(h.cts>t*h.timescale){x=f-1;break}s&&h.is_sync&&(g=f)}for(s&&(x=g),t=r.samples[x].cts,r.nextSample=x;r.samples[x].alreadyRead===r.samples[x].size&&r.samples[x+1];)x++;return _=r.samples[x].offset+r.samples[x].alreadyRead,n.info("ISOFile","Seeking to "+(s?"RAP":"")+" sample #"+r.nextSample+" on track "+r.tkhd.track_id+", time "+n.getDurationString(t,w)+" and offset: "+_),{offset:_,time:t/w}},B.prototype.getTrackDuration=function(t){var s;return t.samples?(s=t.samples[t.samples.length-1],(s.cts+s.duration)/s.timescale):1/0},B.prototype.seek=function(t,s){var r=this.moov,f,h,_,g={offset:1/0,time:1/0};if(this.moov){for(_=0;_<r.traks.length;_++)f=r.traks[_],!(t>this.getTrackDuration(f))&&(h=this.seekTrack(t,s,f),h.offset<g.offset&&(g.offset=h.offset),h.time<g.time&&(g.time=h.time));return n.info("ISOFile","Seeking at time "+n.getDurationString(g.time,1)+" needs a buffer with a fileStart position of "+g.offset),g.offset===1/0?g={offset:this.nextParsePosition,time:0}:g.offset=this.stream.getEndFilePositionAfter(g.offset),n.info("ISOFile","Adjusted seek position (after checking data already in buffer): "+g.offset),g}else throw"Cannot seek: moov not received!"},B.prototype.equal=function(t){for(var s=0;s<this.boxes.length&&s<t.boxes.length;){var r=this.boxes[s],f=t.boxes[s];if(!o.boxEqual(r,f))return!1;s++}return!0},e.ISOFile=B,B.prototype.lastBoxStartPosition=0,B.prototype.parsingMdat=null,B.prototype.nextParsePosition=0,B.prototype.discardMdatData=!1,B.prototype.processIncompleteBox=function(t){var s,r,f;return t.type==="mdat"?(s=new o[t.type+"Box"](t.size),this.parsingMdat=s,this.boxes.push(s),this.mdats.push(s),s.start=t.start,s.hdr_size=t.hdr_size,this.stream.addUsedBytes(s.hdr_size),this.lastBoxStartPosition=s.start+s.size,f=this.stream.seek(s.start+s.size,!1,this.discardMdatData),f?(this.parsingMdat=null,!0):(this.moovStartFound?this.nextParsePosition=this.stream.findEndContiguousBuf():this.nextParsePosition=s.start+s.size,!1)):(t.type==="moov"&&(this.moovStartFound=!0,this.mdats.length===0&&(this.isProgressive=!0)),r=this.stream.mergeNextBuffer?this.stream.mergeNextBuffer():!1,r?(this.nextParsePosition=this.stream.getEndPosition(),!0):(t.type?this.moovStartFound?this.nextParsePosition=this.stream.getEndPosition():this.nextParsePosition=this.stream.getPosition()+t.size:this.nextParsePosition=this.stream.getEndPosition(),!1))},B.prototype.hasIncompleteMdat=function(){return this.parsingMdat!==null},B.prototype.processIncompleteMdat=function(){var t,s;return t=this.parsingMdat,s=this.stream.seek(t.start+t.size,!1,this.discardMdatData),s?(n.debug("ISOFile","Found 'mdat' end in buffered data"),this.parsingMdat=null,!0):(this.nextParsePosition=this.stream.findEndContiguousBuf(),!1)},B.prototype.restoreParsePosition=function(){return this.stream.seek(this.lastBoxStartPosition,!0,this.discardMdatData)},B.prototype.saveParsePosition=function(){this.lastBoxStartPosition=this.stream.getPosition()},B.prototype.updateUsedBytes=function(t,s){this.stream.addUsedBytes&&(t.type==="mdat"?(this.stream.addUsedBytes(t.hdr_size),this.discardMdatData&&this.stream.addUsedBytes(t.size-t.hdr_size)):this.stream.addUsedBytes(t.size))},B.prototype.add=o.Box.prototype.add,B.prototype.addBox=o.Box.prototype.addBox,B.prototype.init=function(t){var s=t||{};this.add("ftyp").set("major_brand",s.brands&&s.brands[0]||"iso4").set("minor_version",0).set("compatible_brands",s.brands||["iso4"]);var r=this.add("moov");return r.add("mvhd").set("timescale",s.timescale||600).set("rate",s.rate||65536).set("creation_time",0).set("modification_time",0).set("duration",s.duration||0).set("volume",s.width?0:256).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("next_track_id",1),r.add("mvex"),this},B.prototype.addTrack=function(t){this.moov||this.init(t);var s=t||{};s.width=s.width||320,s.height=s.height||320,s.id=s.id||this.moov.mvhd.next_track_id,s.type=s.type||"avc1";var r=this.moov.add("trak");this.moov.mvhd.next_track_id=s.id+1,r.add("tkhd").set("flags",o.TKHD_FLAG_ENABLED|o.TKHD_FLAG_IN_MOVIE|o.TKHD_FLAG_IN_PREVIEW).set("creation_time",0).set("modification_time",0).set("track_id",s.id).set("duration",s.duration||0).set("layer",s.layer||0).set("alternate_group",0).set("volume",1).set("matrix",[65536,0,0,0,65536,0,0,0,1073741824]).set("width",s.width<<16).set("height",s.height<<16);var f=r.add("mdia");f.add("mdhd").set("creation_time",0).set("modification_time",0).set("timescale",s.timescale||1).set("duration",s.media_duration||0).set("language",s.language||"und"),f.add("hdlr").set("handler",s.hdlr||"vide").set("name",s.name||"Track created with MP4Box.js"),f.add("elng").set("extended_language",s.language||"fr-FR");var h=f.add("minf");if(o[s.type+"SampleEntry"]!==void 0){var _=new o[s.type+"SampleEntry"];_.data_reference_index=1;var g="";for(var x in o.sampleEntryCodes)for(var w=o.sampleEntryCodes[x],A=0;A<w.length;A++)if(w.indexOf(s.type)>-1){g=x;break}switch(g){case"Visual":if(h.add("vmhd").set("graphicsmode",0).set("opcolor",[0,0,0]),_.set("width",s.width).set("height",s.height).set("horizresolution",72<<16).set("vertresolution",72<<16).set("frame_count",1).set("compressorname",s.type+" Compressor").set("depth",24),s.avcDecoderConfigRecord){var T=new o.avcCBox;T.parse(new a(s.avcDecoderConfigRecord)),_.addBox(T)}else if(s.hevcDecoderConfigRecord){var z=new o.hvcCBox;z.parse(new a(s.hevcDecoderConfigRecord)),_.addBox(z)}break;case"Audio":h.add("smhd").set("balance",s.balance||0),_.set("channel_count",s.channel_count||2).set("samplesize",s.samplesize||16).set("samplerate",s.samplerate||65536);break;case"Hint":h.add("hmhd");break;case"Subtitle":switch(h.add("sthd"),s.type){case"stpp":_.set("namespace",s.namespace||"nonamespace").set("schema_location",s.schema_location||"").set("auxiliary_mime_types",s.auxiliary_mime_types||"");break}break;case"Metadata":h.add("nmhd");break;case"System":h.add("nmhd");break;default:h.add("nmhd");break}s.description&&_.addBox(s.description),s.description_boxes&&s.description_boxes.forEach(function(k){_.addBox(k)}),h.add("dinf").add("dref").addEntry(new o["url Box"]().set("flags",1));var j=h.add("stbl");return j.add("stsd").addEntry(_),j.add("stts").set("sample_counts",[]).set("sample_deltas",[]),j.add("stsc").set("first_chunk",[]).set("samples_per_chunk",[]).set("sample_description_index",[]),j.add("stco").set("chunk_offsets",[]),j.add("stsz").set("sample_sizes",[]),this.moov.mvex.add("trex").set("track_id",s.id).set("default_sample_description_index",s.default_sample_description_index||1).set("default_sample_duration",s.default_sample_duration||0).set("default_sample_size",s.default_sample_size||0).set("default_sample_flags",s.default_sample_flags||0),this.buildTrakSampleLists(r),s.id}},o.Box.prototype.computeSize=function(t){var s=t||new l;s.endianness=l.BIG_ENDIAN,this.write(s)},B.prototype.addSample=function(t,s,r){var f=r||{},h={},_=this.getTrackById(t);if(_!==null){h.number=_.samples.length,h.track_id=_.tkhd.track_id,h.timescale=_.mdia.mdhd.timescale,h.description_index=f.sample_description_index?f.sample_description_index-1:0,h.description=_.mdia.minf.stbl.stsd.entries[h.description_index],h.data=s,h.size=s.byteLength,h.alreadyRead=h.size,h.duration=f.duration||1,h.cts=f.cts||0,h.dts=f.dts||0,h.is_sync=f.is_sync||!1,h.is_leading=f.is_leading||0,h.depends_on=f.depends_on||0,h.is_depended_on=f.is_depended_on||0,h.has_redundancy=f.has_redundancy||0,h.degradation_priority=f.degradation_priority||0,h.offset=0,h.subsamples=f.subsamples,_.samples.push(h),_.samples_size+=h.size,_.samples_duration+=h.duration,_.first_dts===void 0&&(_.first_dts=f.dts),this.processSamples();var g=this.createSingleSampleMoof(h);return this.addBox(g),g.computeSize(),g.trafs[0].truns[0].data_offset=g.size+8,this.add("mdat").data=new Uint8Array(s),h}},B.prototype.createSingleSampleMoof=function(t){var s=0;t.is_sync?s=1<<25:s=65536;var r=new o.moofBox;r.add("mfhd").set("sequence_number",this.nextMoofNumber),this.nextMoofNumber++;var f=r.add("traf"),h=this.getTrackById(t.track_id);return f.add("tfhd").set("track_id",t.track_id).set("flags",o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),f.add("tfdt").set("baseMediaDecodeTime",t.dts-(h.first_dts||0)),f.add("trun").set("flags",o.TRUN_FLAGS_DATA_OFFSET|o.TRUN_FLAGS_DURATION|o.TRUN_FLAGS_SIZE|o.TRUN_FLAGS_FLAGS|o.TRUN_FLAGS_CTS_OFFSET).set("data_offset",0).set("first_sample_flags",0).set("sample_count",1).set("sample_duration",[t.duration]).set("sample_size",[t.size]).set("sample_flags",[s]).set("sample_composition_time_offset",[t.cts-t.dts]),r},B.prototype.lastMoofIndex=0,B.prototype.samplesDataSize=0,B.prototype.resetTables=function(){var t,s,r,f,h,_,g,x;for(this.initial_duration=this.moov.mvhd.duration,this.moov.mvhd.duration=0,t=0;t<this.moov.traks.length;t++){s=this.moov.traks[t],s.tkhd.duration=0,s.mdia.mdhd.duration=0,r=s.mdia.minf.stbl.stco||s.mdia.minf.stbl.co64,r.chunk_offsets=[],f=s.mdia.minf.stbl.stsc,f.first_chunk=[],f.samples_per_chunk=[],f.sample_description_index=[],h=s.mdia.minf.stbl.stsz||s.mdia.minf.stbl.stz2,h.sample_sizes=[],_=s.mdia.minf.stbl.stts,_.sample_counts=[],_.sample_deltas=[],g=s.mdia.minf.stbl.ctts,g&&(g.sample_counts=[],g.sample_offsets=[]),x=s.mdia.minf.stbl.stss;var w=s.mdia.minf.stbl.boxes.indexOf(x);w!=-1&&(s.mdia.minf.stbl.boxes[w]=null)}},B.initSampleGroups=function(t,s,r,f,h){var _,g,x,w;function A(T,z,j){this.grouping_type=T,this.grouping_type_parameter=z,this.sbgp=j,this.last_sample_in_run=-1,this.entry_index=-1}for(s&&(s.sample_groups_info=[]),t.sample_groups_info||(t.sample_groups_info=[]),g=0;g<r.length;g++){for(w=r[g].grouping_type+"/"+r[g].grouping_type_parameter,x=new A(r[g].grouping_type,r[g].grouping_type_parameter,r[g]),s&&(s.sample_groups_info[w]=x),t.sample_groups_info[w]||(t.sample_groups_info[w]=x),_=0;_<f.length;_++)f[_].grouping_type===r[g].grouping_type&&(x.description=f[_],x.description.used=!0);if(h)for(_=0;_<h.length;_++)h[_].grouping_type===r[g].grouping_type&&(x.fragment_description=h[_],x.fragment_description.used=!0,x.is_fragment=!0)}if(s){if(h)for(g=0;g<h.length;g++)!h[g].used&&h[g].version>=2&&(w=h[g].grouping_type+"/0",x=new A(h[g].grouping_type,0),x.is_fragment=!0,s.sample_groups_info[w]||(s.sample_groups_info[w]=x))}else for(g=0;g<f.length;g++)!f[g].used&&f[g].version>=2&&(w=f[g].grouping_type+"/0",x=new A(f[g].grouping_type,0),t.sample_groups_info[w]||(t.sample_groups_info[w]=x))},B.setSampleGroupProperties=function(t,s,r,f){var h,_;s.sample_groups=[];for(h in f)if(s.sample_groups[h]={},s.sample_groups[h].grouping_type=f[h].grouping_type,s.sample_groups[h].grouping_type_parameter=f[h].grouping_type_parameter,r>=f[h].last_sample_in_run&&(f[h].last_sample_in_run<0&&(f[h].last_sample_in_run=0),f[h].entry_index++,f[h].entry_index<=f[h].sbgp.entries.length-1&&(f[h].last_sample_in_run+=f[h].sbgp.entries[f[h].entry_index].sample_count)),f[h].entry_index<=f[h].sbgp.entries.length-1?s.sample_groups[h].group_description_index=f[h].sbgp.entries[f[h].entry_index].group_description_index:s.sample_groups[h].group_description_index=-1,s.sample_groups[h].group_description_index!==0){var g;f[h].fragment_description?g=f[h].fragment_description:g=f[h].description,s.sample_groups[h].group_description_index>0?(s.sample_groups[h].group_description_index>65535?_=(s.sample_groups[h].group_description_index>>16)-1:_=s.sample_groups[h].group_description_index-1,g&&_>=0&&(s.sample_groups[h].description=g.entries[_])):g&&g.version>=2&&g.default_group_description_index>0&&(s.sample_groups[h].description=g.entries[g.default_group_description_index-1])}},B.process_sdtp=function(t,s,r){s&&(t?(s.is_leading=t.is_leading[r],s.depends_on=t.sample_depends_on[r],s.is_depended_on=t.sample_is_depended_on[r],s.has_redundancy=t.sample_has_redundancy[r]):(s.is_leading=0,s.depends_on=0,s.is_depended_on=0,s.has_redundancy=0))},B.prototype.buildSampleLists=function(){var t,s;for(t=0;t<this.moov.traks.length;t++)s=this.moov.traks[t],this.buildTrakSampleLists(s)},B.prototype.buildTrakSampleLists=function(t){var s,r,f,h,_,g,x,w,A,T,z,j,k,it,nt,ht,tt,J,pt,mt,wt,yt,Ut,Dt;if(t.samples=[],t.samples_duration=0,t.samples_size=0,r=t.mdia.minf.stbl.stco||t.mdia.minf.stbl.co64,f=t.mdia.minf.stbl.stsc,h=t.mdia.minf.stbl.stsz||t.mdia.minf.stbl.stz2,_=t.mdia.minf.stbl.stts,g=t.mdia.minf.stbl.ctts,x=t.mdia.minf.stbl.stss,w=t.mdia.minf.stbl.stsd,A=t.mdia.minf.stbl.subs,j=t.mdia.minf.stbl.stdp,T=t.mdia.minf.stbl.sbgps,z=t.mdia.minf.stbl.sgpds,J=-1,pt=-1,mt=-1,wt=-1,yt=0,Ut=0,Dt=0,B.initSampleGroups(t,null,T,z),!(typeof h>"u")){for(s=0;s<h.sample_sizes.length;s++){var Q={};Q.number=s,Q.track_id=t.tkhd.track_id,Q.timescale=t.mdia.mdhd.timescale,Q.alreadyRead=0,t.samples[s]=Q,Q.size=h.sample_sizes[s],t.samples_size+=Q.size,s===0?(it=1,k=0,Q.chunk_index=it,Q.chunk_run_index=k,tt=f.samples_per_chunk[k],ht=0,k+1<f.first_chunk.length?nt=f.first_chunk[k+1]-1:nt=1/0):s<tt?(Q.chunk_index=it,Q.chunk_run_index=k):(it++,Q.chunk_index=it,ht=0,it<=nt||(k++,k+1<f.first_chunk.length?nt=f.first_chunk[k+1]-1:nt=1/0),Q.chunk_run_index=k,tt+=f.samples_per_chunk[k]),Q.description_index=f.sample_description_index[Q.chunk_run_index]-1,Q.description=w.entries[Q.description_index],Q.offset=r.chunk_offsets[Q.chunk_index-1]+ht,ht+=Q.size,s>J&&(pt++,J<0&&(J=0),J+=_.sample_counts[pt]),s>0?(t.samples[s-1].duration=_.sample_deltas[pt],t.samples_duration+=t.samples[s-1].duration,Q.dts=t.samples[s-1].dts+t.samples[s-1].duration):Q.dts=0,g?(s>=mt&&(wt++,mt<0&&(mt=0),mt+=g.sample_counts[wt]),Q.cts=t.samples[s].dts+g.sample_offsets[wt]):Q.cts=Q.dts,x?(s==x.sample_numbers[yt]-1?(Q.is_sync=!0,yt++):(Q.is_sync=!1,Q.degradation_priority=0),A&&A.entries[Ut].sample_delta+Dt==s+1&&(Q.subsamples=A.entries[Ut].subsamples,Dt+=A.entries[Ut].sample_delta,Ut++)):Q.is_sync=!0,B.process_sdtp(t.mdia.minf.stbl.sdtp,Q,Q.number),j?Q.degradation_priority=j.priority[s]:Q.degradation_priority=0,A&&A.entries[Ut].sample_delta+Dt==s&&(Q.subsamples=A.entries[Ut].subsamples,Dt+=A.entries[Ut].sample_delta),(T.length>0||z.length>0)&&B.setSampleGroupProperties(t,Q,s,t.sample_groups_info)}s>0&&(t.samples[s-1].duration=Math.max(t.mdia.mdhd.duration-t.samples[s-1].dts,0),t.samples_duration+=t.samples[s-1].duration)}},B.prototype.updateSampleLists=function(){var t,s,r,f,h,_,g,x,w,A,T,z,j,k,it;if(this.moov!==void 0){for(;this.lastMoofIndex<this.moofs.length;)if(w=this.moofs[this.lastMoofIndex],this.lastMoofIndex++,w.type=="moof")for(A=w,t=0;t<A.trafs.length;t++){for(T=A.trafs[t],z=this.getTrackById(T.tfhd.track_id),j=this.getTrexById(T.tfhd.track_id),T.tfhd.flags&o.TFHD_FLAG_SAMPLE_DESC?f=T.tfhd.default_sample_description_index:f=j?j.default_sample_description_index:1,T.tfhd.flags&o.TFHD_FLAG_SAMPLE_DUR?h=T.tfhd.default_sample_duration:h=j?j.default_sample_duration:0,T.tfhd.flags&o.TFHD_FLAG_SAMPLE_SIZE?_=T.tfhd.default_sample_size:_=j?j.default_sample_size:0,T.tfhd.flags&o.TFHD_FLAG_SAMPLE_FLAGS?g=T.tfhd.default_sample_flags:g=j?j.default_sample_flags:0,T.sample_number=0,T.sbgps.length>0&&B.initSampleGroups(z,T,T.sbgps,z.mdia.minf.stbl.sgpds,T.sgpds),s=0;s<T.truns.length;s++){var nt=T.truns[s];for(r=0;r<nt.sample_count;r++){k={},k.moof_number=this.lastMoofIndex,k.number_in_traf=T.sample_number,T.sample_number++,k.number=z.samples.length,T.first_sample_index=z.samples.length,z.samples.push(k),k.track_id=z.tkhd.track_id,k.timescale=z.mdia.mdhd.timescale,k.description_index=f-1,k.description=z.mdia.minf.stbl.stsd.entries[k.description_index],k.size=_,nt.flags&o.TRUN_FLAGS_SIZE&&(k.size=nt.sample_size[r]),z.samples_size+=k.size,k.duration=h,nt.flags&o.TRUN_FLAGS_DURATION&&(k.duration=nt.sample_duration[r]),z.samples_duration+=k.duration,z.first_traf_merged||r>0?k.dts=z.samples[z.samples.length-2].dts+z.samples[z.samples.length-2].duration:(T.tfdt?k.dts=T.tfdt.baseMediaDecodeTime:k.dts=0,z.first_traf_merged=!0),k.cts=k.dts,nt.flags&o.TRUN_FLAGS_CTS_OFFSET&&(k.cts=k.dts+nt.sample_composition_time_offset[r]),it=g,nt.flags&o.TRUN_FLAGS_FLAGS?it=nt.sample_flags[r]:r===0&&nt.flags&o.TRUN_FLAGS_FIRST_FLAG&&(it=nt.first_sample_flags),k.is_sync=!(it>>16&1),k.is_leading=it>>26&3,k.depends_on=it>>24&3,k.is_depended_on=it>>22&3,k.has_redundancy=it>>20&3,k.degradation_priority=it&65535;var ht=!!(T.tfhd.flags&o.TFHD_FLAG_BASE_DATA_OFFSET),tt=!!(T.tfhd.flags&o.TFHD_FLAG_DEFAULT_BASE_IS_MOOF),J=!!(nt.flags&o.TRUN_FLAGS_DATA_OFFSET),pt=0;ht?pt=T.tfhd.base_data_offset:tt||s===0?pt=A.start:pt=x,s===0&&r===0?J?k.offset=pt+nt.data_offset:k.offset=pt:k.offset=x,x=k.offset+k.size,(T.sbgps.length>0||T.sgpds.length>0||z.mdia.minf.stbl.sbgps.length>0||z.mdia.minf.stbl.sgpds.length>0)&&B.setSampleGroupProperties(z,k,k.number_in_traf,T.sample_groups_info)}}if(T.subs){z.has_fragment_subsamples=!0;var mt=T.first_sample_index;for(s=0;s<T.subs.entries.length;s++)mt+=T.subs.entries[s].sample_delta,k=z.samples[mt-1],k.subsamples=T.subs.entries[s].subsamples}}}},B.prototype.getSample=function(t,s){var r,f=t.samples[s];if(!this.moov)return null;if(!f.data)f.data=new Uint8Array(f.size),f.alreadyRead=0,this.samplesDataSize+=f.size,n.debug("ISOFile","Allocating sample #"+s+" on track #"+t.tkhd.track_id+" of size "+f.size+" (total: "+this.samplesDataSize+")");else if(f.alreadyRead==f.size)return f;for(;;){var h=this.stream.findPosition(!0,f.offset+f.alreadyRead,!1);if(h>-1){r=this.stream.buffers[h];var _=r.byteLength-(f.offset+f.alreadyRead-r.fileStart);if(f.size-f.alreadyRead<=_)return n.debug("ISOFile","Getting sample #"+s+" data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-r.fileStart)+" read size: "+(f.size-f.alreadyRead)+" full size: "+f.size+")"),l.memcpy(f.data.buffer,f.alreadyRead,r,f.offset+f.alreadyRead-r.fileStart,f.size-f.alreadyRead),r.usedBytes+=f.size-f.alreadyRead,this.stream.logBufferLevel(),f.alreadyRead=f.size,f;if(_===0)return null;n.debug("ISOFile","Getting sample #"+s+" partial data (alreadyRead: "+f.alreadyRead+" offset: "+(f.offset+f.alreadyRead-r.fileStart)+" read size: "+_+" full size: "+f.size+")"),l.memcpy(f.data.buffer,f.alreadyRead,r,f.offset+f.alreadyRead-r.fileStart,_),f.alreadyRead+=_,r.usedBytes+=_,this.stream.logBufferLevel()}else return null}},B.prototype.releaseSample=function(t,s){var r=t.samples[s];return r.data?(this.samplesDataSize-=r.size,r.data=null,r.alreadyRead=0,r.size):0},B.prototype.getAllocatedSampleDataSize=function(){return this.samplesDataSize},B.prototype.getCodecs=function(){var t,s="";for(t=0;t<this.moov.traks.length;t++){var r=this.moov.traks[t];t>0&&(s+=","),s+=r.mdia.minf.stbl.stsd.entries[0].getCodec()}return s},B.prototype.getTrexById=function(t){var s;if(!this.moov||!this.moov.mvex)return null;for(s=0;s<this.moov.mvex.trexs.length;s++){var r=this.moov.mvex.trexs[s];if(r.track_id==t)return r}return null},B.prototype.getTrackById=function(t){if(this.moov===void 0)return null;for(var s=0;s<this.moov.traks.length;s++){var r=this.moov.traks[s];if(r.tkhd.track_id==t)return r}return null},B.prototype.itemsDataSize=0,B.prototype.flattenItemInfo=function(){var t=this.items,s=this.entity_groups,r,f,h,_=this.meta;if(_!=null&&_.hdlr!==void 0&&_.iinf!==void 0){for(r=0;r<_.iinf.item_infos.length;r++)h={},h.id=_.iinf.item_infos[r].item_ID,t[h.id]=h,h.ref_to=[],h.name=_.iinf.item_infos[r].item_name,_.iinf.item_infos[r].protection_index>0&&(h.protection=_.ipro.protections[_.iinf.item_infos[r].protection_index-1]),_.iinf.item_infos[r].item_type?h.type=_.iinf.item_infos[r].item_type:h.type="mime",h.content_type=_.iinf.item_infos[r].content_type,h.content_encoding=_.iinf.item_infos[r].content_encoding,h.item_uri_type=_.iinf.item_infos[r].item_uri_type;if(_.grpl)for(r=0;r<_.grpl.boxes.length;r++)entity_group={},entity_group.id=_.grpl.boxes[r].group_id,entity_group.entity_ids=_.grpl.boxes[r].entity_ids,entity_group.type=_.grpl.boxes[r].type,s[entity_group.id]=entity_group;if(_.iloc)for(r=0;r<_.iloc.items.length;r++){var g=_.iloc.items[r];switch(h=t[g.item_ID],g.data_reference_index!==0&&(n.warn("Item storage with reference to other files: not supported"),h.source=_.dinf.boxes[g.data_reference_index-1]),g.construction_method){case 0:break;case 1:break;case 2:n.warn("Item storage with construction_method : not supported");break}for(h.extents=[],h.size=0,f=0;f<g.extents.length;f++)h.extents[f]={},h.extents[f].offset=g.extents[f].extent_offset+g.base_offset,g.construction_method==1&&(h.extents[f].offset+=_.idat.start+_.idat.hdr_size),h.extents[f].length=g.extents[f].extent_length,h.extents[f].alreadyRead=0,h.size+=h.extents[f].length}if(_.pitm&&(t[_.pitm.item_id].primary=!0),_.iref)for(r=0;r<_.iref.references.length;r++){var x=_.iref.references[r];for(f=0;f<x.references.length;f++)t[x.from_item_ID].ref_to.push({type:x.type,id:x.references[f]})}if(_.iprp)for(var w=0;w<_.iprp.ipmas.length;w++){var A=_.iprp.ipmas[w];for(r=0;r<A.associations.length;r++){var T=A.associations[r];if(h=t[T.id],h||(h=s[T.id]),h)for(h.properties===void 0&&(h.properties={},h.properties.boxes=[]),f=0;f<T.props.length;f++){var z=T.props[f];if(z.property_index>0&&z.property_index-1<_.iprp.ipco.boxes.length){var j=_.iprp.ipco.boxes[z.property_index-1];h.properties[j.type]=j,h.properties.boxes.push(j)}}}}}},B.prototype.getItem=function(t){var s,r;if(!this.meta)return null;if(r=this.items[t],!r.data&&r.size)r.data=new Uint8Array(r.size),r.alreadyRead=0,this.itemsDataSize+=r.size,n.debug("ISOFile","Allocating item #"+t+" of size "+r.size+" (total: "+this.itemsDataSize+")");else if(r.alreadyRead===r.size)return r;for(var f=0;f<r.extents.length;f++){var h=r.extents[f];if(h.alreadyRead!==h.length){var _=this.stream.findPosition(!0,h.offset+h.alreadyRead,!1);if(_>-1){s=this.stream.buffers[_];var g=s.byteLength-(h.offset+h.alreadyRead-s.fileStart);if(h.length-h.alreadyRead<=g)n.debug("ISOFile","Getting item #"+t+" extent #"+f+" data (alreadyRead: "+h.alreadyRead+" offset: "+(h.offset+h.alreadyRead-s.fileStart)+" read size: "+(h.length-h.alreadyRead)+" full extent size: "+h.length+" full item size: "+r.size+")"),l.memcpy(r.data.buffer,r.alreadyRead,s,h.offset+h.alreadyRead-s.fileStart,h.length-h.alreadyRead),s.usedBytes+=h.length-h.alreadyRead,this.stream.logBufferLevel(),r.alreadyRead+=h.length-h.alreadyRead,h.alreadyRead=h.length;else return n.debug("ISOFile","Getting item #"+t+" extent #"+f+" partial data (alreadyRead: "+h.alreadyRead+" offset: "+(h.offset+h.alreadyRead-s.fileStart)+" read size: "+g+" full extent size: "+h.length+" full item size: "+r.size+")"),l.memcpy(r.data.buffer,r.alreadyRead,s,h.offset+h.alreadyRead-s.fileStart,g),h.alreadyRead+=g,r.alreadyRead+=g,s.usedBytes+=g,this.stream.logBufferLevel(),null}else return null}}return r.alreadyRead===r.size?r:null},B.prototype.releaseItem=function(t){var s=this.items[t];if(s.data){this.itemsDataSize-=s.size,s.data=null,s.alreadyRead=0;for(var r=0;r<s.extents.length;r++){var f=s.extents[r];f.alreadyRead=0}return s.size}else return 0},B.prototype.processItems=function(t){for(var s in this.items){var r=this.items[s];this.getItem(r.id),t&&!r.sent&&(t(r),r.sent=!0,r.data=null)}},B.prototype.hasItem=function(t){for(var s in this.items){var r=this.items[s];if(r.name===t)return r.id}return-1},B.prototype.getMetaHandler=function(){return this.meta?this.meta.hdlr.handler:null},B.prototype.getPrimaryItem=function(){return!this.meta||!this.meta.pitm?null:this.getItem(this.meta.pitm.item_id)},B.prototype.itemToFragmentedTrackFile=function(t){var s=t||{},r=null;if(s.itemId?r=this.getItem(s.itemId):r=this.getPrimaryItem(),r==null)return null;var f=new B;f.discardMdatData=!1;var h={type:r.type,description_boxes:r.properties.boxes};r.properties.ispe&&(h.width=r.properties.ispe.image_width,h.height=r.properties.ispe.image_height);var _=f.addTrack(h);return _?(f.addSample(_,r.data),f):null},B.prototype.write=function(t){for(var s=0;s<this.boxes.length;s++)this.boxes[s].write(t)},B.prototype.createFragment=function(t,s,r){var f=this.getTrackById(t),h=this.getSample(f,s);if(h==null)return this.setNextSeekPositionFromSample(f.samples[s]),null;var _=r||new l;_.endianness=l.BIG_ENDIAN;var g=this.createSingleSampleMoof(h);g.write(_),g.trafs[0].truns[0].data_offset=g.size+8,n.debug("MP4Box","Adjusting data_offset with new value "+g.trafs[0].truns[0].data_offset),_.adjustUint32(g.trafs[0].truns[0].data_offset_position,g.trafs[0].truns[0].data_offset);var x=new o.mdatBox;return x.data=h.data,x.write(_),_},B.writeInitializationSegment=function(t,s,r,f){var h;n.debug("ISOFile","Generating initialization segment");var _=new l;_.endianness=l.BIG_ENDIAN,t.write(_);var g=s.add("mvex");for(r&&g.add("mehd").set("fragment_duration",r),h=0;h<s.traks.length;h++)g.add("trex").set("track_id",s.traks[h].tkhd.track_id).set("default_sample_description_index",1).set("default_sample_duration",f).set("default_sample_size",0).set("default_sample_flags",65536);return s.write(_),_.buffer},B.prototype.save=function(t){var s=new l;s.endianness=l.BIG_ENDIAN,this.write(s),s.save(t)},B.prototype.getBuffer=function(){var t=new l;return t.endianness=l.BIG_ENDIAN,this.write(t),t.buffer},B.prototype.initializeSegmentation=function(){var t,s,r,f;for(this.onSegment===null&&n.warn("MP4Box","No segmentation callback set!"),this.isFragmentationInitialized||(this.isFragmentationInitialized=!0,this.nextMoofNumber=0,this.resetTables()),s=[],t=0;t<this.fragmentedTracks.length;t++){var h=new o.moovBox;h.mvhd=this.moov.mvhd,h.boxes.push(h.mvhd),r=this.getTrackById(this.fragmentedTracks[t].id),h.boxes.push(r),h.traks.push(r),f={},f.id=r.tkhd.track_id,f.user=this.fragmentedTracks[t].user,f.buffer=B.writeInitializationSegment(this.ftyp,h,this.moov.mvex&&this.moov.mvex.mehd?this.moov.mvex.mehd.fragment_duration:void 0,this.moov.traks[t].samples.length>0?this.moov.traks[t].samples[0].duration:0),s.push(f)}return s},o.Box.prototype.printHeader=function(t){this.size+=8,this.size>c&&(this.size+=8),this.type==="uuid"&&(this.size+=16),t.log(t.indent+"size:"+this.size),t.log(t.indent+"type:"+this.type)},o.FullBox.prototype.printHeader=function(t){this.size+=4,o.Box.prototype.printHeader.call(this,t),t.log(t.indent+"version:"+this.version),t.log(t.indent+"flags:"+this.flags)},o.Box.prototype.print=function(t){this.printHeader(t)},o.ContainerBox.prototype.print=function(t){this.printHeader(t);for(var s=0;s<this.boxes.length;s++)if(this.boxes[s]){var r=t.indent;t.indent+=" ",this.boxes[s].print(t),t.indent=r}},B.prototype.print=function(t){t.indent="";for(var s=0;s<this.boxes.length;s++)this.boxes[s]&&this.boxes[s].print(t)},o.mvhdBox.prototype.print=function(t){o.FullBox.prototype.printHeader.call(this,t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"timescale: "+this.timescale),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"rate: "+this.rate),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"next_track_id: "+this.next_track_id)},o.tkhdBox.prototype.print=function(t){o.FullBox.prototype.printHeader.call(this,t),t.log(t.indent+"creation_time: "+this.creation_time),t.log(t.indent+"modification_time: "+this.modification_time),t.log(t.indent+"track_id: "+this.track_id),t.log(t.indent+"duration: "+this.duration),t.log(t.indent+"volume: "+(this.volume>>8)),t.log(t.indent+"matrix: "+this.matrix.join(", ")),t.log(t.indent+"layer: "+this.layer),t.log(t.indent+"alternate_group: "+this.alternate_group),t.log(t.indent+"width: "+this.width),t.log(t.indent+"height: "+this.height)};var H={};H.createFile=function(t,s){var r=t!==void 0?t:!0,f=new B(s);return f.discardMdatData=!r,f},e.createFile=H.createFile}(en)),en}var Gc=Hc();const Vc=Nc(Gc);let _i=!1;class Yc extends Error{constructor(n){super(n),this.name="NotSupportError"}}async function jc(e,n,a=1e6,l=null){let c,u;if(Reflect.has(globalThis,"MediaSource")==!1)throw new Yc("MediaSource is not supported in this browser or context.");const d=Vc.createFile();let o=null;const p=new Map;let S,v=!1;await async function g(){if(!g.request)return g.request=!0,await new Promise((x,w)=>{o=new MediaSource,e.src=URL.createObjectURL(o),o.addEventListener("sourceopen",()=>{x(),setTimeout(()=>{g.request=!1},1e3)},{once:!0}),o.addEventListener("error",w),setTimeout(w,1e4,new Error("Timeout waiting for sourceopen"))})}();let E=1;const C=function(x){var w=x.id,A=x.codec,T='video/mp4; codecs="'+A+'"',z,j=typeof TrackDefault<"u";MediaSource.isTypeSupported(T)?(c=o.addSourceBuffer(T),p.set(w,c),j&&(c.trackDefaults=new TrackDefaultList([z])),c.addEventListener("error",function(k){}),c.ms=o,c.id=w,d.setSegmentOptions(w,c,{nbSamples:10}),c.pendingAppends=[]):console.error("ms not supported")},B=function g(x){const w=x.target;w.ms.readyState==="open"&&(w.sampleNum=0,w.removeEventListener("updateend",g),w.addEventListener("updateend",H.bind(w,!0,!0)),H.call(w,!1,!0),w.ms.pendingInits--)},H=function g(x,w){if(w===!0){if(x===!0&&this.ms.readyState==="open"&&this.buffered.length>0)try{const T=e.currentTime;for(let z=0;z<this.buffered.length;z++){const j=this.buffered.start(z),k=this.buffered.end(z);if(k<T-5){this.remove(j,k);break}}}catch{}if(this.sampleNum&&(d.releaseUsedSamples(this.id,this.sampleNum),delete this.sampleNum),this.is_last)try{o.readyState==="open"&&(l?.(()=>{o.endOfStream()}),l&&(l=null))}catch{}}if(this.updating===!1&&this.pendingAppends.length>0){if(this.ms.readyState!=="open")return;var A=this.pendingAppends.shift();this.sampleNum=A.sampleNum,this.is_last=A.is_last;try{this.appendBuffer(A.buffer),v&&(requestIdleCallback(function T(){e.play().then(()=>{}).catch(z=>{z&&z.name&&z.name!=="NotAllowedError"&&queueMicrotask(T)})}),v=!1)}catch(T){T.name==="QuotaExceededError"&&(this.pendingAppends.splice(0,0,A),setTimeout(()=>{g.apply(this,arguments)},1e3))}}};d.onMoovStart=function(){},d.onReady=function(g){if(o.movieInfo=g,g.isFragmented?o.duration=o.original_duration=g.fragment_duration/g.timescale:o.duration=o.original_duration=g.duration/g.timescale,g){for(const x of g.tracks)C(x);S=d.initializeSegmentation();for(let x=0;x<S.length;x++){const w=S[x].user;x===0&&(w.ms.pendingInits=0),w.addEventListener("updateend",B),w.appendBuffer(S[x].buffer),w.segmentIndex=0,w.ms.pendingInits++}}},d.onSegment=function(g,x,w,A,T){const z=x;z.segmentIndex++,z.pendingAppends.push({id:g,buffer:w,sampleNum:A,is_last:T}),H.call(z,!0,!1)},d.start();function t(){const g=new Date().getTime();if(g-t.antiTik<100)return;t.antiTik=g;let x,w,A;for(x=0;x<e.buffered.length;x++)if(w=e.buffered.start(x),A=e.buffered.end(x),e.currentTime>=w&&e.currentTime<=A-Math.ceil(11*e.playbackRate))return;const T=d.seek(e.currentTime,!0);_(T.offset,T.offset+a),e.lastSeekTime=e.currentTime}t.antiTik=0;function s(){e.lastSeekTime!==e.currentTime&&t()}function r(){(isNaN(r.last_time)||e.currentTime<r.last_time||e.currentTime-r.last_time>Math.ceil(10*e.playbackRate))&&(t(),r.last_time=e.currentTime)}e.addEventListener("seeked",s),e.addEventListener("timeupdate",r);function f(){if(o.original_duration-e.currentTime<1)if(e.loop){const g=d.seek(0,!0);_(g.offset,g.offset+a).then(()=>e.play()),e.currentTime=0,v=!0}else e.pause()}e.addEventListener("waiting",f);const h=()=>{u=!0,e.removeEventListener("seeked",s),e.removeEventListener("timeupdate",r),e.removeEventListener("waiting",f),p.forEach((g,x)=>{try{g.updating&&g.abort(),o.readyState==="open"&&o.removeSourceBuffer(g),g.removeEventListener("updateend",H),d.releaseUsedSamples(x,g.sampleNum)}catch(w){console.warn("Error cleaning up SourceBuffer:",w)}}),p.clear(),d&&(d.flush(),d.onSegment=null,d.onReady=null,d.onMoovStart=null,d.stop()),URL.revokeObjectURL(e.src),e.src="data:null/null,null";try{_.ab?.abort?.()}catch{}};async function _(g,x,w=null,A=0){if(w==null)w=++E,_.ab?.abort?.(),_.ab=null;else if(w!==E)return!0;if(u)return-1;if(A>64)return 3;const T=new AbortController;_.ab=T;try{const z=new Blob([await n(g,x,T)]);if(w!==E)return 2;if(!z.size){const it=new ArrayBuffer(0);return it.fileStart=g,d.appendBuffer(it,!0),d.flush(),1}const j=await z.arrayBuffer();j.fileStart=g;const k=d.appendBuffer(j,!!z.eof);if(d.flush(),k)return await _(k,k+a,w,++A);if(z.eof)return!1}catch{}return null}return queueMicrotask(async()=>{await _(0,999999)}),h.getMediaSource=()=>o,h}const Kc={name:"VideoDecryption",data(){return{ctx:null,file:null,fileUrl:"",password:"",playing:!1,cleanup:null,mode:"local"}},methods:{handleFileSelect(e){this.file=e.target.files[0]},async getFileSize(e){const n=new AbortController,a=await fetch(e,{signal:n.signal});if(!a.ok)throw new Error(`Failed to fetch file size: ${a.statusText}`);const l=+a.headers.get("Content-Length");if(isNaN(l))throw new Error("Content-Length header is missing or invalid");return n.abort(),l},async playVideo(){try{this.playing=!0,await this.$nextTick();const e=await co();this.ctx=e;let n=this.mode==="local"?this.file:{size:await this.getFileSize(this.fileUrl)};const a=this.mode==="local"?async(u,d)=>{const o=n.slice(u,d);return new Uint8Array(await o.arrayBuffer())}:async(u,d,o)=>{const p=await fetch(this.fileUrl,{headers:{Range:`bytes=${u}-${d-1}`},method:"GET",signal:o});return new Uint8Array(await p.arrayBuffer())},l=this.password;await uo(e,new ho((u,d,o)=>a(u,d,o),n.size),l),console.log("ctx=",e);const c=this.$refs.videoPlayer;c.controls=!0,this.cleanup=await jc(c,async(u,d,o)=>await po(e,u,d,o)),this.$refs.videoDialog.showModal()}catch(e){console.error(e),alert(e),this.playing=!1}},closeDialog(){this.$refs.videoDialog.close()},handleDialogClose(){this.playing=!1,this.cleanup&&(this.cleanup(),this.cleanup=null),fo(this.ctx),console.log("ctx destroy",this.ctx),this.ctx=null}}},Wc={class:"video-decrypt-container"},qc={class:"mode-selector"},$c=["disabled"],Xc={key:0,ref:"videoPlayer",controls:"",style:{flex:"1"}};function Zc(e,n,a,l,c,u){return Pt(),Mt("div",Wc,[Y("div",qc,[Y("label",null,[Tt(Y("input",{type:"radio","onUpdate:modelValue":n[0]||(n[0]=d=>c.mode=d),value:"local"},null,512),[[gs,c.mode]]),n[8]||(n[8]=be(" 本地文件 "))]),Y("label",null,[Tt(Y("input",{type:"radio","onUpdate:modelValue":n[1]||(n[1]=d=>c.mode=d),value:"remote"},null,512),[[gs,c.mode]]),n[9]||(n[9]=be(" 在线文件 "))])]),c.mode==="local"?(Pt(),Mt("input",{key:0,type:"file",onChange:n[2]||(n[2]=(...d)=>u.handleFileSelect&&u.handleFileSelect(...d))},null,32)):pe("",!0),c.mode==="remote"?Tt((Pt(),Mt("input",{key:1,type:"text","onUpdate:modelValue":n[3]||(n[3]=d=>c.fileUrl=d),placeholder:"输入视频URL"},null,512)),[[Qt,c.fileUrl]]):pe("",!0),Tt(Y("input",{type:"password","onUpdate:modelValue":n[4]||(n[4]=d=>c.password=d),placeholder:"输入解密密码"},null,512),[[Qt,c.password]]),Y("button",{onClick:n[5]||(n[5]=(...d)=>u.playVideo&&u.playVideo(...d)),disabled:!c.file&&c.mode==="local"||!c.fileUrl&&c.mode==="remote"||c.playing},"播放视频",8,$c),Y("dialog",{style:{width:"100%",height:"100%",display:"flex","flex-direction":"column"},ref:"videoDialog",onClose:n[7]||(n[7]=(...d)=>u.handleDialogClose&&u.handleDialogClose(...d))},[c.playing?(Pt(),Mt("video",Xc,null,512)):pe("",!0),Y("button",{onClick:n[6]||(n[6]=(...d)=>u.closeDialog&&u.closeDialog(...d)),style:{"margin-top":"0.5em"}},"关闭")],544)])}const Qc=ui(Kc,[["render",Zc],["__scopeId","data-v-59adbdef"]]),Jc=[{path:"/message",name:"message",component:ec},{path:"/file",name:"file",component:bc},{path:"/file-classic",name:"file-classic",component:Oc},{path:"/video-decrypt",name:"video-decrypt",component:Qc},{path:"/",redirect:"/message"}],tu=Vf({history:mf(),routes:Jc});Ll(Ol).use(tu).mount("#app");
//# sourceMappingURL=index-CfPrOeDp.js.map
