{"version":3,"file":"play_video-BFGyulc6.js","sources":["../../node_modules/mp4box/dist/mp4box.all.js","../../node_modules/play-video-streamed/play_video.js"],"sourcesContent":["// file:src/log.js\n/* \n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar Log = (function (){\n\t\tvar start = new Date();\n\t\tvar LOG_LEVEL_ERROR \t= 4;\n\t\tvar LOG_LEVEL_WARNING \t= 3;\n\t\tvar LOG_LEVEL_INFO \t\t= 2;\n\t\tvar LOG_LEVEL_DEBUG\t\t= 1;\n\t\tvar log_level = LOG_LEVEL_ERROR;\n\t\tvar logObject = {\n\t\t\tsetLogLevel : function(level) {\n\t\t\t\tif (level == this.debug) log_level = LOG_LEVEL_DEBUG;\n\t\t\t\telse if (level == this.info) log_level = LOG_LEVEL_INFO;\n\t\t\t\telse if (level == this.warn) log_level = LOG_LEVEL_WARNING;\n\t\t\t\telse if (level == this.error) log_level = LOG_LEVEL_ERROR;\n\t\t\t\telse log_level = LOG_LEVEL_ERROR;\n\t\t\t},\n\t\t\tdebug : function(module, msg) {\n\t\t\t\tif (console.debug === undefined) {\n\t\t\t\t\tconsole.debug = console.log;\n\t\t\t\t}\n\t\t\t\tif (LOG_LEVEL_DEBUG >= log_level) {\n\t\t\t\t\tconsole.debug(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\tlog : function(module, msg) {\n\t\t\t\tthis.debug(module.msg)\n\t\t\t},\n\t\t\tinfo : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_INFO >= log_level) {\n\t\t\t\t\tconsole.info(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\twarn : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_WARNING >= log_level) {\n\t\t\t\t\tconsole.warn(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t},\n\t\t\terror : function(module, msg) {\n\t\t\t\tif (LOG_LEVEL_ERROR >= log_level) {\n\t\t\t\t\tconsole.error(\"[\"+Log.getDurationString(new Date()-start,1000)+\"]\",\"[\"+module+\"]\",msg);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn logObject;\n\t})();\n\t\n/* Helper function to print a duration value in the form H:MM:SS.MS */\nLog.getDurationString = function(duration, _timescale) {\n\tvar neg;\n\t/* Helper function to print a number on a fixed number of digits */\n\tfunction pad(number, length) {\n\t\tvar str = '' + number;\n\t\tvar a = str.split('.');\t\t\n\t\twhile (a[0].length < length) {\n\t\t\ta[0] = '0' + a[0];\n\t\t}\n\t\treturn a.join('.');\n\t}\n\tif (duration < 0) {\n\t\tneg = true;\n\t\tduration = -duration;\n\t} else {\n\t\tneg = false;\t\n\t}\n\tvar timescale = _timescale || 1;\n\tvar duration_sec = duration/timescale;\n\tvar hours = Math.floor(duration_sec/3600);\n\tduration_sec -= hours * 3600;\n\tvar minutes = Math.floor(duration_sec/60);\n\tduration_sec -= minutes * 60;\t\t\n\tvar msec = duration_sec*1000;\n\tduration_sec = Math.floor(duration_sec);\n\tmsec -= duration_sec*1000;\n\tmsec = Math.floor(msec);\n\treturn (neg ? \"-\": \"\")+hours+\":\"+pad(minutes,2)+\":\"+pad(duration_sec,2)+\".\"+pad(msec,3);\n}\n\t\n/* Helper function to stringify HTML5 TimeRanges objects */\t\nLog.printRanges = function(ranges) {\n\tvar length = ranges.length;\n\tif (length > 0) {\n\t\tvar str = \"\";\n\t\tfor (var i = 0; i < length; i++) {\n\t\t  if (i > 0) str += \",\";\n\t\t  str += \"[\"+Log.getDurationString(ranges.start(i))+ \",\"+Log.getDurationString(ranges.end(i))+\"]\";\n\t\t}\n\t\treturn str;\n\t} else {\n\t\treturn \"(empty)\";\n\t}\n}\n\nif (typeof exports !== 'undefined') {\n\texports.Log = Log;\n}\n// file:src/stream.js\nvar MP4BoxStream = function(arrayBuffer) {\n  if (arrayBuffer instanceof ArrayBuffer) {\n    this.buffer = arrayBuffer;\n    this.dataview = new DataView(arrayBuffer);\n  } else {\n    throw (\"Needs an array buffer\");\n  }\n  this.position = 0;\n};\n\n/*************************************************************************\n  Common API between MultiBufferStream and SimpleStream\n *************************************************************************/\nMP4BoxStream.prototype.getPosition = function() {\n  return this.position;\n}\n\nMP4BoxStream.prototype.getEndPosition = function() {\n  return this.buffer.byteLength;\n}\n\nMP4BoxStream.prototype.getLength = function() {\n  return this.buffer.byteLength;\n}\n\nMP4BoxStream.prototype.seek = function (pos) {\n  var npos = Math.max(0, Math.min(this.buffer.byteLength, pos));\n  this.position = (isNaN(npos) || !isFinite(npos)) ? 0 : npos;\n  return true;\n}\n\nMP4BoxStream.prototype.isEos = function () {\n  return this.getPosition() >= this.getEndPosition();\n}\n\n/*************************************************************************\n  Read methods, simimar to DataStream but simpler\n *************************************************************************/\nMP4BoxStream.prototype.readAnyInt = function(size, signed) {\n  var res = 0;\n  if (this.position + size <= this.buffer.byteLength) {\n    switch (size) {\n      case 1:\n        if (signed) {\n          res = this.dataview.getInt8(this.position);\n        } else {\n          res = this.dataview.getUint8(this.position);\n        }\n        break;\n      case 2:\n        if (signed) {\n          res = this.dataview.getInt16(this.position);\n        } else {\n          res = this.dataview.getUint16(this.position);\n        }\n        break;\n      case 3:\n        if (signed) {\n          throw (\"No method for reading signed 24 bits values\");\n        } else {\n          res = this.dataview.getUint8(this.position) << 16;\n          res |= this.dataview.getUint8(this.position+1) << 8;\n          res |= this.dataview.getUint8(this.position+2);\n        }\n        break;\n      case 4:\n        if (signed) {\n          res = this.dataview.getInt32(this.position);\n        } else {\n          res = this.dataview.getUint32(this.position);\n        }\n        break;\n      case 8:\n        if (signed) {\n          throw (\"No method for reading signed 64 bits values\");\n        } else {\n          res = this.dataview.getUint32(this.position) << 32;\n          res |= this.dataview.getUint32(this.position+4);\n        }\n        break;\n      default:\n        throw (\"readInt method not implemented for size: \"+size);\n    }\n    this.position+= size;\n    return res;\n  } else {\n    throw (\"Not enough bytes in buffer\");\n  }\n}\n\nMP4BoxStream.prototype.readUint8 = function() {\n  return this.readAnyInt(1, false);\n}\n\nMP4BoxStream.prototype.readUint16 = function() {\n  return this.readAnyInt(2, false);\n}\n\nMP4BoxStream.prototype.readUint24 = function() {\n  return this.readAnyInt(3, false);\n}\n\nMP4BoxStream.prototype.readUint32 = function() {\n  return this.readAnyInt(4, false);\n}\n\nMP4BoxStream.prototype.readUint64 = function() {\n  return this.readAnyInt(8, false);\n}\n\nMP4BoxStream.prototype.readString = function(length) {\n  if (this.position + length <= this.buffer.byteLength) {\n    var s = \"\";\n    for (var i = 0; i < length; i++) {\n      s += String.fromCharCode(this.readUint8());\n    }\n    return s;\n  } else {\n    throw (\"Not enough bytes in buffer\");\n  }\n}\n\nMP4BoxStream.prototype.readCString = function() {\n  var arr = [];\n  while(true) {\n    var b = this.readUint8();\n    if (b !== 0) {\n      arr.push(b);\n    } else {\n      break;\n    }\n  }\n  return String.fromCharCode.apply(null, arr); \n}\n\nMP4BoxStream.prototype.readInt8 = function() {\n  return this.readAnyInt(1, true);\n}\n\nMP4BoxStream.prototype.readInt16 = function() {\n  return this.readAnyInt(2, true);\n}\n\nMP4BoxStream.prototype.readInt32 = function() {\n  return this.readAnyInt(4, true);\n}\n\nMP4BoxStream.prototype.readInt64 = function() {\n  return this.readAnyInt(8, false);\n}\n\nMP4BoxStream.prototype.readUint8Array = function(length) {\n  var arr = new Uint8Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint8();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readInt16Array = function(length) {\n  var arr = new Int16Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readInt16();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readUint16Array = function(length) {\n  var arr = new Int16Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint16();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readUint32Array = function(length) {\n  var arr = new Uint32Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readUint32();\n  }\n  return arr;\n}\n\nMP4BoxStream.prototype.readInt32Array = function(length) {\n  var arr = new Int32Array(length);\n  for (var i = 0; i < length; i++) {\n    arr[i] = this.readInt32();\n  }\n  return arr;\n}\n\nif (typeof exports !== 'undefined') {\n  exports.MP4BoxStream = MP4BoxStream;\n}// file:src/DataStream.js\n/**\n  DataStream reads scalars, arrays and structs of data from an ArrayBuffer.\n  It's like a file-like DataView on steroids.\n\n  @param {ArrayBuffer} arrayBuffer ArrayBuffer to read from.\n  @param {?Number} byteOffset Offset from arrayBuffer beginning for the DataStream.\n  @param {?Boolean} endianness DataStream.BIG_ENDIAN or DataStream.LITTLE_ENDIAN (the default).\n  */\nvar DataStream = function(arrayBuffer, byteOffset, endianness) {\n  this._byteOffset = byteOffset || 0;\n  if (arrayBuffer instanceof ArrayBuffer) {\n    this.buffer = arrayBuffer;\n  } else if (typeof arrayBuffer == \"object\") {\n    this.dataView = arrayBuffer;\n    if (byteOffset) {\n      this._byteOffset += byteOffset;\n    }\n  } else {\n    this.buffer = new ArrayBuffer(arrayBuffer || 0);\n  }\n  this.position = 0;\n  this.endianness = endianness == null ? DataStream.LITTLE_ENDIAN : endianness;\n};\nDataStream.prototype = {};\n\nDataStream.prototype.getPosition = function() {\n  return this.position;\n}\n\n/**\n  Internal function to resize the DataStream buffer when required.\n  @param {number} extra Number of bytes to add to the buffer allocation.\n  @return {null}\n  */\nDataStream.prototype._realloc = function(extra) {\n  if (!this._dynamicSize) {\n    return;\n  }\n  var req = this._byteOffset + this.position + extra;\n  var blen = this._buffer.byteLength;\n  if (req <= blen) {\n    if (req > this._byteLength) {\n      this._byteLength = req;\n    }\n    return;\n  }\n  if (blen < 1) {\n    blen = 1;\n  }\n  while (req > blen) {\n    blen *= 2;\n  }\n  var buf = new ArrayBuffer(blen);\n  var src = new Uint8Array(this._buffer);\n  var dst = new Uint8Array(buf, 0, src.length);\n  dst.set(src);\n  this.buffer = buf;\n  this._byteLength = req;\n};\n\n/**\n  Internal function to trim the DataStream buffer when required.\n  Used for stripping out the extra bytes from the backing buffer when\n  the virtual byteLength is smaller than the buffer byteLength (happens after\n  growing the buffer with writes and not filling the extra space completely).\n\n  @return {null}\n  */\nDataStream.prototype._trimAlloc = function() {\n  if (this._byteLength == this._buffer.byteLength) {\n    return;\n  }\n  var buf = new ArrayBuffer(this._byteLength);\n  var dst = new Uint8Array(buf);\n  var src = new Uint8Array(this._buffer, 0, dst.length);\n  dst.set(src);\n  this.buffer = buf;\n};\n\n\n/**\n  Big-endian const to use as default endianness.\n  @type {boolean}\n  */\nDataStream.BIG_ENDIAN = false;\n\n/**\n  Little-endian const to use as default endianness.\n  @type {boolean}\n  */\nDataStream.LITTLE_ENDIAN = true;\n\n/**\n  Virtual byte length of the DataStream backing buffer.\n  Updated to be max of original buffer size and last written size.\n  If dynamicSize is false is set to buffer size.\n  @type {number}\n  */\nDataStream.prototype._byteLength = 0;\n\n/**\n  Returns the byte length of the DataStream object.\n  @type {number}\n  */\nObject.defineProperty(DataStream.prototype, 'byteLength',\n  { get: function() {\n    return this._byteLength - this._byteOffset;\n  }});\n\n/**\n  Set/get the backing ArrayBuffer of the DataStream object.\n  The setter updates the DataView to point to the new buffer.\n  @type {Object}\n  */\nObject.defineProperty(DataStream.prototype, 'buffer',\n  { get: function() {\n      this._trimAlloc();\n      return this._buffer;\n    },\n    set: function(v) {\n      this._buffer = v;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._buffer.byteLength;\n    } });\n\n/**\n  Set/get the byteOffset of the DataStream object.\n  The setter updates the DataView to point to the new byteOffset.\n  @type {number}\n  */\nObject.defineProperty(DataStream.prototype, 'byteOffset',\n  { get: function() {\n      return this._byteOffset;\n    },\n    set: function(v) {\n      this._byteOffset = v;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._buffer.byteLength;\n    } });\n\n/**\n  Set/get the backing DataView of the DataStream object.\n  The setter updates the buffer and byteOffset to point to the DataView values.\n  @type {Object}\n  */\nObject.defineProperty(DataStream.prototype, 'dataView',\n  { get: function() {\n      return this._dataView;\n    },\n    set: function(v) {\n      this._byteOffset = v.byteOffset;\n      this._buffer = v.buffer;\n      this._dataView = new DataView(this._buffer, this._byteOffset);\n      this._byteLength = this._byteOffset + v.byteLength;\n    } });\n\n/**\n  Sets the DataStream read/write position to given position.\n  Clamps between 0 and DataStream length.\n\n  @param {number} pos Position to seek to.\n  @return {null}\n  */\nDataStream.prototype.seek = function(pos) {\n  var npos = Math.max(0, Math.min(this.byteLength, pos));\n  this.position = (isNaN(npos) || !isFinite(npos)) ? 0 : npos;\n};\n\n/**\n  Returns true if the DataStream seek pointer is at the end of buffer and\n  there's no more data to read.\n\n  @return {boolean} True if the seek pointer is at the end of the buffer.\n  */\nDataStream.prototype.isEof = function() {\n  return (this.position >= this._byteLength);\n};\n\n\n/**\n  Maps a Uint8Array into the DataStream buffer.\n\n  Nice for quickly reading in data.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint8Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint8Array = function(length) {\n  this._realloc(length * 1);\n  var arr = new Uint8Array(this._buffer, this.byteOffset+this.position, length);\n  this.position += length * 1;\n  return arr;\n};\n\n\n/**\n  Reads an Int32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int32Array.\n */\nDataStream.prototype.readInt32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Int32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads an Int16Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int16Array.\n */\nDataStream.prototype.readInt16Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 2) : length;\n  var arr = new Int16Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads an Int8Array of desired length from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Int8Array.\n */\nDataStream.prototype.readInt8Array = function(length) {\n  length = length == null ? (this.byteLength-this.position) : length;\n  var arr = new Int8Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint32Array.\n */\nDataStream.prototype.readUint32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Uint32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint16Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint16Array.\n */\nDataStream.prototype.readUint16Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 2) : length;\n  var arr = new Uint16Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Uint8Array of desired length from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Uint8Array.\n */\nDataStream.prototype.readUint8Array = function(length) {\n  length = length == null ? (this.byteLength-this.position) : length;\n  var arr = new Uint8Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Float64Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Float64Array.\n */\nDataStream.prototype.readFloat64Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 8) : length;\n  var arr = new Float64Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n/**\n  Reads a Float32Array of desired length and endianness from the DataStream.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} The read Float32Array.\n */\nDataStream.prototype.readFloat32Array = function(length, e) {\n  length = length == null ? (this.byteLength-this.position / 4) : length;\n  var arr = new Float32Array(length);\n  DataStream.memcpy(arr.buffer, 0,\n                    this.buffer, this.byteOffset+this.position,\n                    length*arr.BYTES_PER_ELEMENT);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += arr.byteLength;\n  return arr;\n};\n\n\n/**\n  Reads a 32-bit int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readInt32 = function(e) {\n  var v = this._dataView.getInt32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 16-bit int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readInt16 = function(e) {\n  var v = this._dataView.getInt16(this.position, e == null ? this.endianness : e);\n  this.position += 2;\n  return v;\n};\n\n/**\n  Reads an 8-bit int from the DataStream.\n\n  @return {number} The read number.\n */\nDataStream.prototype.readInt8 = function() {\n  var v = this._dataView.getInt8(this.position);\n  this.position += 1;\n  return v;\n};\n\n/**\n  Reads a 32-bit unsigned int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readUint32 = function(e) {\n  var v = this._dataView.getUint32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 16-bit unsigned int from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readUint16 = function(e) {\n  var v = this._dataView.getUint16(this.position, e == null ? this.endianness : e);\n  this.position += 2;\n  return v;\n};\n\n/**\n  Reads an 8-bit unsigned int from the DataStream.\n\n  @return {number} The read number.\n */\nDataStream.prototype.readUint8 = function() {\n  var v = this._dataView.getUint8(this.position);\n  this.position += 1;\n  return v;\n};\n\n/**\n  Reads a 32-bit float from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readFloat32 = function(e) {\n  var v = this._dataView.getFloat32(this.position, e == null ? this.endianness : e);\n  this.position += 4;\n  return v;\n};\n\n/**\n  Reads a 64-bit float from the DataStream with the desired endianness.\n\n  @param {?boolean} e Endianness of the number.\n  @return {number} The read number.\n */\nDataStream.prototype.readFloat64 = function(e) {\n  var v = this._dataView.getFloat64(this.position, e == null ? this.endianness : e);\n  this.position += 8;\n  return v;\n};\n\n/**\n  Native endianness. Either DataStream.BIG_ENDIAN or DataStream.LITTLE_ENDIAN\n  depending on the platform endianness.\n\n  @type {boolean}\n */\nDataStream.endianness = new Int8Array(new Int16Array([1]).buffer)[0] > 0;\n\n/**\n  Copies byteLength bytes from the src buffer at srcOffset to the\n  dst buffer at dstOffset.\n\n  @param {Object} dst Destination ArrayBuffer to write to.\n  @param {number} dstOffset Offset to the destination ArrayBuffer.\n  @param {Object} src Source ArrayBuffer to read from.\n  @param {number} srcOffset Offset to the source ArrayBuffer.\n  @param {number} byteLength Number of bytes to copy.\n */\nDataStream.memcpy = function(dst, dstOffset, src, srcOffset, byteLength) {\n  var dstU8 = new Uint8Array(dst, dstOffset, byteLength);\n  var srcU8 = new Uint8Array(src, srcOffset, byteLength);\n  dstU8.set(srcU8);\n};\n\n/**\n  Converts array to native endianness in-place.\n\n  @param {Object} array Typed array to convert.\n  @param {boolean} arrayIsLittleEndian True if the data in the array is\n                                       little-endian. Set false for big-endian.\n  @return {Object} The converted typed array.\n */\nDataStream.arrayToNative = function(array, arrayIsLittleEndian) {\n  if (arrayIsLittleEndian == this.endianness) {\n    return array;\n  } else {\n    return this.flipArrayEndianness(array);\n  }\n};\n\n/**\n  Converts native endianness array to desired endianness in-place.\n\n  @param {Object} array Typed array to convert.\n  @param {boolean} littleEndian True if the converted array should be\n                                little-endian. Set false for big-endian.\n  @return {Object} The converted typed array.\n */\nDataStream.nativeToEndian = function(array, littleEndian) {\n  if (this.endianness == littleEndian) {\n    return array;\n  } else {\n    return this.flipArrayEndianness(array);\n  }\n};\n\n/**\n  Flips typed array endianness in-place.\n\n  @param {Object} array Typed array to flip.\n  @return {Object} The converted typed array.\n */\nDataStream.flipArrayEndianness = function(array) {\n  var u8 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n  for (var i=0; i<array.byteLength; i+=array.BYTES_PER_ELEMENT) {\n    for (var j=i+array.BYTES_PER_ELEMENT-1, k=i; j>k; j--, k++) {\n      var tmp = u8[k];\n      u8[k] = u8[j];\n      u8[j] = tmp;\n    }\n  }\n  return array;\n};\n\n/**\n  Seek position where DataStream#readStruct ran into a problem.\n  Useful for debugging struct parsing.\n\n  @type {number}\n */\nDataStream.prototype.failurePosition = 0;\n\nString.fromCharCodeUint8 = function(uint8arr) {\n    var arr = [];\n    for (var i = 0; i < uint8arr.length; i++) {\n      arr[i] = uint8arr[i];\n    }\n    return String.fromCharCode.apply(null, arr);\n}\n/**\n  Read a string of desired length and encoding from the DataStream.\n\n  @param {number} length The length of the string to read in bytes.\n  @param {?string} encoding The encoding of the string data in the DataStream.\n                            Defaults to ASCII.\n  @return {string} The read string.\n */\nDataStream.prototype.readString = function(length, encoding) {\n  if (encoding == null || encoding == \"ASCII\") {\n    return String.fromCharCodeUint8.apply(null, [this.mapUint8Array(length == null ? this.byteLength-this.position : length)]);\n  } else {\n    return (new TextDecoder(encoding)).decode(this.mapUint8Array(length));\n  }\n};\n\n/**\n  Read null-terminated string of desired length from the DataStream. Truncates\n  the returned string so that the null byte is not a part of it.\n\n  @param {?number} length The length of the string to read.\n  @return {string} The read string.\n */\nDataStream.prototype.readCString = function(length) {\n  var blen = this.byteLength-this.position;\n  var u8 = new Uint8Array(this._buffer, this._byteOffset + this.position);\n  var len = blen;\n  if (length != null) {\n    len = Math.min(length, blen);\n  }\n  for (var i = 0; i < len && u8[i] !== 0; i++); // find first zero byte\n  var s = String.fromCharCodeUint8.apply(null, [this.mapUint8Array(i)]);\n  if (length != null) {\n    this.position += len-i;\n  } else if (i != blen) {\n    this.position += 1; // trailing zero if not at end of buffer\n  }\n  return s;\n};\n\n/* \n   TODO: fix endianness for 24/64-bit fields\n   TODO: check range/support for 64-bits numbers in JavaScript\n*/\nvar MAX_SIZE = Math.pow(2, 32);\n\nDataStream.prototype.readInt64 = function () {\n  return (this.readInt32()*MAX_SIZE)+this.readUint32();\n}\nDataStream.prototype.readUint64 = function () {\n\treturn (this.readUint32()*MAX_SIZE)+this.readUint32();\n}\n\nDataStream.prototype.readInt64 = function () {\n  return (this.readUint32()*MAX_SIZE)+this.readUint32();\n}\n\nDataStream.prototype.readUint24 = function () {\n\treturn (this.readUint8()<<16)+(this.readUint8()<<8)+this.readUint8();\n}\n\nif (typeof exports !== 'undefined') {\n  exports.DataStream = DataStream;  \n}\n// file:src/DataStream-write.js\n/**\n  Saves the DataStream contents to the given filename.\n  Uses Chrome's anchor download property to initiate download.\n \n  @param {string} filename Filename to save as.\n  @return {null}\n  */\nDataStream.prototype.save = function(filename) {\n  var blob = new Blob([this.buffer]);\n  if (window.URL && URL.createObjectURL) {\n      var url = window.URL.createObjectURL(blob);\n      var a = document.createElement('a');\n      // Required in Firefox:\n      document.body.appendChild(a);\n      a.setAttribute('href', url);\n      a.setAttribute('download', filename);\n      // Required in Firefox:\n      a.setAttribute('target', '_self');\n      a.click();\n      window.URL.revokeObjectURL(url);\n  } else {\n      throw(\"DataStream.save: Can't create object URL.\");\n  }\n};\n\n/**\n  Whether to extend DataStream buffer when trying to write beyond its size.\n  If set, the buffer is reallocated to twice its current size until the\n  requested write fits the buffer.\n  @type {boolean}\n  */\nDataStream.prototype._dynamicSize = true;\nObject.defineProperty(DataStream.prototype, 'dynamicSize',\n  { get: function() {\n      return this._dynamicSize;\n    },\n    set: function(v) {\n      if (!v) {\n        this._trimAlloc();\n      }\n      this._dynamicSize = v;\n    } });\n\n/**\n  Internal function to trim the DataStream buffer when required.\n  Used for stripping out the first bytes when not needed anymore.\n\n  @return {null}\n  */\nDataStream.prototype.shift = function(offset) {\n  var buf = new ArrayBuffer(this._byteLength-offset);\n  var dst = new Uint8Array(buf);\n  var src = new Uint8Array(this._buffer, offset, dst.length);\n  dst.set(src);\n  this.buffer = buf;\n  this.position -= offset;\n};\n\n/**\n  Writes an Int32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeInt32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Int32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt32(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes an Int16Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeInt16Array = function(arr, e) {\n  this._realloc(arr.length * 2);\n  if (arr instanceof Int16Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt16Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt16(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes an Int8Array to the DataStream.\n\n  @param {Object} arr The array to write.\n */\nDataStream.prototype.writeInt8Array = function(arr) {\n  this._realloc(arr.length * 1);\n  if (arr instanceof Int8Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapInt8Array(arr.length);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeInt8(arr[i]);\n    }\n  }\n};\n\n/**\n  Writes a Uint32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeUint32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Uint32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint32(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Uint16Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeUint16Array = function(arr, e) {\n  this._realloc(arr.length * 2);\n  if (arr instanceof Uint16Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint16Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint16(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Uint8Array to the DataStream.\n\n  @param {Object} arr The array to write.\n */\nDataStream.prototype.writeUint8Array = function(arr) {\n  this._realloc(arr.length * 1);\n  if (arr instanceof Uint8Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapUint8Array(arr.length);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeUint8(arr[i]);\n    }\n  }\n};\n\n/**\n  Writes a Float64Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeFloat64Array = function(arr, e) {\n  this._realloc(arr.length * 8);\n  if (arr instanceof Float64Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapFloat64Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeFloat64(arr[i], e);\n    }\n  }\n};\n\n/**\n  Writes a Float32Array of specified endianness to the DataStream.\n\n  @param {Object} arr The array to write.\n  @param {?boolean} e Endianness of the data to write.\n */\nDataStream.prototype.writeFloat32Array = function(arr, e) {\n  this._realloc(arr.length * 4);\n  if (arr instanceof Float32Array &&\n      this.byteOffset+this.position % arr.BYTES_PER_ELEMENT === 0) {\n    DataStream.memcpy(this._buffer, this.byteOffset+this.position,\n                      arr.buffer, 0,\n                      arr.byteLength);\n    this.mapFloat32Array(arr.length, e);\n  } else {\n    for (var i=0; i<arr.length; i++) {\n      this.writeFloat32(arr[i], e);\n    }\n  }\n};\n\n\n/**\n  Writes a 32-bit int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeInt32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setInt32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 16-bit int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeInt16 = function(v, e) {\n  this._realloc(2);\n  this._dataView.setInt16(this.position, v, e == null ? this.endianness : e);\n  this.position += 2;\n};\n\n/**\n  Writes an 8-bit int to the DataStream.\n\n  @param {number} v Number to write.\n */\nDataStream.prototype.writeInt8 = function(v) {\n  this._realloc(1);\n  this._dataView.setInt8(this.position, v);\n  this.position += 1;\n};\n\n/**\n  Writes a 32-bit unsigned int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeUint32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setUint32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 16-bit unsigned int to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeUint16 = function(v, e) {\n  this._realloc(2);\n  this._dataView.setUint16(this.position, v, e == null ? this.endianness : e);\n  this.position += 2;\n};\n\n/**\n  Writes an 8-bit unsigned  int to the DataStream.\n\n  @param {number} v Number to write.\n */\nDataStream.prototype.writeUint8 = function(v) {\n  this._realloc(1);\n  this._dataView.setUint8(this.position, v);\n  this.position += 1;\n};\n\n/**\n  Writes a 32-bit float to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeFloat32 = function(v, e) {\n  this._realloc(4);\n  this._dataView.setFloat32(this.position, v, e == null ? this.endianness : e);\n  this.position += 4;\n};\n\n/**\n  Writes a 64-bit float to the DataStream with the desired endianness.\n\n  @param {number} v Number to write.\n  @param {?boolean} e Endianness of the number.\n */\nDataStream.prototype.writeFloat64 = function(v, e) {\n  this._realloc(8);\n  this._dataView.setFloat64(this.position, v, e == null ? this.endianness : e);\n  this.position += 8;\n};\n\n/**\n  Write a UCS-2 string of desired endianness to the DataStream. The\n  lengthOverride argument lets you define the number of characters to write.\n  If the string is shorter than lengthOverride, the extra space is padded with\n  zeroes.\n\n  @param {string} str The string to write.\n  @param {?boolean} endianness The endianness to use for the written string data.\n  @param {?number} lengthOverride The number of characters to write.\n */\nDataStream.prototype.writeUCS2String = function(str, endianness, lengthOverride) {\n  if (lengthOverride == null) {\n    lengthOverride = str.length;\n  }\n  for (var i = 0; i < str.length && i < lengthOverride; i++) {\n    this.writeUint16(str.charCodeAt(i), endianness);\n  }\n  for (; i<lengthOverride; i++) {\n    this.writeUint16(0);\n  }\n};\n\n/**\n  Writes a string of desired length and encoding to the DataStream.\n\n  @param {string} s The string to write.\n  @param {?string} encoding The encoding for the written string data.\n                            Defaults to ASCII.\n  @param {?number} length The number of characters to write.\n */\nDataStream.prototype.writeString = function(s, encoding, length) {\n  var i = 0;\n  if (encoding == null || encoding == \"ASCII\") {\n    if (length != null) {\n      var len = Math.min(s.length, length);\n      for (i=0; i<len; i++) {\n        this.writeUint8(s.charCodeAt(i));\n      }\n      for (; i<length; i++) {\n        this.writeUint8(0);\n      }\n    } else {\n      for (i=0; i<s.length; i++) {\n        this.writeUint8(s.charCodeAt(i));\n      }\n    }\n  } else {\n    this.writeUint8Array((new TextEncoder(encoding)).encode(s.substring(0, length)));\n  }\n};\n\n/**\n  Writes a null-terminated string to DataStream and zero-pads it to length\n  bytes. If length is not given, writes the string followed by a zero.\n  If string is longer than length, the written part of the string does not have\n  a trailing zero.\n\n  @param {string} s The string to write.\n  @param {?number} length The number of characters to write.\n */\nDataStream.prototype.writeCString = function(s, length) {\n  var i = 0;\n  if (length != null) {\n    var len = Math.min(s.length, length);\n    for (i=0; i<len; i++) {\n      this.writeUint8(s.charCodeAt(i));\n    }\n    for (; i<length; i++) {\n      this.writeUint8(0);\n    }\n  } else {\n    for (i=0; i<s.length; i++) {\n      this.writeUint8(s.charCodeAt(i));\n    }\n    this.writeUint8(0);\n  }\n};\n\n/**\n  Writes a struct to the DataStream. Takes a structDefinition that gives the\n  types and a struct object that gives the values. Refer to readStruct for the\n  structure of structDefinition.\n\n  @param {Object} structDefinition Type definition of the struct.\n  @param {Object} struct The struct data object.\n  */\nDataStream.prototype.writeStruct = function(structDefinition, struct) {\n  for (var i = 0; i < structDefinition.length; i+=2) {\n    var t = structDefinition[i+1];\n    this.writeType(t, struct[structDefinition[i]], struct);\n  }\n};\n\n/**\n  Writes object v of type t to the DataStream.\n\n  @param {Object} t Type of data to write.\n  @param {Object} v Value of data to write.\n  @param {Object} struct Struct to pass to write callback functions.\n  */\nDataStream.prototype.writeType = function(t, v, struct) {\n  var tp;\n  if (typeof t == \"function\") {\n    return t(this, v);\n  } else if (typeof t == \"object\" && !(t instanceof Array)) {\n    return t.set(this, v, struct);\n  }\n  var lengthOverride = null;\n  var charset = \"ASCII\";\n  var pos = this.position;\n  if (typeof(t) == 'string' && /:/.test(t)) {\n    tp = t.split(\":\");\n    t = tp[0];\n    lengthOverride = parseInt(tp[1]);\n  }\n  if (typeof t == 'string' && /,/.test(t)) {\n    tp = t.split(\",\");\n    t = tp[0];\n    charset = parseInt(tp[1]);\n  }\n\n  switch(t) {\n    case 'uint8':\n      this.writeUint8(v);\n      break;\n    case 'int8':\n      this.writeInt8(v);\n      break;\n\n    case 'uint16':\n      this.writeUint16(v, this.endianness);\n      break;\n    case 'int16':\n      this.writeInt16(v, this.endianness);\n      break;\n    case 'uint32':\n      this.writeUint32(v, this.endianness);\n      break;\n    case 'int32':\n      this.writeInt32(v, this.endianness);\n      break;\n    case 'float32':\n      this.writeFloat32(v, this.endianness);\n      break;\n    case 'float64':\n      this.writeFloat64(v, this.endianness);\n      break;\n\n    case 'uint16be':\n      this.writeUint16(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'int16be':\n      this.writeInt16(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'uint32be':\n      this.writeUint32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'int32be':\n      this.writeInt32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'float32be':\n      this.writeFloat32(v, DataStream.BIG_ENDIAN);\n      break;\n    case 'float64be':\n      this.writeFloat64(v, DataStream.BIG_ENDIAN);\n      break;\n\n    case 'uint16le':\n      this.writeUint16(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'int16le':\n      this.writeInt16(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'uint32le':\n      this.writeUint32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'int32le':\n      this.writeInt32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'float32le':\n      this.writeFloat32(v, DataStream.LITTLE_ENDIAN);\n      break;\n    case 'float64le':\n      this.writeFloat64(v, DataStream.LITTLE_ENDIAN);\n      break;\n\n    case 'cstring':\n      this.writeCString(v, lengthOverride);\n      break;\n\n    case 'string':\n      this.writeString(v, charset, lengthOverride);\n      break;\n\n    case 'u16string':\n      this.writeUCS2String(v, this.endianness, lengthOverride);\n      break;\n\n    case 'u16stringle':\n      this.writeUCS2String(v, DataStream.LITTLE_ENDIAN, lengthOverride);\n      break;\n\n    case 'u16stringbe':\n      this.writeUCS2String(v, DataStream.BIG_ENDIAN, lengthOverride);\n      break;\n\n    default:\n      if (t.length == 3) {\n        var ta = t[1];\n        for (var i=0; i<v.length; i++) {\n          this.writeType(ta, v[i]);\n        }\n        break;\n      } else {\n        this.writeStruct(t, v);\n        break;\n      }\n  }\n  if (lengthOverride != null) {\n    this.position = pos;\n    this._realloc(lengthOverride);\n    this.position = pos + lengthOverride;\n  }\n};\n\n\nDataStream.prototype.writeUint64 = function (v) {\n\tvar h = Math.floor(v / MAX_SIZE);\n\tthis.writeUint32(h);\n\tthis.writeUint32(v & 0xFFFFFFFF);\n}\n\nDataStream.prototype.writeUint24 = function (v) {\n\tthis.writeUint8((v & 0x00FF0000)>>16);\n\tthis.writeUint8((v & 0x0000FF00)>>8);\n\tthis.writeUint8((v & 0x000000FF));\n}\n\nDataStream.prototype.adjustUint32 = function(position, value) {\n\tvar pos = this.position;\n\tthis.seek(position);\n\tthis.writeUint32(value);\n\tthis.seek(pos);\n}\n// file:src/DataStream-map.js\n/**\n  Maps an Int32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Int32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n\n/**\n  Maps an Int16Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int16Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt16Array = function(length, e) {\n  this._realloc(length * 2);\n  var arr = new Int16Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 2;\n  return arr;\n};\n\n/**\n  Maps an Int8Array into the DataStream buffer.\n\n  Nice for quickly reading in data.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Int8Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapInt8Array = function(length) {\n  this._realloc(length * 1);\n  var arr = new Int8Array(this._buffer, this.byteOffset+this.position, length);\n  this.position += length * 1;\n  return arr;\n};\n\n/**\n  Maps a Uint32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Uint32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n\n/**\n  Maps a Uint16Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Uint16Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapUint16Array = function(length, e) {\n  this._realloc(length * 2);\n  var arr = new Uint16Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 2;\n  return arr;\n};\n\n/**\n  Maps a Float64Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Float64Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapFloat64Array = function(length, e) {\n  this._realloc(length * 8);\n  var arr = new Float64Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 8;\n  return arr;\n};\n\n/**\n  Maps a Float32Array into the DataStream buffer, swizzling it to native\n  endianness in-place. The current offset from the start of the buffer needs to\n  be a multiple of element size, just like with typed array views.\n\n  Nice for quickly reading in data. Warning: potentially modifies the buffer\n  contents.\n\n  @param {number} length Number of elements to map.\n  @param {?boolean} e Endianness of the data to read.\n  @return {Object} Float32Array to the DataStream backing buffer.\n  */\nDataStream.prototype.mapFloat32Array = function(length, e) {\n  this._realloc(length * 4);\n  var arr = new Float32Array(this._buffer, this.byteOffset+this.position, length);\n  DataStream.arrayToNative(arr, e == null ? this.endianness : e);\n  this.position += length * 4;\n  return arr;\n};\n// file:src/buffer.js\n/**\n * MultiBufferStream is a class that acts as a SimpleStream for parsing \n * It holds several, possibly non-contiguous ArrayBuffer objects, each with a fileStart property \n * containing the offset for the buffer data in an original/virtual file \n *\n * It inherits also from DataStream for all read/write/alloc operations\n */\n\n/**\n * Constructor\n */\nvar MultiBufferStream = function(buffer) {\n\t/* List of ArrayBuffers, with a fileStart property, sorted in fileStart order and non overlapping */\n\tthis.buffers = [];\t\n\tthis.bufferIndex = -1;\n\tif (buffer) {\n\t\tthis.insertBuffer(buffer);\n\t\tthis.bufferIndex = 0;\n\t}\n}\nMultiBufferStream.prototype = new DataStream(new ArrayBuffer(), 0, DataStream.BIG_ENDIAN);\n\n/************************************************************************************\n  Methods for the managnement of the buffers (insertion, removal, concatenation, ...)\n ***********************************************************************************/\n\nMultiBufferStream.prototype.initialized = function() {\n\tvar firstBuffer;\n\tif (this.bufferIndex > -1) {\n\t\treturn true;\n\t} else if (this.buffers.length > 0) {\n\t\tfirstBuffer = this.buffers[0];\n\t\tif (firstBuffer.fileStart === 0) {\n\t\t\tthis.buffer = firstBuffer;\n\t\t\tthis.bufferIndex = 0;\n\t\t\tLog.debug(\"MultiBufferStream\", \"Stream ready for parsing\");\n\t\t\treturn true;\n\t\t} else {\n\t\t\tLog.warn(\"MultiBufferStream\", \"The first buffer should have a fileStart of 0\");\n\t\t\tthis.logBufferLevel();\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\tLog.warn(\"MultiBufferStream\", \"No buffer to start parsing from\");\n\t\tthis.logBufferLevel();\n\t\treturn false;\n\t}\t\t\t\n}\n\n/**\n * helper functions to concatenate two ArrayBuffer objects\n * @param  {ArrayBuffer} buffer1 \n * @param  {ArrayBuffer} buffer2 \n * @return {ArrayBuffer} the concatenation of buffer1 and buffer2 in that order\n */\nArrayBuffer.concat = function(buffer1, buffer2) {\n  Log.debug(\"ArrayBuffer\", \"Trying to create a new buffer of size: \"+(buffer1.byteLength + buffer2.byteLength));\n  var tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);\n  tmp.set(new Uint8Array(buffer1), 0);\n  tmp.set(new Uint8Array(buffer2), buffer1.byteLength);\n  return tmp.buffer;\n};\n\n/**\n * Reduces the size of a given buffer, but taking the part between offset and offset+newlength\n * @param  {ArrayBuffer} buffer    \n * @param  {Number}      offset    the start of new buffer\n * @param  {Number}      newLength the length of the new buffer\n * @return {ArrayBuffer}           the new buffer\n */\nMultiBufferStream.prototype.reduceBuffer = function(buffer, offset, newLength) {\n\tvar smallB;\n\tsmallB = new Uint8Array(newLength);\n\tsmallB.set(new Uint8Array(buffer, offset, newLength));\n\tsmallB.buffer.fileStart = buffer.fileStart+offset;\n\tsmallB.buffer.usedBytes = 0;\n\treturn smallB.buffer;\t\n}\n\n/**\n * Inserts the new buffer in the sorted list of buffers,\n *  making sure, it is not overlapping with existing ones (possibly reducing its size).\n *  if the new buffer overrides/replaces the 0-th buffer (for instance because it is bigger), \n *  updates the DataStream buffer for parsing \n*/\nMultiBufferStream.prototype.insertBuffer = function(ab) {\t\n\tvar to_add = true;\n\t/* TODO: improve insertion if many buffers */\n\tfor (var i = 0; i < this.buffers.length; i++) {\n\t\tvar b = this.buffers[i];\n\t\tif (ab.fileStart <= b.fileStart) {\n\t\t\t/* the insertion position is found */\n\t\t\tif (ab.fileStart === b.fileStart) {\n\t\t\t\t/* The new buffer overlaps with an existing buffer */\n\t\t\t\tif (ab.byteLength >  b.byteLength) {\n\t\t\t\t\t/* the new buffer is bigger than the existing one\n\t\t\t\t\t   remove the existing buffer and try again to insert \n\t\t\t\t\t   the new buffer to check overlap with the next ones */\n\t\t\t\t\tthis.buffers.splice(i, 1);\n\t\t\t\t\ti--; \n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\t/* the new buffer is smaller than the existing one, just drop it */\n\t\t\t\t\tLog.warn(\"MultiBufferStream\", \"Buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\") already appended, ignoring\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t/* The beginning of the new buffer is not overlapping with an existing buffer\n\t\t\t\t   let's check the end of it */\n\t\t\t\tif (ab.fileStart + ab.byteLength <= b.fileStart) {\n\t\t\t\t\t/* no overlap, we can add it as is */\n\t\t\t\t} else {\n\t\t\t\t\t/* There is some overlap, cut the new buffer short, and add it*/\n\t\t\t\t\tab = this.reduceBuffer(ab, 0, b.fileStart - ab.fileStart);\n\t\t\t\t}\n\t\t\t\tLog.debug(\"MultiBufferStream\", \"Appending new buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\")\");\n\t\t\t\tthis.buffers.splice(i, 0, ab);\n\t\t\t\t/* if this new buffer is inserted in the first place in the list of the buffer, \n\t\t\t\t   and the DataStream is initialized, make it the buffer used for parsing */\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tthis.buffer = ab;\n\t\t\t\t}\n\t\t\t}\n\t\t\tto_add = false;\n\t\t\tbreak;\n\t\t} else if (ab.fileStart < b.fileStart + b.byteLength) {\n\t\t\t/* the new buffer overlaps its beginning with the end of the current buffer */\n\t\t\tvar offset = b.fileStart + b.byteLength - ab.fileStart;\n\t\t\tvar newLength = ab.byteLength - offset;\n\t\t\tif (newLength > 0) {\n\t\t\t\t/* the new buffer is bigger than the current overlap, drop the overlapping part and try again inserting the remaining buffer */\n\t\t\t\tab = this.reduceBuffer(ab, offset, newLength);\n\t\t\t} else {\n\t\t\t\t/* the content of the new buffer is entirely contained in the existing buffer, drop it entirely */\n\t\t\t\tto_add = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t/* if the buffer has not been added, we can add it at the end */\n\tif (to_add) {\n\t\tLog.debug(\"MultiBufferStream\", \"Appending new buffer (fileStart: \"+ab.fileStart+\" - Length: \"+ab.byteLength+\")\");\n\t\tthis.buffers.push(ab);\n\t\t/* if this new buffer is inserted in the first place in the list of the buffer, \n\t\t   and the DataStream is initialized, make it the buffer used for parsing */\n\t\tif (i === 0) {\n\t\t\tthis.buffer = ab;\n\t\t}\n\t}\n}\n\n/**\n * Displays the status of the buffers (number and used bytes)\n * @param  {Object} info callback method for display\n */\nMultiBufferStream.prototype.logBufferLevel = function(info) {\n\tvar i;\n\tvar buffer;\n\tvar used, total;\n\tvar ranges = [];\n\tvar range;\n\tvar bufferedString = \"\";\n\tused = 0;\n\ttotal = 0;\n\tfor (i = 0; i < this.buffers.length; i++) {\n\t\tbuffer = this.buffers[i];\n\t\tif (i === 0) {\n\t\t\trange = {};\n\t\t\tranges.push(range);\n\t\t\trange.start = buffer.fileStart;\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t\tbufferedString += \"[\"+range.start+\"-\";\n\t\t} else if (range.end === buffer.fileStart) {\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t} else {\n\t\t\trange = {};\n\t\t\trange.start = buffer.fileStart;\n\t\t\tbufferedString += (ranges[ranges.length-1].end-1)+\"], [\"+range.start+\"-\";\n\t\t\trange.end = buffer.fileStart+buffer.byteLength;\n\t\t\tranges.push(range);\n\t\t}\n\t\tused += buffer.usedBytes;\n\t\ttotal += buffer.byteLength;\n\t}\n\tif (ranges.length > 0) {\n\t\tbufferedString += (range.end-1)+\"]\";\n\t}\n\tvar log = (info ? Log.info : Log.debug)\n\tif (this.buffers.length === 0) {\n\t\tlog(\"MultiBufferStream\", \"No more buffer in memory\");\n\t} else {\n\t\tlog(\"MultiBufferStream\", \"\"+this.buffers.length+\" stored buffer(s) (\"+used+\"/\"+total+\" bytes), continuous ranges: \"+bufferedString);\n\t}\n}\n\nMultiBufferStream.prototype.cleanBuffers = function () {\n\tvar i;\n\tvar buffer;\n\tfor (i = 0; i < this.buffers.length; i++) {\n\t\tbuffer = this.buffers[i];\n\t\tif (buffer.usedBytes === buffer.byteLength) {\n\t\t\tLog.debug(\"MultiBufferStream\", \"Removing buffer #\"+i);\n\t\t\tthis.buffers.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n}\n\nMultiBufferStream.prototype.mergeNextBuffer = function() {\n\tvar next_buffer;\n\tif (this.bufferIndex+1 < this.buffers.length) {\n\t\tnext_buffer = this.buffers[this.bufferIndex+1];\n\t\tif (next_buffer.fileStart === this.buffer.fileStart + this.buffer.byteLength) {\n\t\t\tvar oldLength = this.buffer.byteLength;\n\t\t\tvar oldUsedBytes = this.buffer.usedBytes;\n\t\t\tvar oldFileStart = this.buffer.fileStart;\n\t\t\tthis.buffers[this.bufferIndex] = ArrayBuffer.concat(this.buffer, next_buffer);\n\t\t\tthis.buffer = this.buffers[this.bufferIndex];\n\t\t\tthis.buffers.splice(this.bufferIndex+1, 1);\n\t\t\tthis.buffer.usedBytes = oldUsedBytes; /* TODO: should it be += ? */\n\t\t\tthis.buffer.fileStart = oldFileStart;\n\t\t\tLog.debug(\"ISOFile\", \"Concatenating buffer for box parsing (length: \"+oldLength+\"->\"+this.buffer.byteLength+\")\");\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n}\n\n\n/*************************************************************************\n  Seek-related functions\n *************************************************************************/\n\n/**\n * Finds the buffer that holds the given file position\n * @param  {Boolean} fromStart    indicates if the search should start from the current buffer (false) \n *                                or from the first buffer (true)\n * @param  {Number}  filePosition position in the file to seek to\n * @param  {Boolean} markAsUsed   indicates if the bytes in between the current position and the seek position \n *                                should be marked as used for garbage collection\n * @return {Number}               the index of the buffer holding the seeked file position, -1 if not found.\n */\nMultiBufferStream.prototype.findPosition = function(fromStart, filePosition, markAsUsed) {\n\tvar i;\n\tvar abuffer = null;\n\tvar index = -1;\n\n\t/* find the buffer with the largest position smaller than the given position */\n\tif (fromStart === true) {\n\t   /* the reposition can be in the past, we need to check from the beginning of the list of buffers */\n\t\ti = 0;\n\t} else {\n\t\ti = this.bufferIndex;\n\t}\n\n\twhile (i < this.buffers.length) {\n\t\tabuffer = this.buffers[i];\n\t\tif (abuffer.fileStart <= filePosition) {\n\t\t\tindex = i;\n\t\t\tif (markAsUsed) {\n\t\t\t\tif (abuffer.fileStart + abuffer.byteLength <= filePosition) {\n\t\t\t\t\tabuffer.usedBytes = abuffer.byteLength;\t\n\t\t\t\t} else {\n\t\t\t\t\tabuffer.usedBytes = filePosition - abuffer.fileStart;\n\t\t\t\t}\t\t\n\t\t\t\tthis.logBufferLevel();\t\n\t\t\t}\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t\ti++;\n\t}\n\n\tif (index !== -1) {\n\t\tabuffer = this.buffers[index];\n\t\tif (abuffer.fileStart + abuffer.byteLength >= filePosition) {\t\t\t\n\t\t\tLog.debug(\"MultiBufferStream\", \"Found position in existing buffer #\"+index);\n\t\t\treturn index;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t} else {\n\t\treturn -1;\n\t}\n}\n\n/**\n * Finds the largest file position contained in a buffer or in the next buffers if they are contiguous (no gap)\n * starting from the given buffer index or from the current buffer if the index is not given\n *\n * @param  {Number} inputindex Index of the buffer to start from\n * @return {Number}            The largest file position found in the buffers\n */\nMultiBufferStream.prototype.findEndContiguousBuf = function(inputindex) {\n\tvar i;\n\tvar currentBuf;\n\tvar nextBuf;\n\tvar index = (inputindex !== undefined ? inputindex : this.bufferIndex);\n\tcurrentBuf = this.buffers[index];\n\t/* find the end of the contiguous range of data */\n\tif (this.buffers.length > index+1) {\n\t\tfor (i = index+1; i < this.buffers.length; i++) {\n\t\t\tnextBuf = this.buffers[i];\n\t\t\tif (nextBuf.fileStart === currentBuf.fileStart + currentBuf.byteLength) {\n\t\t\t\tcurrentBuf = nextBuf;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t/* return the position of last byte in the file that we have */\n\treturn currentBuf.fileStart + currentBuf.byteLength;\n}\n\n/**\n * Returns the largest file position contained in the buffers, larger than the given position\n * @param  {Number} pos the file position to start from\n * @return {Number}     the largest position in the current buffer or in the buffer and the next contiguous \n *                      buffer that holds the given position\n */\nMultiBufferStream.prototype.getEndFilePositionAfter = function(pos) {\n\tvar index = this.findPosition(true, pos, false);\n\tif (index !== -1) {\n\t\treturn this.findEndContiguousBuf(index);\n\t} else {\n\t\treturn pos;\n\t}\n}\n\n/*************************************************************************\n  Garbage collection related functions\n *************************************************************************/\n\n/**\n * Marks a given number of bytes as used in the current buffer for garbage collection\n * @param {Number} nbBytes \n */\nMultiBufferStream.prototype.addUsedBytes = function(nbBytes) {\n\tthis.buffer.usedBytes += nbBytes;\n\tthis.logBufferLevel();\n}\n\n/**\n * Marks the entire current buffer as used, ready for garbage collection\n */\nMultiBufferStream.prototype.setAllUsedBytes = function() {\n\tthis.buffer.usedBytes = this.buffer.byteLength;\n\tthis.logBufferLevel();\n}\n\n/*************************************************************************\n  Common API between MultiBufferStream and SimpleStream\n *************************************************************************/\n\n/**\n * Tries to seek to a given file position\n * if possible, repositions the parsing from there and returns true \n * if not possible, does not change anything and returns false \n * @param  {Number}  filePosition position in the file to seek to\n * @param  {Boolean} fromStart    indicates if the search should start from the current buffer (false) \n *                                or from the first buffer (true)\n * @param  {Boolean} markAsUsed   indicates if the bytes in between the current position and the seek position \n *                                should be marked as used for garbage collection\n * @return {Boolean}              true if the seek succeeded, false otherwise\n */\nMultiBufferStream.prototype.seek = function(filePosition, fromStart, markAsUsed) {\n\tvar index;\n\tindex = this.findPosition(fromStart, filePosition, markAsUsed);\n\tif (index !== -1) {\n\t\tthis.buffer = this.buffers[index];\n\t\tthis.bufferIndex = index;\n\t\tthis.position = filePosition - this.buffer.fileStart;\n\t\tLog.debug(\"MultiBufferStream\", \"Repositioning parser at buffer position: \"+this.position);\n\t\treturn true;\n\t} else {\n\t\tLog.debug(\"MultiBufferStream\", \"Position \"+filePosition+\" not found in buffered data\");\n\t\treturn false;\n\t}\n}\n\n/**\n * Returns the current position in the file\n * @return {Number} the position in the file\n */\nMultiBufferStream.prototype.getPosition = function() {\n\tif (this.bufferIndex === -1 || this.buffers[this.bufferIndex] === null) {\n\t\tthrow \"Error accessing position in the MultiBufferStream\";\n\t}\n\treturn this.buffers[this.bufferIndex].fileStart+this.position;\n}\n\n/**\n * Returns the length of the current buffer\n * @return {Number} the length of the current buffer\n */\nMultiBufferStream.prototype.getLength = function() {\n\treturn this.byteLength;\n}\n\nMultiBufferStream.prototype.getEndPosition = function() {\n\tif (this.bufferIndex === -1 || this.buffers[this.bufferIndex] === null) {\n\t\tthrow \"Error accessing position in the MultiBufferStream\";\n\t}\n\treturn this.buffers[this.bufferIndex].fileStart+this.byteLength;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.MultiBufferStream = MultiBufferStream;\n}// file:src/descriptor.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar MPEG4DescriptorParser = function () {\n\tvar ES_DescrTag \t\t\t= 0x03;\n\tvar DecoderConfigDescrTag \t= 0x04;\n\tvar DecSpecificInfoTag \t\t= 0x05;\n\tvar SLConfigDescrTag \t\t= 0x06;\n\n\tvar descTagToName = [];\n\tdescTagToName[ES_DescrTag] \t\t\t\t= \"ES_Descriptor\";\n\tdescTagToName[DecoderConfigDescrTag] \t= \"DecoderConfigDescriptor\";\n\tdescTagToName[DecSpecificInfoTag] \t\t= \"DecoderSpecificInfo\";\n\tdescTagToName[SLConfigDescrTag] \t\t= \"SLConfigDescriptor\";\n\n\tthis.getDescriptorName = function(tag) {\n\t\treturn descTagToName[tag];\n\t}\n\n\tvar that = this;\n\tvar classes = {};\n\n\tthis.parseOneDescriptor = function (stream) {\n\t\tvar hdrSize = 0;\n\t\tvar size = 0;\n\t\tvar tag;\n\t\tvar desc;\n\t\tvar byteRead;\n\t\ttag = stream.readUint8();\n\t\thdrSize++;\n\t\tbyteRead = stream.readUint8();\n\t\thdrSize++;\n\t\twhile (byteRead & 0x80) {\n\t\t\tsize = (size << 7) + (byteRead & 0x7F);\n\t\t\tbyteRead = stream.readUint8();\n\t\t\thdrSize++;\n\t\t}\n\t\tsize = (size << 7) + (byteRead & 0x7F);\n\t\tLog.debug(\"MPEG4DescriptorParser\", \"Found \"+(descTagToName[tag] || \"Descriptor \"+tag)+\", size \"+size+\" at position \"+stream.getPosition());\n\t\tif (descTagToName[tag]) {\n\t\t\tdesc = new classes[descTagToName[tag]](size);\n\t\t} else {\n\t\t\tdesc = new classes.Descriptor(size);\n\t\t}\n\t\tdesc.parse(stream);\n\t\treturn desc;\n\t}\n\n\tclasses.Descriptor = function(_tag, _size) {\n\t\tthis.tag = _tag;\n\t\tthis.size = _size;\n\t\tthis.descs = [];\n\t}\n\n\tclasses.Descriptor.prototype.parse = function (stream) {\n\t\tthis.data = stream.readUint8Array(this.size);\n\t}\n\n\tclasses.Descriptor.prototype.findDescriptor = function (tag) {\n\t\tfor (var i = 0; i < this.descs.length; i++) {\n\t\t\tif (this.descs[i].tag == tag) {\n\t\t\t\treturn this.descs[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclasses.Descriptor.prototype.parseRemainingDescriptors = function (stream) {\n\t\tvar start = stream.position;\n\t\twhile (stream.position < start+this.size) {\n\t\t\tvar desc = that.parseOneDescriptor(stream);\n\t\t\tthis.descs.push(desc);\n\t\t}\n\t}\n\n\tclasses.ES_Descriptor = function (size) {\n\t\tclasses.Descriptor.call(this, ES_DescrTag, size);\n\t}\n\n\tclasses.ES_Descriptor.prototype = new classes.Descriptor();\n\n\tclasses.ES_Descriptor.prototype.parse = function(stream) {\n\t\tthis.ES_ID = stream.readUint16();\n\t\tthis.flags = stream.readUint8();\n\t\tthis.size -= 3;\n\t\tif (this.flags & 0x80) {\n\t\t\tthis.dependsOn_ES_ID = stream.readUint16();\n\t\t\tthis.size -= 2;\n\t\t} else {\n\t\t\tthis.dependsOn_ES_ID = 0;\n\t\t}\n\t\tif (this.flags & 0x40) {\n\t\t\tvar l = stream.readUint8();\n\t\t\tthis.URL = stream.readString(l);\n\t\t\tthis.size -= l+1;\n\t\t} else {\n\t\t\tthis.URL = \"\";\n\t\t}\n\t\tif (this.flags & 0x20) {\n\t\t\tthis.OCR_ES_ID = stream.readUint16();\n\t\t\tthis.size -= 2;\n\t\t} else {\n\t\t\tthis.OCR_ES_ID = 0;\n\t\t}\n\t\tthis.parseRemainingDescriptors(stream);\n\t}\n\n\tclasses.ES_Descriptor.prototype.getOTI = function(stream) {\n\t\tvar dcd = this.findDescriptor(DecoderConfigDescrTag);\n\t\tif (dcd) {\n\t\t\treturn dcd.oti;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tclasses.ES_Descriptor.prototype.getAudioConfig = function(stream) {\n\t\tvar dcd = this.findDescriptor(DecoderConfigDescrTag);\n\t\tif (!dcd) return null;\n\t\tvar dsi = dcd.findDescriptor(DecSpecificInfoTag);\n\t\tif (dsi && dsi.data) {\n\t\t\tvar audioObjectType = (dsi.data[0]& 0xF8) >> 3;\n\t\t\tif (audioObjectType === 31 && dsi.data.length >= 2) {\n\t\t\t\taudioObjectType = 32 + ((dsi.data[0] & 0x7) << 3) + ((dsi.data[1] & 0xE0) >> 5);\n\t\t\t}\n\t\t\treturn audioObjectType;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tclasses.DecoderConfigDescriptor = function (size) {\n\t\tclasses.Descriptor.call(this, DecoderConfigDescrTag, size);\n\t}\n\tclasses.DecoderConfigDescriptor.prototype = new classes.Descriptor();\n\n\tclasses.DecoderConfigDescriptor.prototype.parse = function(stream) {\n\t\tthis.oti = stream.readUint8();\n\t\tthis.streamType = stream.readUint8();\n\t\tthis.upStream = ((this.streamType >> 1) & 1) !== 0;\n\t\tthis.streamType = this.streamType >>> 2;\n\t\tthis.bufferSize = stream.readUint24();\n\t\tthis.maxBitrate = stream.readUint32();\n\t\tthis.avgBitrate = stream.readUint32();\n\t\tthis.size -= 13;\n\t\tthis.parseRemainingDescriptors(stream);\n\t}\n\n\tclasses.DecoderSpecificInfo = function (size) {\n\t\tclasses.Descriptor.call(this, DecSpecificInfoTag, size);\n\t}\n\tclasses.DecoderSpecificInfo.prototype = new classes.Descriptor();\n\n\tclasses.SLConfigDescriptor = function (size) {\n\t\tclasses.Descriptor.call(this, SLConfigDescrTag, size);\n\t}\n\tclasses.SLConfigDescriptor.prototype = new classes.Descriptor();\n\n\treturn this;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.MPEG4DescriptorParser = MPEG4DescriptorParser;\n}\n// file:src/box.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar BoxParser = {\n\tERR_INVALID_DATA : -1,\n\tERR_NOT_ENOUGH_DATA : 0,\n\tOK : 1,\n\n\t// Boxes to be created with default parsing\n\tBASIC_BOXES: [\n\t\t{type: \"mdat\", name: \"MediaDataBox\"},\n\t\t{type: \"idat\", name: \"ItemDataBox\"},\n\t\t{type: \"free\", name: \"FreeSpaceBox\"},\n\t\t{type: \"skip\", name: \"FreeSpaceBox\"},\n\t\t{type: \"meco\", name: \"AdditionalMetadataContainerBox\"},\n\t\t{type: \"strk\", name: \"SubTrackBox\"}\n\t],\n\tFULL_BOXES: [\n\t\t{type: \"hmhd\", name: \"HintMediaHeaderBox\"},\n\t\t{type: \"nmhd\", name: \"NullMediaHeaderBox\"},\n\t\t{type: \"iods\", name: \"ObjectDescriptorBox\"},\n\t\t{type: \"xml \", name: \"XMLBox\"},\n\t\t{type: \"bxml\", name: \"BinaryXMLBox\"},\n\t\t{type: \"ipro\", name: \"ItemProtectionBox\"},\n\t\t{type: \"mere\", name: \"MetaboxRelationBox\"}\n\t],\n\tCONTAINER_BOXES: [\n\t\t[{type: \"moov\", name: \"CompressedMovieBox\"}, [\"trak\", \"pssh\"]],\n\t\t[{type: \"trak\", name: \"TrackBox\"}],\n\t\t[{type: \"edts\", name: \"EditBox\"}],\n\t\t[{type: \"mdia\", name: \"MediaBox\"}],\n\t\t[{type: \"minf\", name: \"MediaInformationBox\"}],\n\t\t[{type: \"dinf\", name: \"DataInformationBox\"}],\n\t\t[{type: \"stbl\", name: \"SampleTableBox\"}, [\"sgpd\", \"sbgp\"]],\n\t\t[{type: \"mvex\", name: \"MovieExtendsBox\"}, [\"trex\"]],\n\t\t[{type: \"moof\", name: \"CompressedMovieFragmentBox\"}, [\"traf\"]],\n\t\t[{type: \"traf\", name: \"TrackFragmentBox\"}, [\"trun\", \"sgpd\", \"sbgp\"]],\n\t\t[{type: \"vttc\", name: \"VTTCueBox\"}],\n\t\t[{type: \"tref\", name: \"TrackReferenceBox\"}],\n\t\t[{type: \"iref\", name: \"ItemReferenceBox\"}],\n\t\t[{type: \"mfra\", name: \"MovieFragmentRandomAccessBox\"}, [\"tfra\"]],\n\t\t[{type: \"meco\", name: \"AdditionalMetadataContainerBox\"}],\n\t\t[{type: \"hnti\", name: \"trackhintinformation\"}],\n\t\t[{type: \"hinf\", name: \"hintstatisticsbox\"}],\n\t\t[{type: \"strk\", name: \"SubTrackBox\"}],\n\t\t[{type: \"strd\", name: \"SubTrackDefinitionBox\"}],\n\t\t[{type: \"sinf\", name: \"ProtectionSchemeInfoBox\"}],\n\t\t[{type: \"rinf\", name: \"RestrictedSchemeInfoBox\"}],\n\t\t[{type: \"schi\", name: \"SchemeInformationBox\"}],\n\t\t[{type: \"trgr\", name: \"TrackGroupBox\"}],\n\t\t[{type: \"udta\", name: \"UserDataBox\"}, [\"kind\"]],\n\t\t[{type: \"iprp\", name: \"ItemPropertiesBox\"}, [\"ipma\"]],\n\t\t[{type: \"ipco\", name: \"ItemPropertyContainerBox\"}],\n\t\t[{type: \"grpl\", name: \"GroupsListBox\"}],\n\t\t[{type: \"j2kH\", name: \"J2KHeaderInfoBox\"}],\n\t\t[{type: \"etyp\", name: \"ExtendedTypeBox\"}, [\"tyco\"]]\n\t],\n\t// Boxes effectively created\n\tboxCodes : [],\n\tfullBoxCodes : [],\n\tcontainerBoxCodes : [],\n\tsampleEntryCodes : {},\n\tsampleGroupEntryCodes: [],\n\ttrackGroupTypes: [],\n\tUUIDBoxes: {},\n\tUUIDs: [],\n\tinitialize: function() {\n\t\tBoxParser.FullBox.prototype = new BoxParser.Box();\n\t\tBoxParser.ContainerBox.prototype = new BoxParser.Box();\n\t\tBoxParser.SampleEntry.prototype = new BoxParser.Box();\n\t\tBoxParser.TrackGroupTypeBox.prototype = new BoxParser.FullBox();\n\n\t\t/* creating constructors for simple boxes */\n\t\tBoxParser.BASIC_BOXES.forEach(function(box) {\n\t\t\tBoxParser.createBoxCtor(box.type, box.name)\n\t\t});\n\t\tBoxParser.FULL_BOXES.forEach(function(box) {\n\t\t\tBoxParser.createFullBoxCtor(box.type, box.name);\n\t\t});\n\t\tBoxParser.CONTAINER_BOXES.forEach(function(boxes) {\n\t\t\tBoxParser.createContainerBoxCtor(boxes[0].type, boxes[0].name, null, boxes[1]);\n\t\t});\n\t},\n\tBox: function(_type, _size, _name, _uuid) {\n\t\tthis.type = _type;\n\t\tthis.box_name = _name;\n\t\tthis.size = _size;\n\t\tthis.uuid = _uuid;\n\t},\n\tFullBox: function(type, size, name, uuid) {\n\t\tBoxParser.Box.call(this, type, size, name, uuid);\n\t\tthis.flags = 0;\n\t\tthis.version = 0;\n\t},\n\tContainerBox: function(type, size, name, uuid) {\n\t\tBoxParser.Box.call(this, type, size, name, uuid);\n\t\tthis.boxes = [];\n\t},\n\tSampleEntry: function(type, size, hdr_size, start) {\n\t\tBoxParser.ContainerBox.call(this, type, size);\n\t\tthis.hdr_size = hdr_size;\n\t\tthis.start = start;\n\t},\n\tSampleGroupEntry: function(type) {\n\t\tthis.grouping_type = type;\n\t},\n\tTrackGroupTypeBox: function(type, size) {\n\t\tBoxParser.FullBox.call(this, type, size);\n\t},\n\tcreateBoxCtor: function(type, name, parseMethod){\n\t\tBoxParser.boxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.Box.call(this, type, size, name);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.Box();\n\t\tif (parseMethod) BoxParser[type+\"Box\"].prototype.parse = parseMethod;\n\t},\n\tcreateFullBoxCtor: function(type, name, parseMethod) {\n\t\t//BoxParser.fullBoxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.FullBox.call(this, type, size, name);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.FullBox();\n\t\tBoxParser[type+\"Box\"].prototype.parse = function(stream) {\n\t\t\tthis.parseFullHeader(stream);\n\t\t\tif (parseMethod) {\n\t\t\t\tparseMethod.call(this, stream);\n\t\t\t}\n\t\t};\n\t},\n\taddSubBoxArrays: function(subBoxNames) {\n\t\tif (subBoxNames) {\n\t\t\tthis.subBoxNames = subBoxNames;\n\t\t\tvar nbSubBoxes = subBoxNames.length;\n\t\t\tfor (var k = 0; k<nbSubBoxes; k++) {\n\t\t\t\tthis[subBoxNames[k]+\"s\"] = [];\n\t\t\t}\n\t\t}\n\t},\n\tcreateContainerBoxCtor: function(type, name, parseMethod, subBoxNames) {\n\t\t//BoxParser.containerBoxCodes.push(type);\n\t\tBoxParser[type+\"Box\"] = function(size) {\n\t\t\tBoxParser.ContainerBox.call(this, type, size, name);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t}\n\t\tBoxParser[type+\"Box\"].prototype = new BoxParser.ContainerBox();\n\t\tif (parseMethod) BoxParser[type+\"Box\"].prototype.parse = parseMethod;\n\t},\n\tcreateMediaSampleEntryCtor: function(mediaType, parseMethod, subBoxNames) {\n\t\tBoxParser.sampleEntryCodes[mediaType] = [];\n\t\tBoxParser[mediaType+\"SampleEntry\"] = function(type, size) {\n\t\t\tBoxParser.SampleEntry.call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t};\n\t\tBoxParser[mediaType+\"SampleEntry\"].prototype = new BoxParser.SampleEntry();\n\t\tif (parseMethod) BoxParser[mediaType+\"SampleEntry\"].prototype .parse = parseMethod;\n\t},\n\tcreateSampleEntryCtor: function(mediaType, type, parseMethod, subBoxNames) {\n\t\tBoxParser.sampleEntryCodes[mediaType].push(type);\n\t\tBoxParser[type+\"SampleEntry\"] = function(size) {\n\t\t\tBoxParser[mediaType+\"SampleEntry\"].call(this, type, size);\n\t\t\tBoxParser.addSubBoxArrays.call(this, subBoxNames);\n\t\t};\n\t\tBoxParser[type+\"SampleEntry\"].prototype = new BoxParser[mediaType+\"SampleEntry\"]();\n\t\tif (parseMethod) BoxParser[type+\"SampleEntry\"].prototype.parse = parseMethod;\n\t},\n\tcreateEncryptedSampleEntryCtor: function(mediaType, type, parseMethod) {\n\t\tBoxParser.createSampleEntryCtor.call(this, mediaType, type, parseMethod, [\"sinf\"]);\n\t},\n\tcreateSampleGroupCtor: function(type, parseMethod) {\n\t\t//BoxParser.sampleGroupEntryCodes.push(type);\n\t\tBoxParser[type+\"SampleGroupEntry\"] = function(size) {\n\t\t\tBoxParser.SampleGroupEntry.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"SampleGroupEntry\"].prototype = new BoxParser.SampleGroupEntry();\n\t\tif (parseMethod) BoxParser[type+\"SampleGroupEntry\"].prototype.parse = parseMethod;\n\t},\n\tcreateTrackGroupCtor: function(type, parseMethod) {\n\t\t//BoxParser.trackGroupTypes.push(type);\n\t\tBoxParser[type+\"TrackGroupTypeBox\"] = function(size) {\n\t\t\tBoxParser.TrackGroupTypeBox.call(this, type, size);\n\t\t}\n\t\tBoxParser[type+\"TrackGroupTypeBox\"].prototype = new BoxParser.TrackGroupTypeBox();\n\t\tif (parseMethod) BoxParser[type+\"TrackGroupTypeBox\"].prototype.parse = parseMethod;\n\t},\n\tcreateUUIDBox: function(uuid, name, isFullBox, isContainerBox, parseMethod) {\n\t\tBoxParser.UUIDs.push(uuid);\n\t\tBoxParser.UUIDBoxes[uuid] = function(size) {\n\t\t\tif (isFullBox) {\n\t\t\t\tBoxParser.FullBox.call(this, \"uuid\", size, name, uuid);\n\t\t\t} else {\n\t\t\t\tif (isContainerBox) {\n\t\t\t\t\tBoxParser.ContainerBox.call(this, \"uuid\", size, name, uuid);\n\t\t\t\t} else {\n\t\t\t\t\tBoxParser.Box.call(this, \"uuid\", size, name, uuid);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tBoxParser.UUIDBoxes[uuid].prototype = (isFullBox ? new BoxParser.FullBox() : (isContainerBox ? new BoxParser.ContainerBox() : new BoxParser.Box()));\n\t\tif (parseMethod) {\n\t\t\tif (isFullBox) {\n\t\t\t\tBoxParser.UUIDBoxes[uuid].prototype.parse = function(stream) {\n\t\t\t\t\tthis.parseFullHeader(stream);\n\t\t\t\t\tif (parseMethod) {\n\t\t\t\t\t\tparseMethod.call(this, stream);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tBoxParser.UUIDBoxes[uuid].prototype.parse = parseMethod;\n\t\t\t}\n\t\t}\n\t}\n}\n\nBoxParser.initialize();\n\nBoxParser.TKHD_FLAG_ENABLED    = 0x000001;\nBoxParser.TKHD_FLAG_IN_MOVIE   = 0x000002;\nBoxParser.TKHD_FLAG_IN_PREVIEW = 0x000004;\n\nBoxParser.TFHD_FLAG_BASE_DATA_OFFSET\t= 0x01;\nBoxParser.TFHD_FLAG_SAMPLE_DESC\t\t\t= 0x02;\nBoxParser.TFHD_FLAG_SAMPLE_DUR\t\t\t= 0x08;\nBoxParser.TFHD_FLAG_SAMPLE_SIZE\t\t\t= 0x10;\nBoxParser.TFHD_FLAG_SAMPLE_FLAGS\t\t= 0x20;\nBoxParser.TFHD_FLAG_DUR_EMPTY\t\t\t= 0x10000;\nBoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF= 0x20000;\n\nBoxParser.TRUN_FLAGS_DATA_OFFSET= 0x01;\nBoxParser.TRUN_FLAGS_FIRST_FLAG\t= 0x04;\nBoxParser.TRUN_FLAGS_DURATION\t= 0x100;\nBoxParser.TRUN_FLAGS_SIZE\t\t= 0x200;\nBoxParser.TRUN_FLAGS_FLAGS\t\t= 0x400;\nBoxParser.TRUN_FLAGS_CTS_OFFSET\t= 0x800;\n\nBoxParser.Box.prototype.add = function(name) {\n\treturn this.addBox(new BoxParser[name+\"Box\"]());\n}\n\nBoxParser.Box.prototype.addBox = function(box) {\n\tthis.boxes.push(box);\n\tif (this[box.type+\"s\"]) {\n\t\tthis[box.type+\"s\"].push(box);\n\t} else {\n\t\tthis[box.type] = box;\n\t}\n\treturn box;\n}\n\nBoxParser.Box.prototype.set = function(prop, value) {\n\tthis[prop] = value;\n\treturn this;\n}\n\nBoxParser.Box.prototype.addEntry = function(value, _prop) {\n\tvar prop = _prop || \"entries\";\n\tif (!this[prop]) {\n\t\tthis[prop] = [];\n\t}\n\tthis[prop].push(value);\n\treturn this;\n}\n\nif (typeof exports !== \"undefined\") {\n\texports.BoxParser = BoxParser;\n}\n// file:src/box-parse.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.parseUUID = function(stream) {\n\treturn BoxParser.parseHex16(stream);\n}\n\nBoxParser.parseHex16 = function(stream) {\n\tvar hex16 = \"\"\n\tfor (var i = 0; i <16; i++) {\n\t\tvar hex = stream.readUint8().toString(16);\n\t\thex16 += (hex.length === 1 ? \"0\"+hex : hex);\n\t}\n\treturn hex16;\n}\n\nBoxParser.parseOneBox = function(stream, headerOnly, parentSize) {\n\tvar box;\n\tvar start = stream.getPosition();\n\tvar hdr_size = 0;\n\tvar diff;\n\tvar uuid;\n\tif (stream.getEndPosition() - start < 8) {\n\t\tLog.debug(\"BoxParser\", \"Not enough data in stream to parse the type and size of the box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t}\n\tif (parentSize && parentSize < 8) {\n\t\tLog.debug(\"BoxParser\", \"Not enough bytes left in the parent box to parse a new box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t}\n\tvar size = stream.readUint32();\n\tvar type = stream.readString(4);\n\tvar box_type = type;\n\tLog.debug(\"BoxParser\", \"Found box of type '\"+type+\"' and size \"+size+\" at position \"+start);\n\thdr_size = 8;\n\tif (type == \"uuid\") {\n\t\tif ((stream.getEndPosition() - stream.getPosition() < 16) || (parentSize -hdr_size < 16)) {\n\t\t\tstream.seek(start);\n\t\t\tLog.debug(\"BoxParser\", \"Not enough bytes left in the parent box to parse a UUID box\");\n\t\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t\t}\n\t\tuuid = BoxParser.parseUUID(stream);\n\t\thdr_size += 16;\n\t\tbox_type = uuid;\n\t}\n\tif (size == 1) {\n\t\tif ((stream.getEndPosition() - stream.getPosition() < 8) || (parentSize && (parentSize - hdr_size) < 8)) {\n\t\t\tstream.seek(start);\n\t\t\tLog.warn(\"BoxParser\", \"Not enough data in stream to parse the extended size of the \\\"\"+type+\"\\\" box\");\n\t\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA };\n\t\t}\n\t\tsize = stream.readUint64();\n\t\thdr_size += 8;\n\t} else if (size === 0) {\n\t\t/* box extends till the end of file or invalid file */\n\t\tif (parentSize) {\n\t\t\tsize = parentSize;\n\t\t} else {\n\t\t\t/* box extends till the end of file */\n\t\t\tif (type !== \"mdat\") {\n\t\t\t\tLog.error(\"BoxParser\", \"Unlimited box size not supported for type: '\"+type+\"'\");\n\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\treturn { code: BoxParser.OK, box: box, size: box.size };\n\t\t\t}\n\t\t}\n\t}\n\tif (size !== 0 && size < hdr_size) {\n\t\tLog.error(\"BoxParser\", \"Box of type \"+type+\" has an invalid size \"+size+\" (too small to be a box)\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (size !== 0 && parentSize && size > parentSize) {\n\t\tLog.error(\"BoxParser\", \"Box of type '\"+type+\"' has a size \"+size+\" greater than its container size \"+parentSize);\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (size !== 0 && start + size > stream.getEndPosition()) {\n\t\tstream.seek(start);\n\t\tLog.info(\"BoxParser\", \"Not enough data in stream to parse the entire '\"+type+\"' box\");\n\t\treturn { code: BoxParser.ERR_NOT_ENOUGH_DATA, type: type, size: size, hdr_size: hdr_size, start: start };\n\t}\n\tif (headerOnly) {\n\t\treturn { code: BoxParser.OK, type: type, size: size, hdr_size: hdr_size, start: start };\n\t} else {\n\t\tif (BoxParser[type+\"Box\"]) {\n\t\t\tbox = new BoxParser[type+\"Box\"](size);\n\t\t} else {\n\t\t\tif (type !== \"uuid\") {\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown box type: '\"+type+\"'\");\n\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\tbox.has_unparsed_data = true;\n\t\t\t} else {\n\t\t\t\tif (BoxParser.UUIDBoxes[uuid]) {\n\t\t\t\t\tbox = new BoxParser.UUIDBoxes[uuid](size);\n\t\t\t\t} else {\n\t\t\t\t\tLog.warn(\"BoxParser\", \"Unknown uuid type: '\"+uuid+\"'\");\n\t\t\t\t\tbox = new BoxParser.Box(type, size);\n\t\t\t\t\tbox.uuid = uuid;\n\t\t\t\t\tbox.has_unparsed_data = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tbox.hdr_size = hdr_size;\n\t/* recording the position of the box in the input stream */\n\tbox.start = start;\n\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\tLog.info(\"BoxParser\", \"'\"+box_type+\"' box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\tbox.parseDataAndRewind(stream);\n\t}\n\tbox.parse(stream);\n\tdiff = stream.getPosition() - (box.start+box.size);\n\tif (diff < 0) {\n\t\tLog.warn(\"BoxParser\", \"Parsing of box '\"+box_type+\"' did not read the entire indicated box data size (missing \"+(-diff)+\" bytes), seeking forward\");\n\t\tstream.seek(box.start+box.size);\n\t} else if (diff > 0) {\n\t\tLog.error(\"BoxParser\", \"Parsing of box '\"+box_type+\"' read \"+diff+\" more bytes than the indicated box data size, seeking backwards\");\n\t\tif (box.size !== 0) stream.seek(box.start+box.size);\n\t}\n\treturn { code: BoxParser.OK, box: box, size: box.size };\n}\n\nBoxParser.Box.prototype.parse = function(stream) {\n\tif (this.type != \"mdat\") {\n\t\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t} else {\n\t\tif (this.size === 0) {\n\t\t\tstream.seek(stream.getEndPosition());\n\t\t} else {\n\t\t\tstream.seek(this.start+this.size);\n\t\t}\n\t}\n}\n\n/* Used to parse a box without consuming its data, to allow detailled parsing\n   Useful for boxes for which a write method is not yet implemented */\nBoxParser.Box.prototype.parseDataAndRewind = function(stream) {\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.FullBox.prototype.parseDataAndRewind = function(stream) {\n\tthis.parseFullHeader(stream);\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n\t// restore the header size as if the full header had not been parsed\n\tthis.hdr_size -= 4;\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.FullBox.prototype.parseFullHeader = function (stream) {\n\tthis.version = stream.readUint8();\n\tthis.flags = stream.readUint24();\n\tthis.hdr_size += 4;\n}\n\nBoxParser.FullBox.prototype.parse = function (stream) {\n\tthis.parseFullHeader(stream);\n\tthis.data = stream.readUint8Array(this.size-this.hdr_size);\n}\n\nBoxParser.ContainerBox.prototype.parse = function(stream) {\n\tvar ret;\n\tvar box;\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\t/* store the box in the 'boxes' array to preserve box order (for offset) but also store box in a property for more direct access */\n\t\t\tthis.boxes.push(box);\n\t\t\tif (this.subBoxNames && this.subBoxNames.indexOf(box.type) != -1) {\n\t\t\t\tthis[this.subBoxNames[this.subBoxNames.indexOf(box.type)]+\"s\"].push(box);\n\t\t\t} else {\n\t\t\t\tvar box_type = box.type !== \"uuid\" ? box.type : box.uuid;\n\t\t\t\tif (this[box_type]) {\n\t\t\t\t\tLog.warn(\"Box of type \"+box_type+\" already stored in field of this type\");\n\t\t\t\t} else {\n\t\t\t\t\tthis[box_type] = box;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\nBoxParser.Box.prototype.parseLanguage = function(stream) {\n\tthis.language = stream.readUint16();\n\tvar chars = [];\n\tchars[0] = (this.language>>10)&0x1F;\n\tchars[1] = (this.language>>5)&0x1F;\n\tchars[2] = (this.language)&0x1F;\n\tthis.languageString = String.fromCharCode(chars[0]+0x60, chars[1]+0x60, chars[2]+0x60);\n}\n\n// file:src/parsing/sampleentries/sampleentry.js\nBoxParser.SAMPLE_ENTRY_TYPE_VISUAL \t\t= \"Visual\";\nBoxParser.SAMPLE_ENTRY_TYPE_AUDIO \t\t= \"Audio\";\nBoxParser.SAMPLE_ENTRY_TYPE_HINT \t\t= \"Hint\";\nBoxParser.SAMPLE_ENTRY_TYPE_METADATA \t= \"Metadata\";\nBoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE \t= \"Subtitle\";\nBoxParser.SAMPLE_ENTRY_TYPE_SYSTEM \t\t= \"System\";\nBoxParser.SAMPLE_ENTRY_TYPE_TEXT \t\t= \"Text\";\n\nBoxParser.SampleEntry.prototype.parseHeader = function(stream) {\n\tstream.readUint8Array(6);\n\tthis.data_reference_index = stream.readUint16();\n\tthis.hdr_size += 8;\n}\n\nBoxParser.SampleEntry.prototype.parse = function(stream) {\n\tthis.parseHeader(stream);\n\tthis.data = stream.readUint8Array(this.size - this.hdr_size);\n}\n\nBoxParser.SampleEntry.prototype.parseDataAndRewind = function(stream) {\n\tthis.parseHeader(stream);\n\tthis.data = stream.readUint8Array(this.size - this.hdr_size);\n\t// restore the header size as if the sample entry header had not been parsed\n\tthis.hdr_size -= 8;\n\t// rewinding\n\tstream.position -= this.size-this.hdr_size;\n}\n\nBoxParser.SampleEntry.prototype.parseFooter = function(stream) {\n\tBoxParser.ContainerBox.prototype.parse.call(this, stream);\n}\n\n// Base SampleEntry types with default parsing\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_HINT);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SYSTEM);\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_TEXT);\n\n//Base SampleEntry types for Audio and Video with specific parsing\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, function(stream) {\n\tvar compressorname_length;\n\tthis.parseHeader(stream);\n\tstream.readUint16();\n\tstream.readUint16();\n\tstream.readUint32Array(3);\n\tthis.width = stream.readUint16();\n\tthis.height = stream.readUint16();\n\tthis.horizresolution = stream.readUint32();\n\tthis.vertresolution = stream.readUint32();\n\tstream.readUint32();\n\tthis.frame_count = stream.readUint16();\n\tcompressorname_length = Math.min(31, stream.readUint8());\n\tthis.compressorname = stream.readString(compressorname_length);\n\tif (compressorname_length < 31) {\n\t\tstream.readString(31 - compressorname_length);\n\t}\n\tthis.depth = stream.readUint16();\n\tstream.readUint16();\n\tthis.parseFooter(stream);\n});\n\nBoxParser.createMediaSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, function(stream) {\n\tthis.parseHeader(stream);\n\tstream.readUint32Array(2);\n\tthis.channel_count = stream.readUint16();\n\tthis.samplesize = stream.readUint16();\n\tstream.readUint16();\n\tstream.readUint16();\n\tthis.samplerate = (stream.readUint32()/(1<<16));\n\tthis.parseFooter(stream);\n});\n\n// Sample entries inheriting from Audio and Video\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avc4\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"av01\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"dav1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hvc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hev1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"hvt1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"lhe1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"dvh1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"dvhe\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvc1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvi1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvs1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vvcN\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vp08\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"vp09\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"avs3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"j2ki\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"mjp2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \"mjpg\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL,\t\"uncv\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mp4a\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ac-3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ac-4\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"ec-3\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"Opus\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mha1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mha2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mhm1\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"mhm2\");\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"fLaC\");\n\n// Encrypted sample entries\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_VISUAL, \t\"encv\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_AUDIO, \t\"enca\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \t\"encu\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SYSTEM, \t\"encs\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_TEXT, \t\t\"enct\");\nBoxParser.createEncryptedSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \t\"encm\");\n// file:src/parsing/a1lx.js\nBoxParser.createBoxCtor(\"a1lx\", \"AV1LayeredImageIndexingProperty\", function(stream) {\n\tvar large_size = stream.readUint8() & 1;\n\tvar FieldLength = ((large_size & 1) + 1) * 16;\n\tthis.layer_size = [];\n\tfor (var i = 0; i < 3; i++) {\n\t\tif (FieldLength == 16) {\n\t\t\tthis.layer_size[i] = stream.readUint16();\n\t\t} else {\n\t\t\tthis.layer_size[i] = stream.readUint32();\n\t\t}\n\t}\n});// file:src/parsing/a1op.js\nBoxParser.createBoxCtor(\"a1op\", \"OperatingPointSelectorProperty\", function(stream) {\n\tthis.op_index = stream.readUint8();\n});// file:src/parsing/auxC.js\nBoxParser.createFullBoxCtor(\"auxC\", \"AuxiliaryTypeProperty\", function(stream) {\n\tthis.aux_type = stream.readCString();\n\tvar aux_subtype_length = this.size - this.hdr_size - (this.aux_type.length + 1);\n\tthis.aux_subtype = stream.readUint8Array(aux_subtype_length);\n});// file:src/parsing/av1C.js\nBoxParser.createBoxCtor(\"av1C\", \"AV1CodecConfigurationBox\", function(stream) {\n\tvar i;\n\tvar toparse;\n\tvar tmp = stream.readUint8();\n\tif ((tmp >> 7 & 0x1) !== 1) {\n\t\tLog.error(\"av1C marker problem\");\n\t\treturn;\n\t}\n\tthis.version = tmp & 0x7F;\n\tif (this.version !== 1) {\n\t\tLog.error(\"av1C version \"+this.version+\" not supported\");\n\t\treturn;\n\t}\n\ttmp = stream.readUint8();\n\tthis.seq_profile = (tmp >> 5) & 0x7;\n\tthis.seq_level_idx_0 = tmp & 0x1F;\n\ttmp = stream.readUint8();\n\tthis.seq_tier_0 = (tmp >> 7) & 0x1;\n\tthis.high_bitdepth = (tmp >> 6) & 0x1;\n\tthis.twelve_bit = (tmp >> 5) & 0x1;\n\tthis.monochrome = (tmp >> 4) & 0x1;\n\tthis.chroma_subsampling_x = (tmp >> 3) & 0x1;\n\tthis.chroma_subsampling_y = (tmp >> 2) & 0x1;\n\tthis.chroma_sample_position = (tmp & 0x3);\n\ttmp = stream.readUint8();\n\tthis.reserved_1 = (tmp >> 5) & 0x7;\n\tif (this.reserved_1 !== 0) {\n\t\tLog.error(\"av1C reserved_1 parsing problem\");\n\t\treturn;\n\t}\n\tthis.initial_presentation_delay_present = (tmp >> 4) & 0x1;\n\tif (this.initial_presentation_delay_present === 1) {\n\t\tthis.initial_presentation_delay_minus_one = (tmp & 0xF);\n\t} else {\n\t\tthis.reserved_2 = (tmp & 0xF);\n\t\tif (this.reserved_2 !== 0) {\n\t\t\tLog.error(\"av1C reserved_2 parsing problem\");\n\t\t\treturn;\n\t\t}\n\t}\n\n\tvar configOBUs_length = this.size - this.hdr_size - 4;\n\tthis.configOBUs = stream.readUint8Array(configOBUs_length);\n});\n\n// file:src/parsing/avcC.js\nfunction printPS(ps) {\n\tvar str = \"<table class='inner-table'>\";\n\tstr += \"<thead><tr><th>length</th><th>nalu_data</th></tr></thead>\";\n\tstr += \"<tbody>\";\n\n\tfor (var i=0; i < ps.length; i++) {\n\t\tvar nalu = ps[i];\n\t\tstr += \"<tr>\";\n\t\tstr += \"<td>\"+nalu.length+\"</td>\";\n\t\tstr += \"<td>\";\n\t\tstr += nalu.nalu.reduce(function(str, byte) {\n\t\t\treturn str + byte.toString(16).padStart(2, \"0\");\n\t\t}, \"0x\");\n\t\tstr += \"</td></tr>\";\n\t}\n\tstr += \"</tbody></table>\";\n\treturn str;\n}\n\nBoxParser.createBoxCtor(\"avcC\", \"AVCConfigurationBox\", function(stream) {\n\tvar i;\n\tvar toparse;\n\tthis.configurationVersion = stream.readUint8();\n\tthis.AVCProfileIndication = stream.readUint8();\n\tthis.profile_compatibility = stream.readUint8();\n\tthis.AVCLevelIndication = stream.readUint8();\n\tthis.lengthSizeMinusOne = (stream.readUint8() & 0x3);\n\tthis.nb_SPS_nalus = (stream.readUint8() & 0x1F);\n\ttoparse = this.size - this.hdr_size - 6;\n\tthis.SPS = [];\n\tthis.SPS.toString = function () {\n\t\treturn printPS(this);\n\t}\n\tfor (i = 0; i < this.nb_SPS_nalus; i++) {\n\t\tthis.SPS[i] = {};\n\t\tthis.SPS[i].length = stream.readUint16();\n\t\tthis.SPS[i].nalu = stream.readUint8Array(this.SPS[i].length);\n\t\ttoparse -= 2+this.SPS[i].length;\n\t}\n\tthis.nb_PPS_nalus = stream.readUint8();\n\ttoparse--;\n\tthis.PPS = [];\n\tthis.PPS.toString = function () {\n\t\treturn printPS(this);\n\t}\n\tfor (i = 0; i < this.nb_PPS_nalus; i++) {\n\t\tthis.PPS[i] = {};\n\t\tthis.PPS[i].length = stream.readUint16();\n\t\tthis.PPS[i].nalu = stream.readUint8Array(this.PPS[i].length);\n\t\ttoparse -= 2+this.PPS[i].length;\n\t}\n\tif (toparse>0) {\n\t\tthis.ext = stream.readUint8Array(toparse);\n\t}\n});\n\n// file:src/parsing/btrt.js\nBoxParser.createBoxCtor(\"btrt\", \"BitRateBox\", function(stream) {\n\tthis.bufferSizeDB = stream.readUint32();\n\tthis.maxBitrate = stream.readUint32();\n\tthis.avgBitrate = stream.readUint32();\n});\n\n// file:src/parsing/ccst.js\nBoxParser.createFullBoxCtor(\"ccst\", \"CodingConstraintsBox\", function(stream) {\n\tvar flags = stream.readUint8();\n\tthis.all_ref_pics_intra = ((flags & 0x80) == 0x80);\n\tthis.intra_pred_used = ((flags & 0x40) == 0x40);\n\tthis.max_ref_per_pic = ((flags & 0x3f) >> 2);\n\tstream.readUint24();\n});\n\n// file:src/parsing/cdef.js\nBoxParser.createBoxCtor(\"cdef\", \"ComponentDefinitionBox\", function(stream) {\n    var i;\n    this.channel_count = stream.readUint16();\n    this.channel_indexes = [];\n    this.channel_types = [];\n    this.channel_associations = [];\n    for (i = 0; i < this.channel_count; i++) {\n        this.channel_indexes.push(stream.readUint16());\n        this.channel_types.push(stream.readUint16());\n        this.channel_associations.push(stream.readUint16());\n    }\n});\n\n// file:src/parsing/clap.js\nBoxParser.createBoxCtor(\"clap\", \"CleanApertureBox\", function(stream) {\n\tthis.cleanApertureWidthN = stream.readUint32();\n\tthis.cleanApertureWidthD = stream.readUint32();\n\tthis.cleanApertureHeightN = stream.readUint32();\n\tthis.cleanApertureHeightD = stream.readUint32();\n\tthis.horizOffN = stream.readUint32();\n\tthis.horizOffD = stream.readUint32();\n\tthis.vertOffN = stream.readUint32();\n\tthis.vertOffD = stream.readUint32();\n});// file:src/parsing/clli.js\nBoxParser.createBoxCtor(\"clli\", \"ContentLightLevelBox\", function(stream) {\n\tthis.max_content_light_level = stream.readUint16();\n    this.max_pic_average_light_level = stream.readUint16();\n});\n\n// file:src/parsing/cmex.js\nBoxParser.createFullBoxCtor(\"cmex\", \"CameraExtrinsicMatrixProperty\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.pos_x = stream.readInt32();\n\t}\n\tif (this.flags & 0x2) {\n\t\tthis.pos_y = stream.readInt32();\n\t}\n\tif (this.flags & 0x4) {\n\t\tthis.pos_z = stream.readInt32();\n\t}\n\tif (this.flags & 0x8) {\n\t\tif (this.version == 0) {\n\t\t\tif (this.flags & 0x10) {\n\t\t\t\tthis.quat_x = stream.readInt32();\n\t\t\t\tthis.quat_y = stream.readInt32();\n\t\t\t\tthis.quat_z = stream.readInt32();\n\t\t\t} else {\n\t\t\t\tthis.quat_x = stream.readInt16();\n\t\t\t\tthis.quat_y = stream.readInt16();\n\t\t\t\tthis.quat_z = stream.readInt16();\n\t\t\t}\n\t\t} else if (this.version == 1) {\n\t\t\t//ViewpointGlobalCoordinateSysRotationStruct rot;\n\t\t}\n\t}\n\tif (this.flags & 0x20) {\n\t\tthis.id = stream.readUint32();\n\t}\n});\n// file:src/parsing/cmin.js\nBoxParser.createFullBoxCtor(\"cmin\", \"CameraIntrinsicMatrixProperty\", function(stream) {\n\tthis.focal_length_x = stream.readInt32();\n\tthis.principal_point_x = stream.readInt32();\n\tthis.principal_point_y = stream.readInt32();\n\tif (this.flags & 0x1) {\n\t\tthis.focal_length_y = stream.readInt32();\n\t\tthis.skew_factor = stream.readInt32();\n\t}\n});// file:src/parsing/cmpd.js\nBoxParser.createBoxCtor(\"cmpd\", \"ComponentDefinitionBox\", function(stream) {\n\tthis.component_count = stream.readUint32();\n\tthis.component_types = [];\n\tthis.component_type_urls = [];\n\tfor (i = 0; i < this.component_count; i++) {\n\t\tvar component_type = stream.readUint16();\n\t\tthis.component_types.push(component_type);\n\t\tif (component_type >= 0x8000) {\n\t\t\tthis.component_type_urls.push(stream.readCString());\n\t\t}\n\t}\n});// file:src/parsing/co64.js\nBoxParser.createFullBoxCtor(\"co64\", \"ChunkLargeOffsetBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.chunk_offsets = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.chunk_offsets.push(stream.readUint64());\n\t\t}\n\t}\n});\n\n// file:src/parsing/CoLL.js\nBoxParser.createFullBoxCtor(\"CoLL\", \"ContentLightLevelBox\", function(stream) {\n\tthis.maxCLL = stream.readUint16();\n    this.maxFALL = stream.readUint16();\n});\n\n// file:src/parsing/colr.js\nBoxParser.createBoxCtor(\"colr\", \"ColourInformationBox\", function(stream) {\n\tthis.colour_type = stream.readString(4);\n\tif (this.colour_type === 'nclx') {\n\t\tthis.colour_primaries = stream.readUint16();\n\t\tthis.transfer_characteristics = stream.readUint16();\n\t\tthis.matrix_coefficients = stream.readUint16();\n\t\tvar tmp = stream.readUint8();\n\t\tthis.full_range_flag = tmp >> 7;\n\t} else if (this.colour_type === 'rICC') {\n\t\tthis.ICC_profile = stream.readUint8Array(this.size - 4);\n\t} else if (this.colour_type === 'prof') {\n\t\tthis.ICC_profile = stream.readUint8Array(this.size - 4);\n\t}\n});// file:src/parsing/cprt.js\nBoxParser.createFullBoxCtor(\"cprt\", \"CopyrightBox\", function (stream) {\n\tthis.parseLanguage(stream);\n\tthis.notice = stream.readCString();\n});\n\n// file:src/parsing/cslg.js\nBoxParser.createFullBoxCtor(\"cslg\", \"CompositionToDecodeBox\", function(stream) {\n\tvar entry_count;\n\tif (this.version === 0) {\n\t\tthis.compositionToDTSShift = stream.readInt32(); /* signed */\n\t\tthis.leastDecodeToDisplayDelta = stream.readInt32(); /* signed */\n\t\tthis.greatestDecodeToDisplayDelta = stream.readInt32(); /* signed */\n\t\tthis.compositionStartTime = stream.readInt32(); /* signed */\n\t\tthis.compositionEndTime = stream.readInt32(); /* signed */\n\t}\n});\n\n// file:src/parsing/ctts.js\nBoxParser.createFullBoxCtor(\"ctts\", \"CompositionOffsetBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.sample_counts = [];\n\tthis.sample_offsets = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\t/* some files are buggy and declare version=0 while using signed offsets.\n\t\t\t   The likelyhood of using the most significant bit in a 32-bits time offset is very low,\n\t\t\t   so using signed value here as well */\n\t\t\t   var value = stream.readInt32();\n\t\t\t   if (value < 0) {\n\t\t\t   \t\tLog.warn(\"BoxParser\", \"ctts box uses negative values without using version 1\");\n\t\t\t   }\n\t\t\tthis.sample_offsets.push(value);\n\t\t}\n\t} else if (this.version == 1) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\tthis.sample_offsets.push(stream.readInt32()); /* signed */\n\t\t}\n\t}\n});\n\n// file:src/parsing/dac3.js\nBoxParser.createBoxCtor(\"dac3\", \"AC3SpecificBox\", function(stream) {\n\tvar tmp_byte1 = stream.readUint8();\n\tvar tmp_byte2 = stream.readUint8();\n\tvar tmp_byte3 = stream.readUint8();\n\tthis.fscod = tmp_byte1 >> 6;\n\tthis.bsid  = ((tmp_byte1 >> 1) & 0x1F);\n\tthis.bsmod = ((tmp_byte1 & 0x1) <<  2) | ((tmp_byte2 >> 6) & 0x3);\n\tthis.acmod = ((tmp_byte2 >> 3) & 0x7);\n\tthis.lfeon = ((tmp_byte2 >> 2) & 0x1);\n\tthis.bit_rate_code = (tmp_byte2 & 0x3) | ((tmp_byte3 >> 5) & 0x7);\n});\n\n// file:src/parsing/dec3.js\nBoxParser.createBoxCtor(\"dec3\", \"EC3SpecificBox\", function(stream) {\n\tvar tmp_16 = stream.readUint16();\n\tthis.data_rate = tmp_16 >> 3;\n\tthis.num_ind_sub = tmp_16 & 0x7;\n\tthis.ind_subs = [];\n\tfor (var i = 0; i < this.num_ind_sub+1; i++) {\n\t\tvar ind_sub = {};\n\t\tthis.ind_subs.push(ind_sub);\n\t\tvar tmp_byte1 = stream.readUint8();\n\t\tvar tmp_byte2 = stream.readUint8();\n\t\tvar tmp_byte3 = stream.readUint8();\n\t\tind_sub.fscod = tmp_byte1 >> 6;\n\t\tind_sub.bsid  = ((tmp_byte1 >> 1) & 0x1F);\n\t\tind_sub.bsmod = ((tmp_byte1 & 0x1) << 4) | ((tmp_byte2 >> 4) & 0xF);\n\t\tind_sub.acmod = ((tmp_byte2 >> 1) & 0x7);\n\t\tind_sub.lfeon = (tmp_byte2 & 0x1);\n\t\tind_sub.num_dep_sub = ((tmp_byte3 >> 1) & 0xF);\n\t\tif (ind_sub.num_dep_sub > 0) {\n\t\t\tind_sub.chan_loc = ((tmp_byte3 & 0x1) << 8) | stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/dfLa.js\nBoxParser.createFullBoxCtor(\"dfLa\", \"FLACSpecificBox\", function(stream) {\n    var BLOCKTYPE_MASK = 0x7F;\n    var LASTMETADATABLOCKFLAG_MASK = 0x80;\n\n    var boxesFound = [];\n    var knownBlockTypes = [\n        \"STREAMINFO\",\n        \"PADDING\",\n        \"APPLICATION\",\n        \"SEEKTABLE\",\n        \"VORBIS_COMMENT\",\n        \"CUESHEET\",\n        \"PICTURE\",\n        \"RESERVED\"\n    ];\n\n    // for (i=0; ; i++) { // to end of box\n    do {\n        var flagAndType = stream.readUint8();\n\n        var type = Math.min(\n            (flagAndType & BLOCKTYPE_MASK),\n            (knownBlockTypes.length - 1)\n        );\n\n        // if this is a STREAMINFO block, read the true samplerate since this\n        // can be different to the AudioSampleEntry samplerate.\n        if (!(type)) {\n            // read past all the other stuff\n            stream.readUint8Array(13);\n\n            // extract samplerate\n            this.samplerate = (stream.readUint32() >> 12);\n\n            // read to end of STREAMINFO\n            stream.readUint8Array(20);\n        } else {\n            // not interested in other block types so just discard length bytes\n            stream.readUint8Array(stream.readUint24());\n        }\n\n        boxesFound.push(knownBlockTypes[type]);\n\n        if (!!(flagAndType & LASTMETADATABLOCKFLAG_MASK)) {\n            break;\n        }\n    } while (true);\n\n    this.numMetadataBlocks =\n        boxesFound.length + \" (\" + boxesFound.join(\", \") + \")\";\n});\n// file:src/parsing/dimm.js\nBoxParser.createBoxCtor(\"dimm\", \"hintimmediateBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/dmax.js\nBoxParser.createBoxCtor(\"dmax\", \"hintlongestpacket\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/dmed.js\nBoxParser.createBoxCtor(\"dmed\", \"hintmediaBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/dOps.js\nBoxParser.createBoxCtor(\"dOps\", \"OpusSpecificBox\", function(stream) {\n\tthis.Version = stream.readUint8();\n\tthis.OutputChannelCount = stream.readUint8();\n\tthis.PreSkip = stream.readUint16();\n\tthis.InputSampleRate = stream.readUint32();\n\tthis.OutputGain = stream.readInt16();\n\tthis.ChannelMappingFamily = stream.readUint8();\n\tif (this.ChannelMappingFamily !== 0) {\n\t\tthis.StreamCount = stream.readUint8();\n\t\tthis.CoupledCount = stream.readUint8();\n\t\tthis.ChannelMapping = [];\n\t\tfor (var i = 0; i < this.OutputChannelCount; i++) {\n\t\t\tthis.ChannelMapping[i] = stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/dref.js\nBoxParser.createFullBoxCtor(\"dref\", \"DataReferenceBox\", function(stream) {\n\tvar ret;\n\tvar box;\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.entries.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/drep.js\nBoxParser.createBoxCtor(\"drep\", \"hintrepeatedBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/elng.js\nBoxParser.createFullBoxCtor(\"elng\", \"ExtendedLanguageBox\", function(stream) {\n\tthis.extended_language = stream.readString(this.size-this.hdr_size);\n});\n\n// file:src/parsing/elst.js\nBoxParser.createFullBoxCtor(\"elst\", \"EditListBox\", function(stream) {\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry = {};\n\t\tthis.entries.push(entry);\n\t\tif (this.version === 1) {\n\t\t\tentry.segment_duration = stream.readUint64();\n\t\t\tentry.media_time = stream.readInt64();\n\t\t} else {\n\t\t\tentry.segment_duration = stream.readUint32();\n\t\t\tentry.media_time = stream.readInt32();\n\t\t}\n\t\tentry.media_rate_integer = stream.readInt16();\n\t\tentry.media_rate_fraction = stream.readInt16();\n\t}\n});\n\n// file:src/parsing/emsg.js\nBoxParser.createFullBoxCtor(\"emsg\", \"EventMessageBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.timescale \t\t\t\t\t= stream.readUint32();\n\t\tthis.presentation_time \t\t\t= stream.readUint64();\n\t\tthis.event_duration\t\t\t \t= stream.readUint32();\n\t\tthis.id \t\t\t\t\t\t= stream.readUint32();\n\t\tthis.scheme_id_uri \t\t\t\t= stream.readCString();\n\t\tthis.value \t\t\t\t\t\t= stream.readCString();\n\t} else {\n\t\tthis.scheme_id_uri \t\t\t\t= stream.readCString();\n\t\tthis.value \t\t\t\t\t\t= stream.readCString();\n\t\tthis.timescale \t\t\t\t\t= stream.readUint32();\n\t\tthis.presentation_time_delta \t= stream.readUint32();\n\t\tthis.event_duration\t\t\t \t= stream.readUint32();\n\t\tthis.id \t\t\t\t\t\t= stream.readUint32();\n\t}\n\tvar message_size = this.size - this.hdr_size - (4*4 + (this.scheme_id_uri.length+1) + (this.value.length+1));\n\tif (this.version == 1) {\n\t\tmessage_size -= 4;\n\t}\n\tthis.message_data = stream.readUint8Array(message_size);\n});\n\n// file:src/parsing/EntityToGroup.js\n// ISO/IEC 14496-12:2022 Section 8.18.3 Entity to group box\nBoxParser.createEntityToGroupCtor = function(type, parseMethod) {\n    BoxParser[type+\"Box\"] = function(size) {\n        BoxParser.FullBox.call(this, type, size);\n    }\n    BoxParser[type+\"Box\"].prototype = new BoxParser.FullBox();\n    BoxParser[type+\"Box\"].prototype.parse = function(stream) {\n        this.parseFullHeader(stream);\n        if (parseMethod) {\n            parseMethod.call(this, stream);\n        } else {\n            this.group_id = stream.readUint32();\n            this.num_entities_in_group = stream.readUint32();\n            this.entity_ids = [];\n            for (i = 0; i < this.num_entities_in_group; i++) {\n                var entity_id = stream.readUint32();\n                this.entity_ids.push(entity_id);\n            }\n        }\n    };\n};\n\n// Auto exposure bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.2.1)\nBoxParser.createEntityToGroupCtor(\"aebr\");\n\n// Flash exposure bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.5.1)\nBoxParser.createEntityToGroupCtor(\"afbr\");\n\n// Album collection (ISO/IEC 23008-12:2022 Section 6.8.7.1)\nBoxParser.createEntityToGroupCtor(\"albc\");\n\n// Alternative entity (ISO/IEC 14496-12:2022 Section 8.18.3.1)\nBoxParser.createEntityToGroupCtor(\"altr\");\n\n// Burst image entity group (ISO/IEC 23008-12:2022 Section 6.8.2.2)\nBoxParser.createEntityToGroupCtor(\"brst\");\n\n// Depth of field bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.6.1)\nBoxParser.createEntityToGroupCtor(\"dobr\");\n\n// Equivalent entity (ISO/IEC 23008-12:2022 Section 6.8.1.1)\nBoxParser.createEntityToGroupCtor(\"eqiv\");\n\n// Favourites collection (ISO/IEC 23008-12:2022 Section 6.8.7.2)\nBoxParser.createEntityToGroupCtor(\"favc\");\n\n// Focus bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.4.1)\nBoxParser.createEntityToGroupCtor(\"fobr\");\n\n// Audio to image entity group (ISO/IEC 23008-12:2022 Section 6.8.4)\nBoxParser.createEntityToGroupCtor(\"iaug\");\n\n// Panorama (ISO/IEC 23008-12:2022 Section 6.8.8.1)\nBoxParser.createEntityToGroupCtor(\"pano\");\n\n// Slideshow (ISO/IEC 23008-12:2022 Section 6.8.9.1)\nBoxParser.createEntityToGroupCtor(\"slid\");\n\n// Stereo pair (ISO/IEC 23008-12:2022 Section 6.8.5)\nBoxParser.createEntityToGroupCtor(\"ster\");\n\n// Time-synchronised capture entity group (ISO/IEC 23008-12:2022 Section 6.8.3)\nBoxParser.createEntityToGroupCtor(\"tsyn\");\n\n// White balance bracketing (ISO/IEC 23008-12:2022 Section 6.8.6.3.1)\nBoxParser.createEntityToGroupCtor(\"wbbr\");\n\n// Alternative entity (ISO/IEC 23008-12:2022 AMD1 Section 6.8.10)\nBoxParser.createEntityToGroupCtor(\"prgr\");\n\n// Image Pyramid entity group (ISO/IEC 23008-12:20xx Section 6.8.11)\nBoxParser.createEntityToGroupCtor(\"pymd\", function(stream) {\n    this.group_id = stream.readUint32();\n    this.num_entities_in_group = stream.readUint32();\n    this.entity_ids = [];\n    for (var i = 0; i < this.num_entities_in_group; i++) {\n        var entity_id = stream.readUint32();\n        this.entity_ids.push(entity_id);\n    }\n    \n    this.tile_size_x = stream.readUint16();\n    this.tile_size_y = stream.readUint16();\n    this.layer_binning = [];\n    this.tiles_in_layer_column_minus1 = [];\n    this.tiles_in_layer_row_minus1 = [];\n    for (i = 0; i < this.num_entities_in_group; i++) {\n        this.layer_binning[i] = stream.readUint16();\n        this.tiles_in_layer_row_minus1[i] = stream.readUint16();\n        this.tiles_in_layer_column_minus1[i] = stream.readUint16();\n    }\n});\n\n// file:src/parsing/esds.js\nBoxParser.createFullBoxCtor(\"esds\", \"ElementaryStreamDescriptorBox\", function(stream) {\n\tvar esd_data = stream.readUint8Array(this.size-this.hdr_size);\n\tif (typeof MPEG4DescriptorParser !== \"undefined\") {\n\t\tvar esd_parser = new MPEG4DescriptorParser();\n\t\tthis.esd = esd_parser.parseOneDescriptor(new DataStream(esd_data.buffer, 0, DataStream.BIG_ENDIAN));\n\t}\n});\n\n// file:src/parsing/fiel.js\nBoxParser.createBoxCtor(\"fiel\", \"FieldHandlingBox\", function(stream) {\n\tthis.fieldCount = stream.readUint8();\n\tthis.fieldOrdering = stream.readUint8();\n});\n\n// file:src/parsing/frma.js\nBoxParser.createBoxCtor(\"frma\", \"OriginalFormatBox\", function(stream) {\n\tthis.data_format = stream.readString(4);\n});\n\n// file:src/parsing/ftyp.js\nBoxParser.createBoxCtor(\"ftyp\", \"FileTypeBox\", function(stream) {\n\tvar toparse = this.size - this.hdr_size;\n\tthis.major_brand = stream.readString(4);\n\tthis.minor_version = stream.readUint32();\n\ttoparse -= 8;\n\tthis.compatible_brands = [];\n\tvar i = 0;\n\twhile (toparse>=4) {\n\t\tthis.compatible_brands[i] = stream.readString(4);\n\t\ttoparse -= 4;\n\t\ti++;\n\t}\n});\n\n// file:src/parsing/hdlr.js\nBoxParser.createFullBoxCtor(\"hdlr\", \"HandlerBox\", function(stream) {\n\tif (this.version === 0) {\n\t\tstream.readUint32();\n\t\tthis.handler = stream.readString(4);\n\t\tstream.readUint32Array(3);\n\t\tthis.name = stream.readString(this.size-this.hdr_size-20);\n\t\tif (this.name[this.name.length-1]==='\\0') {\n\t\t\tthis.name = this.name.slice(0,-1);\n\t\t}\n\t}\n});\n\n// file:src/parsing/hvcC.js\nBoxParser.createBoxCtor(\"hvcC\", \"HEVCConfigurationBox\", function(stream) {\n\tvar i, j;\n\tvar nb_nalus;\n\tvar length;\n\tvar tmp_byte;\n\tthis.configurationVersion = stream.readUint8();\n\ttmp_byte = stream.readUint8();\n\tthis.general_profile_space = tmp_byte >> 6;\n\tthis.general_tier_flag = (tmp_byte & 0x20) >> 5;\n\tthis.general_profile_idc = (tmp_byte & 0x1F);\n\tthis.general_profile_compatibility = stream.readUint32();\n\tthis.general_constraint_indicator = stream.readUint8Array(6);\n\tthis.general_level_idc = stream.readUint8();\n\tthis.min_spatial_segmentation_idc = stream.readUint16() & 0xFFF;\n\tthis.parallelismType = (stream.readUint8() & 0x3);\n\tthis.chroma_format_idc = (stream.readUint8() & 0x3);\n\tthis.bit_depth_luma_minus8 = (stream.readUint8() & 0x7);\n\tthis.bit_depth_chroma_minus8 = (stream.readUint8() & 0x7);\n\tthis.avgFrameRate = stream.readUint16();\n\ttmp_byte = stream.readUint8();\n\tthis.constantFrameRate = (tmp_byte >> 6);\n\tthis.numTemporalLayers = (tmp_byte & 0XD) >> 3;\n\tthis.temporalIdNested = (tmp_byte & 0X4) >> 2;\n\tthis.lengthSizeMinusOne = (tmp_byte & 0X3);\n\n\tthis.nalu_arrays = [];\n\tthis.nalu_arrays.toString = function () {\n\t\tvar str = \"<table class='inner-table'>\";\n\t\tstr += \"<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>\";\n\t\tstr += \"<tbody>\";\n\n\t\tfor (var i=0; i<this.length; i++) {\n\t\t\tvar nalu_array = this[i];\n\t\t\tstr += \"<tr>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.completeness+\"</td>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.nalu_type+\"</td>\";\n\t\t\tfor (var j=0; j<nalu_array.length; j++) {\n\t\t\t\tvar nalu = nalu_array[j];\n\t\t\t\tif (j !== 0) str += \"<tr>\";\n\t\t\t\tstr += \"<td>\";\n\t\t\t\tstr += nalu.data.reduce(function(str, byte) {\n\t\t\t\t\treturn str + byte.toString(16).padStart(2, \"0\");\n\t\t\t\t}, \"0x\");\n\t\t\t\tstr += \"</td></tr>\";\n\t\t\t}\n\t\t}\n\t\tstr += \"</tbody></table>\";\n\t\treturn str;\n\t}\n\tvar numOfArrays = stream.readUint8();\n\tfor (i = 0; i < numOfArrays; i++) {\n\t\tvar nalu_array = [];\n\t\tthis.nalu_arrays.push(nalu_array);\n\t\ttmp_byte = stream.readUint8()\n\t\tnalu_array.completeness = (tmp_byte & 0x80) >> 7;\n\t\tnalu_array.nalu_type = tmp_byte & 0x3F;\n\t\tvar numNalus = stream.readUint16();\n\t\tfor (j = 0; j < numNalus; j++) {\n\t\t\tvar nalu = {}\n\t\t\tnalu_array.push(nalu);\n\t\t\tlength = stream.readUint16();\n\t\t\tnalu.data   = stream.readUint8Array(length);\n\t\t}\n\t}\n});\n\n// file:src/parsing/iinf.js\nBoxParser.createFullBoxCtor(\"iinf\", \"ItemInfoBox\", function(stream) {\n\tvar ret;\n\tif (this.version === 0) {\n\t\tthis.entry_count = stream.readUint16();\n\t} else {\n\t\tthis.entry_count = stream.readUint32();\n\t}\n\tthis.item_infos = [];\n\tfor (var i = 0; i < this.entry_count; i++) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (ret.box.type !== \"infe\") {\n\t\t\t\tLog.error(\"BoxParser\", \"Expected 'infe' box, got \"+ret.box.type);\n\t\t\t}\n\t\t\tthis.item_infos[i] = ret.box;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/iloc.js\nBoxParser.createFullBoxCtor(\"iloc\", \"ItemLocationBox\", function(stream) {\n\tvar byte;\n\tbyte = stream.readUint8();\n\tthis.offset_size = (byte >> 4) & 0xF;\n\tthis.length_size = byte & 0xF;\n\tbyte = stream.readUint8();\n\tthis.base_offset_size = (byte >> 4) & 0xF;\n\tif (this.version === 1 || this.version === 2) {\n\t\tthis.index_size = byte & 0xF;\n\t} else {\n\t\tthis.index_size = 0;\n\t\t// reserved = byte & 0xF;\n\t}\n\tthis.items = [];\n\tvar item_count = 0;\n\tif (this.version < 2) {\n\t\titem_count = stream.readUint16();\n\t} else if (this.version === 2) {\n\t\titem_count = stream.readUint32();\n\t} else {\n\t\tthrow \"version of iloc box not supported\";\n\t}\n\tfor (var i = 0; i < item_count; i++) {\n\t\tvar item = {};\n\t\tthis.items.push(item);\n\t\tif (this.version < 2) {\n\t\t\titem.item_ID = stream.readUint16();\n\t\t} else if (this.version === 2) {\n\t\t\titem.item_ID = stream.readUint32();\n\t\t} else {\n\t\t\tthrow \"version of iloc box not supported\";\n\t\t}\n\t\tif (this.version === 1 || this.version === 2) {\n\t\t\titem.construction_method = (stream.readUint16() & 0xF);\n\t\t} else {\n\t\t\titem.construction_method = 0;\n\t\t}\n\t\titem.data_reference_index = stream.readUint16();\n\t\tswitch(this.base_offset_size) {\n\t\t\tcase 0:\n\t\t\t\titem.base_offset = 0;\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\titem.base_offset = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tcase 8:\n\t\t\t\titem.base_offset = stream.readUint64();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow \"Error reading base offset size\";\n\t\t}\n\t\tvar extent_count = stream.readUint16();\n\t\titem.extents = [];\n\t\tfor (var j=0; j < extent_count; j++) {\n\t\t\tvar extent = {};\n\t\t\titem.extents.push(extent);\n\t\t\tif (this.version === 1 || this.version === 2) {\n\t\t\t\tswitch(this.index_size) {\n\t\t\t\t\tcase 0:\n\t\t\t\t\t\textent.extent_index = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\textent.extent_index = stream.readUint32();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 8:\n\t\t\t\t\t\textent.extent_index = stream.readUint64();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tswitch(this.offset_size) {\n\t\t\t\tcase 0:\n\t\t\t\t\textent.extent_offset = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\textent.extent_offset = stream.readUint32();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\textent.extent_offset = stream.readUint64();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t}\n\t\t\tswitch(this.length_size) {\n\t\t\t\tcase 0:\n\t\t\t\t\textent.extent_length = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 4:\n\t\t\t\t\textent.extent_length = stream.readUint32();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 8:\n\t\t\t\t\textent.extent_length = stream.readUint64();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow \"Error reading extent index\";\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/imir.js\nBoxParser.createBoxCtor(\"imir\", \"ImageMirror\", function(stream) {\n\tvar tmp = stream.readUint8();\n\tthis.reserved = tmp >> 7;\n\tthis.axis = tmp & 1;\n});// file:src/parsing/infe.js\nBoxParser.createFullBoxCtor(\"infe\", \"ItemInfoEntry\", function(stream) {\n\tif (this.version === 0 || this.version === 1) {\n\t\tthis.item_ID = stream.readUint16();\n\t\tthis.item_protection_index = stream.readUint16();\n\t\tthis.item_name = stream.readCString();\n\t\tthis.content_type = stream.readCString();\n\t\tthis.content_encoding = stream.readCString();\n\t}\n\tif (this.version === 1) {\n\t\tthis.extension_type = stream.readString(4);\n\t\tLog.warn(\"BoxParser\", \"Cannot parse extension type\");\n\t\tstream.seek(this.start+this.size);\n\t\treturn;\n\t}\n\tif (this.version >= 2) {\n\t\tif (this.version === 2) {\n\t\t\tthis.item_ID = stream.readUint16();\n\t\t} else if (this.version === 3) {\n\t\t\tthis.item_ID = stream.readUint32();\n\t\t}\n\t\tthis.item_protection_index = stream.readUint16();\n\t\tthis.item_type = stream.readString(4);\n\t\tthis.item_name = stream.readCString();\n\t\tif (this.item_type === \"mime\") {\n\t\t\tthis.content_type = stream.readCString();\n\t\t\tthis.content_encoding = stream.readCString();\n\t\t} else if (this.item_type === \"uri \") {\n\t\t\tthis.item_uri_type = stream.readCString();\n\t\t}\n\t}\n});\n// file:src/parsing/ipma.js\nBoxParser.createFullBoxCtor(\"ipma\", \"ItemPropertyAssociationBox\", function(stream) {\n\tvar i, j;\n\tentry_count = stream.readUint32();\n\tthis.associations = [];\n\tfor(i=0; i<entry_count; i++) {\n\t\tvar item_assoc = {};\n\t\tthis.associations.push(item_assoc);\n\t\tif (this.version < 1) {\n\t\t\titem_assoc.id = stream.readUint16();\n\t\t} else {\n\t\t\titem_assoc.id = stream.readUint32();\n\t\t}\n\t\tvar association_count = stream.readUint8();\n\t\titem_assoc.props = [];\n\t\tfor (j = 0; j < association_count; j++) {\n\t\t\tvar tmp = stream.readUint8();\n\t\t\tvar p = {};\n\t\t\titem_assoc.props.push(p);\n\t\t\tp.essential = ((tmp & 0x80) >> 7) === 1;\n\t\t\tif (this.flags & 0x1) {\n\t\t\t\tp.property_index = (tmp & 0x7F) << 8 | stream.readUint8();\n\t\t\t} else {\n\t\t\t\tp.property_index = (tmp & 0x7F);\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/iref.js\nBoxParser.createFullBoxCtor(\"iref\", \"ItemReferenceBox\", function(stream) {\n\tvar ret;\n\tvar entryCount;\n\tvar box;\n\tthis.references = [];\n\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (this.version === 0) {\n\t\t\t\tbox = new BoxParser.SingleItemTypeReferenceBox(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t} else {\n\t\t\t\tbox = new BoxParser.SingleItemTypeReferenceBoxLarge(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t}\n\t\t\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\t\t\tLog.warn(\"BoxParser\", box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.references.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n// file:src/parsing/irot.js\nBoxParser.createBoxCtor(\"irot\", \"ImageRotation\", function(stream) {\n\tthis.angle = stream.readUint8() & 0x3;\n});\n\n// file:src/parsing/ispe.js\nBoxParser.createFullBoxCtor(\"ispe\", \"ImageSpatialExtentsProperty\", function(stream) {\n\tthis.image_width = stream.readUint32();\n\tthis.image_height = stream.readUint32();\n});// file:src/parsing/kind.js\nBoxParser.createFullBoxCtor(\"kind\", \"KindBox\", function(stream) {\n\tthis.schemeURI = stream.readCString();\n\tthis.value = stream.readCString();\n});\n// file:src/parsing/leva.js\nBoxParser.createFullBoxCtor(\"leva\", \"LevelAssignmentBox\", function(stream) {\n\tvar count = stream.readUint8();\n\tthis.levels = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tvar level = {};\n\t\tthis.levels[i] = level;\n\t\tlevel.track_ID = stream.readUint32();\n\t\tvar tmp_byte = stream.readUint8();\n\t\tlevel.padding_flag = tmp_byte >> 7;\n\t\tlevel.assignment_type = tmp_byte & 0x7F;\n\t\tswitch (level.assignment_type) {\n\t\t\tcase 0:\n\t\t\t\tlevel.grouping_type = stream.readString(4);\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tlevel.grouping_type = stream.readString(4);\n\t\t\t\tlevel.grouping_type_parameter = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tlevel.sub_track_id = stream.readUint32();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown leva assignement type\");\n\t\t}\n\t}\n});\n\n// file:src/parsing/lhvC.js\nBoxParser.createBoxCtor(\"lhvC\", \"LHEVCConfigurationBox\", function(stream) {\n\tvar i, j;\n\tvar tmp_byte;\n\tthis.configurationVersion = stream.readUint8();\n\tthis.min_spatial_segmentation_idc = stream.readUint16() & 0xFFF;\n\tthis.parallelismType = (stream.readUint8() & 0x3);\n\ttmp_byte = stream.readUint8();\n\tthis.numTemporalLayers = (tmp_byte & 0XD) >> 3;\n\tthis.temporalIdNested = (tmp_byte & 0X4) >> 2;\n\tthis.lengthSizeMinusOne = (tmp_byte & 0X3);\n\n\tthis.nalu_arrays = [];\n\tthis.nalu_arrays.toString = function () {\n\t\tvar str = \"<table class='inner-table'>\";\n\t\tstr += \"<thead><tr><th>completeness</th><th>nalu_type</th><th>nalu_data</th></tr></thead>\";\n\t\tstr += \"<tbody>\";\n\n\t\tfor (var i=0; i<this.length; i++) {\n\t\t\tvar nalu_array = this[i];\n\t\t\tstr += \"<tr>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.completeness+\"</td>\";\n\t\t\tstr += \"<td rowspan='\"+nalu_array.length+\"'>\"+nalu_array.nalu_type+\"</td>\";\n\t\t\tfor (var j=0; j<nalu_array.length; j++) {\n\t\t\t\tvar nalu = nalu_array[j];\n\t\t\t\tif (j !== 0) str += \"<tr>\";\n\t\t\t\tstr += \"<td>\";\n\t\t\t\tstr += nalu.data.reduce(function(str, byte) {\n\t\t\t\t\treturn str + byte.toString(16).padStart(2, \"0\");\n\t\t\t\t}, \"0x\");\n\t\t\t\tstr += \"</td></tr>\";\n\t\t\t}\n\t\t}\n\t\tstr += \"</tbody></table>\";\n\t\treturn str;\n\t}\n\tvar numOfArrays = stream.readUint8();\n\tfor (i = 0; i < numOfArrays; i++) {\n\t\tvar nalu_array = [];\n\t\tthis.nalu_arrays.push(nalu_array);\n\t\ttmp_byte = stream.readUint8()\n\t\tnalu_array.completeness = (tmp_byte & 0x80) >> 7;\n\t\tnalu_array.nalu_type = tmp_byte & 0x3F;\n\t\tvar numNalus = stream.readUint16();\n\t\tfor (j = 0; j < numNalus; j++) {\n\t\t\tvar nalu = {}\n\t\t\tnalu_array.push(nalu);\n\t\t\tvar length = stream.readUint16();\n\t\t\tnalu.data  = stream.readUint8Array(length);\n\t\t}\n\t}\n});\n\n// file:src/parsing/lsel.js\nBoxParser.createBoxCtor(\"lsel\", \"LayerSelectorProperty\", function(stream) {\n\tthis.layer_id = stream.readUint16();\n});// file:src/parsing/maxr.js\nBoxParser.createBoxCtor(\"maxr\", \"hintmaxrate\", function(stream) {\n\tthis.period = stream.readUint32();\n\tthis.bytes = stream.readUint32();\n});\n\n// file:src/parsing/mdcv.js\nfunction ColorPoint(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nColorPoint.prototype.toString = function() {\n    return \"(\"+this.x+\",\"+this.y+\")\";\n}\n\nBoxParser.createBoxCtor(\"mdcv\", \"MasteringDisplayColourVolumeBox\", function(stream) {\n    this.display_primaries = [];\n    this.display_primaries[0] = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.display_primaries[1] = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.display_primaries[2] = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.white_point = new ColorPoint(stream.readUint16(),stream.readUint16());\n    this.max_display_mastering_luminance = stream.readUint32();\n    this.min_display_mastering_luminance = stream.readUint32();\n});\n\n// file:src/parsing/mdhd.js\nBoxParser.createFullBoxCtor(\"mdhd\", \"MediaHeaderBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tthis.parseLanguage(stream);\n\tstream.readUint16();\n});\n\n// file:src/parsing/mehd.js\nBoxParser.createFullBoxCtor(\"mehd\", \"MovieExtendsHeaderBox\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tLog.warn(\"BoxParser\", \"mehd box incorrectly uses flags set to 1, converting version to 1\");\n\t\tthis.version = 1;\n\t}\n\tif (this.version == 1) {\n\t\tthis.fragment_duration = stream.readUint64();\n\t} else {\n\t\tthis.fragment_duration = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/meta.js\nBoxParser.createFullBoxCtor(\"meta\", \"MetaBox\", function(stream) {\n\tthis.boxes = [];\n\tBoxParser.ContainerBox.prototype.parse.call(this, stream);\n});\n// file:src/parsing/mfhd.js\nBoxParser.createFullBoxCtor(\"mfhd\", \"MovieFragmentHeaderBox\", function(stream) {\n\tthis.sequence_number = stream.readUint32();\n});\n\n// file:src/parsing/mfro.js\nBoxParser.createFullBoxCtor(\"mfro\", \"MovieFragmentRandomAccessOffsetBox\", function(stream) {\n\tthis._size = stream.readUint32();\n});\n\n// file:src/parsing/mskC.js\nBoxParser.createFullBoxCtor(\"mskC\", \"MaskConfigurationProperty\", function(stream) {\n    this.bits_per_pixel = stream.readUint8();\n});\n\n// file:src/parsing/mvhd.js\nBoxParser.createFullBoxCtor(\"mvhd\", \"MovieHeaderBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.timescale = stream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tthis.rate = stream.readUint32();\n\tthis.volume = stream.readUint16()>>8;\n\tstream.readUint16();\n\tstream.readUint32Array(2);\n\tthis.matrix = stream.readUint32Array(9);\n\tstream.readUint32Array(6);\n\tthis.next_track_id = stream.readUint32();\n});\n// file:src/parsing/npck.js\nBoxParser.createBoxCtor(\"npck\", \"hintPacketsSent\", function(stream) {\n\tthis.packetssent = stream.readUint32();\n});\n\n// file:src/parsing/nump.js\nBoxParser.createBoxCtor(\"nump\", \"hintPacketsSent\", function(stream) {\n\tthis.packetssent = stream.readUint64();\n});\n\n// file:src/parsing/padb.js\nBoxParser.createFullBoxCtor(\"padb\", \"PaddingBitsBox\", function(stream) {\n\tvar sample_count = stream.readUint32();\n\tthis.padbits = [];\n\tfor (var i = 0; i < Math.floor((sample_count+1)/2); i++) {\n\t\tthis.padbits = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/pasp.js\nBoxParser.createBoxCtor(\"pasp\", \"PixelAspectRatioBox\", function(stream) {\n\tthis.hSpacing = stream.readUint32();\n\tthis.vSpacing = stream.readUint32();\n});// file:src/parsing/payl.js\nBoxParser.createBoxCtor(\"payl\", \"CuePayloadBox\", function(stream) {\n\tthis.text = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/payt.js\nBoxParser.createBoxCtor(\"payt\", \"hintpayloadID\", function(stream) {\n\tthis.payloadID = stream.readUint32();\n\tvar count = stream.readUint8();\n\tthis.rtpmap_string = stream.readString(count);\n});\n\n// file:src/parsing/pdin.js\nBoxParser.createFullBoxCtor(\"pdin\", \"ProgressiveDownloadInfoBox\", function(stream) {\n\tvar count = (this.size - this.hdr_size)/8;\n\tthis.rate = [];\n\tthis.initial_delay = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.rate[i] = stream.readUint32();\n\t\tthis.initial_delay[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/pitm.js\nBoxParser.createFullBoxCtor(\"pitm\", \"PrimaryItemBox\", function(stream) {\n\tif (this.version === 0) {\n\t\tthis.item_id = stream.readUint16();\n\t} else {\n\t\tthis.item_id = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/pixi.js\nBoxParser.createFullBoxCtor(\"pixi\", \"PixelInformationProperty\", function(stream) {\n\tvar i;\n\tthis.num_channels = stream.readUint8();\n\tthis.bits_per_channels = [];\n\tfor (i = 0; i < this.num_channels; i++) {\n\t\tthis.bits_per_channels[i] = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/pmax.js\nBoxParser.createBoxCtor(\"pmax\", \"hintlargestpacket\", function(stream) {\n\tthis.bytes = stream.readUint32();\n});\n\n// file:src/parsing/prdi.js\nBoxParser.createFullBoxCtor(\"prdi\", \"ProgressiveDerivedImageItemInformationProperty\", function(stream) {\n\tthis.step_count = stream.readUint16();\n\tthis.item_count = [];\n\tif (this.flags & 0x2) {\n\t\tfor (var i = 0; i < this.step_count; i++) {\n\t\t\tthis.item_count[i] = stream.readUint16();\n\t\t}\n\t}\n});// file:src/parsing/prft.js\nBoxParser.createFullBoxCtor(\"prft\", \"ProducerReferenceTimeBox\", function(stream) {\n\tthis.ref_track_id = stream.readUint32();\n\tthis.ntp_timestamp = stream.readUint64();\n\tif (this.version === 0) {\n\t\tthis.media_time = stream.readUint32();\n\t} else {\n\t\tthis.media_time = stream.readUint64();\n\t}\n});\n\n// file:src/parsing/pssh.js\nBoxParser.createFullBoxCtor(\"pssh\", \"ProtectionSystemSpecificHeaderBox\", function(stream) {\n\tthis.system_id = BoxParser.parseHex16(stream);\n\tif (this.version > 0) {\n\t\tvar count = stream.readUint32();\n\t\tthis.kid = [];\n\t\tfor (var i = 0; i < count; i++) {\n\t\t\tthis.kid[i] = BoxParser.parseHex16(stream);\n\t\t}\n\t}\n\tvar datasize = stream.readUint32();\n\tif (datasize > 0) {\n\t\tthis.data = stream.readUint8Array(datasize);\n\t}\n});\n\n// file:src/parsing/qt/clef.js\nBoxParser.createFullBoxCtor(\"clef\", \"TrackCleanApertureDimensionsBox\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/enof.js\nBoxParser.createFullBoxCtor(\"enof\", \"TrackEncodedPixelsDimensionsBox\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/prof.js\nBoxParser.createFullBoxCtor(\"prof\", \"TrackProductionApertureDimensionsBox\", function(stream) {\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});// file:src/parsing/qt/tapt.js\nBoxParser.createContainerBoxCtor(\"tapt\", \"TrackApertureModeDimensionsBox\", null, [ \"clef\", \"prof\", \"enof\"]);// file:src/parsing/rtp.js\nBoxParser.createBoxCtor(\"rtp \", \"rtpmoviehintinformation\", function(stream) {\n\tthis.descriptionformat = stream.readString(4);\n\tthis.sdptext = stream.readString(this.size - this.hdr_size - 4);\n});\n\n// file:src/parsing/saio.js\nBoxParser.createFullBoxCtor(\"saio\", \"SampleAuxiliaryInformationOffsetsBox\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.aux_info_type = stream.readString(4);\n\t\tthis.aux_info_type_parameter = stream.readUint32();\n\t}\n\tvar count = stream.readUint32();\n\tthis.offset = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tif (this.version === 0) {\n\t\t\tthis.offset[i] = stream.readUint32();\n\t\t} else {\n\t\t\tthis.offset[i] = stream.readUint64();\n\t\t}\n\t}\n});\n// file:src/parsing/saiz.js\nBoxParser.createFullBoxCtor(\"saiz\", \"SampleAuxiliaryInformationSizesBox\", function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.aux_info_type = stream.readString(4);\n\t\tthis.aux_info_type_parameter = stream.readUint32();\n\t}\n\tthis.default_sample_info_size = stream.readUint8();\n\tthis.sample_count = stream.readUint32();\n\tthis.sample_info_size = [];\n\tif (this.default_sample_info_size === 0) {\n\t\tfor (var i = 0; i < this.sample_count; i++) {\n\t\t\tthis.sample_info_size[i] = stream.readUint8();\n\t\t}\n\t}\n});\n\n// file:src/parsing/sampleentries/mett.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"mett\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/metx.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"metx\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.namespace = stream.readCString();\n\tthis.schema_location = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/sbtt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"sbtt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/stpp.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"stpp\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.namespace = stream.readCString();\n\tthis.schema_location = stream.readCString();\n\tthis.auxiliary_mime_types = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/stxt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"stxt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.content_encoding = stream.readCString();\n\tthis.mime_format = stream.readCString();\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/sampleentries/tx3g.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_SUBTITLE, \"tx3g\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.displayFlags = stream.readUint32();\n\tthis.horizontal_justification = stream.readInt8();\n\tthis.vertical_justification = stream.readInt8();\n\tthis.bg_color_rgba = stream.readUint8Array(4);\n\tthis.box_record = stream.readInt16Array(4);\n\tthis.style_record = stream.readUint8Array(12);\n\tthis.parseFooter(stream);\n});\n// file:src/parsing/sampleentries/wvtt.js\nBoxParser.createSampleEntryCtor(BoxParser.SAMPLE_ENTRY_TYPE_METADATA, \"wvtt\", function(stream) {\n\tthis.parseHeader(stream);\n\tthis.parseFooter(stream);\n});\n\n// file:src/parsing/samplegroups/alst.js\nBoxParser.createSampleGroupCtor(\"alst\", function(stream) {\n\tvar i;\n\tvar roll_count = stream.readUint16();\n\tthis.first_output_sample = stream.readUint16();\n\tthis.sample_offset = [];\n\tfor (i = 0; i < roll_count; i++) {\n\t\tthis.sample_offset[i] = stream.readUint32();\n\t}\n\tvar remaining = this.description_length - 4 - 4*roll_count;\n\tthis.num_output_samples = [];\n\tthis.num_total_samples = [];\n\tfor (i = 0; i < remaining/4; i++) {\n\t\tthis.num_output_samples[i] = stream.readUint16();\n\t\tthis.num_total_samples[i] = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/samplegroups/avll.js\nBoxParser.createSampleGroupCtor(\"avll\", function(stream) {\n\tthis.layerNumber = stream.readUint8();\n\tthis.accurateStatisticsFlag = stream.readUint8();\n\tthis.avgBitRate = stream.readUint16();\n\tthis.avgFrameRate = stream.readUint16();\n});\n\n// file:src/parsing/samplegroups/avss.js\nBoxParser.createSampleGroupCtor(\"avss\", function(stream) {\n\tthis.subSequenceIdentifier = stream.readUint16();\n\tthis.layerNumber = stream.readUint8();\n\tvar tmp_byte = stream.readUint8();\n\tthis.durationFlag = tmp_byte >> 7;\n\tthis.avgRateFlag = (tmp_byte >> 6) & 0x1;\n\tif (this.durationFlag) {\n\t\tthis.duration = stream.readUint32();\n\t}\n\tif (this.avgRateFlag) {\n\t\tthis.accurateStatisticsFlag = stream.readUint8();\n\t\tthis.avgBitRate = stream.readUint16();\n\t\tthis.avgFrameRate = stream.readUint16();\n\t}\n\tthis.dependency = [];\n\tvar numReferences = stream.readUint8();\n\tfor (var i = 0; i < numReferences; i++) {\n\t\tvar dependencyInfo = {};\n\t\tthis.dependency.push(dependencyInfo);\n\t\tdependencyInfo.subSeqDirectionFlag = stream.readUint8();\n\t\tdependencyInfo.layerNumber = stream.readUint8();\n\t\tdependencyInfo.subSequenceIdentifier = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/samplegroups/dtrt.js\nBoxParser.createSampleGroupCtor(\"dtrt\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/mvif.js\nBoxParser.createSampleGroupCtor(\"mvif\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/prol.js\nBoxParser.createSampleGroupCtor(\"prol\", function(stream) {\n\tthis.roll_distance = stream.readInt16();\n});\n\n// file:src/parsing/samplegroups/rap.js\nBoxParser.createSampleGroupCtor(\"rap \", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.num_leading_samples_known = tmp_byte >> 7;\n\tthis.num_leading_samples = tmp_byte & 0x7F;\n});\n\n// file:src/parsing/samplegroups/rash.js\nBoxParser.createSampleGroupCtor(\"rash\", function(stream) {\n\tthis.operation_point_count = stream.readUint16();\n\tif (this.description_length !== 2+(this.operation_point_count === 1?2:this.operation_point_count*6)+9) {\n\t\tLog.warn(\"BoxParser\", \"Mismatch in \"+this.grouping_type+\" sample group length\");\n\t\tthis.data =  stream.readUint8Array(this.description_length-2);\n\t} else {\n\t\tif (this.operation_point_count === 1) {\n\t\t\tthis.target_rate_share = stream.readUint16();\n\t\t} else {\n\t\t\tthis.target_rate_share = [];\n\t\t\tthis.available_bitrate = [];\n\t\t\tfor (var i = 0; i < this.operation_point_count; i++) {\n\t\t\t\tthis.available_bitrate[i] = stream.readUint32();\n\t\t\t\tthis.target_rate_share[i] = stream.readUint16();\n\t\t\t}\n\t\t}\n\t\tthis.maximum_bitrate = stream.readUint32();\n\t\tthis.minimum_bitrate = stream.readUint32();\n\t\tthis.discard_priority = stream.readUint8();\n\t}\n});\n\n// file:src/parsing/samplegroups/roll.js\nBoxParser.createSampleGroupCtor(\"roll\", function(stream) {\n\tthis.roll_distance = stream.readInt16();\n});\n\n// file:src/parsing/samplegroups/samplegroup.js\nBoxParser.SampleGroupEntry.prototype.parse = function(stream) {\n\tLog.warn(\"BoxParser\", \"Unknown Sample Group type: \"+this.grouping_type);\n\tthis.data =  stream.readUint8Array(this.description_length);\n}\n\n// file:src/parsing/samplegroups/scif.js\nBoxParser.createSampleGroupCtor(\"scif\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/scnm.js\nBoxParser.createSampleGroupCtor(\"scnm\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/seig.js\nBoxParser.createSampleGroupCtor(\"seig\", function(stream) {\n\tthis.reserved = stream.readUint8();\n\tvar tmp = stream.readUint8();\n\tthis.crypt_byte_block = tmp >> 4;\n\tthis.skip_byte_block = tmp & 0xF;\n\tthis.isProtected = stream.readUint8();\n\tthis.Per_Sample_IV_Size = stream.readUint8();\n\tthis.KID = BoxParser.parseHex16(stream);\n\tthis.constant_IV_size = 0;\n\tthis.constant_IV = 0;\n\tif (this.isProtected === 1 && this.Per_Sample_IV_Size === 0) {\n\t\tthis.constant_IV_size = stream.readUint8();\n\t\tthis.constant_IV = stream.readUint8Array(this.constant_IV_size);\n\t}\n});\n\n// file:src/parsing/samplegroups/stsa.js\nBoxParser.createSampleGroupCtor(\"stsa\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/sync.js\nBoxParser.createSampleGroupCtor(\"sync\", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.NAL_unit_type = tmp_byte & 0x3F;\n});\n\n// file:src/parsing/samplegroups/tele.js\nBoxParser.createSampleGroupCtor(\"tele\", function(stream) {\n\tvar tmp_byte = stream.readUint8();\n\tthis.level_independently_decodable = tmp_byte >> 7;\n});\n\n// file:src/parsing/samplegroups/tsas.js\nBoxParser.createSampleGroupCtor(\"tsas\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/tscl.js\nBoxParser.createSampleGroupCtor(\"tscl\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/samplegroups/vipr.js\nBoxParser.createSampleGroupCtor(\"vipr\", function(stream) {\n\tLog.warn(\"BoxParser\", \"Sample Group type: \"+this.grouping_type+\" not fully parsed\");\n});\n\n// file:src/parsing/sbgp.js\nBoxParser.createFullBoxCtor(\"sbgp\", \"SampleToGroupBox\", function(stream) {\n\tthis.grouping_type = stream.readString(4);\n\tif (this.version === 1) {\n\t\tthis.grouping_type_parameter = stream.readUint32();\n\t} else {\n\t\tthis.grouping_type_parameter = 0;\n\t}\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry = {};\n\t\tthis.entries.push(entry);\n\t\tentry.sample_count = stream.readInt32();\n\t\tentry.group_description_index = stream.readInt32();\n\t}\n});\n\n// file:src/parsing/sbpm.js\nfunction Pixel(row, col) {\n\tthis.bad_pixel_row = row;\n\tthis.bad_pixel_column = col;\n}\n\nPixel.prototype.toString = function pixelToString() {\n\treturn \"[row: \" + this.bad_pixel_row + \", column: \" + this.bad_pixel_column + \"]\";\n}\n\nBoxParser.createFullBoxCtor(\"sbpm\", \"SensorBadPixelsMapBox\", function(stream) {\n\tvar i;\n\tthis.component_count = stream.readUint16();\n    this.component_index = [];\n    for (i = 0; i < this.component_count; i++) {\n        this.component_index.push(stream.readUint16());\n    }\n\tvar flags = stream.readUint8();\n\tthis.correction_applied = (0x80 == (flags & 0x80));\n\tthis.num_bad_rows = stream.readUint32();\n\tthis.num_bad_cols = stream.readUint32();\n\tthis.num_bad_pixels = stream.readUint32();\n\tthis.bad_rows = [];\n\tthis.bad_columns = [];\n\tthis.bad_pixels = [];\n\tfor (i = 0; i < this.num_bad_rows; i++) {\n\t\tthis.bad_rows.push(stream.readUint32());\n\t}\n\tfor (i = 0; i < this.num_bad_cols; i++) {\n\t\tthis.bad_columns.push(stream.readUint32());\n\t}\n\tfor (i = 0; i < this.num_bad_pixels; i++) {\n\t\tvar row = stream.readUint32();\n\t\tvar col = stream.readUint32();\n\t\tthis.bad_pixels.push(new Pixel(row, col));\n\t}\n});\n\n// file:src/parsing/schm.js\nBoxParser.createFullBoxCtor(\"schm\", \"SchemeTypeBox\", function(stream) {\n\tthis.scheme_type = stream.readString(4);\n\tthis.scheme_version = stream.readUint32();\n\tif (this.flags & 0x000001) {\n\t\tthis.scheme_uri = stream.readString(this.size - this.hdr_size - 8);\n\t}\n});\n\n// file:src/parsing/sdp.js\nBoxParser.createBoxCtor(\"sdp \", \"rtptracksdphintinformation\", function(stream) {\n\tthis.sdptext = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/sdtp.js\nBoxParser.createFullBoxCtor(\"sdtp\", \"SampleDependencyTypeBox\", function(stream) {\n\tvar tmp_byte;\n\tvar count = (this.size - this.hdr_size);\n\tthis.is_leading = [];\n\tthis.sample_depends_on = [];\n\tthis.sample_is_depended_on = [];\n\tthis.sample_has_redundancy = [];\n\tfor (var i = 0; i < count; i++) {\n\t\ttmp_byte = stream.readUint8();\n\t\tthis.is_leading[i] = tmp_byte >> 6;\n\t\tthis.sample_depends_on[i] = (tmp_byte >> 4) & 0x3;\n\t\tthis.sample_is_depended_on[i] = (tmp_byte >> 2) & 0x3;\n\t\tthis.sample_has_redundancy[i] = tmp_byte & 0x3;\n\t}\n});\n\n// file:src/parsing/senc.js\n// Cannot be fully parsed because Per_Sample_IV_Size needs to be known\r\nBoxParser.createFullBoxCtor(\"senc\", \"SampleEncryptionBox\" /*, function(stream) {\r\n\tthis.parseFullHeader(stream);\r\n\tvar sample_count = stream.readUint32();\r\n\tthis.samples = [];\r\n\tfor (var i = 0; i < sample_count; i++) {\r\n\t\tvar sample = {};\r\n\t\t// tenc.default_Per_Sample_IV_Size or seig.Per_Sample_IV_Size\r\n\t\tsample.InitializationVector = this.readUint8Array(Per_Sample_IV_Size*8);\r\n\t\tif (this.flags & 0x2) {\r\n\t\t\tsample.subsamples = [];\r\n\t\t\tsubsample_count = stream.readUint16();\r\n\t\t\tfor (var j = 0; j < subsample_count; j++) {\r\n\t\t\t\tvar subsample = {};\r\n\t\t\t\tsubsample.BytesOfClearData = stream.readUint16();\r\n\t\t\t\tsubsample.BytesOfProtectedData = stream.readUint32();\r\n\t\t\t\tsample.subsamples.push(subsample);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// TODO\r\n\t\tthis.samples.push(sample);\r\n\t}\r\n}*/);\r\n// file:src/parsing/sgpd.js\nBoxParser.createFullBoxCtor(\"sgpd\", \"SampleGroupDescriptionBox\", function(stream) {\n\tthis.grouping_type = stream.readString(4);\n\tLog.debug(\"BoxParser\", \"Found Sample Groups of type \"+this.grouping_type);\n\tif (this.version === 1) {\n\t\tthis.default_length = stream.readUint32();\n\t} else {\n\t\tthis.default_length = 0;\n\t}\n\tif (this.version >= 2) {\n\t\tthis.default_group_description_index = stream.readUint32();\n\t}\n\tthis.entries = [];\n\tvar entry_count = stream.readUint32();\n\tfor (var i = 0; i < entry_count; i++) {\n\t\tvar entry;\n\t\tif (BoxParser[this.grouping_type+\"SampleGroupEntry\"]) {\n\t\t\tentry = new BoxParser[this.grouping_type+\"SampleGroupEntry\"](this.grouping_type);\n\t\t}  else {\n\t\t\tentry = new BoxParser.SampleGroupEntry(this.grouping_type);\n\t\t}\n\t\tthis.entries.push(entry);\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tentry.description_length = stream.readUint32();\n\t\t\t} else {\n\t\t\t\tentry.description_length = this.default_length;\n\t\t\t}\n\t\t} else {\n\t\t\tentry.description_length = this.default_length;\n\t\t}\n\t\tif (entry.write === BoxParser.SampleGroupEntry.prototype.write) {\n\t\t\tLog.info(\"BoxParser\", \"SampleGroup for type \"+this.grouping_type+\" writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t// storing data\n\t\t\tentry.data = stream.readUint8Array(entry.description_length);\n\t\t\t// rewinding\n\t\t\tstream.position -= entry.description_length;\n\t\t}\n\t\tentry.parse(stream);\n\t}\n});\n\n// file:src/parsing/sidx.js\nBoxParser.createFullBoxCtor(\"sidx\", \"CompressedSegmentIndexBox\", function(stream) {\n\tthis.reference_ID = stream.readUint32();\n\tthis.timescale = stream.readUint32();\n\tif (this.version === 0) {\n\t\tthis.earliest_presentation_time = stream.readUint32();\n\t\tthis.first_offset = stream.readUint32();\n\t} else {\n\t\tthis.earliest_presentation_time = stream.readUint64();\n\t\tthis.first_offset = stream.readUint64();\n\t}\n\tstream.readUint16();\n\tthis.references = [];\n\tvar count = stream.readUint16();\n\tfor (var i = 0; i < count; i++) {\n\t\tvar ref = {};\n\t\tthis.references.push(ref);\n\t\tvar tmp_32 = stream.readUint32();\n\t\tref.reference_type = (tmp_32 >> 31) & 0x1;\n\t\tref.referenced_size = tmp_32 & 0x7FFFFFFF;\n\t\tref.subsegment_duration = stream.readUint32();\n\t\ttmp_32 = stream.readUint32();\n\t\tref.starts_with_SAP = (tmp_32 >> 31) & 0x1;\n\t\tref.SAP_type = (tmp_32 >> 28) & 0x7;\n\t\tref.SAP_delta_time = tmp_32 & 0xFFFFFFF;\n\t}\n});\n\n// file:src/parsing/singleitemtypereference.js\nBoxParser.SingleItemTypeReferenceBox = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.SingleItemTypeReferenceBox.prototype = new BoxParser.Box();\nBoxParser.SingleItemTypeReferenceBox.prototype.parse = function(stream) {\n\tthis.from_item_ID = stream.readUint16();\n\tvar count =  stream.readUint16();\n\tthis.references = [];\n\tfor(var i = 0; i < count; i++) {\n\t\tthis.references[i] = {};\n\t\tthis.references[i].to_item_ID = stream.readUint16();\n\t}\n}\n\n// file:src/parsing/singleitemtypereferencelarge.js\nBoxParser.SingleItemTypeReferenceBoxLarge = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.SingleItemTypeReferenceBoxLarge.prototype = new BoxParser.Box();\nBoxParser.SingleItemTypeReferenceBoxLarge.prototype.parse = function(stream) {\n\tthis.from_item_ID = stream.readUint32();\n\tvar count =  stream.readUint16();\n\tthis.references = [];\n\tfor(var i = 0; i < count; i++) {\n\t\tthis.references[i] = {};\n\t\tthis.references[i].to_item_ID = stream.readUint32();\n\t}\n}\n\n// file:src/parsing/SmDm.js\nBoxParser.createFullBoxCtor(\"SmDm\", \"SMPTE2086MasteringDisplayMetadataBox\", function(stream) {\n\tthis.primaryRChromaticity_x = stream.readUint16();\n    this.primaryRChromaticity_y = stream.readUint16();\n    this.primaryGChromaticity_x = stream.readUint16();\n    this.primaryGChromaticity_y = stream.readUint16();\n    this.primaryBChromaticity_x = stream.readUint16();\n    this.primaryBChromaticity_y = stream.readUint16();\n    this.whitePointChromaticity_x = stream.readUint16();\n    this.whitePointChromaticity_y = stream.readUint16();\n    this.luminanceMax = stream.readUint32();\n    this.luminanceMin = stream.readUint32();\n});\n\n// file:src/parsing/smhd.js\nBoxParser.createFullBoxCtor(\"smhd\", \"SoundMediaHeaderBox\", function(stream) {\n\tthis.balance = stream.readUint16();\n\tstream.readUint16();\n});\n\n// file:src/parsing/ssix.js\nBoxParser.createFullBoxCtor(\"ssix\", \"CompressedSubsegmentIndexBox\", function(stream) {\n\tthis.subsegments = [];\n\tvar subsegment_count = stream.readUint32();\n\tfor (var i = 0; i < subsegment_count; i++) {\n\t\tvar subsegment = {};\n\t\tthis.subsegments.push(subsegment);\n\t\tsubsegment.ranges = [];\n\t\tvar range_count = stream.readUint32();\n\t\tfor (var j = 0; j < range_count; j++) {\n\t\t\tvar range = {};\n\t\t\tsubsegment.ranges.push(range);\n\t\t\trange.level = stream.readUint8();\n\t\t\trange.range_size = stream.readUint24();\n\t\t}\n\t}\n});\n\n// file:src/parsing/stco.js\nBoxParser.createFullBoxCtor(\"stco\", \"ChunkOffsetBox\", function(stream) {\n\tvar entry_count;\n\tentry_count = stream.readUint32();\n\tthis.chunk_offsets = [];\n\tif (this.version === 0) {\n\t\tfor (var i = 0; i < entry_count; i++) {\n\t\t\tthis.chunk_offsets.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stdp.js\nBoxParser.createFullBoxCtor(\"stdp\", \"DegradationPriorityBox\", function(stream) {\n\tvar count = (this.size - this.hdr_size)/2;\n\tthis.priority = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.priority[i] = stream.readUint16();\n\t}\n});\n\n// file:src/parsing/sthd.js\nBoxParser.createFullBoxCtor(\"sthd\", \"SubtitleMediaHeaderBox\");\n\n// file:src/parsing/stri.js\nBoxParser.createFullBoxCtor(\"stri\", \"SubTrackInformationBox\", function(stream) {\n\tthis.switch_group = stream.readUint16();\n\tthis.alternate_group = stream.readUint16();\n\tthis.sub_track_id = stream.readUint32();\n\tvar count = (this.size - this.hdr_size - 8)/4;\n\tthis.attribute_list = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.attribute_list[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/stsc.js\nBoxParser.createFullBoxCtor(\"stsc\", \"SampleToChunkBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.first_chunk = [];\n\tthis.samples_per_chunk = [];\n\tthis.sample_description_index = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.first_chunk.push(stream.readUint32());\n\t\t\tthis.samples_per_chunk.push(stream.readUint32());\n\t\t\tthis.sample_description_index.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsd.js\nBoxParser.createFullBoxCtor(\"stsd\", \"SampleDescriptionBox\", function(stream) {\n\tvar i;\n\tvar ret;\n\tvar entryCount;\n\tvar box;\n\tthis.entries = [];\n\tentryCount = stream.readUint32();\n\tfor (i = 1; i <= entryCount; i++) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tif (BoxParser[ret.type+\"SampleEntry\"]) {\n\t\t\t\tbox = new BoxParser[ret.type+\"SampleEntry\"](ret.size);\n\t\t\t\tbox.hdr_size = ret.hdr_size;\n\t\t\t\tbox.start = ret.start;\n\t\t\t} else {\n\t\t\t\tLog.warn(\"BoxParser\", \"Unknown sample entry type: \"+ret.type);\n\t\t\t\tbox = new BoxParser.SampleEntry(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\t}\n\t\t\tif (box.write === BoxParser.SampleEntry.prototype.write) {\n\t\t\t\tLog.info(\"BoxParser\", \"SampleEntry \"+box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.entries.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsg.js\nBoxParser.createFullBoxCtor(\"stsg\", \"SubTrackSampleGroupBox\", function(stream) {\n\tthis.grouping_type = stream.readUint32();\n\tvar count = stream.readUint16();\n\tthis.group_description_index = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.group_description_index[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/stsh.js\nBoxParser.createFullBoxCtor(\"stsh\", \"ShadowSyncSampleBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tentry_count = stream.readUint32();\n\tthis.shadowed_sample_numbers = [];\n\tthis.sync_sample_numbers = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.shadowed_sample_numbers.push(stream.readUint32());\n\t\t\tthis.sync_sample_numbers.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stss.js\nBoxParser.createFullBoxCtor(\"stss\", \"SyncSampleBox\", function(stream) {\n\tvar i;\n\tvar entry_count;\n\tentry_count = stream.readUint32();\n\tif (this.version === 0) {\n\t\tthis.sample_numbers = [];\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_numbers.push(stream.readUint32());\n\t\t}\n\t}\n});\n\n// file:src/parsing/stsz.js\nBoxParser.createFullBoxCtor(\"stsz\", \"SampleSizeBox\", function(stream) {\n\tvar i;\n\tthis.sample_sizes = [];\n\tif (this.version === 0) {\n\t\tthis.sample_size = stream.readUint32();\n\t\tthis.sample_count = stream.readUint32();\n\t\tfor (i = 0; i < this.sample_count; i++) {\n\t\t\tif (this.sample_size === 0) {\n\t\t\t\tthis.sample_sizes.push(stream.readUint32());\n\t\t\t} else {\n\t\t\t\tthis.sample_sizes[i] = this.sample_size;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/stts.js\nBoxParser.createFullBoxCtor(\"stts\", \"TimeToSampleBox\", function(stream) {\n\tvar entry_count;\n\tvar i;\n\tvar delta;\n\tentry_count = stream.readUint32();\n\tthis.sample_counts = [];\n\tthis.sample_deltas = [];\n\tif (this.version === 0) {\n\t\tfor(i=0; i<entry_count; i++) {\n\t\t\tthis.sample_counts.push(stream.readUint32());\n\t\t\tdelta = stream.readInt32();\n\t\t\tif (delta < 0) {\n\t\t\t\tLog.warn(\"BoxParser\", \"File uses negative stts sample delta, using value 1 instead, sync may be lost!\");\n\t\t\t\tdelta = 1;\n\t\t\t}\n\t\t\tthis.sample_deltas.push(delta);\n\t\t}\n\t}\n});\n\n// file:src/parsing/stvi.js\nBoxParser.createFullBoxCtor(\"stvi\", \"StereoVideoBox\", function(stream) {\n\tvar tmp32 = stream.readUint32();\n\tthis.single_view_allowed = tmp32 & 0x3;\n\tthis.stereo_scheme = stream.readUint32();\n\tvar length = stream.readUint32();\n\tthis.stereo_indication_type = stream.readString(length);\n\tvar ret;\n\tvar box;\n\tthis.boxes = [];\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.boxes.push(box);\n\t\t\tthis[box.type] = box;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/styp.js\nBoxParser.createBoxCtor(\"styp\", \"SegmentTypeBox\", function(stream) {\n\tBoxParser.ftypBox.prototype.parse.call(this, stream);\n});\n\n// file:src/parsing/stz2.js\nBoxParser.createFullBoxCtor(\"stz2\", \"CompactSampleSizeBox\", function(stream) {\n\tvar i;\n\tvar sample_size;\n\tvar sample_count;\n\tthis.sample_sizes = [];\n\tif (this.version === 0) {\n\t\tthis.reserved = stream.readUint24();\n\t\tthis.field_size = stream.readUint8();\n\t\tsample_count = stream.readUint32();\n\t\tif (this.field_size === 4) {\n\t\t\tfor (i = 0; i < sample_count; i+=2) {\n\t\t\t\tvar tmp = stream.readUint8();\n\t\t\t\tthis.sample_sizes[i] = (tmp >> 4) & 0xF;\n\t\t\t\tthis.sample_sizes[i+1] = tmp & 0xF;\n\t\t\t}\n\t\t} else if (this.field_size === 8) {\n\t\t\tfor (i = 0; i < sample_count; i++) {\n\t\t\t\tthis.sample_sizes[i] = stream.readUint8();\n\t\t\t}\n\t\t} else if (this.field_size === 16) {\n\t\t\tfor (i = 0; i < sample_count; i++) {\n\t\t\t\tthis.sample_sizes[i] = stream.readUint16();\n\t\t\t}\n\t\t} else {\n\t\t\tLog.error(\"BoxParser\", \"Error in length field in stz2 box\");\n\t\t}\n\t}\n});\n\n// file:src/parsing/subs.js\nBoxParser.createFullBoxCtor(\"subs\", \"SubSampleInformationBox\", function(stream) {\n\tvar i,j;\n\tvar entry_count;\n\tvar subsample_count;\n\tentry_count = stream.readUint32();\n\tthis.entries = [];\n\tfor (i = 0; i < entry_count; i++) {\n\t\tvar sampleInfo = {};\n\t\tthis.entries[i] = sampleInfo;\n\t\tsampleInfo.sample_delta = stream.readUint32();\n\t\tsampleInfo.subsamples = [];\n\t\tsubsample_count = stream.readUint16();\n\t\tif (subsample_count>0) {\n\t\t\tfor (j = 0; j < subsample_count; j++) {\n\t\t\t\tvar subsample = {};\n\t\t\t\tsampleInfo.subsamples.push(subsample);\n\t\t\t\tif (this.version == 1) {\n\t\t\t\t\tsubsample.size = stream.readUint32();\n\t\t\t\t} else {\n\t\t\t\t\tsubsample.size = stream.readUint16();\n\t\t\t\t}\n\t\t\t\tsubsample.priority = stream.readUint8();\n\t\t\t\tsubsample.discardable = stream.readUint8();\n\t\t\t\tsubsample.codec_specific_parameters = stream.readUint32();\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/tenc.js\nBoxParser.createFullBoxCtor(\"tenc\", \"TrackEncryptionBox\", function(stream) {\n\tstream.readUint8(); // reserved\n\tif (this.version === 0) {\n\t\tstream.readUint8();\n\t} else {\n\t\tvar tmp = stream.readUint8();\n\t\tthis.default_crypt_byte_block = (tmp >> 4) & 0xF;\n\t\tthis.default_skip_byte_block = tmp & 0xF;\n\t}\n\tthis.default_isProtected = stream.readUint8();\n\tthis.default_Per_Sample_IV_Size = stream.readUint8();\n\tthis.default_KID = BoxParser.parseHex16(stream);\n\tif (this.default_isProtected === 1 && this.default_Per_Sample_IV_Size === 0) {\n\t\tthis.default_constant_IV_size = stream.readUint8();\n\t\tthis.default_constant_IV = stream.readUint8Array(this.default_constant_IV_size);\n\t}\n});// file:src/parsing/tfdt.js\nBoxParser.createFullBoxCtor(\"tfdt\", \"TrackFragmentBaseMediaDecodeTimeBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.baseMediaDecodeTime = stream.readUint64();\n\t} else {\n\t\tthis.baseMediaDecodeTime = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/tfhd.js\nBoxParser.createFullBoxCtor(\"tfhd\", \"TrackFragmentHeaderBox\", function(stream) {\n\tvar readBytes = 0;\n\tthis.track_id = stream.readUint32();\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET)) {\n\t\tthis.base_data_offset = stream.readUint64();\n\t\treadBytes += 8;\n\t} else {\n\t\tthis.base_data_offset = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC)) {\n\t\tthis.default_sample_description_index = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_description_index = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR)) {\n\t\tthis.default_sample_duration = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_duration = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE)) {\n\t\tthis.default_sample_size = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_size = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS)) {\n\t\tthis.default_sample_flags = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.default_sample_flags = 0;\n\t}\n});\n\n// file:src/parsing/tfra.js\nBoxParser.createFullBoxCtor(\"tfra\", \"TrackFragmentRandomAccessBox\", function(stream) {\n\tthis.track_ID = stream.readUint32();\n\tstream.readUint24();\n\tvar tmp_byte = stream.readUint8();\n\tthis.length_size_of_traf_num = (tmp_byte >> 4) & 0x3;\n\tthis.length_size_of_trun_num = (tmp_byte >> 2) & 0x3;\n\tthis.length_size_of_sample_num = (tmp_byte) & 0x3;\n\tthis.entries = [];\n\tvar number_of_entries = stream.readUint32();\n\tfor (var i = 0; i < number_of_entries; i++) {\n\t\tif (this.version === 1) {\n\t\t\tthis.time = stream.readUint64();\n\t\t\tthis.moof_offset = stream.readUint64();\n\t\t} else {\n\t\t\tthis.time = stream.readUint32();\n\t\t\tthis.moof_offset = stream.readUint32();\n\t\t}\n\t\tthis.traf_number = stream[\"readUint\"+(8*(this.length_size_of_traf_num+1))]();\n\t\tthis.trun_number = stream[\"readUint\"+(8*(this.length_size_of_trun_num+1))]();\n\t\tthis.sample_number = stream[\"readUint\"+(8*(this.length_size_of_sample_num+1))]();\n\t}\n});\n\n// file:src/parsing/tkhd.js\nBoxParser.createFullBoxCtor(\"tkhd\", \"TrackHeaderBox\", function(stream) {\n\tif (this.version == 1) {\n\t\tthis.creation_time = stream.readUint64();\n\t\tthis.modification_time = stream.readUint64();\n\t\tthis.track_id = stream.readUint32();\n\t\tstream.readUint32();\n\t\tthis.duration = stream.readUint64();\n\t} else {\n\t\tthis.creation_time = stream.readUint32();\n\t\tthis.modification_time = stream.readUint32();\n\t\tthis.track_id = stream.readUint32();\n\t\tstream.readUint32();\n\t\tthis.duration = stream.readUint32();\n\t}\n\tstream.readUint32Array(2);\n\tthis.layer = stream.readInt16();\n\tthis.alternate_group = stream.readInt16();\n\tthis.volume = stream.readInt16()>>8;\n\tstream.readUint16();\n\tthis.matrix = stream.readInt32Array(9);\n\tthis.width = stream.readUint32();\n\tthis.height = stream.readUint32();\n});\n\n// file:src/parsing/tmax.js\nBoxParser.createBoxCtor(\"tmax\", \"hintmaxrelativetime\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/tmin.js\nBoxParser.createBoxCtor(\"tmin\", \"hintminrelativetime\", function(stream) {\n\tthis.time = stream.readUint32();\n});\n\n// file:src/parsing/totl.js\nBoxParser.createBoxCtor(\"totl\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint32();\n});\n\n// file:src/parsing/tpay.js\nBoxParser.createBoxCtor(\"tpay\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint32();\n});\n\n// file:src/parsing/tpyl.js\nBoxParser.createBoxCtor(\"tpyl\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/TrackGroup.js\nBoxParser.TrackGroupTypeBox.prototype.parse = function(stream) {\n\tthis.parseFullHeader(stream);\n\tthis.track_group_id = stream.readUint32();\n}\n\n// file:src/parsing/trackgroups/msrc.js\nBoxParser.createTrackGroupCtor(\"msrc\");// file:src/parsing/TrakReference.js\nBoxParser.TrackReferenceTypeBox = function(type, size, hdr_size, start) {\n\tBoxParser.Box.call(this, type, size);\n\tthis.hdr_size = hdr_size;\n\tthis.start = start;\n}\nBoxParser.TrackReferenceTypeBox.prototype = new BoxParser.Box();\nBoxParser.TrackReferenceTypeBox.prototype.parse = function(stream) {\n\tthis.track_ids = stream.readUint32Array((this.size-this.hdr_size)/4);\n}\n\n// file:src/parsing/tref.js\nBoxParser.trefBox.prototype.parse = function(stream) {\n\tvar ret;\n\tvar box;\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, true, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = new BoxParser.TrackReferenceTypeBox(ret.type, ret.size, ret.hdr_size, ret.start);\n\t\t\tif (box.write === BoxParser.Box.prototype.write && box.type !== \"mdat\") {\n\t\t\t\tLog.info(\"BoxParser\", \"TrackReference \"+box.type+\" box writing not yet implemented, keeping unparsed data in memory for later write\");\n\t\t\t\tbox.parseDataAndRewind(stream);\n\t\t\t}\n\t\t\tbox.parse(stream);\n\t\t\tthis.boxes.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// file:src/parsing/trep.js\nBoxParser.createFullBoxCtor(\"trep\", \"TrackExtensionPropertiesBox\", function(stream) {\n\tthis.track_ID = stream.readUint32();\n\tthis.boxes = [];\n\twhile (stream.getPosition() < this.start+this.size) {\n\t\tret = BoxParser.parseOneBox(stream, false, this.size - (stream.getPosition() - this.start));\n\t\tif (ret.code === BoxParser.OK) {\n\t\t\tbox = ret.box;\n\t\t\tthis.boxes.push(box);\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\t}\n});\n\n// file:src/parsing/trex.js\nBoxParser.createFullBoxCtor(\"trex\", \"TrackExtendsBox\", function(stream) {\n\tthis.track_id = stream.readUint32();\n\tthis.default_sample_description_index = stream.readUint32();\n\tthis.default_sample_duration = stream.readUint32();\n\tthis.default_sample_size = stream.readUint32();\n\tthis.default_sample_flags = stream.readUint32();\n});\n\n// file:src/parsing/trpy.js\nBoxParser.createBoxCtor(\"trpy\", \"hintBytesSent\", function(stream) {\n\tthis.bytessent = stream.readUint64();\n});\n\n// file:src/parsing/trun.js\nBoxParser.createFullBoxCtor(\"trun\", \"TrackRunBox\", function(stream) {\n\tvar readBytes = 0;\n\tthis.sample_count = stream.readUint32();\n\treadBytes+= 4;\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) ) {\n\t\tthis.data_offset = stream.readInt32(); //signed\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.data_offset = 0;\n\t}\n\tif (this.size - this.hdr_size > readBytes && (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) ) {\n\t\tthis.first_sample_flags = stream.readUint32();\n\t\treadBytes += 4;\n\t} else {\n\t\tthis.first_sample_flags = 0;\n\t}\n\tthis.sample_duration = [];\n\tthis.sample_size = [];\n\tthis.sample_flags = [];\n\tthis.sample_composition_time_offset = [];\n\tif (this.size - this.hdr_size > readBytes) {\n\t\tfor (var i = 0; i < this.sample_count; i++) {\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\t\tthis.sample_duration[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\t\tthis.sample_size[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\t\tthis.sample_flags[i] = stream.readUint32();\n\t\t\t}\n\t\t\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\t\tif (this.version === 0) {\n\t\t\t\t\tthis.sample_composition_time_offset[i] = stream.readUint32();\n\t\t\t\t} else {\n\t\t\t\t\tthis.sample_composition_time_offset[i] = stream.readInt32(); //signed\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\n// file:src/parsing/tsel.js\nBoxParser.createFullBoxCtor(\"tsel\", \"TrackSelectionBox\", function(stream) {\n\tthis.switch_group = stream.readUint32();\n\tvar count = (this.size - this.hdr_size - 4)/4;\n\tthis.attribute_list = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.attribute_list[i] = stream.readUint32();\n\t}\n});\n\n// file:src/parsing/txtC.js\nBoxParser.createFullBoxCtor(\"txtC\", \"TextConfigBox\", function(stream) {\n\tthis.config = stream.readCString();\n});\n\n// file:src/parsing/tyco.js\nBoxParser.createBoxCtor(\"tyco\", \"TypeCombinationBox\", function(stream) {\n\tvar count = (this.size - this.hdr_size) / 4;\n\tthis.compatible_brands = [];\n\tfor (var i = 0; i < count; i++) {\n\t\tthis.compatible_brands[i] = stream.readString(4);\n\t}\n});\n\n// file:src/parsing/udes.js\nBoxParser.createFullBoxCtor(\"udes\", \"UserDescriptionProperty\", function(stream) {\n\tthis.lang = stream.readCString();\n\tthis.name = stream.readCString();\n\tthis.description = stream.readCString();\n\tthis.tags = stream.readCString();\n});\n\n// file:src/parsing/uncC.js\nBoxParser.createFullBoxCtor(\"uncC\", \"UncompressedFrameConfigBox\", function(stream) {\n    var i;\n    this.profile = stream.readString(4);\n    if (this.version == 1) {\n        // Nothing - just the profile\n    } else if (this.version == 0) {\n        this.component_count = stream.readUint32();\n        this.component_index = [];\n        this.component_bit_depth_minus_one = [];\n        this.component_format = [];\n        this.component_align_size = [];\n        for (i = 0; i < this.component_count; i++) {\n            this.component_index.push(stream.readUint16());\n            this.component_bit_depth_minus_one.push(stream.readUint8());\n            this.component_format.push(stream.readUint8());\n            this.component_align_size.push(stream.readUint8());\n        }\n        this.sampling_type = stream.readUint8();\n        this.interleave_type = stream.readUint8();\n        this.block_size = stream.readUint8();\n        var flags = stream.readUint8();\n        this.component_little_endian = (flags >> 7) & 0x1;\n        this.block_pad_lsb = (flags >> 6) & 0x1;\n        this.block_little_endian = (flags >> 5) & 0x1;\n        this.block_reversed = (flags >> 4) & 0x1;\n        this.pad_unknown = (flags >> 3) & 0x1;\n        this.pixel_size = stream.readUint32();\n        this.row_align_size = stream.readUint32();\n        this.tile_align_size = stream.readUint32();\n        this.num_tile_cols_minus_one = stream.readUint32();\n        this.num_tile_rows_minus_one = stream.readUint32();\n    }\n});\n\n// file:src/parsing/url.js\nBoxParser.createFullBoxCtor(\"url \", \"DataEntryUrlBox\", function(stream) {\n\tif (this.flags !== 0x000001) {\n\t\tthis.location = stream.readCString();\n\t}\n});\n\n// file:src/parsing/urn.js\nBoxParser.createFullBoxCtor(\"urn \", \"DataEntryUrnBox\", function(stream) {\n\tthis.name = stream.readCString();\n\tif (this.size - this.hdr_size - this.name.length - 1 > 0) {\n\t\tthis.location = stream.readCString();\n\t}\n});\n\n// file:src/parsing/uuid/piff/piffLsm.js\nBoxParser.createUUIDBox(\"a5d40b30e81411ddba2f0800200c9a66\", \"LiveServerManifestBox\", true, false, function(stream) {\n    this.LiveServerManifest = stream.readString(this.size - this.hdr_size)\n        .replace(/&/g, \"&amp;\")\n        .replace(/</g, \"&lt;\")\n        .replace(/>/g, \"&gt;\")\n        .replace(/\"/g, \"&quot;\")\n        .replace(/'/g, \"&#039;\");\n});// file:src/parsing/uuid/piff/piffPssh.js\nBoxParser.createUUIDBox(\"d08a4f1810f34a82b6c832d8aba183d3\", \"PiffProtectionSystemSpecificHeaderBox\", true, false, function(stream) {\n\tthis.system_id = BoxParser.parseHex16(stream);\n\tvar datasize = stream.readUint32();\n\tif (datasize > 0) {\n\t\tthis.data = stream.readUint8Array(datasize);\n\t}\n});\n\n// file:src/parsing/uuid/piff/piffSenc.js\nBoxParser.createUUIDBox(\"a2394f525a9b4f14a2446c427c648df4\", \"PiffSampleEncryptionBox\", true, false /*, function(stream) {\n\tif (this.flags & 0x1) {\n\t\tthis.AlgorithmID = stream.readUint24();\n\t\tthis.IV_size = stream.readUint8();\n\t\tthis.KID = BoxParser.parseHex16(stream);\n\t}\n\tvar sample_count = stream.readUint32();\n\tthis.samples = [];\n\tfor (var i = 0; i < sample_count; i++) {\n\t\tvar sample = {};\n\t\tsample.InitializationVector = this.readUint8Array(this.IV_size*8);\n\t\tif (this.flags & 0x2) {\n\t\t\tsample.subsamples = [];\n\t\t\tsample.NumberOfEntries = stream.readUint16();\n\t\t\tfor (var j = 0; j < sample.NumberOfEntries; j++) {\n\t\t\t\tvar subsample = {};\n\t\t\t\tsubsample.BytesOfClearData = stream.readUint16();\n\t\t\t\tsubsample.BytesOfProtectedData = stream.readUint32();\n\t\t\t\tsample.subsamples.push(subsample);\n\t\t\t}\n\t\t}\n\t\tthis.samples.push(sample);\n\t}\n}*/);\n// file:src/parsing/uuid/piff/piffTenc.js\nBoxParser.createUUIDBox(\"8974dbce7be74c5184f97148f9882554\", \"PiffTrackEncryptionBox\", true, false, function(stream) {\n\tthis.default_AlgorithmID = stream.readUint24();\n\tthis.default_IV_size = stream.readUint8();\n\tthis.default_KID = BoxParser.parseHex16(stream);\n});// file:src/parsing/uuid/piff/piffTfrf.js\nBoxParser.createUUIDBox(\"d4807ef2ca3946958e5426cb9e46a79f\", \"TfrfBox\", true, false, function(stream) {\n    this.fragment_count = stream.readUint8();\n    this.entries = [];\n\n    for (var i = 0; i < this.fragment_count; i++) {\n        var entry = {};\n        var absolute_time = 0;\n        var absolute_duration = 0;\n\n        if (this.version === 1) {\n            absolute_time = stream.readUint64();\n            absolute_duration = stream.readUint64();\n        } else {\n            absolute_time = stream.readUint32();\n            absolute_duration = stream.readUint32();\n        }\n\n        entry.absolute_time = absolute_time;\n        entry.absolute_duration = absolute_duration;\n\n        this.entries.push(entry);\n    }\n});// file:src/parsing/uuid/piff/piffTfxd.js\nBoxParser.createUUIDBox(\"6d1d9b0542d544e680e2141daff757b2\", \"TfxdBox\", true, false, function(stream) {\n    if (this.version === 1) {\n       this.absolute_time = stream.readUint64();\n       this.duration = stream.readUint64();\n    } else {\n       this.absolute_time = stream.readUint32();\n       this.duration = stream.readUint32();\n    }\n});// file:src/parsing/vmhd.js\nBoxParser.createFullBoxCtor(\"vmhd\", \"VideoMediaHeaderBox\", function(stream) {\n\tthis.graphicsmode = stream.readUint16();\n\tthis.opcolor = stream.readUint16Array(3);\n});\n\n// file:src/parsing/vpcC.js\nBoxParser.createFullBoxCtor(\"vpcC\", \"VPCodecConfigurationRecord\", function (stream) {\n\tvar tmp;\n\tif (this.version === 1) {\n\t\tthis.profile = stream.readUint8();\n\t\tthis.level = stream.readUint8();\n\t\ttmp = stream.readUint8();\n\t\tthis.bitDepth = tmp >> 4;\n\t\tthis.chromaSubsampling = (tmp >> 1) & 0x7;\n\t\tthis.videoFullRangeFlag = tmp & 0x1;\n\t\tthis.colourPrimaries = stream.readUint8();\n\t\tthis.transferCharacteristics = stream.readUint8();\n\t\tthis.matrixCoefficients = stream.readUint8();\n\t\tthis.codecIntializationDataSize = stream.readUint16();\n\t\tthis.codecIntializationData = stream.readUint8Array(this.codecIntializationDataSize);\n\t} else {\n\t\tthis.profile = stream.readUint8();\n\t\tthis.level = stream.readUint8();\n\t\ttmp = stream.readUint8();\n\t\tthis.bitDepth = (tmp >> 4) & 0xF;\n\t\tthis.colorSpace = tmp & 0xF;\n\t\ttmp = stream.readUint8();\n\t\tthis.chromaSubsampling = (tmp >> 4) & 0xF;\n\t\tthis.transferFunction = (tmp >> 1) & 0x7;\n\t\tthis.videoFullRangeFlag = tmp & 0x1;\n\t\tthis.codecIntializationDataSize = stream.readUint16();\n\t\tthis.codecIntializationData = stream.readUint8Array(this.codecIntializationDataSize);\n\t}\n});// file:src/parsing/vttC.js\nBoxParser.createBoxCtor(\"vttC\", \"WebVTTConfigurationBox\", function(stream) {\n\tthis.text = stream.readString(this.size - this.hdr_size);\n});\n\n// file:src/parsing/vvcC.js\nBoxParser.createFullBoxCtor(\"vvcC\", \"VvcConfigurationBox\", function (stream) {\n  var i, j;\n\n  // helper object to simplify extracting individual bits\n  var bitReader = {\n    held_bits: undefined,\n    num_held_bits: 0,\n\n    stream_read_1_bytes: function (strm) {\n      this.held_bits = strm.readUint8();\n      this.num_held_bits = 1 * 8;\n    },\n    stream_read_2_bytes: function (strm) {\n      this.held_bits = strm.readUint16();\n      this.num_held_bits = 2 * 8;\n    },\n\n    extract_bits: function (num_bits) {\n      var ret = (this.held_bits >> (this.num_held_bits - num_bits)) & ((1 << num_bits) - 1);\n      this.num_held_bits -= num_bits;\n      return ret;\n    }\n  };\n\n  // VvcDecoderConfigurationRecord\n  bitReader.stream_read_1_bytes(stream);\n  bitReader.extract_bits(5);  // reserved\n  this.lengthSizeMinusOne = bitReader.extract_bits(2);\n  this.ptl_present_flag = bitReader.extract_bits(1);\n\n  if (this.ptl_present_flag) {\n    bitReader.stream_read_2_bytes(stream);\n    this.ols_idx = bitReader.extract_bits(9);\n    this.num_sublayers = bitReader.extract_bits(3);\n    this.constant_frame_rate = bitReader.extract_bits(2);\n    this.chroma_format_idc = bitReader.extract_bits(2);\n\n    bitReader.stream_read_1_bytes(stream);\n    this.bit_depth_minus8 = bitReader.extract_bits(3);\n    bitReader.extract_bits(5);  // reserved\n\n    // VvcPTLRecord\n    {\n      bitReader.stream_read_2_bytes(stream);\n      bitReader.extract_bits(2);  // reserved\n      this.num_bytes_constraint_info = bitReader.extract_bits(6);\n      this.general_profile_idc = bitReader.extract_bits(7);\n      this.general_tier_flag = bitReader.extract_bits(1);\n\n      this.general_level_idc = stream.readUint8();\n\n      bitReader.stream_read_1_bytes(stream);\n      this.ptl_frame_only_constraint_flag = bitReader.extract_bits(1);\n      this.ptl_multilayer_enabled_flag = bitReader.extract_bits(1);\n\n      this.general_constraint_info = new Uint8Array(this.num_bytes_constraint_info);\n      if (this.num_bytes_constraint_info) {\n        for (i = 0; i < this.num_bytes_constraint_info - 1; i++) {\n          var cnstr1 = bitReader.extract_bits(6);\n          bitReader.stream_read_1_bytes(stream);\n          var cnstr2 = bitReader.extract_bits(2);\n\n          this.general_constraint_info[i] = ((cnstr1 << 2) | cnstr2);\n        }\n        this.general_constraint_info[this.num_bytes_constraint_info - 1] = bitReader.extract_bits(6);\n      } else {\n        //forbidden in spec!\n        bitReader.extract_bits(6);\n      }\n\n      if (this.num_sublayers > 1) {\n        bitReader.stream_read_1_bytes(stream);\n        this.ptl_sublayer_present_mask = 0;\n        for (j = this.num_sublayers - 2; j >= 0; --j) {\n          var val = bitReader.extract_bits(1);\n          this.ptl_sublayer_present_mask |= val << j;\n        }\n        for (j = this.num_sublayers; j <= 8 && this.num_sublayers > 1; ++j) {\n          bitReader.extract_bits(1);  // ptl_reserved_zero_bit\n        }\n\n        this.sublayer_level_idc = [];\n        for (j = this.num_sublayers - 2; j >= 0; --j) {\n          if (this.ptl_sublayer_present_mask & (1 << j)) {\n            this.sublayer_level_idc[j] = stream.readUint8();\n          }\n        }\n      }\n\n      this.ptl_num_sub_profiles = stream.readUint8();\n      this.general_sub_profile_idc = [];\n      if (this.ptl_num_sub_profiles) {\n        for (i = 0; i < this.ptl_num_sub_profiles; i++) {\n          this.general_sub_profile_idc.push(stream.readUint32());\n        }\n      }\n    }  // end VvcPTLRecord\n\n    this.max_picture_width = stream.readUint16();\n    this.max_picture_height = stream.readUint16();\n    this.avg_frame_rate = stream.readUint16();\n  }\n\n  var VVC_NALU_OPI = 12;\n  var VVC_NALU_DEC_PARAM = 13;\n\n  this.nalu_arrays = [];\n  var num_of_arrays = stream.readUint8();\n  for (i = 0; i < num_of_arrays; i++) {\n    var nalu_array = [];\n    this.nalu_arrays.push(nalu_array);\n\n    bitReader.stream_read_1_bytes(stream);\n    nalu_array.completeness = bitReader.extract_bits(1);\n    bitReader.extract_bits(2);  // reserved\n    nalu_array.nalu_type = bitReader.extract_bits(5);\n\n    var numNalus = 1;\n    if (nalu_array.nalu_type != VVC_NALU_DEC_PARAM && nalu_array.nalu_type != VVC_NALU_OPI) {\n      numNalus = stream.readUint16();\n    }\n\n    for (j = 0; j < numNalus; j++) {\n      var len = stream.readUint16();\n      nalu_array.push({\n        data: stream.readUint8Array(len),\n        length: len\n      });\n    }\n  }\n});\n// file:src/parsing/vvnC.js\nBoxParser.createFullBoxCtor(\"vvnC\", \"VvcNALUConfigBox\", function (stream) {\n  // VvcNALUConfigBox\n  var tmp = strm.readUint8();\n  this.lengthSizeMinusOne = (tmp & 0x3);\n});\n// file:src/box-codecs.js\nBoxParser.SampleEntry.prototype.isVideo = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isAudio = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isSubtitle = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isMetadata = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.isHint = function() {\n\treturn false;\n}\n\nBoxParser.SampleEntry.prototype.getCodec = function() {\n\treturn this.type.replace('.','');\n}\n\nBoxParser.SampleEntry.prototype.getWidth = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getHeight = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getChannelCount = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getSampleRate = function() {\n\treturn \"\";\n}\n\nBoxParser.SampleEntry.prototype.getSampleSize = function() {\n\treturn \"\";\n}\n\nBoxParser.VisualSampleEntry.prototype.isVideo = function() {\n\treturn true;\n}\n\nBoxParser.VisualSampleEntry.prototype.getWidth = function() {\n\treturn this.width;\n}\n\nBoxParser.VisualSampleEntry.prototype.getHeight = function() {\n\treturn this.height;\n}\n\nBoxParser.AudioSampleEntry.prototype.isAudio = function() {\n\treturn true;\n}\n\nBoxParser.AudioSampleEntry.prototype.getChannelCount = function() {\n\treturn this.channel_count;\n}\n\nBoxParser.AudioSampleEntry.prototype.getSampleRate = function() {\n\treturn this.samplerate;\n}\n\nBoxParser.AudioSampleEntry.prototype.getSampleSize = function() {\n\treturn this.samplesize;\n}\n\nBoxParser.SubtitleSampleEntry.prototype.isSubtitle = function() {\n\treturn true;\n}\n\nBoxParser.MetadataSampleEntry.prototype.isMetadata = function() {\n\treturn true;\n}\n\n\nBoxParser.decimalToHex = function(d, padding) {\n\tvar hex = Number(d).toString(16);\n\tpadding = typeof (padding) === \"undefined\" || padding === null ? padding = 2 : padding;\n\twhile (hex.length < padding) {\n\t\thex = \"0\" + hex;\n\t}\n\treturn hex;\n}\n\nBoxParser.avc1SampleEntry.prototype.getCodec =\nBoxParser.avc2SampleEntry.prototype.getCodec =\nBoxParser.avc3SampleEntry.prototype.getCodec =\nBoxParser.avc4SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.avcC) {\n\t\treturn baseCodec+\".\"+BoxParser.decimalToHex(this.avcC.AVCProfileIndication)+\n\t\t\t\t\t\t  \"\"+BoxParser.decimalToHex(this.avcC.profile_compatibility)+\n\t\t\t\t\t\t  \"\"+BoxParser.decimalToHex(this.avcC.AVCLevelIndication);\n\t} else {\n\t\treturn baseCodec;\n\t}\n}\n\nBoxParser.hev1SampleEntry.prototype.getCodec =\nBoxParser.hvc1SampleEntry.prototype.getCodec = function() {\n\tvar i;\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.hvcC) {\n\t\tbaseCodec += '.';\n\t\tswitch (this.hvcC.general_profile_space) {\n\t\t\tcase 0:\n\t\t\t\tbaseCodec += '';\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tbaseCodec += 'A';\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tbaseCodec += 'B';\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tbaseCodec += 'C';\n\t\t\t\tbreak;\n\t\t}\n\t\tbaseCodec += this.hvcC.general_profile_idc;\n\t\tbaseCodec += '.';\n\t\tvar val = this.hvcC.general_profile_compatibility;\n\t\tvar reversed = 0;\n\t\tfor (i=0; i<32; i++) {\n\t\t\treversed |= val & 1;\n\t\t\tif (i==31) break;\n\t\t\treversed <<= 1;\n\t\t\tval >>=1;\n\t\t}\n\t\tbaseCodec += BoxParser.decimalToHex(reversed, 0);\n\t\tbaseCodec += '.';\n\t\tif (this.hvcC.general_tier_flag === 0) {\n\t\t\tbaseCodec += 'L';\n\t\t} else {\n\t\t\tbaseCodec += 'H';\n\t\t}\n\t\tbaseCodec += this.hvcC.general_level_idc;\n\t\tvar hasByte = false;\n\t\tvar constraint_string = \"\";\n\t\tfor (i = 5; i >= 0; i--) {\n\t\t\tif (this.hvcC.general_constraint_indicator[i] || hasByte) {\n\t\t\t\tconstraint_string = \".\"+BoxParser.decimalToHex(this.hvcC.general_constraint_indicator[i], 0)+constraint_string;\n\t\t\t\thasByte = true;\n\t\t\t}\n\t\t}\n\t\tbaseCodec += constraint_string;\n\t}\n\treturn baseCodec;\n}\n\nBoxParser.vvc1SampleEntry.prototype.getCodec =\nBoxParser.vvi1SampleEntry.prototype.getCodec = function () {\n\tvar i;\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.vvcC) {\n\t\tbaseCodec += '.' + this.vvcC.general_profile_idc;\n\t\tif (this.vvcC.general_tier_flag) {\n\t\t\tbaseCodec += '.H';\n\t\t} else {\n\t\t\tbaseCodec += '.L';\n\t\t}\n\t\tbaseCodec += this.vvcC.general_level_idc;\n\n\t\tvar constraint_string = \"\";\n\t\tif (this.vvcC.general_constraint_info) {\n\t\t\tvar bytes = [];\n\t\t\tvar byte = 0;\n\t\t\tbyte |= this.vvcC.ptl_frame_only_constraint << 7;\n\t\t\tbyte |= this.vvcC.ptl_multilayer_enabled << 6;\n\t\t\tvar last_nonzero;\n\t\t\tfor (i = 0; i < this.vvcC.general_constraint_info.length; ++i) {\n\t\t\t\tbyte |= (this.vvcC.general_constraint_info[i] >> 2) & 0x3f;\n\t\t\t\tbytes.push(byte);\n\t\t\t\tif (byte) {\n\t\t\t\t\tlast_nonzero = i;\n\t\t\t\t}\n\n\t\t\t\tbyte = (this.vvcC.general_constraint_info[i] >> 2) & 0x03;\n\t\t\t}\n\n\t\t\tif (last_nonzero === undefined) {\n\t\t\t\tconstraint_string = \".CA\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconstraint_string = \".C\"\n\t\t\t\tvar base32_chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567\";\n\t\t\t\tvar held_bits = 0;\n\t\t\t\tvar num_held_bits = 0;\n\t\t\t\tfor (i = 0; i <= last_nonzero; ++i) {\n\t\t\t\t\theld_bits = (held_bits << 8) | bytes[i];\n\t\t\t\t\tnum_held_bits += 8;\n\n\t\t\t\t\twhile (num_held_bits >= 5) {\n\t\t\t\t\t\tvar val = (held_bits >> (num_held_bits - 5)) & 0x1f;\n\t\t\t\t\t\tconstraint_string += base32_chars[val];\n\n\t\t\t\t\t\tnum_held_bits -= 5;\n\t\t\t\t\t\theld_bits &= (1 << num_held_bits) - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (num_held_bits) {\n\t\t\t\t\theld_bits <<= (5 - num_held_bits);  // right-pad with zeros to 5 bits (is this correct?)\n\t\t\t\t\tconstraint_string += base32_chars[held_bits & 0x1f];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbaseCodec += constraint_string;\n\t}\n\treturn baseCodec;\n}\n\nBoxParser.mp4aSampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif (this.esds && this.esds.esd) {\n\t\tvar oti = this.esds.esd.getOTI();\n\t\tvar dsi = this.esds.esd.getAudioConfig();\n\t\treturn baseCodec+\".\"+BoxParser.decimalToHex(oti)+(dsi ? \".\"+dsi: \"\");\n\t} else {\n\t\treturn baseCodec;\n\t}\n}\n\nBoxParser.stxtSampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tif(this.mime_format) {\n\t\treturn baseCodec + \".\" + this.mime_format;\n\t} else {\n\t\treturn baseCodec\n\t}\n}\n\nBoxParser.vp08SampleEntry.prototype.getCodec =\nBoxParser.vp09SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tvar level = this.vpcC.level;\n\tif (level == 0) {\n\t\tlevel = \"00\";\n\t}\n\tvar bitDepth = this.vpcC.bitDepth;\n\tif (bitDepth == 8) {\n\t\tbitDepth = \"08\";\n\t}\n\treturn baseCodec + \".0\" + this.vpcC.profile + \".\" + level + \".\" + bitDepth;\n}\n\nBoxParser.av01SampleEntry.prototype.getCodec = function() {\n\tvar baseCodec = BoxParser.SampleEntry.prototype.getCodec.call(this);\n\tvar level = this.av1C.seq_level_idx_0;\n\tif (level < 10) {\n\t\tlevel = \"0\" + level;\n\t}\n\tvar bitdepth;\n\tif (this.av1C.seq_profile === 2 && this.av1C.high_bitdepth === 1) {\n\t\tbitdepth = (this.av1C.twelve_bit === 1) ? \"12\" : \"10\";\n\t} else if ( this.av1C.seq_profile <= 2 ) {\n\t\tbitdepth = (this.av1C.high_bitdepth === 1) ? \"10\" : \"08\";\n\t}\n\t// TODO need to parse the SH to find color config\n\treturn baseCodec+\".\"+this.av1C.seq_profile+\".\"+level+(this.av1C.seq_tier_0?\"H\":\"M\")+\".\"+bitdepth;//+\".\"+this.av1C.monochrome+\".\"+this.av1C.chroma_subsampling_x+\"\"+this.av1C.chroma_subsampling_y+\"\"+this.av1C.chroma_sample_position;\n}\n// file:src/box-write.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.Box.prototype.writeHeader = function(stream, msg) {\n\tthis.size += 8;\n\tif (this.size > MAX_SIZE) {\n\t\tthis.size += 8;\n\t}\n\tif (this.type === \"uuid\") {\n\t\tthis.size += 16;\n\t}\n\tLog.debug(\"BoxWriter\", \"Writing box \"+this.type+\" of size: \"+this.size+\" at position \"+stream.getPosition()+(msg || \"\"));\n\tif (this.size > MAX_SIZE) {\n\t\tstream.writeUint32(1);\n\t} else {\n\t\tthis.sizePosition = stream.getPosition();\n\t\tstream.writeUint32(this.size);\n\t}\n\tstream.writeString(this.type, null, 4);\n\tif (this.type === \"uuid\") {\n\t\tstream.writeUint8Array(this.uuid);\n\t}\n\tif (this.size > MAX_SIZE) {\n\t\tstream.writeUint64(this.size);\n\t} \n}\n\nBoxParser.FullBox.prototype.writeHeader = function(stream) {\n\tthis.size += 4;\n\tBoxParser.Box.prototype.writeHeader.call(this, stream, \" v=\"+this.version+\" f=\"+this.flags);\n\tstream.writeUint8(this.version);\n\tstream.writeUint24(this.flags);\n}\n\nBoxParser.Box.prototype.write = function(stream) {\n\tif (this.type === \"mdat\") {\n\t\t/* TODO: fix this */\n\t\tif (this.data) {\n\t\t\tthis.size = this.data.length;\n\t\t\tthis.writeHeader(stream);\n\t\t\tstream.writeUint8Array(this.data);\n\t\t}\n\t} else {\n\t\tthis.size = (this.data ? this.data.length : 0);\n\t\tthis.writeHeader(stream);\n\t\tif (this.data) {\n\t\t\tstream.writeUint8Array(this.data);\n\t\t}\n\t}\n}\n\nBoxParser.ContainerBox.prototype.write = function(stream) {\n\tthis.size = 0;\n\tthis.writeHeader(stream);\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tthis.boxes[i].write(stream);\n\t\t\tthis.size += this.boxes[i].size;\n\t\t}\n\t}\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\nBoxParser.TrackReferenceTypeBox.prototype.write = function(stream) {\n\tthis.size = this.track_ids.length*4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32Array(this.track_ids);\n}\n\n// file:src/writing/avcC.js\nBoxParser.avcCBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.size = 7;\n\tfor (i = 0; i < this.SPS.length; i++) {\n\t\tthis.size += 2+this.SPS[i].length;\n\t}\n\tfor (i = 0; i < this.PPS.length; i++) {\n\t\tthis.size += 2+this.PPS[i].length;\n\t}\n\tif (this.ext) {\n\t\tthis.size += this.ext.length;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint8(this.configurationVersion);\n\tstream.writeUint8(this.AVCProfileIndication);\n\tstream.writeUint8(this.profile_compatibility);\n\tstream.writeUint8(this.AVCLevelIndication);\n\tstream.writeUint8(this.lengthSizeMinusOne + (63<<2));\n\tstream.writeUint8(this.SPS.length + (7<<5));\n\tfor (i = 0; i < this.SPS.length; i++) {\n\t\tstream.writeUint16(this.SPS[i].length);\n\t\tstream.writeUint8Array(this.SPS[i].nalu);\n\t}\n\tstream.writeUint8(this.PPS.length);\n\tfor (i = 0; i < this.PPS.length; i++) {\n\t\tstream.writeUint16(this.PPS[i].length);\n\t\tstream.writeUint8Array(this.PPS[i].nalu);\n\t}\n\tif (this.ext) {\n\t\tstream.writeUint8Array(this.ext);\n\t}\n}\n\n// file:src/writing/co64.js\nBoxParser.co64Box.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.chunk_offsets.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.chunk_offsets.length);\n\tfor(i=0; i<this.chunk_offsets.length; i++) {\n\t\tstream.writeUint64(this.chunk_offsets[i]);\n\t}\n}\n\n// file:src/writing/cslg.js\nBoxParser.cslgBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4*5;\n\tthis.writeHeader(stream);\n\tstream.writeInt32(this.compositionToDTSShift);\n\tstream.writeInt32(this.leastDecodeToDisplayDelta);\n\tstream.writeInt32(this.greatestDecodeToDisplayDelta);\n\tstream.writeInt32(this.compositionStartTime);\n\tstream.writeInt32(this.compositionEndTime);\n}\n\n// file:src/writing/ctts.js\nBoxParser.cttsBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.sample_counts.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_counts.length);\n\tfor(i=0; i<this.sample_counts.length; i++) {\n\t\tstream.writeUint32(this.sample_counts[i]);\n\t\tif (this.version === 1) {\n\t\t\tstream.writeInt32(this.sample_offsets[i]); /* signed */\n\t\t} else {\t\t\t\n\t\t\tstream.writeUint32(this.sample_offsets[i]); /* unsigned */\n\t\t}\n\t}\n}\n\n// file:src/writing/dref.js\nBoxParser.drefBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4; //\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tthis.entries[i].write(stream);\n\t\tthis.size += this.entries[i].size;\n\t}\t\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\n// file:src/writing/elng.js\nBoxParser.elngBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = this.extended_language.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.extended_language);\n}\n\n// file:src/writing/elst.js\nBoxParser.elstBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4+12*this.entries.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tvar entry = this.entries[i];\n\t\tstream.writeUint32(entry.segment_duration);\n\t\tstream.writeInt32(entry.media_time);\n\t\tstream.writeInt16(entry.media_rate_integer);\n\t\tstream.writeInt16(entry.media_rate_fraction);\n\t}\n}\n\n// file:src/writing/emsg.js\nBoxParser.emsgBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4*4+this.message_data.length+(this.scheme_id_uri.length+1)+(this.value.length+1);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.scheme_id_uri);\n\tstream.writeCString(this.value);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.presentation_time_delta);\n\tstream.writeUint32(this.event_duration);\n\tstream.writeUint32(this.id);\n\tstream.writeUint8Array(this.message_data);\n}\n\n// file:src/writing/ftyp.js\nBoxParser.ftypBox.prototype.write = function(stream) {\n\tthis.size = 8+4*this.compatible_brands.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.major_brand, null, 4);\n\tstream.writeUint32(this.minor_version);\n\tfor (var i = 0; i < this.compatible_brands.length; i++) {\n\t\tstream.writeString(this.compatible_brands[i], null, 4);\n\t}\n}\n\n// file:src/writing/hdlr.js\nBoxParser.hdlrBox.prototype.write = function(stream) {\n\tthis.size = 5*4+this.name.length+1;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(0);\n\tstream.writeString(this.handler, null, 4);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeCString(this.name);\n}\n\n// file:src/writing/hvcC.js\nBoxParser.hvcCBox.prototype.write = function(stream) {\n    var i,j;\n    this.size = 23;\n\n    for (i = 0; i < this.nalu_arrays.length; i++) {\n      this.size += 3;\n      for (j = 0; j < this.nalu_arrays[i].length; j++) {\n        this.size += 2 + this.nalu_arrays[i][j].data.length;\n      }\n    }\n\n    this.writeHeader(stream);\n\n    stream.writeUint8(this.configurationVersion);\n    stream.writeUint8((this.general_profile_space << 6) +\n                      (this.general_tier_flag << 5) +\n                      this.general_profile_idc);\n    stream.writeUint32(this.general_profile_compatibility);\n    stream.writeUint8Array(this.general_constraint_indicator);\n    stream.writeUint8(this.general_level_idc);\n    stream.writeUint16(this.min_spatial_segmentation_idc + (15<<24));\n    stream.writeUint8(this.parallelismType + (63<<2));\n    stream.writeUint8(this.chroma_format_idc + (63<<2));\n    stream.writeUint8(this.bit_depth_luma_minus8 + (31<<3));\n    stream.writeUint8(this.bit_depth_chroma_minus8 + (31<<3));\n    stream.writeUint16(this.avgFrameRate);\n    stream.writeUint8((this.constantFrameRate<<6) +\n                   (this.numTemporalLayers<<3) +\n                   (this.temporalIdNested<<2) +\n                   this.lengthSizeMinusOne);\n    stream.writeUint8(this.nalu_arrays.length);\n    for (i = 0; i < this.nalu_arrays.length; i++) {\n      // bit(1) array_completeness + bit(1) reserved = 0 + bit(6) nal_unit_type\n      stream.writeUint8((this.nalu_arrays[i].completeness<<7) +\n                         this.nalu_arrays[i].nalu_type);\n      stream.writeUint16(this.nalu_arrays[i].length);\n      for (j = 0; j < this.nalu_arrays[i].length; j++) {\n        stream.writeUint16(this.nalu_arrays[i][j].data.length);\n        stream.writeUint8Array(this.nalu_arrays[i][j].data);\n      }\n    }\n}\n// file:src/writing/kind.js\nBoxParser.kindBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = (this.schemeURI.length+1)+(this.value.length+1);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.schemeURI);\n\tstream.writeCString(this.value);\n}\n\n// file:src/writing/mdhd.js\nBoxParser.mdhdBox.prototype.write = function(stream) {\n\tthis.size = 4*4+2*2;\n\tthis.flags = 0;\n\tthis.version = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint16(this.language);\n\tstream.writeUint16(0);\n}\n\n// file:src/writing/mehd.js\nBoxParser.mehdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.fragment_duration);\n}\n\n// file:src/writing/mfhd.js\nBoxParser.mfhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sequence_number);\n}\n\n// file:src/writing/mvhd.js\nBoxParser.mvhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 23*4+2*2;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint32(this.rate);\n\tstream.writeUint16(this.volume<<8);\n\tstream.writeUint16(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32Array(this.matrix);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(this.next_track_id);\n}\n\n// file:src/writing/sampleentry.js\nBoxParser.SampleEntry.prototype.writeHeader = function(stream) {\n\tthis.size = 8;\n\tBoxParser.Box.prototype.writeHeader.call(this, stream);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint8(0);\n\tstream.writeUint16(this.data_reference_index);\n}\n\nBoxParser.SampleEntry.prototype.writeFooter = function(stream) {\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tthis.boxes[i].write(stream);\n\t\tthis.size += this.boxes[i].size;\n\t}\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\t\n}\n\nBoxParser.SampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tstream.writeUint8Array(this.data);\n\tthis.size += this.data.length;\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\t\n}\n\nBoxParser.VisualSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += 2*7+6*4+32;\n\tstream.writeUint16(0); \n\tstream.writeUint16(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.width);\n\tstream.writeUint16(this.height);\n\tstream.writeUint32(this.horizresolution);\n\tstream.writeUint32(this.vertresolution);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.frame_count);\n\tstream.writeUint8(Math.min(31, this.compressorname.length));\n\tstream.writeString(this.compressorname, null, 31);\n\tstream.writeUint16(this.depth);\n\tstream.writeInt16(-1);\n\tthis.writeFooter(stream);\n}\n\nBoxParser.AudioSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += 2*4+3*4;\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeUint16(this.channel_count);\n\tstream.writeUint16(this.samplesize);\n\tstream.writeUint16(0);\n\tstream.writeUint16(0);\n\tstream.writeUint32(this.samplerate<<16);\n\tthis.writeFooter(stream);\n}\n\nBoxParser.stppSampleEntry.prototype.write = function(stream) {\n\tthis.writeHeader(stream);\n\tthis.size += this.namespace.length+1+\n\t\t\t\t this.schema_location.length+1+\n\t\t\t\t this.auxiliary_mime_types.length+1;\n\tstream.writeCString(this.namespace);\n\tstream.writeCString(this.schema_location);\n\tstream.writeCString(this.auxiliary_mime_types);\n\tthis.writeFooter(stream);\n}\n\n// file:src/writing/samplegroups/samplegroup.js\nBoxParser.SampleGroupEntry.prototype.write = function(stream) {\n\tstream.writeUint8Array(this.data);\n}\n\n// file:src/writing/sbgp.js\nBoxParser.sbgpBox.prototype.write = function(stream) {\n\tthis.version = 1;\t\n\tthis.flags = 0;\n\tthis.size = 12+8*this.entries.length;\n\tthis.writeHeader(stream);\n\tstream.writeString(this.grouping_type, null, 4);\n\tstream.writeUint32(this.grouping_type_parameter);\n\tstream.writeUint32(this.entries.length);\n\tfor (var i = 0; i < this.entries.length; i++) {\n\t\tvar entry = this.entries[i];\n\t\tstream.writeInt32(entry.sample_count);\n\t\tstream.writeInt32(entry.group_description_index);\n\t}\n}\n\n// file:src/writing/sgpd.js\nBoxParser.sgpdBox.prototype.write = function(stream) {\n\tvar i;\n\tvar entry;\n\t// leave version as read\n\t// this.version;\n\tthis.flags = 0;\n\tthis.size = 12;\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tentry = this.entries[i];\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tthis.size += 4;\n\t\t\t}\n\t\t\tthis.size += entry.data.length;\n\t\t}\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeString(this.grouping_type, null, 4);\n\tif (this.version === 1) {\n\t\tstream.writeUint32(this.default_length);\n\t}\n\tif (this.version >= 2) {\n\t\tstream.writeUint32(this.default_sample_description_index);\n\t}\n\tstream.writeUint32(this.entries.length);\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tentry = this.entries[i];\n\t\tif (this.version === 1) {\n\t\t\tif (this.default_length === 0) {\n\t\t\t\tstream.writeUint32(entry.description_length);\n\t\t\t}\n\t\t}\n\t\tentry.write(stream);\n\t}\n}\n\n\n// file:src/writing/sidx.js\nBoxParser.sidxBox.prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = 4*4+2+2+12*this.references.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.reference_ID);\n\tstream.writeUint32(this.timescale);\n\tstream.writeUint32(this.earliest_presentation_time);\n\tstream.writeUint32(this.first_offset);\n\tstream.writeUint16(0);\n\tstream.writeUint16(this.references.length);\n\tfor (var i = 0; i < this.references.length; i++) {\n\t\tvar ref = this.references[i];\n\t\tstream.writeUint32(ref.reference_type << 31 | ref.referenced_size);\n\t\tstream.writeUint32(ref.subsegment_duration);\n\t\tstream.writeUint32(ref.starts_with_SAP << 31 | ref.SAP_type << 28 | ref.SAP_delta_time);\n\t}\n}\n\n// file:src/writing/smhd.js\nBoxParser.smhdBox.prototype.write = function(stream) {\n  var i;\n  this.version = 0;\n  this.flags = 1;\n  this.size = 4;\n  this.writeHeader(stream);\n  stream.writeUint16(this.balance);\n  stream.writeUint16(0);\n}\n// file:src/writing/stco.js\nBoxParser.stcoBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+4*this.chunk_offsets.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.chunk_offsets.length);\n\tstream.writeUint32Array(this.chunk_offsets);\n}\n\n// file:src/writing/stsc.js\nBoxParser.stscBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+12*this.first_chunk.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.first_chunk.length);\n\tfor(i=0; i<this.first_chunk.length; i++) {\n\t\tstream.writeUint32(this.first_chunk[i]);\n\t\tstream.writeUint32(this.samples_per_chunk[i]);\n\t\tstream.writeUint32(this.sample_description_index[i]);\n\t}\n}\n\n// file:src/writing/stsd.js\nBoxParser.stsdBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 0;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.entries.length);\n\tthis.size += 4;\n\tfor (i = 0; i < this.entries.length; i++) {\n\t\tthis.entries[i].write(stream);\n\t\tthis.size += this.entries[i].size;\n\t}\n\t/* adjusting the size, now that all sub-boxes are known */\n\tLog.debug(\"BoxWriter\", \"Adjusting box \"+this.type+\" with new size \"+this.size);\n\tstream.adjustUint32(this.sizePosition, this.size);\n}\n\n// file:src/writing/stsh.js\nBoxParser.stshBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.shadowed_sample_numbers.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.shadowed_sample_numbers.length);\n\tfor(i=0; i<this.shadowed_sample_numbers.length; i++) {\n\t\tstream.writeUint32(this.shadowed_sample_numbers[i]);\n\t\tstream.writeUint32(this.sync_sample_numbers[i]);\n\t}\n}\n\n// file:src/writing/stss.js\nBoxParser.stssBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+4*this.sample_numbers.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_numbers.length);\n\tstream.writeUint32Array(this.sample_numbers);\n}\n\n// file:src/writing/stsz.js\nBoxParser.stszBox.prototype.write = function(stream) {\n\tvar i;\n\tvar constant = true;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tif (this.sample_sizes.length > 0) {\n\t\ti = 0;\n\t\twhile (i+1 < this.sample_sizes.length) {\n\t\t\tif (this.sample_sizes[i+1] !==  this.sample_sizes[0]) {\n\t\t\t\tconstant = false;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t} else {\n\t\tconstant = false;\n\t}\n\tthis.size = 8;\n\tif (!constant) {\n\t\tthis.size += 4*this.sample_sizes.length;\n\t}\n\tthis.writeHeader(stream);\n\tif (!constant) {\n\t\tstream.writeUint32(0);\n\t} else {\n\t\tstream.writeUint32(this.sample_sizes[0]);\n\t}\n\tstream.writeUint32(this.sample_sizes.length);\n\tif (!constant) {\n\t\tstream.writeUint32Array(this.sample_sizes);\n\t}\t\n}\n\n// file:src/writing/stts.js\nBoxParser.sttsBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4+8*this.sample_counts.length;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_counts.length);\n\tfor(i=0; i<this.sample_counts.length; i++) {\n\t\tstream.writeUint32(this.sample_counts[i]);\n\t\tstream.writeUint32(this.sample_deltas[i]);\n\t}\n}\n\n// file:src/writing/tfdt.js\nBoxParser.tfdtBox.prototype.write = function(stream) {\n\tvar UINT32_MAX = Math.pow(2, 32) - 1;\n\t// use version 1 if baseMediaDecodeTime does not fit 32 bits\n\tthis.version = this.baseMediaDecodeTime > UINT32_MAX ? 1 : 0;\n\tthis.flags = 0;\n\tthis.size = 4;\n\tif (this.version === 1) {\n\t\tthis.size += 4;\n\t}\n\tthis.writeHeader(stream);\n\tif (this.version === 1) {\n\t\tstream.writeUint64(this.baseMediaDecodeTime);\n\t} else {\n\t\tstream.writeUint32(this.baseMediaDecodeTime);\n\t}\n}\n\n// file:src/writing/tfhd.js\nBoxParser.tfhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.size = 4;\n\tif (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) {\n\t\tthis.size += 8;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\tthis.size += 4;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.track_id);\n\tif (this.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) {\n\t\tstream.writeUint64(this.base_data_offset);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\tstream.writeUint32(this.default_sample_description_index);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\tstream.writeUint32(this.default_sample_duration);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\tstream.writeUint32(this.default_sample_size);\n\t}\n\tif (this.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\tstream.writeUint32(this.default_sample_flags);\n\t}\n}\n\n// file:src/writing/tkhd.js\nBoxParser.tkhdBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\t//this.flags = 0;\n\tthis.size = 4*18+2*4;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.creation_time);\n\tstream.writeUint32(this.modification_time);\n\tstream.writeUint32(this.track_id);\n\tstream.writeUint32(0);\n\tstream.writeUint32(this.duration);\n\tstream.writeUint32(0);\n\tstream.writeUint32(0);\n\tstream.writeInt16(this.layer);\n\tstream.writeInt16(this.alternate_group);\n\tstream.writeInt16(this.volume<<8);\n\tstream.writeUint16(0);\n\tstream.writeInt32Array(this.matrix);\n\tstream.writeUint32(this.width);\n\tstream.writeUint32(this.height);\n}\n\n// file:src/writing/trex.js\nBoxParser.trexBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.flags = 0;\n\tthis.size = 4*5;\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.track_id);\n\tstream.writeUint32(this.default_sample_description_index);\n\tstream.writeUint32(this.default_sample_duration);\n\tstream.writeUint32(this.default_sample_size);\n\tstream.writeUint32(this.default_sample_flags);\n}\n\n// file:src/writing/trun.js\nBoxParser.trunBox.prototype.write = function(stream) {\n\tthis.version = 0;\n\tthis.size = 4;\n\tif (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) {\n\t\tthis.size += 4;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\tthis.size += 4*this.sample_duration.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\tthis.size += 4*this.sample_size.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\tthis.size += 4*this.sample_flags.length;\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\tthis.size += 4*this.sample_composition_time_offset.length;\n\t}\n\tthis.writeHeader(stream);\n\tstream.writeUint32(this.sample_count);\n\tif (this.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) {\n\t\tthis.data_offset_position = stream.getPosition();\n\t\tstream.writeInt32(this.data_offset); //signed\n\t}\n\tif (this.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG) {\n\t\tstream.writeUint32(this.first_sample_flags);\n\t}\n\tfor (var i = 0; i < this.sample_count; i++) {\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\tstream.writeUint32(this.sample_duration[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\tstream.writeUint32(this.sample_size[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\tstream.writeUint32(this.sample_flags[i]);\n\t\t}\n\t\tif (this.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\tif (this.version === 0) {\n\t\t\t\tstream.writeUint32(this.sample_composition_time_offset[i]);\n\t\t\t} else {\n\t\t\t\tstream.writeInt32(this.sample_composition_time_offset[i]); //signed\n\t\t\t}\n\t\t}\n\t}\t\t\n}\n\n// file:src/writing/url.js\nBoxParser[\"url Box\"].prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tif (this.location) {\n\t\tthis.flags = 0;\n\t\tthis.size = this.location.length+1;\n\t} else {\n\t\tthis.flags = 0x000001;\n\t\tthis.size = 0;\n\t}\n\tthis.writeHeader(stream);\n\tif (this.location) {\n\t\tstream.writeCString(this.location);\n\t}\n}\n\n// file:src/writing/urn.js\nBoxParser[\"urn Box\"].prototype.write = function(stream) {\n\tthis.version = 0;\t\n\tthis.flags = 0;\n\tthis.size = this.name.length+1+(this.location ? this.location.length+1 : 0);\n\tthis.writeHeader(stream);\n\tstream.writeCString(this.name);\n\tif (this.location) {\n\t\tstream.writeCString(this.location);\n\t}\n}\n\n// file:src/writing/vmhd.js\nBoxParser.vmhdBox.prototype.write = function(stream) {\n\tvar i;\n\tthis.version = 0;\n\tthis.flags = 1;\n\tthis.size = 8;\n\tthis.writeHeader(stream);\n\tstream.writeUint16(this.graphicsmode);\n\tstream.writeUint16Array(this.opcolor);\n}\n\n// file:src/box-unpack.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.cttsBox.prototype.unpack = function(samples) {\n\tvar i, j, k;\n\tk = 0;\n\tfor (i = 0; i < this.sample_counts.length; i++) {\n\t\tfor (j = 0; j < this.sample_counts[i]; j++) {\n\t\t\tsamples[k].pts = samples[k].dts + this.sample_offsets[i];\n\t\t\tk++;\n\t\t}\n\t}\n}\n\nBoxParser.sttsBox.prototype.unpack = function(samples) {\n\tvar i, j, k;\n\tk = 0;\n\tfor (i = 0; i < this.sample_counts.length; i++) {\n\t\tfor (j = 0; j < this.sample_counts[i]; j++) {\n\t\t\tif (k === 0) {\n\t\t\t\tsamples[k].dts = 0;\n\t\t\t} else {\n\t\t\t\tsamples[k].dts = samples[k-1].dts + this.sample_deltas[i];\n\t\t\t}\n\t\t\tk++;\n\t\t}\n\t}\n}\n\nBoxParser.stcoBox.prototype.unpack = function(samples) {\n\tvar i;\n\tfor (i = 0; i < this.chunk_offsets.length; i++) {\n\t\tsamples[i].offset = this.chunk_offsets[i];\n\t}\n}\n\nBoxParser.stscBox.prototype.unpack = function(samples) {\n\tvar i, j, k, l, m;\n\tl = 0;\n\tm = 0;\n\tfor (i = 0; i < this.first_chunk.length; i++) {\n\t\tfor (j = 0; j < (i+1 < this.first_chunk.length ? this.first_chunk[i+1] : Infinity); j++) {\n\t\t\tm++;\n\t\t\tfor (k = 0; k < this.samples_per_chunk[i]; k++) {\n\t\t\t\tif (samples[l]) {\n\t\t\t\t\tsamples[l].description_index = this.sample_description_index[i];\n\t\t\t\t\tsamples[l].chunk_index = m;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tl++;\n\t\t\t}\t\t\t\n\t\t}\n\t}\n}\n\nBoxParser.stszBox.prototype.unpack = function(samples) {\n\tvar i;\n\tfor (i = 0; i < this.sample_sizes.length; i++) {\n\t\tsamples[i].size = this.sample_sizes[i];\n\t}\n}\n// file:src/box-diff.js\n\nBoxParser.DIFF_BOXES_PROP_NAMES = [ \"boxes\", \"entries\", \"references\", \"subsamples\",\n\t\t\t\t\t \t \"items\", \"item_infos\", \"extents\", \"associations\",\n\t\t\t\t\t \t \"subsegments\", \"ranges\", \"seekLists\", \"seekPoints\",\n\t\t\t\t\t \t \"esd\", \"levels\"];\n\nBoxParser.DIFF_PRIMITIVE_ARRAY_PROP_NAMES = [ \"compatible_brands\", \"matrix\", \"opcolor\", \"sample_counts\", \"sample_deltas\",\n\"first_chunk\", \"samples_per_chunk\", \"sample_sizes\", \"chunk_offsets\", \"sample_offsets\", \"sample_description_index\", \"sample_duration\" ];\n\nBoxParser.boxEqualFields = function(box_a, box_b) {\n\tif (box_a && !box_b) return false;\n\tvar prop;\n\tfor (prop in box_a) {\n\t\tif (BoxParser.DIFF_BOXES_PROP_NAMES.indexOf(prop) > -1) {\n\t\t\tcontinue;\n\t\t// } else if (excluded_fields && excluded_fields.indexOf(prop) > -1) {\n\t\t// \tcontinue;\n\t\t} else if (box_a[prop] instanceof BoxParser.Box || box_b[prop] instanceof BoxParser.Box) {\n\t\t\tcontinue;\n\t\t} else if (typeof box_a[prop] === \"undefined\" || typeof box_b[prop] === \"undefined\") {\n\t\t\tcontinue;\n\t\t} else if (typeof box_a[prop] === \"function\" || typeof box_b[prop] === \"function\") {\n\t\t\tcontinue;\n\t\t} else if (\n\t\t\t(box_a.subBoxNames && box_a.subBoxNames.indexOf(prop.slice(0,4)) > -1) ||\n\t\t\t(box_b.subBoxNames && box_b.subBoxNames.indexOf(prop.slice(0,4)) > -1))  {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tif (prop === \"data\" || prop === \"start\" || prop === \"size\" || prop === \"creation_time\" || prop === \"modification_time\") {\n\t\t\t\tcontinue;\n\t\t\t} else if (BoxParser.DIFF_PRIMITIVE_ARRAY_PROP_NAMES.indexOf(prop) > -1) {\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\tif (box_a[prop] !== box_b[prop]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n\nBoxParser.boxEqual = function(box_a, box_b) {\n\tif (!BoxParser.boxEqualFields(box_a, box_b)) {\n\t\treturn false;\n\t}\n\tfor (var j = 0; j < BoxParser.DIFF_BOXES_PROP_NAMES.length; j++) {\n\t\tvar name = BoxParser.DIFF_BOXES_PROP_NAMES[j];\n\t\tif (box_a[name] && box_b[name]) {\n\t\t\tif (!BoxParser.boxEqual(box_a[name], box_b[name])) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}\n// file:src/text-mp4.js\n/* \n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar VTTin4Parser = function() {\t\n}\n\nVTTin4Parser.prototype.parseSample = function(data) {\n\tvar cues, cue;\n\tvar stream = new MP4BoxStream(data.buffer);\n\tcues = [];\n\twhile (!stream.isEos()) {\n\t\tcue = BoxParser.parseOneBox(stream, false);\n\t\tif (cue.code === BoxParser.OK && cue.box.type === \"vttc\") {\n\t\t\tcues.push(cue.box);\n\t\t}\t\t\n\t}\n\treturn cues;\n}\n\nVTTin4Parser.prototype.getText = function (startTime, endTime, data) {\n\tfunction pad(n, width, z) {\n\t  z = z || '0';\n\t  n = n + '';\n\t  return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n\t}\n\tfunction secToTimestamp(insec) {\n\t\tvar h = Math.floor(insec/3600);\n\t\tvar m = Math.floor((insec - h*3600)/60);\n\t\tvar s = Math.floor(insec - h*3600 - m*60);\n\t\tvar ms = Math.floor((insec - h*3600 - m*60 - s)*1000);\n\t\treturn \"\"+pad(h, 2)+\":\"+pad(m,2)+\":\"+pad(s, 2)+\".\"+pad(ms, 3);\n\t}\n\tvar cues = this.parseSample(data);\n\tvar string = \"\";\n\tfor (var i = 0; i < cues.length; i++) {\n\t\tvar cueIn4 = cues[i];\n\t\tstring += secToTimestamp(startTime)+\" --> \"+secToTimestamp(endTime)+\"\\r\\n\";\n\t\tstring += cueIn4.payl.text;\n\t}\n\treturn string;\n}\n\nvar XMLSubtitlein4Parser = function() {\t\n}\n\nXMLSubtitlein4Parser.prototype.parseSample = function(sample) {\n\tvar res = {};\t\n\tvar i;\n\tres.resources = [];\n\tvar stream = new MP4BoxStream(sample.data.buffer);\n\tif (!sample.subsamples || sample.subsamples.length === 0) {\n\t\tres.documentString = stream.readString(sample.data.length);\n\t} else {\n\t\tres.documentString = stream.readString(sample.subsamples[0].size);\n\t\tif (sample.subsamples.length > 1) {\n\t\t\tfor (i = 1; i < sample.subsamples.length; i++) {\n\t\t\t\tres.resources[i] = stream.readUint8Array(sample.subsamples[i].size);\n\t\t\t}\n\t\t}\n\t}\n\tif (typeof (DOMParser) !== \"undefined\") {\n\t\tres.document = (new DOMParser()).parseFromString(res.documentString, \"application/xml\");\n\t}\n\treturn res;\n}\n\nvar Textin4Parser = function() {\t\n}\n\nTextin4Parser.prototype.parseSample = function(sample) {\n\tvar textString;\n\tvar stream = new MP4BoxStream(sample.data.buffer);\n\ttextString = stream.readString(sample.data.length);\n\treturn textString;\n}\n\nTextin4Parser.prototype.parseConfig = function(data) {\n\tvar textString;\n\tvar stream = new MP4BoxStream(data.buffer);\n\tstream.readUint32(); // version & flags\n\ttextString = stream.readCString();\n\treturn textString;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.VTTin4Parser = VTTin4Parser;\n\texports.XMLSubtitlein4Parser = XMLSubtitlein4Parser;\n\texports.Textin4Parser = Textin4Parser;\n}\n// file:src/isofile.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar ISOFile = function (stream) {\n\t/* MutiBufferStream object used to parse boxes */\n\tthis.stream = stream || new MultiBufferStream();\n\t/* Array of all boxes (in order) found in the file */\n\tthis.boxes = [];\n\t/* Array of all mdats */\n\tthis.mdats = [];\n\t/* Array of all moofs */\n\tthis.moofs = [];\n\t/* Boolean indicating if the file is compatible with progressive parsing (moov first) */\n\tthis.isProgressive = false;\n\t/* Boolean used to fire moov start event only once */\n\tthis.moovStartFound = false;\n\t/* Callback called when the moov parsing starts */\n\tthis.onMoovStart = null;\n\t/* Boolean keeping track of the call to onMoovStart, to avoid double calls */\n\tthis.moovStartSent = false;\n\t/* Callback called when the moov is entirely parsed */\n\tthis.onReady = null;\n\t/* Boolean keeping track of the call to onReady, to avoid double calls */\n\tthis.readySent = false;\n\t/* Callback to call when segments are ready */\n\tthis.onSegment = null;\n\t/* Callback to call when samples are ready */\n\tthis.onSamples = null;\n\t/* Callback to call when there is an error in the parsing or processing of samples */\n\tthis.onError = null;\n\t/* Boolean indicating if the moov box run-length encoded tables of sample information have been processed */\n\tthis.sampleListBuilt = false;\n\t/* Array of Track objects for which fragmentation of samples is requested */\n\tthis.fragmentedTracks = [];\n\t/* Array of Track objects for which extraction of samples is requested */\n\tthis.extractedTracks = [];\n\t/* Boolean indicating that fragmention is ready */\n\tthis.isFragmentationInitialized = false;\n\t/* Boolean indicating that fragmented has started */\n\tthis.sampleProcessingStarted = false;\n\t/* Number of the next 'moof' to generate when fragmenting */\n\tthis.nextMoofNumber = 0;\n\t/* Boolean indicating if the initial list of items has been produced */\n\tthis.itemListBuilt = false;\n\t/* Array of items */\n\tthis.items = [];\n\t/* Array of entity groups */\n\tthis.entity_groups = [];\n\t/* Callback called when the sidx box is entirely parsed */\n\tthis.onSidx = null;\n\t/* Boolean keeping track of the call to onSidx, to avoid double calls */\n\tthis.sidxSent = false;\n}\n\nISOFile.prototype.setSegmentOptions = function(id, user, options) {\n\tvar trak = this.getTrackById(id);\n\tif (trak) {\n\t\tvar fragTrack = {};\n\t\tthis.fragmentedTracks.push(fragTrack);\n\t\tfragTrack.id = id;\n\t\tfragTrack.user = user;\n\t\tfragTrack.trak = trak;\n\t\ttrak.nextSample = 0;\n\t\tfragTrack.segmentStream = null;\n\t\tfragTrack.nb_samples = 1000;\n\t\tfragTrack.rapAlignement = true;\n\t\tif (options) {\n\t\t\tif (options.nbSamples) fragTrack.nb_samples = options.nbSamples;\n\t\t\tif (options.rapAlignement) fragTrack.rapAlignement = options.rapAlignement;\n\t\t}\n\t}\n}\n\nISOFile.prototype.unsetSegmentOptions = function(id) {\n\tvar index = -1;\n\tfor (var i = 0; i < this.fragmentedTracks.length; i++) {\n\t\tvar fragTrack = this.fragmentedTracks[i];\n\t\tif (fragTrack.id == id) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\tif (index > -1) {\n\t\tthis.fragmentedTracks.splice(index, 1);\n\t}\n}\n\nISOFile.prototype.setExtractionOptions = function(id, user, options) {\n\tvar trak = this.getTrackById(id);\n\tif (trak) {\n\t\tvar extractTrack = {};\n\t\tthis.extractedTracks.push(extractTrack);\n\t\textractTrack.id = id;\n\t\textractTrack.user = user;\n\t\textractTrack.trak = trak;\n\t\ttrak.nextSample = 0;\n\t\textractTrack.nb_samples = 1000;\n\t\textractTrack.samples = [];\n\t\tif (options) {\n\t\t\tif (options.nbSamples) extractTrack.nb_samples = options.nbSamples;\n\t\t}\n\t}\n}\n\nISOFile.prototype.unsetExtractionOptions = function(id) {\n\tvar index = -1;\n\tfor (var i = 0; i < this.extractedTracks.length; i++) {\n\t\tvar extractTrack = this.extractedTracks[i];\n\t\tif (extractTrack.id == id) {\n\t\t\tindex = i;\n\t\t}\n\t}\n\tif (index > -1) {\n\t\tthis.extractedTracks.splice(index, 1);\n\t}\n}\n\nISOFile.prototype.parse = function() {\n\tvar found;\n\tvar ret;\n\tvar box;\n\tvar parseBoxHeadersOnly = false;\n\n\tif (this.restoreParsePosition)\t{\n\t\tif (!this.restoreParsePosition()) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\twhile (true) {\n\n\t\tif (this.hasIncompleteMdat && this.hasIncompleteMdat()) {\n\t\t\tif (this.processIncompleteMdat()) {\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.saveParsePosition)\t{\n\t\t\t\tthis.saveParsePosition();\n\t\t\t}\n\t\t\tret = BoxParser.parseOneBox(this.stream, parseBoxHeadersOnly);\n\t\t\tif (ret.code === BoxParser.ERR_NOT_ENOUGH_DATA) {\n\t\t\t\tif (this.processIncompleteBox) {\n\t\t\t\t\tif (this.processIncompleteBox(ret)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar box_type;\n\t\t\t\t/* the box is entirely parsed */\n\t\t\t\tbox = ret.box;\n\t\t\t\tbox_type = (box.type !== \"uuid\" ? box.type : box.uuid);\n\t\t\t\t/* store the box in the 'boxes' array to preserve box order (for file rewrite if needed)  */\n\t\t\t\tthis.boxes.push(box);\n\t\t\t\t/* but also store box in a property for more direct access */\n\t\t\t\tswitch (box_type) {\n\t\t\t\t\tcase \"mdat\":\n\t\t\t\t\t\tthis.mdats.push(box);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"moof\":\n\t\t\t\t\t\tthis.moofs.push(box);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"moov\":\n\t\t\t\t\t\tthis.moovStartFound = true;\n\t\t\t\t\t\tif (this.mdats.length === 0) {\n\t\t\t\t\t\t\tthis.isProgressive = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t/* no break */\n\t\t\t\t\t\t/* falls through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif (this[box_type] !== undefined) {\n\t\t\t\t\t\t\tLog.warn(\"ISOFile\", \"Duplicate Box of type: \"+box_type+\", overriding previous occurrence\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis[box_type] = box;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (this.updateUsedBytes) {\n\t\t\t\t\tthis.updateUsedBytes(box, ret);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.prototype.checkBuffer = function (ab) {\n\tif (ab === null || ab === undefined) {\n\t\tthrow(\"Buffer must be defined and non empty\");\n\t}\n\tif (ab.fileStart === undefined) {\n\t\tthrow(\"Buffer must have a fileStart property\");\n\t}\n\tif (ab.byteLength === 0) {\n\t\tLog.warn(\"ISOFile\", \"Ignoring empty buffer (fileStart: \"+ab.fileStart+\")\");\n\t\tthis.stream.logBufferLevel();\n\t\treturn false;\n\t}\n\tLog.info(\"ISOFile\", \"Processing buffer (fileStart: \"+ab.fileStart+\")\");\n\n\t/* mark the bytes in the buffer as not being used yet */\n\tab.usedBytes = 0;\n\tthis.stream.insertBuffer(ab);\n\tthis.stream.logBufferLevel();\n\n\tif (!this.stream.initialized()) {\n\t\tLog.warn(\"ISOFile\", \"Not ready to start parsing\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n/* Processes a new ArrayBuffer (with a fileStart property)\n   Returns the next expected file position, or undefined if not ready to parse */\nISOFile.prototype.appendBuffer = function(ab, last) {\n\tvar nextFileStart;\n\tif (!this.checkBuffer(ab)) {\n\t\treturn;\n\t}\n\n\t/* Parse whatever is in the existing buffers */\n\tthis.parse();\n\n\t/* Check if the moovStart callback needs to be called */\n\tif (this.moovStartFound && !this.moovStartSent) {\n\t\tthis.moovStartSent = true;\n\t\tif (this.onMoovStart) this.onMoovStart();\n\t}\n\n\tif (this.moov) {\n\t\t/* A moov box has been entirely parsed */\n\n\t\t/* if this is the first call after the moov is found we initialize the list of samples (may be empty in fragmented files) */\n\t\tif (!this.sampleListBuilt) {\n\t\t\tthis.buildSampleLists();\n\t\t\tthis.sampleListBuilt = true;\n\t\t}\n\n\t\t/* We update the sample information if there are any new moof boxes */\n\t\tthis.updateSampleLists();\n\n\t\t/* If the application needs to be informed that the 'moov' has been found,\n\t\t   we create the information object and callback the application */\n\t\tif (this.onReady && !this.readySent) {\n\t\t\tthis.readySent = true;\n\t\t\tthis.onReady(this.getInfo());\n\t\t}\n\n\t\t/* See if any sample extraction or segment creation needs to be done with the available samples */\n\t\tthis.processSamples(last);\n\n\t\t/* Inform about the best range to fetch next */\n\t\tif (this.nextSeekPosition) {\n\t\t\tnextFileStart = this.nextSeekPosition;\n\t\t\tthis.nextSeekPosition = undefined;\n\t\t} else {\n\t\t\tnextFileStart = this.nextParsePosition;\n\t\t}\n\t\tif (this.stream.getEndFilePositionAfter) {\n\t\t\tnextFileStart = this.stream.getEndFilePositionAfter(nextFileStart);\n\t\t}\n\t} else {\n\t\tif (this.nextParsePosition) {\n\t\t\t/* moov has not been parsed but the first buffer was received,\n\t\t\t   the next fetch should probably be the next box start */\n\t\t\tnextFileStart = this.nextParsePosition;\n\t\t} else {\n\t\t\t/* No valid buffer has been parsed yet, we cannot know what to parse next */\n\t\t\tnextFileStart = 0;\n\t\t}\n\t}\n\tif (this.sidx) {\n\t\tif (this.onSidx && !this.sidxSent) {\n\t\t\tthis.onSidx(this.sidx);\n\t\t\tthis.sidxSent = true;\n\t\t}\n\t}\n\tif (this.meta) {\n\t\tif (this.flattenItemInfo && !this.itemListBuilt) {\n\t\t\tthis.flattenItemInfo();\n\t\t\tthis.itemListBuilt = true;\n\t\t}\n\t\tif (this.processItems) {\n\t\t\tthis.processItems(this.onItem);\n\t\t}\n\t}\n\n\tif (this.stream.cleanBuffers) {\n\t\tLog.info(\"ISOFile\", \"Done processing buffer (fileStart: \"+ab.fileStart+\") - next buffer to fetch should have a fileStart position of \"+nextFileStart);\n\t\tthis.stream.logBufferLevel();\n\t\tthis.stream.cleanBuffers();\n\t\tthis.stream.logBufferLevel(true);\n\t\tLog.info(\"ISOFile\", \"Sample data size in memory: \"+this.getAllocatedSampleDataSize());\n\t}\n\treturn nextFileStart;\n}\n\nISOFile.prototype.getInfo = function() {\n\tvar i, j;\n\tvar movie = {};\n\tvar trak;\n\tvar track;\n\tvar ref;\n\tvar sample_desc;\n\tvar _1904 = (new Date('1904-01-01T00:00:00Z').getTime());\n\n\tif (this.moov) {\n\t\tmovie.hasMoov = true;\n\t\tmovie.duration = this.moov.mvhd.duration;\n\t\tmovie.timescale = this.moov.mvhd.timescale;\n\t\tmovie.isFragmented = (this.moov.mvex != null);\n\t\tif (movie.isFragmented && this.moov.mvex.mehd) {\n\t\t\tmovie.fragment_duration = this.moov.mvex.mehd.fragment_duration;\n\t\t}\n\t\tmovie.isProgressive = this.isProgressive;\n\t\tmovie.hasIOD = (this.moov.iods != null);\n\t\tmovie.brands = [];\n\t\tmovie.brands.push(this.ftyp.major_brand);\n\t\tmovie.brands = movie.brands.concat(this.ftyp.compatible_brands);\n\t\tmovie.created = new Date(_1904+this.moov.mvhd.creation_time*1000);\n\t\tmovie.modified = new Date(_1904+this.moov.mvhd.modification_time*1000);\n\t\tmovie.tracks = [];\n\t\tmovie.audioTracks = [];\n\t\tmovie.videoTracks = [];\n\t\tmovie.subtitleTracks = [];\n\t\tmovie.metadataTracks = [];\n\t\tmovie.hintTracks = [];\n\t\tmovie.otherTracks = [];\n\t\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\t\ttrak = this.moov.traks[i];\n\t\t\tsample_desc = trak.mdia.minf.stbl.stsd.entries[0];\n\t\t\ttrack = {};\n\t\t\tmovie.tracks.push(track);\n\t\t\ttrack.id = trak.tkhd.track_id;\n\t\t\ttrack.name = trak.mdia.hdlr.name;\n\t\t\ttrack.references = [];\n\t\t\tif (trak.tref) {\n\t\t\t\tfor (j = 0; j < trak.tref.boxes.length; j++) {\n\t\t\t\t\tref = {};\n\t\t\t\t\ttrack.references.push(ref);\n\t\t\t\t\tref.type = trak.tref.boxes[j].type;\n\t\t\t\t\tref.track_ids = trak.tref.boxes[j].track_ids;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (trak.edts) {\n\t\t\t\ttrack.edits = trak.edts.elst.entries;\n\t\t\t}\n\t\t\ttrack.created = new Date(_1904+trak.tkhd.creation_time*1000);\n\t\t\ttrack.modified = new Date(_1904+trak.tkhd.modification_time*1000);\n\t\t\ttrack.movie_duration = trak.tkhd.duration;\n\t\t\ttrack.movie_timescale = movie.timescale;\n\t\t\ttrack.layer = trak.tkhd.layer;\n\t\t\ttrack.alternate_group = trak.tkhd.alternate_group;\n\t\t\ttrack.volume = trak.tkhd.volume;\n\t\t\ttrack.matrix = trak.tkhd.matrix;\n\t\t\ttrack.track_width = trak.tkhd.width/(1<<16);\n\t\t\ttrack.track_height = trak.tkhd.height/(1<<16);\n\t\t\ttrack.timescale = trak.mdia.mdhd.timescale;\n\t\t\ttrack.cts_shift = trak.mdia.minf.stbl.cslg;\n\t\t\ttrack.duration = trak.mdia.mdhd.duration;\n\t\t\ttrack.samples_duration = trak.samples_duration;\n\t\t\ttrack.codec = sample_desc.getCodec();\n\t\t\ttrack.kind = (trak.udta && trak.udta.kinds.length ? trak.udta.kinds[0] : { schemeURI: \"\", value: \"\"});\n\t\t\ttrack.language = (trak.mdia.elng ? trak.mdia.elng.extended_language : trak.mdia.mdhd.languageString);\n\t\t\ttrack.nb_samples = trak.samples.length;\n\t\t\ttrack.size = trak.samples_size;\n\t\t\ttrack.bitrate = (track.size*8*track.timescale)/track.samples_duration;\n\t\t\tif (sample_desc.isAudio()) {\n\t\t\t\ttrack.type = \"audio\";\n\t\t\t\tmovie.audioTracks.push(track);\n\t\t\t\ttrack.audio = {};\n\t\t\t\ttrack.audio.sample_rate = sample_desc.getSampleRate();\n\t\t\t\ttrack.audio.channel_count = sample_desc.getChannelCount();\n\t\t\t\ttrack.audio.sample_size = sample_desc.getSampleSize();\n\t\t\t} else if (sample_desc.isVideo()) {\n\t\t\t\ttrack.type = \"video\";\n\t\t\t\tmovie.videoTracks.push(track);\n\t\t\t\ttrack.video = {};\n\t\t\t\ttrack.video.width = sample_desc.getWidth();\n\t\t\t\ttrack.video.height = sample_desc.getHeight();\n\t\t\t} else if (sample_desc.isSubtitle()) {\n\t\t\t\ttrack.type = \"subtitles\";\n\t\t\t\tmovie.subtitleTracks.push(track);\n\t\t\t} else if (sample_desc.isHint()) {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.hintTracks.push(track);\n\t\t\t} else if (sample_desc.isMetadata()) {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.metadataTracks.push(track);\n\t\t\t} else {\n\t\t\t\ttrack.type = \"metadata\";\n\t\t\t\tmovie.otherTracks.push(track);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tmovie.hasMoov = false;\n\t}\n\tmovie.mime = \"\";\n\tif (movie.hasMoov && movie.tracks) {\n\t\tif (movie.videoTracks && movie.videoTracks.length > 0) {\n\t\t\tmovie.mime += 'video/mp4; codecs=\\\"';\n\t\t} else if (movie.audioTracks && movie.audioTracks.length > 0) {\n\t\t\tmovie.mime += 'audio/mp4; codecs=\\\"';\n\t\t} else {\n\t\t\tmovie.mime += 'application/mp4; codecs=\\\"';\n\t\t}\n\t\tfor (i = 0; i < movie.tracks.length; i++) {\n\t\t\tif (i !== 0) movie.mime += ',';\n\t\t\tmovie.mime+= movie.tracks[i].codec;\n\t\t}\n\t\tmovie.mime += '\\\"; profiles=\\\"';\n\t\tmovie.mime += this.ftyp.compatible_brands.join();\n\t\tmovie.mime += '\\\"';\n\t}\n\treturn movie;\n}\n\nISOFile.prototype.setNextSeekPositionFromSample = function (sample) {\n\tif (!sample) {\n\t\treturn;\n\t}\n\tif (this.nextSeekPosition) {\n\t\tthis.nextSeekPosition = Math.min(sample.offset+sample.alreadyRead,this.nextSeekPosition);\n\t} else {\n\t\tthis.nextSeekPosition = sample.offset+sample.alreadyRead;\n\t}\n}\n\nISOFile.prototype.processSamples = function(last) {\n\tvar i;\n\tvar trak;\n\tif (!this.sampleProcessingStarted) return;\n\n\t/* For each track marked for fragmentation,\n\t   check if the next sample is there (i.e. if the sample information is known (i.e. moof has arrived) and if it has been downloaded)\n\t   and create a fragment with it */\n\tif (this.isFragmentationInitialized && this.onSegment !== null) {\n\t\tfor (i = 0; i < this.fragmentedTracks.length; i++) {\n\t\t\tvar fragTrak = this.fragmentedTracks[i];\n\t\t\ttrak = fragTrak.trak;\n\t\t\twhile (trak.nextSample < trak.samples.length && this.sampleProcessingStarted) {\n\t\t\t\t/* The sample information is there (either because the file is not fragmented and this is not the last sample,\n\t\t\t\tor because the file is fragmented and the moof for that sample has been received */\n\t\t\t\tLog.debug(\"ISOFile\", \"Creating media fragment on track #\"+fragTrak.id +\" for sample \"+trak.nextSample);\n\t\t\t\tvar result = this.createFragment(fragTrak.id, trak.nextSample, fragTrak.segmentStream);\n\t\t\t\tif (result) {\n\t\t\t\t\tfragTrak.segmentStream = result;\n\t\t\t\t\ttrak.nextSample++;\n\t\t\t\t} else {\n\t\t\t\t\t/* The fragment could not be created because the media data is not there (not downloaded), wait for it */\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t/* A fragment is created by sample, but the segment is the accumulation in the buffer of these fragments.\n\t\t\t\t   It is flushed only as requested by the application (nb_samples) to avoid too many callbacks */\n\t\t\t\tif (trak.nextSample % fragTrak.nb_samples === 0 || (last || trak.nextSample >= trak.samples.length)) {\n\t\t\t\t\tLog.info(\"ISOFile\", \"Sending fragmented data on track #\"+fragTrak.id+\" for samples [\"+Math.max(0,trak.nextSample-fragTrak.nb_samples)+\",\"+(trak.nextSample-1)+\"]\");\n\t\t\t\t\tLog.info(\"ISOFile\", \"Sample data size in memory: \"+this.getAllocatedSampleDataSize());\n\t\t\t\t\tif (this.onSegment) {\n\t\t\t\t\t\tthis.onSegment(fragTrak.id, fragTrak.user, fragTrak.segmentStream.buffer, trak.nextSample, (last || trak.nextSample >= trak.samples.length));\n\t\t\t\t\t}\n\t\t\t\t\t/* force the creation of a new buffer */\n\t\t\t\t\tfragTrak.segmentStream = null;\n\t\t\t\t\tif (fragTrak !== this.fragmentedTracks[i]) {\n\t\t\t\t\t\t/* make sure we can stop fragmentation if needed */\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (this.onSamples !== null) {\n\t\t/* For each track marked for data export,\n\t\t   check if the next sample is there (i.e. has been downloaded) and send it */\n\t\tfor (i = 0; i < this.extractedTracks.length; i++) {\n\t\t\tvar extractTrak = this.extractedTracks[i];\n\t\t\ttrak = extractTrak.trak;\n\t\t\twhile (trak.nextSample < trak.samples.length && this.sampleProcessingStarted) {\n\t\t\t\tLog.debug(\"ISOFile\", \"Exporting on track #\"+extractTrak.id +\" sample #\"+trak.nextSample);\n\t\t\t\tvar sample = this.getSample(trak, trak.nextSample);\n\t\t\t\tif (sample) {\n\t\t\t\t\ttrak.nextSample++;\n\t\t\t\t\textractTrak.samples.push(sample);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setNextSeekPositionFromSample(trak.samples[trak.nextSample]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (trak.nextSample % extractTrak.nb_samples === 0 || trak.nextSample >= trak.samples.length) {\n\t\t\t\t\tLog.debug(\"ISOFile\", \"Sending samples on track #\"+extractTrak.id+\" for sample \"+trak.nextSample);\n\t\t\t\t\tif (this.onSamples) {\n\t\t\t\t\t\tthis.onSamples(extractTrak.id, extractTrak.user, extractTrak.samples);\n\t\t\t\t\t}\n\t\t\t\t\textractTrak.samples = [];\n\t\t\t\t\tif (extractTrak !== this.extractedTracks[i]) {\n\t\t\t\t\t\t/* check if the extraction needs to be stopped */\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n/* Find and return specific boxes using recursion and early return */\nISOFile.prototype.getBox = function(type) {\n  var result = this.getBoxes(type, true);\n  return (result.length ? result[0] : null);\n}\n\nISOFile.prototype.getBoxes = function(type, returnEarly) {\n  var result = [];\n  ISOFile._sweep.call(this, type, result, returnEarly);\n  return result;\n}\n\nISOFile._sweep = function(type, result, returnEarly) {\n  if (this.type && this.type == type) result.push(this);\n  for (var box in this.boxes) {\n    if (result.length && returnEarly) return;\n    ISOFile._sweep.call(this.boxes[box], type, result, returnEarly);\n  }\n}\n\nISOFile.prototype.getTrackSamplesInfo = function(track_id) {\n\tvar track = this.getTrackById(track_id);\n\tif (track) {\n\t\treturn track.samples;\n\t} else {\n\t\treturn;\n\t}\n}\n\nISOFile.prototype.getTrackSample = function(track_id, number) {\n\tvar track = this.getTrackById(track_id);\n\tvar sample = this.getSample(track, number);\n\treturn sample;\n}\n\n/* Called by the application to release the resources associated to samples already forwarded to the application */\nISOFile.prototype.releaseUsedSamples = function (id, sampleNum) {\n\tvar size = 0;\n\tvar trak = this.getTrackById(id);\n\tif (!trak.lastValidSample) trak.lastValidSample = 0;\n\tfor (var i = trak.lastValidSample; i < sampleNum; i++) {\n\t\tsize+=this.releaseSample(trak, i);\n\t}\n\tLog.info(\"ISOFile\", \"Track #\"+id+\" released samples up to \"+sampleNum+\" (released size: \"+size+\", remaining: \"+this.samplesDataSize+\")\");\n\ttrak.lastValidSample = sampleNum;\n}\n\nISOFile.prototype.start = function() {\n\tthis.sampleProcessingStarted = true;\n\tthis.processSamples(false);\n}\n\nISOFile.prototype.stop = function() {\n\tthis.sampleProcessingStarted = false;\n}\n\n/* Called by the application to flush the remaining samples (e.g. once the download is finished or when no more samples will be added) */\nISOFile.prototype.flush = function() {\n\tLog.info(\"ISOFile\", \"Flushing remaining samples\");\n\tthis.updateSampleLists();\n\tthis.processSamples(true);\n\tthis.stream.cleanBuffers();\n\tthis.stream.logBufferLevel(true);\n}\n\n/* Finds the byte offset for a given time on a given track\n   also returns the time of the previous rap */\nISOFile.prototype.seekTrack = function(time, useRap, trak) {\n\tvar j;\n\tvar sample;\n\tvar seek_offset = Infinity;\n\tvar rap_seek_sample_num = 0;\n\tvar seek_sample_num = 0;\n\tvar timescale;\n\n\tif (trak.samples.length === 0) {\n\t\tLog.info(\"ISOFile\", \"No sample in track, cannot seek! Using time \"+Log.getDurationString(0, 1) +\" and offset: \"+0);\n\t\treturn { offset: 0, time: 0 };\n\t}\n\n\tfor (j = 0; j < trak.samples.length; j++) {\n\t\tsample = trak.samples[j];\n\t\tif (j === 0) {\n\t\t\tseek_sample_num = 0;\n\t\t\ttimescale = sample.timescale;\n\t\t} else if (sample.cts > time * sample.timescale) {\n\t\t\tseek_sample_num = j-1;\n\t\t\tbreak;\n\t\t}\n\t\tif (useRap && sample.is_sync) {\n\t\t\trap_seek_sample_num = j;\n\t\t}\n\t}\n\tif (useRap) {\n\t\tseek_sample_num = rap_seek_sample_num;\n\t}\n\ttime = trak.samples[seek_sample_num].cts;\n\ttrak.nextSample = seek_sample_num;\n\twhile (trak.samples[seek_sample_num].alreadyRead === trak.samples[seek_sample_num].size) {\n\t\t// No remaining samples to look for, all are downloaded.\n\t\tif (!trak.samples[seek_sample_num + 1]) {\n\t\t\tbreak;\n\t\t}\n\t\tseek_sample_num++;\n\t}\n\tseek_offset = trak.samples[seek_sample_num].offset+trak.samples[seek_sample_num].alreadyRead;\n\tLog.info(\"ISOFile\", \"Seeking to \"+(useRap ? \"RAP\": \"\")+\" sample #\"+trak.nextSample+\" on track \"+trak.tkhd.track_id+\", time \"+Log.getDurationString(time, timescale) +\" and offset: \"+seek_offset);\n\treturn { offset: seek_offset, time: time/timescale };\n}\n\nISOFile.prototype.getTrackDuration = function (trak) {\n\tvar sample;\n\n\tif (!trak.samples) {\n\t\treturn Infinity;\n\t}\n\tsample = trak.samples[trak.samples.length - 1];\n\treturn (sample.cts + sample.duration) / sample.timescale;\n}\n\n/* Finds the byte offset in the file corresponding to the given time or to the time of the previous RAP */\nISOFile.prototype.seek = function(time, useRap) {\n\tvar moov = this.moov;\n\tvar trak;\n\tvar trak_seek_info;\n\tvar i;\n\tvar seek_info = { offset: Infinity, time: Infinity };\n\tif (!this.moov) {\n\t\tthrow \"Cannot seek: moov not received!\";\n\t} else {\n\t\tfor (i = 0; i<moov.traks.length; i++) {\n\t\t\ttrak = moov.traks[i];\n\t\t\tif (time > this.getTrackDuration(trak)) { // skip tracks that already ended\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttrak_seek_info = this.seekTrack(time, useRap, trak);\n\t\t\tif (trak_seek_info.offset < seek_info.offset) {\n\t\t\t\tseek_info.offset = trak_seek_info.offset;\n\t\t\t}\n\t\t\tif (trak_seek_info.time < seek_info.time) {\n\t\t\t\tseek_info.time = trak_seek_info.time;\n\t\t\t}\n\t\t}\n\t\tLog.info(\"ISOFile\", \"Seeking at time \"+Log.getDurationString(seek_info.time, 1)+\" needs a buffer with a fileStart position of \"+seek_info.offset);\n\t\tif (seek_info.offset === Infinity) {\n\t\t\t/* No sample info, in all tracks, cannot seek */\n\t\t\tseek_info = { offset: this.nextParsePosition, time: 0 };\n\t\t} else {\n\t\t\t/* check if the seek position is already in some buffer and\n\t\t\t in that case return the end of that buffer (or of the last contiguous buffer) */\n\t\t\t/* TODO: Should wait until append operations are done */\n\t\t\tseek_info.offset = this.stream.getEndFilePositionAfter(seek_info.offset);\n\t\t}\n\t\tLog.info(\"ISOFile\", \"Adjusted seek position (after checking data already in buffer): \"+seek_info.offset);\n\t\treturn seek_info;\n\t}\n}\n\nISOFile.prototype.equal = function(b) {\n\tvar box_index = 0;\n\twhile (box_index < this.boxes.length && box_index < b.boxes.length) {\n\t\tvar a_box = this.boxes[box_index];\n\t\tvar b_box = b.boxes[box_index];\n\t\tif (!BoxParser.boxEqual(a_box, b_box)) {\n\t\t\treturn false;\n\t\t}\n\t\tbox_index++;\n\t}\n\treturn true;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.ISOFile = ISOFile;\n}\n// file:src/isofile-advanced-parsing.js\n/* position in the current buffer of the beginning of the last box parsed */\nISOFile.prototype.lastBoxStartPosition = 0;\n/* indicator if the parsing is stuck in the middle of an mdat box */\nISOFile.prototype.parsingMdat = null;\n/* next file position that the parser needs:\n    - 0 until the first buffer (i.e. fileStart ===0) has been received \n    - otherwise, the next box start until the moov box has been parsed\n    - otherwise, the position of the next sample to fetch\n */\nISOFile.prototype.nextParsePosition = 0;\n/* keep mdat data */\nISOFile.prototype.discardMdatData = false;\n\nISOFile.prototype.processIncompleteBox = function(ret) {\n\tvar box;\n\tvar merged;\n\tvar found;\n\t\n\t/* we did not have enough bytes in the current buffer to parse the entire box */\n\tif (ret.type === \"mdat\") { \n\t\t/* we had enough bytes to get its type and size and it's an 'mdat' */\n\t\t\n\t\t/* special handling for mdat boxes, since we don't actually need to parse it linearly \n\t\t   we create the box */\n\t\tbox = new BoxParser[ret.type+\"Box\"](ret.size);\t\n\t\tthis.parsingMdat = box;\n\t\tthis.boxes.push(box);\n\t\tthis.mdats.push(box);\t\t\t\n\t\tbox.start = ret.start;\n\t\tbox.hdr_size = ret.hdr_size;\n\t\tthis.stream.addUsedBytes(box.hdr_size);\n\n\t\t/* indicate that the parsing should start from the end of the box */\n\t\tthis.lastBoxStartPosition = box.start + box.size;\n \t\t/* let's see if we have the end of the box in the other buffers */\n\t\tfound = this.stream.seek(box.start + box.size, false, this.discardMdatData);\n\t\tif (found) {\n\t\t\t/* found the end of the box */\n\t\t\tthis.parsingMdat = null;\n\t\t\t/* let's see if we can parse more in this buffer */\n\t\t\treturn true;\n\t\t} else {\n\t\t\t/* 'mdat' end not found in the existing buffers */\n\t\t\t/* determine the next position in the file to start parsing from */\n\t\t\tif (!this.moovStartFound) {\n\t\t\t\t/* moov not find yet, \n\t\t\t\t   the file probably has 'mdat' at the beginning, and 'moov' at the end, \n\t\t\t\t   indicate that the downloader should not try to download those bytes now */\n\t\t\t\tthis.nextParsePosition = box.start + box.size;\n\t\t\t} else {\n\t\t\t\t/* we have the start of the moov box, \n\t\t\t\t   the next bytes should try to complete the current 'mdat' */\n\t\t\t\tthis.nextParsePosition = this.stream.findEndContiguousBuf();\n\t\t\t}\n\t\t\t/* not much we can do, wait for more buffers to arrive */\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\t/* box is incomplete, we may not even know its type */\n\t\tif (ret.type === \"moov\") { \n\t\t\t/* the incomplete box is a 'moov' box */\n\t\t\tthis.moovStartFound = true;\n\t\t\tif (this.mdats.length === 0) {\n\t\t\t\tthis.isProgressive = true;\n\t\t\t}\n\t\t}\n\t\t/* either it's not an mdat box (and we need to parse it, we cannot skip it)\n\t\t   (TODO: we could skip 'free' boxes ...)\n\t\t\t   or we did not have enough data to parse the type and size of the box, \n\t\t   we try to concatenate the current buffer with the next buffer to restart parsing */\n\t\tmerged = (this.stream.mergeNextBuffer ? this.stream.mergeNextBuffer() : false);\n\t\tif (merged) {\n\t\t\t/* The next buffer was contiguous, the merging succeeded,\n\t\t\t   we can now continue parsing, \n\t\t\t   the next best position to parse is at the end of this new buffer */\n\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\treturn true;\n\t\t} else {\n\t\t\t/* we cannot concatenate existing buffers because they are not contiguous or because there is no additional buffer */\n\t\t\t/* The next best position to parse is still at the end of this old buffer */\n\t\t\tif (!ret.type) {\n\t\t\t\t/* There were not enough bytes in the buffer to parse the box type and length,\n\t\t\t\t   the next fetch should retrieve those missing bytes, i.e. the next bytes after this buffer */\n\t\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\t} else {\n\t\t\t\t/* we had enough bytes to parse size and type of the incomplete box\n\t\t\t\t   if we haven't found yet the moov box, skip this one and try the next one \n\t\t\t\t   if we have found the moov box, let's continue linear parsing */\n\t\t\t\tif (this.moovStartFound) {\n\t\t\t\t\tthis.nextParsePosition = this.stream.getEndPosition();\n\t\t\t\t} else {\n\t\t\t\t\tthis.nextParsePosition = this.stream.getPosition() + ret.size;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nISOFile.prototype.hasIncompleteMdat = function () {\n\treturn (this.parsingMdat !== null);\n}\n\nISOFile.prototype.processIncompleteMdat = function () {\n\tvar box;\n\tvar found;\n\t\n\t/* we are in the parsing of an incomplete mdat box */\n\tbox = this.parsingMdat;\n\n\tfound = this.stream.seek(box.start + box.size, false, this.discardMdatData);\n\tif (found) {\n\t\tLog.debug(\"ISOFile\", \"Found 'mdat' end in buffered data\");\n\t\t/* the end of the mdat has been found */ \n\t\tthis.parsingMdat = null;\n\t\t/* we can parse more in this buffer */\n\t\treturn true;\n\t} else {\n\t\t/* we don't have the end of this mdat yet, \n\t\t   indicate that the next byte to fetch is the end of the buffers we have so far, \n\t\t   return and wait for more buffer to come */\n\t\tthis.nextParsePosition = this.stream.findEndContiguousBuf();\n\t\treturn false;\n\t}\n}\n\nISOFile.prototype.restoreParsePosition = function() {\n\t/* Reposition at the start position of the previous box not entirely parsed */\n\treturn this.stream.seek(this.lastBoxStartPosition, true, this.discardMdatData);\n}\n\nISOFile.prototype.saveParsePosition = function() {\n\t/* remember the position of the box start in case we need to roll back (if the box is incomplete) */\n\tthis.lastBoxStartPosition = this.stream.getPosition();\t\n}\n\nISOFile.prototype.updateUsedBytes = function(box, ret) {\n\tif (this.stream.addUsedBytes) {\n\t\tif (box.type === \"mdat\") {\n\t\t\t/* for an mdat box, only its header is considered used, other bytes will be used when sample data is requested */\n\t\t\tthis.stream.addUsedBytes(box.hdr_size);\n\t\t\tif (this.discardMdatData) {\n\t\t\t\tthis.stream.addUsedBytes(box.size-box.hdr_size);\n\t\t\t}\n\t\t} else {\n\t\t\t/* for all other boxes, the entire box data is considered used */\n\t\t\tthis.stream.addUsedBytes(box.size);\n\t\t}\t\n\t}\n}\n// file:src/isofile-advanced-creation.js\nISOFile.prototype.add = BoxParser.Box.prototype.add;\nISOFile.prototype.addBox = BoxParser.Box.prototype.addBox;\n\nISOFile.prototype.init = function (_options) {\n\tvar options = _options || {}; \n\tvar ftyp = this.add(\"ftyp\").set(\"major_brand\", (options.brands && options.brands[0]) || \"iso4\")\n\t\t\t\t\t\t\t   .set(\"minor_version\", 0)\n\t\t\t\t\t\t\t   .set(\"compatible_brands\", options.brands || [\"iso4\"]);\n\tvar moov = this.add(\"moov\");\n\tmoov.add(\"mvhd\").set(\"timescale\", options.timescale || 600)\n\t\t\t\t\t.set(\"rate\", options.rate || 1<<16)\n\t\t\t\t\t.set(\"creation_time\", 0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"duration\", options.duration || 0)\n\t\t\t\t\t.set(\"volume\", (options.width) ? 0 : 0x0100)\n\t\t\t\t\t.set(\"matrix\", [ 1<<16, 0, 0, 0, 1<<16, 0, 0, 0, 0x40000000])\n\t\t\t\t\t.set(\"next_track_id\", 1);\n\tmoov.add(\"mvex\");\n\treturn this;\n}\n\nISOFile.prototype.addTrack = function (_options) {\n\tif (!this.moov) {\n\t\tthis.init(_options);\n\t}\n\n\tvar options = _options || {}; \n\toptions.width = options.width || 320;\n\toptions.height = options.height || 320;\n\toptions.id = options.id || this.moov.mvhd.next_track_id;\n\toptions.type = options.type || \"avc1\";\n\n\tvar trak = this.moov.add(\"trak\");\n\tthis.moov.mvhd.next_track_id = options.id+1;\n\ttrak.add(\"tkhd\").set(\"flags\",BoxParser.TKHD_FLAG_ENABLED | \n\t\t\t\t\t\t\t\t BoxParser.TKHD_FLAG_IN_MOVIE | \n\t\t\t\t\t\t\t\t BoxParser.TKHD_FLAG_IN_PREVIEW)\n\t\t\t\t\t.set(\"creation_time\",0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"track_id\", options.id)\n\t\t\t\t\t.set(\"duration\", options.duration || 0)\n\t\t\t\t\t.set(\"layer\", options.layer || 0)\n\t\t\t\t\t.set(\"alternate_group\", 0)\n\t\t\t\t\t.set(\"volume\", 1)\n\t\t\t\t\t.set(\"matrix\", [ 1<<16, 0, 0, 0, 1<<16, 0, 0, 0, 0x40000000 ])\n\t\t\t\t\t.set(\"width\", options.width << 16)\n\t\t\t\t\t.set(\"height\", options.height << 16);\n\n\tvar mdia = trak.add(\"mdia\");\n\tmdia.add(\"mdhd\").set(\"creation_time\", 0)\n\t\t\t\t\t.set(\"modification_time\", 0)\n\t\t\t\t\t.set(\"timescale\", options.timescale || 1)\n\t\t\t\t\t.set(\"duration\", options.media_duration || 0)\n\t\t\t\t\t.set(\"language\", options.language || \"und\");\n\n\tmdia.add(\"hdlr\").set(\"handler\", options.hdlr || \"vide\")\n\t\t\t\t\t.set(\"name\", options.name || \"Track created with MP4Box.js\");\n\n\tmdia.add(\"elng\").set(\"extended_language\", options.language || \"fr-FR\");\n\n\tvar minf = mdia.add(\"minf\");\n\tif (BoxParser[options.type+\"SampleEntry\"] === undefined) return;\n\tvar sample_description_entry = new BoxParser[options.type+\"SampleEntry\"]();\n\tsample_description_entry.data_reference_index = 1;\n\tvar media_type = \"\";\n\tfor (var mediaType in BoxParser.sampleEntryCodes) {\n\t\tvar codes = BoxParser.sampleEntryCodes[mediaType];\n\t\tfor (var i = 0; i < codes.length; i++) {\n\t\t\tif (codes.indexOf(options.type) > -1) {\n\t\t\t\tmedia_type = mediaType;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tswitch(media_type) {\n\t\tcase \"Visual\":\n\t\t\tminf.add(\"vmhd\").set(\"graphicsmode\",0).set(\"opcolor\", [ 0, 0, 0 ]);\n\t\t\tsample_description_entry.set(\"width\", options.width)\n\t\t\t\t\t\t.set(\"height\", options.height)\n\t\t\t\t\t\t.set(\"horizresolution\", 0x48<<16)\n\t\t\t\t\t\t.set(\"vertresolution\", 0x48<<16)\n\t\t\t\t\t\t.set(\"frame_count\", 1)\n\t\t\t\t\t\t.set(\"compressorname\", options.type+\" Compressor\")\n\t\t\t\t\t\t.set(\"depth\", 0x18);\n\t\t\tif (options.avcDecoderConfigRecord) {\n\t\t\t\tvar avcC = new BoxParser.avcCBox();\n\t\t\t\tavcC.parse(new MP4BoxStream(options.avcDecoderConfigRecord));\n\t\t\t\tsample_description_entry.addBox(avcC);\n\t\t\t} else if (options.hevcDecoderConfigRecord) {\n\t\t\t\tvar hvcC = new BoxParser.hvcCBox();\n\t\t\t\thvcC.parse(new MP4BoxStream(options.hevcDecoderConfigRecord));\n\t\t\t\tsample_description_entry.addBox(hvcC);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"Audio\":\n\t\t\tminf.add(\"smhd\").set(\"balance\", options.balance || 0);\n\t\t\tsample_description_entry.set(\"channel_count\", options.channel_count || 2)\n\t\t\t\t\t\t.set(\"samplesize\", options.samplesize || 16)\n\t\t\t\t\t\t.set(\"samplerate\", options.samplerate || 1<<16);\n\t\t\tbreak;\n\t\tcase \"Hint\":\n\t\t\tminf.add(\"hmhd\"); // TODO: add properties\n\t\t\tbreak;\n\t\tcase \"Subtitle\":\n\t\t\tminf.add(\"sthd\");\n\t\t\tswitch (options.type) {\n\t\t\t\tcase \"stpp\":\n\t\t\t\t\tsample_description_entry.set(\"namespace\", options.namespace || \"nonamespace\")\n\t\t\t\t\t\t\t\t.set(\"schema_location\", options.schema_location || \"\")\n\t\t\t\t\t\t\t\t.set(\"auxiliary_mime_types\", options.auxiliary_mime_types || \"\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"Metadata\":\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t\tcase \"System\":\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tminf.add(\"nmhd\");\n\t\t\tbreak;\n\t}\n\tif (options.description) {\n\t\tsample_description_entry.addBox(options.description);\n\t}\n\tif (options.description_boxes) {\n\t\toptions.description_boxes.forEach(function (b) {\n\t\t\tsample_description_entry.addBox(b);\n\t\t});\n\t}\n\tminf.add(\"dinf\").add(\"dref\").addEntry((new BoxParser[\"url Box\"]()).set(\"flags\", 0x1));\n\tvar stbl = minf.add(\"stbl\");\n\tstbl.add(\"stsd\").addEntry(sample_description_entry);\n\tstbl.add(\"stts\").set(\"sample_counts\", [])\n\t\t\t\t\t.set(\"sample_deltas\", []);\n\tstbl.add(\"stsc\").set(\"first_chunk\", [])\n\t\t\t\t\t.set(\"samples_per_chunk\", [])\n\t\t\t\t\t.set(\"sample_description_index\", []);\n\tstbl.add(\"stco\").set(\"chunk_offsets\", []);\n\tstbl.add(\"stsz\").set(\"sample_sizes\", []);\n\n\tthis.moov.mvex.add(\"trex\").set(\"track_id\", options.id)\n\t\t\t\t\t\t\t  .set(\"default_sample_description_index\", options.default_sample_description_index || 1)\n\t\t\t\t\t\t\t  .set(\"default_sample_duration\", options.default_sample_duration || 0)\n\t\t\t\t\t\t\t  .set(\"default_sample_size\", options.default_sample_size || 0)\n\t\t\t\t\t\t\t  .set(\"default_sample_flags\", options.default_sample_flags || 0);\n\tthis.buildTrakSampleLists(trak);\n\treturn options.id;\n}\n\nBoxParser.Box.prototype.computeSize = function(stream_) {\n\tvar stream = stream_ || new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n}\n\nISOFile.prototype.addSample = function (track_id, data, _options) {\n\tvar options = _options || {};\n\tvar sample = {};\n\tvar trak = this.getTrackById(track_id);\n\tif (trak === null) return;\n    sample.number = trak.samples.length;\n\tsample.track_id = trak.tkhd.track_id;\n\tsample.timescale = trak.mdia.mdhd.timescale;\n\tsample.description_index = (options.sample_description_index ? options.sample_description_index - 1: 0);\n\tsample.description = trak.mdia.minf.stbl.stsd.entries[sample.description_index];\n\tsample.data = data;\n\tsample.size = data.byteLength;\n\tsample.alreadyRead = sample.size;\n\tsample.duration = options.duration || 1;\n\tsample.cts = options.cts || 0;\n\tsample.dts = options.dts || 0;\n\tsample.is_sync = options.is_sync || false;\n\tsample.is_leading = options.is_leading || 0;\n\tsample.depends_on = options.depends_on || 0;\n\tsample.is_depended_on = options.is_depended_on || 0;\n\tsample.has_redundancy = options.has_redundancy || 0;\n\tsample.degradation_priority = options.degradation_priority || 0;\n\tsample.offset = 0;\n\tsample.subsamples = options.subsamples;\n\ttrak.samples.push(sample);\n\ttrak.samples_size += sample.size;\n\ttrak.samples_duration += sample.duration;\n\tif (trak.first_dts === undefined) {\n\t\ttrak.first_dts = options.dts;\n\t}\n\n\tthis.processSamples();\n\t\n\tvar moof = this.createSingleSampleMoof(sample);\n\tthis.addBox(moof);\n\tmoof.computeSize();\n\t/* adjusting the data_offset now that the moof size is known*/\n\tmoof.trafs[0].truns[0].data_offset = moof.size+8; //8 is mdat header\n\tthis.add(\"mdat\").data = new Uint8Array(data);\n\treturn sample;\n}\n\nISOFile.prototype.createSingleSampleMoof = function(sample) {\n\tvar sample_flags = 0;\n\tif (sample.is_sync)\n\t\tsample_flags = (1 << 25);  // sample_depends_on_none (I picture)\n\telse\n\t\tsample_flags = (1 << 16);  // non-sync\n\n\tvar moof = new BoxParser.moofBox();\n\tmoof.add(\"mfhd\").set(\"sequence_number\", this.nextMoofNumber);\n\tthis.nextMoofNumber++;\n\tvar traf = moof.add(\"traf\");\n\tvar trak = this.getTrackById(sample.track_id);\n\ttraf.add(\"tfhd\").set(\"track_id\", sample.track_id)\n\t\t\t\t\t.set(\"flags\", BoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF);\n\ttraf.add(\"tfdt\").set(\"baseMediaDecodeTime\", (sample.dts - (trak.first_dts || 0)));\n\ttraf.add(\"trun\").set(\"flags\", BoxParser.TRUN_FLAGS_DATA_OFFSET | BoxParser.TRUN_FLAGS_DURATION | \n\t\t\t\t \t\t\t\t  BoxParser.TRUN_FLAGS_SIZE | BoxParser.TRUN_FLAGS_FLAGS | \n\t\t\t\t \t\t\t\t  BoxParser.TRUN_FLAGS_CTS_OFFSET)\n\t\t\t\t\t.set(\"data_offset\",0)\n\t\t\t\t\t.set(\"first_sample_flags\",0)\n\t\t\t\t\t.set(\"sample_count\",1)\n\t\t\t\t\t.set(\"sample_duration\",[sample.duration])\n\t\t\t\t\t.set(\"sample_size\",[sample.size])\n\t\t\t\t\t.set(\"sample_flags\",[sample_flags])\n\t\t\t\t\t.set(\"sample_composition_time_offset\", [sample.cts - sample.dts]);\n\treturn moof;\n}\n\n// file:src/isofile-sample-processing.js\n/* Index of the last moof box received */\nISOFile.prototype.lastMoofIndex = 0;\n\n/* size of the buffers allocated for samples */\nISOFile.prototype.samplesDataSize = 0;\n\n/* Resets all sample tables */\nISOFile.prototype.resetTables = function () {\n\tvar i;\n\tvar trak, stco, stsc, stsz, stts, ctts, stss;\n\tthis.initial_duration = this.moov.mvhd.duration;\n\tthis.moov.mvhd.duration = 0;\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\ttrak = this.moov.traks[i];\n\t\ttrak.tkhd.duration = 0;\n\t\ttrak.mdia.mdhd.duration = 0;\n\t\tstco = trak.mdia.minf.stbl.stco || trak.mdia.minf.stbl.co64;\n\t\tstco.chunk_offsets = [];\n\t\tstsc = trak.mdia.minf.stbl.stsc;\n\t\tstsc.first_chunk = [];\n\t\tstsc.samples_per_chunk = [];\n\t\tstsc.sample_description_index = [];\n\t\tstsz = trak.mdia.minf.stbl.stsz || trak.mdia.minf.stbl.stz2;\n\t\tstsz.sample_sizes = [];\n\t\tstts = trak.mdia.minf.stbl.stts;\n\t\tstts.sample_counts = [];\n\t\tstts.sample_deltas = [];\n\t\tctts = trak.mdia.minf.stbl.ctts;\n\t\tif (ctts) {\n\t\t\tctts.sample_counts = [];\n\t\t\tctts.sample_offsets = [];\n\t\t}\n\t\tstss = trak.mdia.minf.stbl.stss;\n\t\tvar k = trak.mdia.minf.stbl.boxes.indexOf(stss);\n\t\tif (k != -1) trak.mdia.minf.stbl.boxes[k] = null;\n\t}\n}\n\nISOFile.initSampleGroups = function(trak, traf, sbgps, trak_sgpds, traf_sgpds) {\n\tvar l;\n\tvar k;\n\tvar sample_groups_info;\n\tvar sample_group_info;\n\tvar sample_group_key;\n\tfunction SampleGroupInfo(_type, _parameter, _sbgp) {\n\t\tthis.grouping_type = _type;\n\t\tthis.grouping_type_parameter = _parameter;\n\t\tthis.sbgp = _sbgp;\n\t\tthis.last_sample_in_run = -1;\n\t\tthis.entry_index = -1;\t\t\n\t}\n\tif (traf) {\n\t\ttraf.sample_groups_info = [];\n\t} \n\tif (!trak.sample_groups_info) {\n\t\ttrak.sample_groups_info = [];\n\t}\n\tfor (k = 0; k < sbgps.length; k++) {\n\t\tsample_group_key = sbgps[k].grouping_type +\"/\"+ sbgps[k].grouping_type_parameter;\n\t\tsample_group_info = new SampleGroupInfo(sbgps[k].grouping_type, sbgps[k].grouping_type_parameter, sbgps[k]);\n\t\tif (traf) {\n\t\t\ttraf.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t}\n\t\tif (!trak.sample_groups_info[sample_group_key]) {\n\t\t\ttrak.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t}\n\t\tfor (l=0; l <trak_sgpds.length; l++) {\n\t\t\tif (trak_sgpds[l].grouping_type === sbgps[k].grouping_type) {\n\t\t\t\tsample_group_info.description = trak_sgpds[l];\n\t\t\t\tsample_group_info.description.used = true;\n\t\t\t}\n\t\t}\n\t\tif (traf_sgpds) {\n\t\t\tfor (l=0; l <traf_sgpds.length; l++) {\n\t\t\t\tif (traf_sgpds[l].grouping_type === sbgps[k].grouping_type) {\n\t\t\t\t\tsample_group_info.fragment_description = traf_sgpds[l];\n\t\t\t\t\tsample_group_info.fragment_description.used = true;\n\t\t\t\t\tsample_group_info.is_fragment = true;\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\t}\n\tif (!traf) {\n\t\tfor (k = 0; k < trak_sgpds.length; k++) {\n\t\t\tif (!trak_sgpds[k].used && trak_sgpds[k].version >= 2) {\n\t\t\t\tsample_group_key = trak_sgpds[k].grouping_type +\"/0\";\n\t\t\t\tsample_group_info = new SampleGroupInfo(trak_sgpds[k].grouping_type, 0);\n\t\t\t\tif (!trak.sample_groups_info[sample_group_key]) {\n\t\t\t\t\ttrak.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif (traf_sgpds) {\n\t\t\tfor (k = 0; k < traf_sgpds.length; k++) {\n\t\t\t\tif (!traf_sgpds[k].used && traf_sgpds[k].version >= 2) {\n\t\t\t\t\tsample_group_key = traf_sgpds[k].grouping_type +\"/0\";\n\t\t\t\t\tsample_group_info = new SampleGroupInfo(traf_sgpds[k].grouping_type, 0);\n\t\t\t\t\tsample_group_info.is_fragment = true;\n\t\t\t\t\tif (!traf.sample_groups_info[sample_group_key]) {\n\t\t\t\t\t\ttraf.sample_groups_info[sample_group_key] = sample_group_info;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.setSampleGroupProperties = function(trak, sample, sample_number, sample_groups_info) {\n\tvar k;\n\tvar index;\n\tsample.sample_groups = [];\n\tfor (k in sample_groups_info) {\n\t\tsample.sample_groups[k] = {};\n\t\tsample.sample_groups[k].grouping_type = sample_groups_info[k].grouping_type;\n\t\tsample.sample_groups[k].grouping_type_parameter = sample_groups_info[k].grouping_type_parameter;\n\t\tif (sample_number >= sample_groups_info[k].last_sample_in_run) {\n\t\t\tif (sample_groups_info[k].last_sample_in_run < 0) {\n\t\t\t\tsample_groups_info[k].last_sample_in_run = 0;\n\t\t\t}\n\t\t\tsample_groups_info[k].entry_index++;\t\n\t\t\tif (sample_groups_info[k].entry_index <= sample_groups_info[k].sbgp.entries.length - 1) {\n\t\t\t\tsample_groups_info[k].last_sample_in_run += sample_groups_info[k].sbgp.entries[sample_groups_info[k].entry_index].sample_count;\n\t\t\t}\n\t\t}\n\t\tif (sample_groups_info[k].entry_index <= sample_groups_info[k].sbgp.entries.length - 1) {\n\t\t\tsample.sample_groups[k].group_description_index = sample_groups_info[k].sbgp.entries[sample_groups_info[k].entry_index].group_description_index;\n\t\t} else {\n\t\t\tsample.sample_groups[k].group_description_index = -1; // special value for not defined\n\t\t}\n\t\tif (sample.sample_groups[k].group_description_index !== 0) {\n\t\t\tvar description;\n\t\t\tif (sample_groups_info[k].fragment_description) {\n\t\t\t\tdescription = sample_groups_info[k].fragment_description;\n\t\t\t} else {\n\t\t\t\tdescription = sample_groups_info[k].description;\n\t\t\t}\n\t\t\tif (sample.sample_groups[k].group_description_index > 0) {\n\t\t\t\tif (sample.sample_groups[k].group_description_index > 65535) {\n\t\t\t\t\tindex = (sample.sample_groups[k].group_description_index >> 16)-1;\n\t\t\t\t} else {\n\t\t\t\t\tindex = sample.sample_groups[k].group_description_index-1;\n\t\t\t\t}\n\t\t\t\tif (description && index >= 0) {\n\t\t\t\t\tsample.sample_groups[k].description = description.entries[index];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (description && description.version >= 2) {\n\t\t\t\t\tif (description.default_group_description_index > 0) {\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tsample.sample_groups[k].description = description.entries[description.default_group_description_index-1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.process_sdtp = function (sdtp, sample, number) {\n\tif (!sample) {\n\t\treturn;\n\t}\n\tif (sdtp) {\n\t\tsample.is_leading = sdtp.is_leading[number];\n\t\tsample.depends_on = sdtp.sample_depends_on[number];\n\t\tsample.is_depended_on = sdtp.sample_is_depended_on[number];\n\t\tsample.has_redundancy = sdtp.sample_has_redundancy[number];\n\t} else {\n\t\tsample.is_leading = 0;\n\t\tsample.depends_on = 0;\n\t\tsample.is_depended_on = 0\n\t\tsample.has_redundancy = 0;\n\t}\t\n}\n\n/* Build initial sample list from  sample tables */\nISOFile.prototype.buildSampleLists = function() {\t\n\tvar i;\n\tvar trak;\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\ttrak = this.moov.traks[i];\n\t\tthis.buildTrakSampleLists(trak);\n\t}\n}\n\nISOFile.prototype.buildTrakSampleLists = function(trak) {\t\n\tvar j, k;\n\tvar stco, stsc, stsz, stts, ctts, stss, stsd, subs, sbgps, sgpds, stdp;\n\tvar chunk_run_index, chunk_index, last_chunk_in_run, offset_in_chunk, last_sample_in_chunk;\n\tvar last_sample_in_stts_run, stts_run_index, last_sample_in_ctts_run, ctts_run_index, last_stss_index, last_subs_index, subs_entry_index, last_subs_sample_index;\n\n\ttrak.samples = [];\n\ttrak.samples_duration = 0;\n\ttrak.samples_size = 0;\n\tstco = trak.mdia.minf.stbl.stco || trak.mdia.minf.stbl.co64;\n\tstsc = trak.mdia.minf.stbl.stsc;\n\tstsz = trak.mdia.minf.stbl.stsz || trak.mdia.minf.stbl.stz2;\n\tstts = trak.mdia.minf.stbl.stts;\n\tctts = trak.mdia.minf.stbl.ctts;\n\tstss = trak.mdia.minf.stbl.stss;\n\tstsd = trak.mdia.minf.stbl.stsd;\n\tsubs = trak.mdia.minf.stbl.subs;\n\tstdp = trak.mdia.minf.stbl.stdp;\n\tsbgps = trak.mdia.minf.stbl.sbgps;\n\tsgpds = trak.mdia.minf.stbl.sgpds;\n\t\n\tlast_sample_in_stts_run = -1;\n\tstts_run_index = -1;\n\tlast_sample_in_ctts_run = -1;\n\tctts_run_index = -1;\n\tlast_stss_index = 0;\n\tsubs_entry_index = 0;\n\tlast_subs_sample_index = 0;\t\t\n\n\tISOFile.initSampleGroups(trak, null, sbgps, sgpds);\n\n\tif (typeof stsz === \"undefined\") {\n\t\treturn;\n\t}\n\n\t/* we build the samples one by one and compute their properties */\n\tfor (j = 0; j < stsz.sample_sizes.length; j++) {\n\t\tvar sample = {};\n\t\tsample.number = j;\n\t\tsample.track_id = trak.tkhd.track_id;\n\t\tsample.timescale = trak.mdia.mdhd.timescale;\n\t\tsample.alreadyRead = 0;\n\t\ttrak.samples[j] = sample;\n\t\t/* size can be known directly */\n\t\tsample.size = stsz.sample_sizes[j];\n\t\ttrak.samples_size += sample.size;\n\t\t/* computing chunk-based properties (offset, sample description index)*/\n\t\tif (j === 0) {\t\t\t\t\n\t\t\tchunk_index = 1; /* the first sample is in the first chunk (chunk indexes are 1-based) */\n\t\t\tchunk_run_index = 0; /* the first chunk is the first entry in the first_chunk table */\n\t\t\tsample.chunk_index = chunk_index;\n\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\tlast_sample_in_chunk = stsc.samples_per_chunk[chunk_run_index];\n\t\t\toffset_in_chunk = 0;\n\n\t\t\t/* Is there another entry in the first_chunk table ? */\n\t\t\tif (chunk_run_index + 1 < stsc.first_chunk.length) {\n\t\t\t\t/* The last chunk in the run is the chunk before the next first chunk */\n\t\t\t\tlast_chunk_in_run = stsc.first_chunk[chunk_run_index+1]-1; \t\n\t\t\t} else {\n\t\t\t\t/* There is only one entry in the table, it is valid for all future chunks*/\n\t\t\t\tlast_chunk_in_run = Infinity;\n\t\t\t}\n\t\t} else {\n\t\t\tif (j < last_sample_in_chunk) {\n\t\t\t\t/* the sample is still in the current chunk */\n\t\t\t\tsample.chunk_index = chunk_index;\n\t\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\t} else {\n\t\t\t\t/* the sample is in the next chunk */\n\t\t\t\tchunk_index++;\n\t\t\t\tsample.chunk_index = chunk_index;\n\t\t\t\t/* reset the accumulated offset in the chunk */\n\t\t\t\toffset_in_chunk = 0;\n\t\t\t\tif (chunk_index <= last_chunk_in_run) {\n\t\t\t\t\t/* stay in the same entry of the first_chunk table */\n\t\t\t\t\t/* chunk_run_index unmodified */\n\t\t\t\t} else {\n\t\t\t\t\tchunk_run_index++;\n\t\t\t\t\t/* Is there another entry in the first_chunk table ? */\n\t\t\t\t\tif (chunk_run_index + 1 < stsc.first_chunk.length) {\n\t\t\t\t\t\t/* The last chunk in the run is the chunk before the next first chunk */\n\t\t\t\t\t\tlast_chunk_in_run = stsc.first_chunk[chunk_run_index+1]-1; \t\n\t\t\t\t\t} else {\n\t\t\t\t\t\t/* There is only one entry in the table, it is valid for all future chunks*/\n\t\t\t\t\t\tlast_chunk_in_run = Infinity;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\tsample.chunk_run_index = chunk_run_index;\n\t\t\t\tlast_sample_in_chunk += stsc.samples_per_chunk[chunk_run_index];\n\t\t\t}\n\t\t}\n\n\t\tsample.description_index = stsc.sample_description_index[sample.chunk_run_index]-1;\n\t\tsample.description = stsd.entries[sample.description_index];\n\t\tsample.offset = stco.chunk_offsets[sample.chunk_index-1] + offset_in_chunk; /* chunk indexes are 1-based */\n\t\toffset_in_chunk += sample.size;\n\n\t\t/* setting dts, cts, duration and rap flags */\n\t\tif (j > last_sample_in_stts_run) {\n\t\t\tstts_run_index++;\n\t\t\tif (last_sample_in_stts_run < 0) {\n\t\t\t\tlast_sample_in_stts_run = 0;\n\t\t\t}\n\t\t\tlast_sample_in_stts_run += stts.sample_counts[stts_run_index];\t\t\t\t\n\t\t}\n\t\tif (j > 0) {\n\t\t\ttrak.samples[j-1].duration = stts.sample_deltas[stts_run_index];\n\t\t\ttrak.samples_duration += trak.samples[j-1].duration;\n\t\t\tsample.dts = trak.samples[j-1].dts + trak.samples[j-1].duration;\n\t\t} else {\n\t\t\tsample.dts = 0;\n\t\t}\n\t\tif (ctts) {\n\t\t\tif (j >= last_sample_in_ctts_run) {\n\t\t\t\tctts_run_index++;\n\t\t\t\tif (last_sample_in_ctts_run < 0) {\n\t\t\t\t\tlast_sample_in_ctts_run = 0;\n\t\t\t\t}\n\t\t\t\tlast_sample_in_ctts_run += ctts.sample_counts[ctts_run_index];\t\t\t\t\n\t\t\t}\n\t\t\tsample.cts = trak.samples[j].dts + ctts.sample_offsets[ctts_run_index];\n\t\t} else {\n\t\t\tsample.cts = sample.dts;\n\t\t}\n\t\tif (stss) {\n\t\t\tif (j == stss.sample_numbers[last_stss_index] - 1) { // sample numbers are 1-based\n\t\t\t\tsample.is_sync = true;\n\t\t\t\tlast_stss_index++;\n\t\t\t} else {\n\t\t\t\tsample.is_sync = false;\t\t\t\t\n\t\t\t\tsample.degradation_priority = 0;\n\t\t\t}\n\t\t\tif (subs) {\n\t\t\t\tif (subs.entries[subs_entry_index].sample_delta + last_subs_sample_index == j+1) {\n\t\t\t\t\tsample.subsamples = subs.entries[subs_entry_index].subsamples;\n\t\t\t\t\tlast_subs_sample_index += subs.entries[subs_entry_index].sample_delta;\n\t\t\t\t\tsubs_entry_index++;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tsample.is_sync = true;\n\t\t}\n\t\tISOFile.process_sdtp(trak.mdia.minf.stbl.sdtp, sample, sample.number);\n\t\tif (stdp) {\n\t\t\tsample.degradation_priority = stdp.priority[j];\n\t\t} else {\n\t\t\tsample.degradation_priority = 0;\n\t\t}\n\t\tif (subs) {\n\t\t\tif (subs.entries[subs_entry_index].sample_delta + last_subs_sample_index == j) {\n\t\t\t\tsample.subsamples = subs.entries[subs_entry_index].subsamples;\n\t\t\t\tlast_subs_sample_index += subs.entries[subs_entry_index].sample_delta;\n\t\t\t}\n\t\t}\n\t\tif (sbgps.length > 0 || sgpds.length > 0) {\n\t\t\tISOFile.setSampleGroupProperties(trak, sample, j, trak.sample_groups_info);\n\t\t}\n\t}\n\tif (j>0) {\n\t\ttrak.samples[j-1].duration = Math.max(trak.mdia.mdhd.duration - trak.samples[j-1].dts, 0);\n\t\ttrak.samples_duration += trak.samples[j-1].duration;\n\t}\n}\n\n/* Update sample list when new 'moof' boxes are received */\nISOFile.prototype.updateSampleLists = function() {\t\n\tvar i, j, k;\n\tvar default_sample_description_index, default_sample_duration, default_sample_size, default_sample_flags;\n\tvar last_run_position;\n\tvar box, moof, traf, trak, trex;\n\tvar sample;\n\tvar sample_flags;\n\t\n\tif (this.moov === undefined) {\n\t\treturn;\n\t}\n\t/* if the input file is fragmented and fetched in multiple downloads, we need to update the list of samples */\n\twhile (this.lastMoofIndex < this.moofs.length) {\n\t\tbox = this.moofs[this.lastMoofIndex];\n\t\tthis.lastMoofIndex++;\n\t\tif (box.type == \"moof\") {\n\t\t\tmoof = box;\n\t\t\tfor (i = 0; i < moof.trafs.length; i++) {\n\t\t\t\ttraf = moof.trafs[i];\n\t\t\t\ttrak = this.getTrackById(traf.tfhd.track_id);\n\t\t\t\ttrex = this.getTrexById(traf.tfhd.track_id);\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_DESC) {\n\t\t\t\t\tdefault_sample_description_index = traf.tfhd.default_sample_description_index;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_description_index = (trex ? trex.default_sample_description_index: 1);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_DUR) {\n\t\t\t\t\tdefault_sample_duration = traf.tfhd.default_sample_duration;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_duration = (trex ? trex.default_sample_duration : 0);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_SIZE) {\n\t\t\t\t\tdefault_sample_size = traf.tfhd.default_sample_size;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_size = (trex ? trex.default_sample_size : 0);\n\t\t\t\t}\n\t\t\t\tif (traf.tfhd.flags & BoxParser.TFHD_FLAG_SAMPLE_FLAGS) {\n\t\t\t\t\tdefault_sample_flags = traf.tfhd.default_sample_flags;\n\t\t\t\t} else {\n\t\t\t\t\tdefault_sample_flags = (trex ? trex.default_sample_flags : 0);\n\t\t\t\t}\n\t\t\t\ttraf.sample_number = 0;\n\t\t\t\t/* process sample groups */\n\t\t\t\tif (traf.sbgps.length > 0) {\n\t\t\t\t\tISOFile.initSampleGroups(trak, traf, traf.sbgps, trak.mdia.minf.stbl.sgpds, traf.sgpds);\n\t\t\t\t}\n\t\t\t\tfor (j = 0; j < traf.truns.length; j++) {\n\t\t\t\t\tvar trun = traf.truns[j];\n\t\t\t\t\tfor (k = 0; k < trun.sample_count; k++) {\n\t\t\t\t\t\tsample = {};\n\t\t\t\t\t\tsample.moof_number = this.lastMoofIndex;\n\t\t\t\t\t\tsample.number_in_traf = traf.sample_number;\n\t\t\t\t\t\ttraf.sample_number++;\n\t\t\t            sample.number = trak.samples.length;\n\t\t\t\t\t\ttraf.first_sample_index = trak.samples.length;\n\t\t\t\t\t\ttrak.samples.push(sample);\n\t\t\t\t\t\tsample.track_id = trak.tkhd.track_id;\n\t\t\t\t\t\tsample.timescale = trak.mdia.mdhd.timescale;\n\t\t\t\t\t\tsample.description_index = default_sample_description_index-1;\n\t\t\t\t\t\tsample.description = trak.mdia.minf.stbl.stsd.entries[sample.description_index];\n\t\t\t\t\t\tsample.size = default_sample_size;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_SIZE) {\n\t\t\t\t\t\t\tsample.size = trun.sample_size[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrak.samples_size += sample.size;\n\t\t\t\t\t\tsample.duration = default_sample_duration;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_DURATION) {\n\t\t\t\t\t\t\tsample.duration = trun.sample_duration[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttrak.samples_duration += sample.duration;\n\t\t\t\t\t\tif (trak.first_traf_merged || k > 0) {\n\t\t\t\t\t\t\tsample.dts = trak.samples[trak.samples.length-2].dts+trak.samples[trak.samples.length-2].duration;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (traf.tfdt) {\n\t\t\t\t\t\t\t\tsample.dts = traf.tfdt.baseMediaDecodeTime;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsample.dts = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttrak.first_traf_merged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample.cts = sample.dts;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_CTS_OFFSET) {\n\t\t\t\t\t\t\tsample.cts = sample.dts + trun.sample_composition_time_offset[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample_flags = default_sample_flags;\n\t\t\t\t\t\tif (trun.flags & BoxParser.TRUN_FLAGS_FLAGS) {\n\t\t\t\t\t\t\tsample_flags = trun.sample_flags[k];\n\t\t\t\t\t\t} else if (k === 0 && (trun.flags & BoxParser.TRUN_FLAGS_FIRST_FLAG)) {\n\t\t\t\t\t\t\tsample_flags = trun.first_sample_flags;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsample.is_sync = ((sample_flags >> 16 & 0x1) ? false : true);\n\t\t\t\t\t\tsample.is_leading = (sample_flags >> 26 & 0x3);\n\t\t\t\t\t\tsample.depends_on = (sample_flags >> 24 & 0x3);\n\t\t\t\t\t\tsample.is_depended_on = (sample_flags >> 22 & 0x3);\n\t\t\t\t\t\tsample.has_redundancy = (sample_flags >> 20 & 0x3);\n\t\t\t\t\t\tsample.degradation_priority = (sample_flags & 0xFFFF);\n\t\t\t\t\t\t//ISOFile.process_sdtp(traf.sdtp, sample, sample.number_in_traf);\n\t\t\t\t\t\tvar bdop = (traf.tfhd.flags & BoxParser.TFHD_FLAG_BASE_DATA_OFFSET) ? true : false;\n\t\t\t\t\t\tvar dbim = (traf.tfhd.flags & BoxParser.TFHD_FLAG_DEFAULT_BASE_IS_MOOF) ? true : false;\n\t\t\t\t\t\tvar dop = (trun.flags & BoxParser.TRUN_FLAGS_DATA_OFFSET) ? true : false;\n\t\t\t\t\t\tvar bdo = 0;\n\t\t\t\t\t\tif (!bdop) {\n\t\t\t\t\t\t\tif (!dbim) {\n\t\t\t\t\t\t\t\tif (j === 0) { // the first track in the movie fragment\n\t\t\t\t\t\t\t\t\tbdo = moof.start; // the position of the first byte of the enclosing Movie Fragment Box\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tbdo = last_run_position; // end of the data defined by the preceding *track* (irrespective of the track id) fragment in the moof\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbdo = moof.start;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbdo = traf.tfhd.base_data_offset;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (j === 0 && k === 0) {\n\t\t\t\t\t\t\tif (dop) {\n\t\t\t\t\t\t\t\tsample.offset = bdo + trun.data_offset; // If the data-offset is present, it is relative to the base-data-offset established in the track fragment header\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tsample.offset = bdo; // the data for this run starts the base-data-offset defined by the track fragment header\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsample.offset = last_run_position; // this run starts immediately after the data of the previous run\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlast_run_position = sample.offset + sample.size;\n\t\t\t\t\t\tif (traf.sbgps.length > 0 || traf.sgpds.length > 0 ||\n\t\t\t\t\t\t\ttrak.mdia.minf.stbl.sbgps.length > 0 || trak.mdia.minf.stbl.sgpds.length > 0) {\n\t\t\t\t\t\t\tISOFile.setSampleGroupProperties(trak, sample, sample.number_in_traf, traf.sample_groups_info);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (traf.subs) {\n\t\t\t\t\ttrak.has_fragment_subsamples = true;\n\t\t\t\t\tvar sample_index = traf.first_sample_index;\n\t\t\t\t\tfor (j = 0; j < traf.subs.entries.length; j++) {\n\t\t\t\t\t\tsample_index += traf.subs.entries[j].sample_delta;\n\t\t\t\t\t\tsample = trak.samples[sample_index-1];\n\t\t\t\t\t\tsample.subsamples = traf.subs.entries[j].subsamples;\n\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\n}\n\n/* Try to get sample data for a given sample:\n   returns null if not found\n   returns the same sample if already requested\n */\nISOFile.prototype.getSample = function(trak, sampleNum) {\t\n\tvar buffer;\n\tvar sample = trak.samples[sampleNum];\n\t\n\tif (!this.moov) {\n\t\treturn null;\n\t}\n\n\tif (!sample.data) {\n\t\t/* Not yet fetched */\n\t\tsample.data = new Uint8Array(sample.size);\n\t\tsample.alreadyRead = 0;\n\t\tthis.samplesDataSize += sample.size;\n\t\tLog.debug(\"ISOFile\", \"Allocating sample #\"+sampleNum+\" on track #\"+trak.tkhd.track_id+\" of size \"+sample.size+\" (total: \"+this.samplesDataSize+\")\");\n\t} else if (sample.alreadyRead == sample.size) {\n\t\t/* Already fetched entirely */\n\t\treturn sample;\n\t}\n\n\t/* The sample has only been partially fetched, we need to check in all buffers */\n\twhile(true) {\n\t\tvar index =\tthis.stream.findPosition(true, sample.offset + sample.alreadyRead, false);\n\t\tif (index > -1) {\n\t\t\tbuffer = this.stream.buffers[index];\n\t\t\tvar lengthAfterStart = buffer.byteLength - (sample.offset + sample.alreadyRead - buffer.fileStart);\n\t\t\tif (sample.size - sample.alreadyRead <= lengthAfterStart) {\n\t\t\t\t/* the (rest of the) sample is entirely contained in this buffer */\n\n\t\t\t\tLog.debug(\"ISOFile\",\"Getting sample #\"+sampleNum+\" data (alreadyRead: \"+sample.alreadyRead+\" offset: \"+\n\t\t\t\t\t(sample.offset+sample.alreadyRead - buffer.fileStart)+\" read size: \"+(sample.size - sample.alreadyRead)+\" full size: \"+sample.size+\")\");\n\n\t\t\t\tDataStream.memcpy(sample.data.buffer, sample.alreadyRead,\n\t\t\t\t                  buffer, sample.offset+sample.alreadyRead - buffer.fileStart, sample.size - sample.alreadyRead);\n\n\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\tbuffer.usedBytes += sample.size - sample.alreadyRead;\n\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\tsample.alreadyRead = sample.size;\n\n\t\t\t\treturn sample;\n\t\t\t} else {\n\t\t\t\t/* the sample does not end in this buffer */\n\n\t\t\t\tif (lengthAfterStart === 0) return null;\n\n\t\t\t\tLog.debug(\"ISOFile\",\"Getting sample #\"+sampleNum+\" partial data (alreadyRead: \"+sample.alreadyRead+\" offset: \"+\n\t\t\t\t\t(sample.offset+sample.alreadyRead - buffer.fileStart)+\" read size: \"+lengthAfterStart+\" full size: \"+sample.size+\")\");\n\n\t\t\t\tDataStream.memcpy(sample.data.buffer, sample.alreadyRead,\n\t\t\t\t                  buffer, sample.offset+sample.alreadyRead - buffer.fileStart, lengthAfterStart);\n\t\t\t\tsample.alreadyRead += lengthAfterStart;\n\n\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\tbuffer.usedBytes += lengthAfterStart;\n\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\t/* keep looking in the next buffer */\n\t\t\t}\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\n/* Release the memory used to store the data of the sample */\nISOFile.prototype.releaseSample = function(trak, sampleNum) {\t\n\tvar sample = trak.samples[sampleNum];\n\tif (sample.data) {\n\t\tthis.samplesDataSize -= sample.size;\n\t\tsample.data = null;\n\t\tsample.alreadyRead = 0;\n\t\treturn sample.size;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\nISOFile.prototype.getAllocatedSampleDataSize = function() {\n\treturn this.samplesDataSize;\n}\n\n/* Builds the MIME Type 'codecs' sub-parameters for the whole file */\nISOFile.prototype.getCodecs = function() {\t\n\tvar i;\n\tvar codecs = \"\";\n\tfor (i = 0; i < this.moov.traks.length; i++) {\n\t\tvar trak = this.moov.traks[i];\n\t\tif (i>0) {\n\t\t\tcodecs+=\",\"; \n\t\t}\n\t\tcodecs += trak.mdia.minf.stbl.stsd.entries[0].getCodec();\t\t\n\t}\n\treturn codecs;\n}\n\n/* Helper function */\nISOFile.prototype.getTrexById = function(id) {\t\n\tvar i;\n\tif (!this.moov || !this.moov.mvex) return null;\n\tfor (i = 0; i < this.moov.mvex.trexs.length; i++) {\n\t\tvar trex = this.moov.mvex.trexs[i];\n\t\tif (trex.track_id == id) return trex;\n\t}\n\treturn null;\n}\n\n/* Helper function */\nISOFile.prototype.getTrackById = function(id) {\n\tif (this.moov === undefined) {\n\t\treturn null;\n\t}\n\tfor (var j = 0; j < this.moov.traks.length; j++) {\n\t\tvar trak = this.moov.traks[j];\n\t\tif (trak.tkhd.track_id == id) return trak;\n\t}\n\treturn null;\n}\n// file:src/isofile-item-processing.js\n/* size of the buffers allocated for samples */\nISOFile.prototype.itemsDataSize = 0;\n\nISOFile.prototype.flattenItemInfo = function() {\t\n\tvar items = this.items;\n\tvar entity_groups = this.entity_groups;\n\tvar i, j;\n\tvar item;\n\tvar meta = this.meta;\n\tif (meta === null || meta === undefined) return;\n\tif (meta.hdlr === undefined) return;\n\tif (meta.iinf === undefined) return;\n\tfor (i = 0; i < meta.iinf.item_infos.length; i++) {\n\t\titem = {};\n\t\titem.id = meta.iinf.item_infos[i].item_ID;\n\t\titems[item.id] = item;\n\t\titem.ref_to = [];\n\t\titem.name = meta.iinf.item_infos[i].item_name;\n\t\tif (meta.iinf.item_infos[i].protection_index > 0) {\n\t\t\titem.protection = meta.ipro.protections[meta.iinf.item_infos[i].protection_index-1];\n\t\t}\n\t\tif (meta.iinf.item_infos[i].item_type) {\n\t\t\titem.type = meta.iinf.item_infos[i].item_type;\n\t\t} else {\n\t\t\titem.type = \"mime\";\n\t\t}\n\t\titem.content_type = meta.iinf.item_infos[i].content_type;\n\t\titem.content_encoding = meta.iinf.item_infos[i].content_encoding;\n\t\titem.item_uri_type = meta.iinf.item_infos[i].item_uri_type;\n\t}\n\tif (meta.grpl) {\n\t\tfor (i = 0; i < meta.grpl.boxes.length; i++) {\n\t\t\tentity_group = {};\n\t\t\tentity_group.id = meta.grpl.boxes[i].group_id;\n\t\t\tentity_group.entity_ids = meta.grpl.boxes[i].entity_ids;\n\t\t\tentity_group.type = meta.grpl.boxes[i].type;\n\t\t\tentity_groups[entity_group.id] = entity_group;\n\t\t}\n\t}\n\tif (meta.iloc) {\n\t\tfor(i = 0; i < meta.iloc.items.length; i++) {\n\t\t\tvar offset;\n\t\t\tvar itemloc = meta.iloc.items[i];\n\t\t\titem = items[itemloc.item_ID];\n\t\t\tif (itemloc.data_reference_index !== 0) {\n\t\t\t\tLog.warn(\"Item storage with reference to other files: not supported\");\n\t\t\t\titem.source = meta.dinf.boxes[itemloc.data_reference_index-1];\n\t\t\t}\n\t\t\tswitch(itemloc.construction_method) {\n\t\t\t\tcase 0: // offset into the file referenced by the data reference index\n\t\t\t\tbreak;\n\t\t\t\tcase 1: // offset into the idat box of this meta box\n\t\t\t\tbreak;\n\t\t\t\tcase 2: // offset into another item\n\t\t\t\tLog.warn(\"Item storage with construction_method : not supported\");\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\titem.extents = [];\n\t\t\titem.size = 0;\n\t\t\tfor (j = 0; j < itemloc.extents.length; j++) {\n\t\t\t\titem.extents[j] = {};\n\t\t\t\titem.extents[j].offset = itemloc.extents[j].extent_offset + itemloc.base_offset;\n\t\t\t\tif (itemloc.construction_method == 1) {\n\t\t\t\t\titem.extents[j].offset += meta.idat.start + meta.idat.hdr_size;\n\t\t\t\t}\n\t\t\t\titem.extents[j].length = itemloc.extents[j].extent_length;\n\t\t\t\titem.extents[j].alreadyRead = 0;\n\t\t\t\titem.size += item.extents[j].length;\n\t\t\t}\n\t\t}\n\t}\n\tif (meta.pitm) {\n\t\titems[meta.pitm.item_id].primary = true;\n\t}\n\tif (meta.iref) {\n\t\tfor (i=0; i <meta.iref.references.length; i++) {\n\t\t\tvar ref = meta.iref.references[i];\n\t\t\tfor (j=0; j<ref.references.length; j++) {\n\t\t\t\titems[ref.from_item_ID].ref_to.push({type: ref.type, id: ref.references[j]});\n\t\t\t}\n\t\t}\n\t}\n\tif (meta.iprp) {\n\t\tfor (var k = 0; k < meta.iprp.ipmas.length; k++) {\n\t\t\tvar ipma = meta.iprp.ipmas[k];\n\t\t\tfor (i = 0; i < ipma.associations.length; i++) {\n\t\t\t\tvar association = ipma.associations[i];\n\t\t\t\titem = items[association.id];\n\t\t\t\tif (!item) {\n\t\t\t\t\titem = entity_groups[association.id];\n\t\t\t\t}\n\t\t\t\tif (item) {\n\t\t\t\t\tif (item.properties === undefined) {\n\t\t\t\t\t\titem.properties = {};\n\t\t\t\t\t\titem.properties.boxes = [];\n\t\t\t\t\t}\n\t\t\t\t\tfor (j = 0; j < association.props.length; j++) {\n\t\t\t\t\t\tvar propEntry = association.props[j];\n\t\t\t\t\t\tif (propEntry.property_index > 0 && propEntry.property_index-1 < meta.iprp.ipco.boxes.length) {\n\t\t\t\t\t\t\tvar propbox = meta.iprp.ipco.boxes[propEntry.property_index-1];\n\t\t\t\t\t\t\titem.properties[propbox.type] = propbox;\n\t\t\t\t\t\t\titem.properties.boxes.push(propbox);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nISOFile.prototype.getItem = function(item_id) {\t\n\tvar buffer;\n\tvar item;\n\t\n\tif (!this.meta) {\n\t\treturn null;\n\t}\n\n \titem = this.items[item_id];\n\tif (!item.data && item.size) {\n\t\t/* Not yet fetched */\n\t\titem.data = new Uint8Array(item.size);\n\t\titem.alreadyRead = 0;\n\t\tthis.itemsDataSize += item.size;\n\t\tLog.debug(\"ISOFile\", \"Allocating item #\"+item_id+\" of size \"+item.size+\" (total: \"+this.itemsDataSize+\")\");\n\t} else if (item.alreadyRead === item.size) {\n\t\t/* Already fetched entirely */\n\t\treturn item;\n\t}\n\n\t/* The item has only been partially fetched, we need to check in all buffers to find the remaining extents*/\n\n\tfor (var i = 0; i < item.extents.length; i++) {\n\t\tvar extent = item.extents[i];\n\t\tif (extent.alreadyRead === extent.length) {\n\t\t\tcontinue;\n\t\t} else {\n\t\t\tvar index =\tthis.stream.findPosition(true, extent.offset + extent.alreadyRead, false);\n\t\t\tif (index > -1) {\n\t\t\t\tbuffer = this.stream.buffers[index];\n\t\t\t\tvar lengthAfterStart = buffer.byteLength - (extent.offset + extent.alreadyRead - buffer.fileStart);\n\t\t\t\tif (extent.length - extent.alreadyRead <= lengthAfterStart) {\n\t\t\t\t\t/* the (rest of the) extent is entirely contained in this buffer */\n\n\t\t\t\t\tLog.debug(\"ISOFile\",\"Getting item #\"+item_id+\" extent #\"+i+\" data (alreadyRead: \"+extent.alreadyRead+\n\t\t\t\t\t\t\" offset: \"+(extent.offset+extent.alreadyRead - buffer.fileStart)+\" read size: \"+(extent.length - extent.alreadyRead)+\n\t\t\t\t\t\t\" full extent size: \"+extent.length+\" full item size: \"+item.size+\")\");\n\n\t\t\t\t\tDataStream.memcpy(item.data.buffer, item.alreadyRead, \n\t\t\t\t\t                  buffer, extent.offset+extent.alreadyRead - buffer.fileStart, extent.length - extent.alreadyRead);\n\n\t\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\t\tbuffer.usedBytes += extent.length - extent.alreadyRead;\n\t\t\t\t\tthis.stream.logBufferLevel();\n\n\t\t\t\t\titem.alreadyRead += (extent.length - extent.alreadyRead);\n\t\t\t\t\textent.alreadyRead = extent.length;\n\t\t\t\t} else {\n\t\t\t\t\t/* the sample does not end in this buffer */\n\n\t\t\t\t\tLog.debug(\"ISOFile\",\"Getting item #\"+item_id+\" extent #\"+i+\" partial data (alreadyRead: \"+extent.alreadyRead+\" offset: \"+\n\t\t\t\t\t\t(extent.offset+extent.alreadyRead - buffer.fileStart)+\" read size: \"+lengthAfterStart+\n\t\t\t\t\t\t\" full extent size: \"+extent.length+\" full item size: \"+item.size+\")\");\n\n\t\t\t\t\tDataStream.memcpy(item.data.buffer, item.alreadyRead, \n\t\t\t\t\t                  buffer, extent.offset+extent.alreadyRead - buffer.fileStart, lengthAfterStart);\n\t\t\t\t\textent.alreadyRead += lengthAfterStart;\n\t\t\t\t\titem.alreadyRead += lengthAfterStart;\n\n\t\t\t\t\t/* update the number of bytes used in this buffer and check if it needs to be removed */\n\t\t\t\t\tbuffer.usedBytes += lengthAfterStart;\n\t\t\t\t\tthis.stream.logBufferLevel();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\tif (item.alreadyRead === item.size) {\n\t\t/* fetched entirely */\n\t\treturn item;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n/* Release the memory used to store the data of the item */\nISOFile.prototype.releaseItem = function(item_id) {\t\n\tvar item = this.items[item_id];\n\tif (item.data) {\n\t\tthis.itemsDataSize -= item.size;\n\t\titem.data = null;\n\t\titem.alreadyRead = 0;\n\t\tfor (var i = 0; i < item.extents.length; i++) {\n\t\t\tvar extent = item.extents[i];\n\t\t\textent.alreadyRead = 0;\n\t\t}\n\t\treturn item.size;\n\t} else {\n\t\treturn 0;\n\t}\n}\n\n\nISOFile.prototype.processItems = function(callback) {\n\tfor(var i in this.items) {\n\t\tvar item = this.items[i];\n\t\tthis.getItem(item.id);\n\t\tif (callback && !item.sent) {\n\t\t\tcallback(item);\n\t\t\titem.sent = true;\n\t\t\titem.data = null;\n\t\t}\n\t}\n}\n\nISOFile.prototype.hasItem = function(name) {\n\tfor(var i in this.items) {\n\t\tvar item = this.items[i];\n\t\tif (item.name === name) {\n\t\t\treturn item.id;\n\t\t}\n\t}\n\treturn -1;\n}\n\nISOFile.prototype.getMetaHandler = function() {\n\tif (!this.meta) {\n\t\treturn null;\n\t} else {\n\t\treturn this.meta.hdlr.handler;\t\t\n\t}\n}\n\nISOFile.prototype.getPrimaryItem = function() {\n\tif (!this.meta || !this.meta.pitm) {\n\t\treturn null;\n\t} else {\n\t\treturn this.getItem(this.meta.pitm.item_id);\n\t}\n}\n\nISOFile.prototype.itemToFragmentedTrackFile = function(_options) {\n\tvar options = _options || {};\n\tvar item = null;\n\tif (options.itemId) {\n\t\titem = this.getItem(options.itemId);\n\t} else {\n\t\titem = this.getPrimaryItem();\n\t}\n\tif (item == null) return null;\n\n\tvar file = new ISOFile();\n\tfile.discardMdatData = false;\n\t// assuming the track type is the same as the item type\n\tvar trackOptions = { type: item.type, description_boxes: item.properties.boxes};\n\tif (item.properties.ispe) {\n\t\ttrackOptions.width = item.properties.ispe.image_width;\n\t\ttrackOptions.height = item.properties.ispe.image_height;\n\t}\n\tvar trackId = file.addTrack(trackOptions);\n\tif (trackId) {\n\t\tfile.addSample(trackId, item.data);\n\t\treturn file;\n\t} else {\n\t\treturn null;\n\t}\n}\n\n// file:src/isofile-write.js\n/* Rewrite the entire file */\nISOFile.prototype.write = function(outstream) {\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tthis.boxes[i].write(outstream);\n\t}\n}\n\nISOFile.prototype.createFragment = function(track_id, sampleNumber, stream_) {\n\tvar trak = this.getTrackById(track_id);\n\tvar sample = this.getSample(trak, sampleNumber);\n\tif (sample == null) {\n\t\tthis.setNextSeekPositionFromSample(trak.samples[sampleNumber]);\n\t\treturn null;\n\t}\n\t\n\tvar stream = stream_ || new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\n\tvar moof = this.createSingleSampleMoof(sample);\n\tmoof.write(stream);\n\n\t/* adjusting the data_offset now that the moof size is known*/\n\tmoof.trafs[0].truns[0].data_offset = moof.size+8; //8 is mdat header\n\tLog.debug(\"MP4Box\", \"Adjusting data_offset with new value \"+moof.trafs[0].truns[0].data_offset);\n\tstream.adjustUint32(moof.trafs[0].truns[0].data_offset_position, moof.trafs[0].truns[0].data_offset);\n\t\t\n\tvar mdat = new BoxParser.mdatBox();\n\tmdat.data = sample.data;\n\tmdat.write(stream);\n\treturn stream;\n}\n\n/* Modify the file and create the initialization segment */\nISOFile.writeInitializationSegment = function(ftyp, moov, total_duration, sample_duration) {\n\tvar i;\n\tvar index;\n\tvar mehd;\n\tvar trex;\n\tvar box;\n\tLog.debug(\"ISOFile\", \"Generating initialization segment\");\n\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tftyp.write(stream);\n\t\n\t/* we can now create the new mvex box */\n\tvar mvex = moov.add(\"mvex\");\n\tif (total_duration) {\n\t\tmvex.add(\"mehd\").set(\"fragment_duration\", total_duration);\n\t}\n\tfor (i = 0; i < moov.traks.length; i++) {\n\t\tmvex.add(\"trex\").set(\"track_id\", moov.traks[i].tkhd.track_id)\n\t\t\t\t\t\t.set(\"default_sample_description_index\", 1)\n\t\t\t\t\t\t.set(\"default_sample_duration\", sample_duration)\n\t\t\t\t\t\t.set(\"default_sample_size\", 0)\n\t\t\t\t\t\t.set(\"default_sample_flags\", 1<<16)\n\t}\n\tmoov.write(stream);\n\n\treturn stream.buffer;\n\n}\n\nISOFile.prototype.save = function(name) {\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n\tstream.save(name);\t\n}\n\nISOFile.prototype.getBuffer = function() {\n\tvar stream = new DataStream();\n\tstream.endianness = DataStream.BIG_ENDIAN;\n\tthis.write(stream);\n\treturn stream.buffer;\n}\n\nISOFile.prototype.initializeSegmentation = function() {\n\tvar i;\n\tvar j;\n\tvar box;\n\tvar initSegs;\n\tvar trak;\n\tvar seg;\n\tif (this.onSegment === null) {\n\t\tLog.warn(\"MP4Box\", \"No segmentation callback set!\");\n\t}\n\tif (!this.isFragmentationInitialized) {\n\t\tthis.isFragmentationInitialized = true;\t\t\n\t\tthis.nextMoofNumber = 0;\n\t\tthis.resetTables();\n\t}\t\n\tinitSegs = [];\t\n\tfor (i = 0; i < this.fragmentedTracks.length; i++) {\n\t\tvar moov = new BoxParser.moovBox();\n\t\tmoov.mvhd = this.moov.mvhd;\n\t    moov.boxes.push(moov.mvhd);\n\t\ttrak = this.getTrackById(this.fragmentedTracks[i].id);\n\t\tmoov.boxes.push(trak);\n\t\tmoov.traks.push(trak);\n\t\tseg = {};\n\t\tseg.id = trak.tkhd.track_id;\n\t\tseg.user = this.fragmentedTracks[i].user;\n\t\tseg.buffer = ISOFile.writeInitializationSegment(this.ftyp, moov, (this.moov.mvex && this.moov.mvex.mehd ? this.moov.mvex.mehd.fragment_duration: undefined), (this.moov.traks[i].samples.length>0 ? this.moov.traks[i].samples[0].duration: 0));\n\t\tinitSegs.push(seg);\n\t}\n\treturn initSegs;\n}\n\n// file:src/box-print.js\n/* \n * Copyright (c) Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nBoxParser.Box.prototype.printHeader = function(output) {\n\tthis.size += 8;\n\tif (this.size > MAX_SIZE) {\n\t\tthis.size += 8;\n\t}\n\tif (this.type === \"uuid\") {\n\t\tthis.size += 16;\n\t}\n\toutput.log(output.indent+\"size:\"+this.size);\n\toutput.log(output.indent+\"type:\"+this.type);\n}\n\nBoxParser.FullBox.prototype.printHeader = function(output) {\n\tthis.size += 4;\n\tBoxParser.Box.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"version:\"+this.version);\n\toutput.log(output.indent+\"flags:\"+this.flags);\n}\n\nBoxParser.Box.prototype.print = function(output) {\n\tthis.printHeader(output);\n}\n\nBoxParser.ContainerBox.prototype.print = function(output) {\n\tthis.printHeader(output);\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tvar prev_indent = output.indent;\n\t\t\toutput.indent += \" \";\n\t\t\tthis.boxes[i].print(output);\n\t\t\toutput.indent = prev_indent;\n\t\t}\n\t}\n}\n\nISOFile.prototype.print = function(output) {\n\toutput.indent = \"\";\n\tfor (var i=0; i<this.boxes.length; i++) {\n\t\tif (this.boxes[i]) {\n\t\t\tthis.boxes[i].print(output);\n\t\t}\n\t}\t\n}\n\nBoxParser.mvhdBox.prototype.print = function(output) {\n\tBoxParser.FullBox.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"creation_time: \"+this.creation_time);\n\toutput.log(output.indent+\"modification_time: \"+this.modification_time);\n\toutput.log(output.indent+\"timescale: \"+this.timescale);\n\toutput.log(output.indent+\"duration: \"+this.duration);\n\toutput.log(output.indent+\"rate: \"+this.rate);\n\toutput.log(output.indent+\"volume: \"+(this.volume>>8));\n\toutput.log(output.indent+\"matrix: \"+this.matrix.join(\", \"));\n\toutput.log(output.indent+\"next_track_id: \"+this.next_track_id);\n}\n\nBoxParser.tkhdBox.prototype.print = function(output) {\n\tBoxParser.FullBox.prototype.printHeader.call(this, output);\n\toutput.log(output.indent+\"creation_time: \"+this.creation_time);\n\toutput.log(output.indent+\"modification_time: \"+this.modification_time);\n\toutput.log(output.indent+\"track_id: \"+this.track_id);\n\toutput.log(output.indent+\"duration: \"+this.duration);\n\toutput.log(output.indent+\"volume: \"+(this.volume>>8));\n\toutput.log(output.indent+\"matrix: \"+this.matrix.join(\", \"));\n\toutput.log(output.indent+\"layer: \"+this.layer);\n\toutput.log(output.indent+\"alternate_group: \"+this.alternate_group);\n\toutput.log(output.indent+\"width: \"+this.width);\n\toutput.log(output.indent+\"height: \"+this.height);\n}// file:src/mp4box.js\n/*\n * Copyright (c) 2012-2013. Telecom ParisTech/TSI/MM/GPAC Cyril Concolato\n * License: BSD-3-Clause (see LICENSE file)\n */\nvar MP4Box = {};\n\nMP4Box.createFile = function (_keepMdatData, _stream) {\n\t/* Boolean indicating if bytes containing media data should be kept in memory */\n\tvar keepMdatData = (_keepMdatData !== undefined ? _keepMdatData : true);\n\tvar file = new ISOFile(_stream);\n\tfile.discardMdatData = (keepMdatData ? false : true);\n\treturn file;\n}\n\nif (typeof exports !== 'undefined') {\n\texports.createFile = MP4Box.createFile;\n}\n","import MP4Box, { Log } from 'mp4box';\r\n\r\nlet Logs = false;\r\nexport function setLogEnabled(enabled) {\r\n    Logs = !!enabled; \r\n}\r\n\r\n// 异常类\r\nexport class NotSupportError extends Error {\r\n    constructor(message) {\r\n        super(message);\r\n        this.name = \"NotSupportError\";\r\n    }\r\n}\r\n\r\nexport function version() {\r\n    return \"5.6.2 Paralogism\";\r\n}\r\n\r\n/**\r\n * 播放MP4视频的简化封装\r\n * @param {HTMLVideoElement} video - 视频元素\r\n * @param {function(start: number, end: number, abort?: AbortController): Promise<ArrayBuffer>} fileReader - 文件读取函数\r\n * @param {Number} bs - 缓冲区大小，默认为1MB\r\n * @param {function(end_of_stream_func)|null} [onVideoEnd] - 视频结束时的回调函数，默认为null\r\n * @returns {Promise<function()>} - 清理函数\r\n */\r\nexport async function PlayMp4Video(video, fileReader, bs = 1000000, onVideoEnd = null) {\r\n    let sb, cleaned;\r\n    // 如果浏览器不支持 MediaSource，这可怎么办呢？\r\n    // 我们直接抛出异常，让调用者自行处理。\r\n    if (Reflect.has(globalThis, 'MediaSource') == false)\r\n        throw new NotSupportError(\"MediaSource is not supported in this browser or context.\");\r\n\r\n    const mp4boxfile = MP4Box.createFile();\r\n    /**\r\n     * @type {MediaSource}\r\n     */\r\n    let ms = null;\r\n    const activeSourceBuffers = new Map(); // 跟踪活动的SourceBuffer\r\n    let initSegs;\r\n    let nextLoadShouldPlay = false;\r\n\r\n    let resolve_ready, reject_ready;\r\n    const ready = new Promise((resolve, reject) => {\r\n        resolve_ready = resolve;\r\n        reject_ready = reject;\r\n    });\r\n\r\n    const createNewMs = async function createNewMs() {\r\n        if (createNewMs.request) return;\r\n        if (Logs) console.log(\"A new request to create a new MediaSource has been issued.\");\r\n        createNewMs.request = true;\r\n\r\n        return await new Promise((resolve, reject) => {\r\n            ms = new MediaSource();\r\n            video.src = URL.createObjectURL(ms);\r\n            ms.addEventListener('sourceopen', () => {\r\n                if (Logs) console.log(\"MediaSource opened successfully\");\r\n                resolve();\r\n                \r\n                setTimeout(() => {\r\n                    createNewMs.request = false;\r\n                }, 1000); // 1秒后释放请求\r\n            }, { once: true });\r\n            ms.addEventListener('error', reject);\r\n\r\n            setTimeout(reject, 10000, new Error(\"Timeout waiting for sourceopen\"));\r\n        });\r\n    }\r\n\r\n    await createNewMs();\r\n\r\n    let loadSegmentId = 1;\r\n\r\n    const addBuffer = function addBuffer(mp4track) {\r\n        var track_id = mp4track.id;\r\n        var codec = mp4track.codec;\r\n        var mime = 'video/mp4; codecs=\\\"' + codec + '\\\"';\r\n        var trackDefault;\r\n        var trackDefaultSupport = (typeof TrackDefault !== \"undefined\");\r\n        if (MediaSource.isTypeSupported(mime)) {\r\n            sb = ms.addSourceBuffer(mime);\r\n            activeSourceBuffers.set(track_id, sb); // 存储SourceBuffer\r\n            if (trackDefaultSupport) {\r\n                sb.trackDefaults = new TrackDefaultList([trackDefault]);\r\n            }\r\n            sb.addEventListener(\"error\", function (e) {\r\n                if (Logs) console.error(\"MSE SourceBuffer #\", track_id, e);\r\n            });\r\n            sb.ms = ms;\r\n            sb.id = track_id;\r\n            mp4boxfile.setSegmentOptions(track_id, sb, { nbSamples: 10 });\r\n            sb.pendingAppends = [];\r\n            resolve_ready();\r\n        } else {\r\n            if (Logs) console.error(\"ms not supported\", mime);\r\n            reject_ready(new NotSupportError(\"Video codec is not supported by the browser\"));\r\n        }\r\n    }\r\n    const onInitAppended = function onInitAppended(e) {\r\n        const sb = e.target;\r\n        if (sb.ms.readyState === \"open\") {\r\n            sb.sampleNum = 0;\r\n            sb.removeEventListener('updateend', onInitAppended);\r\n            sb.addEventListener('updateend', onUpdateEnd.bind(sb, true, true));\r\n            /* In case there are already pending buffers we call onUpdateEnd to start appending them*/\r\n            if (Logs) console.log(\"Application\", \"Initialization appended\", sb.segmentIndex, sb.pendingAppends.length)\r\n            onUpdateEnd.call(sb, false, true);\r\n            sb.ms.pendingInits--;\r\n        }\r\n    }\r\n    const onUpdateEnd = function onUpdateEnd(isNotInit, isEndOfAppend) {\r\n        if (isEndOfAppend === true) {\r\n            if (isNotInit === true) {\r\n                // 浏览器会自动清理资源。我们不需要手动清理\r\n            }\r\n            if (this.sampleNum) {\r\n                mp4boxfile.releaseUsedSamples(this.id, this.sampleNum);\r\n                delete this.sampleNum;\r\n            }\r\n            if (this.is_last) try {\r\n                if (ms.readyState === \"open\") {\r\n                    onVideoEnd?.(() => ms.endOfStream());\r\n                    if (onVideoEnd) onVideoEnd = null;\r\n                }\r\n                // 处理视频流结束，用户往回seek的情况\r\n            } catch {}\r\n        }\r\n        if (this.updating === false && this.pendingAppends.length > 0) {\r\n            if (this.ms.readyState !== \"open\") {\r\n                return;\r\n            }\r\n            var obj = this.pendingAppends.shift();\r\n            this.sampleNum = obj.sampleNum;\r\n            this.is_last = obj.is_last;\r\n            try {\r\n                // if (Logs) console.debug(\"onUpdateEnd:: Appending buffer\");  // DO NOT log here -- too many logs (debug only)\r\n                this.appendBuffer(obj.buffer); \r\n                if (nextLoadShouldPlay) {\r\n                    video.play();\r\n                    nextLoadShouldPlay = false;\r\n                }\r\n            }\r\n            catch (e) {\r\n                if (e.name === 'QuotaExceededError') {\r\n                    this.pendingAppends.splice(0, 0, obj);\r\n                    setTimeout(() => {\r\n                        onUpdateEnd.apply(this, arguments);\r\n                    }, 1000);\r\n                }\r\n                else if (Logs) console.error('[player]', 'unexpected error:', e);\r\n            }\r\n        }\r\n    }\r\n\r\n    mp4boxfile.onMoovStart = function () {\r\n        if (Logs) console.log(\"Application\", \"Starting to parse movie information\");\r\n    }\r\n    mp4boxfile.onReady = function (info) {\r\n        ms.movieInfo = info;\r\n        if (info.isFragmented) {\r\n            ms.duration = ms.original_duration = info.fragment_duration / info.timescale;\r\n        } else {\r\n            ms.duration = ms.original_duration = info.duration / info.timescale;\r\n        }\r\n\r\n        if (info) {\r\n            for (const track of info.tracks) addBuffer(track);\r\n            initSegs = mp4boxfile.initializeSegmentation();\r\n            for (let i = 0; i < initSegs.length; i++) {\r\n                const sb = initSegs[i].user;\r\n                if (i === 0) {\r\n                    sb.ms.pendingInits = 0;\r\n                }\r\n                sb.addEventListener(\"updateend\", onInitAppended);\r\n                if (Logs) console.debug(\"Application\", \"Appending source buffer\")\r\n                sb.appendBuffer(initSegs[i].buffer);\r\n                sb.segmentIndex = 0;\r\n                sb.ms.pendingInits++;\r\n            }\r\n        }\r\n    };\r\n    mp4boxfile.onSegment = function (id, user, buffer, sampleNum, is_last) {\r\n        const sb = user;\r\n        sb.segmentIndex++;\r\n        sb.pendingAppends.push({ id: id, buffer: buffer, sampleNum: sampleNum, is_last: is_last });\r\n        onUpdateEnd.call(sb, true, false);\r\n    };\r\n    mp4boxfile.onError = function () {\r\n        reject_ready(new Error(\"Error in mp4boxfile\", {\r\n            data: arguments\r\n        }));\r\n    };\r\n    mp4boxfile.start();\r\n\r\n    // 监听seek事件\r\n    function doSeek() {\r\n        // antiTik\r\n        const time = new Date().getTime();\r\n        if (time - doSeek.antiTik < 100) return;\r\n        doSeek.antiTik = time;\r\n        // antiTik end\r\n\r\n        let i, start, end;\r\n        for (i = 0; i < video.buffered.length; i++) {\r\n            start = video.buffered.start(i);\r\n            end = video.buffered.end(i);\r\n            if (video.currentTime >= start && video.currentTime <= (end - Math.ceil(11 * video.playbackRate))) {\r\n                return;\r\n            }\r\n        }\r\n        /* Chrome fires twice the seeking event with the same value */\r\n        const seek_info = mp4boxfile.seek(video.currentTime, true);\r\n        const r = loadSegment(seek_info.offset, seek_info.offset + bs)\r\n        video.lastSeekTime = video.currentTime;\r\n        return r\r\n    }\r\n    doSeek.antiTik = 0;\r\n    function onSeeked() {\r\n        if (video.lastSeekTime !== video.currentTime) {\r\n            doSeek();\r\n        }\r\n    }\r\n    let lastHadPaused = false;\r\n    function onTimeUpdate() {\r\n        if (isNaN(onTimeUpdate.last_time) || (video.currentTime < onTimeUpdate.last_time) || ((video.currentTime - onTimeUpdate.last_time) > Math.ceil(10 * video.playbackRate))) {\r\n            doSeek();\r\n            onTimeUpdate.last_time = video.currentTime;\r\n            lastHadPaused = false;\r\n        }\r\n    }\r\n    video.addEventListener('seeked', onSeeked);\r\n    video.addEventListener('timeupdate', onTimeUpdate);\r\n\r\n    // 检查视频结束\r\n    function onWaiting() {\r\n        if (ms.original_duration - video.currentTime > 1) return;\r\n        if (Logs) console.log(\"Video ended\");\r\n        if (video.loop || lastHadPaused) {\r\n            video.currentTime = 0;\r\n            doSeek();\r\n            nextLoadShouldPlay = true;\r\n            lastHadPaused = false;\r\n        } else {\r\n            // 使得视频在结束的时候自动暂停\r\n            video.pause();\r\n            lastHadPaused = true;\r\n        }\r\n    }\r\n    video.addEventListener('waiting', onWaiting);\r\n\r\n    // 添加清理函数\r\n    const cleanup = () => {\r\n        cleaned = true;\r\n        // 移除所有事件监听器\r\n        video.removeEventListener('seeked', onSeeked);\r\n        video.removeEventListener('timeupdate', onTimeUpdate);\r\n        video.removeEventListener('waiting', onWaiting);\r\n\r\n        // 清理SourceBuffer\r\n        activeSourceBuffers.forEach((sb, trackId) => {\r\n            try {\r\n                if (sb.updating) {\r\n                    sb.abort();\r\n                }\r\n                if (ms.readyState === 'open') {\r\n                    ms.removeSourceBuffer(sb);\r\n                }\r\n                sb.removeEventListener('updateend', onUpdateEnd);\r\n                mp4boxfile.releaseUsedSamples(trackId, sb.sampleNum)\r\n            } catch (e) {\r\n                console.warn(\"Error cleaning up SourceBuffer:\", e);\r\n            }\r\n        });\r\n        activeSourceBuffers.clear();\r\n\r\n        // 清理MP4Box资源\r\n        if (mp4boxfile) {\r\n            mp4boxfile.flush();\r\n            mp4boxfile.onSegment = null;\r\n            mp4boxfile.onReady = null;\r\n            mp4boxfile.onMoovStart = null;\r\n            mp4boxfile.stop();\r\n        }\r\n\r\n        URL.revokeObjectURL(video.src);\r\n        video.src = 'data:null/null,null';\r\n\r\n        try { loadSegment.ab?.abort?.(); } catch { }\r\n    };\r\n\r\n    async function loadSegment(start, end, id = null, depth = 0) {\r\n        if (id == null && Logs) console.log('loadSegment start; id will be', loadSegmentId + 1);\r\n        if (id == null) {\r\n            id = (++loadSegmentId);\r\n            loadSegment.ab?.abort?.();\r\n            loadSegment.ab = null;\r\n        }\r\n        else if (id !== loadSegmentId) {\r\n            if (Logs) console.log('loadSegment return, reason: another request has been issued, current id=', id, '/another id=', loadSegmentId);\r\n            return true;\r\n        }\r\n        if (cleaned) return -1;\r\n        if (depth > 64) {\r\n            if (Logs) console.log('loadSegment return, reason: max depth has been reached');\r\n            return 3;\r\n        }\r\n\r\n        const controller = new AbortController();\r\n        loadSegment.ab = controller;\r\n        try {\r\n            const blob = new Blob([await fileReader(start, end, controller)]);\r\n            if (id !== loadSegmentId) {\r\n                if (Logs) console.log('loadSegment return, reason: since last operation (data fetched) another request has been issued, current id=', id, '/another id=', loadSegmentId);\r\n                return 2;\r\n            }\r\n            if (!blob.size) {\r\n                const ab = new ArrayBuffer(0);\r\n                ab.fileStart = start;\r\n                mp4boxfile.appendBuffer(ab, true);\r\n                mp4boxfile.flush();\r\n                if (Logs) console.log('loadSegment return, reason: EOF; params=', start, end, id, depth);\r\n                return 1;\r\n            }\r\n            const buffer = await blob.arrayBuffer();\r\n            buffer.fileStart = start;\r\n            const mstart = mp4boxfile.appendBuffer(buffer, !!blob.eof);\r\n            mp4boxfile.flush();\r\n\r\n            if (mstart) return await loadSegment(mstart, mstart + bs, id, ++depth);\r\n            else if (blob.eof) return false;\r\n\r\n            if (Logs) console.log('loadSegment return, reason: no next start position has specified');\r\n        } catch {\r\n            if (Logs) console.log('loadSegment aborted: id=', id);\r\n        }\r\n        return null;\r\n    }\r\n    queueMicrotask(async () => {\r\n        const r = await loadSegment(0, bs);\r\n        if (Logs) console.log('loadSegment=', r);\r\n    });\r\n\r\n    cleanup.getMediaSource = () => {\r\n        return ms;\r\n    };\r\n    setTimeout(() => {\r\n        reject_ready(new Error(\"Timeout waiting for ready\"));\r\n    }, 30000);\r\n    try {\r\n        await ready;\r\n    } catch (e) {\r\n        cleanup();\r\n        throw e;\r\n    }\r\n    return cleanup;\r\n}\r\n\r\n"],"names":["Log","start","LOG_LEVEL_ERROR","LOG_LEVEL_WARNING","LOG_LEVEL_INFO","LOG_LEVEL_DEBUG","log_level","logObject","level","module","msg","duration","_timescale","neg","pad","number","length","str","a","timescale","duration_sec","hours","minutes","msec","ranges","i","exports","MP4BoxStream","arrayBuffer","pos","npos","size","signed","res","s","arr","b","DataStream","byteOffset","endianness","extra","req","blen","buf","src","dst","v","e","dstOffset","srcOffset","byteLength","dstU8","srcU8","array","arrayIsLittleEndian","littleEndian","u8","j","k","tmp","uint8arr","encoding","len","MAX_SIZE","filename","blob","url","offset","lengthOverride","structDefinition","struct","t","tp","charset","ta","h","position","value","MultiBufferStream","buffer","firstBuffer","buffer1","buffer2","newLength","smallB","ab","to_add","info","used","total","range","bufferedString","log","next_buffer","oldLength","oldUsedBytes","oldFileStart","fromStart","filePosition","markAsUsed","abuffer","index","inputindex","currentBuf","nextBuf","nbBytes","MPEG4DescriptorParser","ES_DescrTag","DecoderConfigDescrTag","DecSpecificInfoTag","SLConfigDescrTag","descTagToName","tag","that","classes","stream","desc","byteRead","_tag","_size","l","dcd","dsi","audioObjectType","BoxParser","box","boxes","_type","_name","_uuid","type","name","uuid","hdr_size","parseMethod","subBoxNames","nbSubBoxes","mediaType","isFullBox","isContainerBox","prop","_prop","hex16","hex","headerOnly","parentSize","diff","box_type","ret","chars","compressorname_length","large_size","FieldLength","aux_subtype_length","configOBUs_length","printPS","ps","nalu","byte","toparse","flags","component_type","entry_count","tmp_byte1","tmp_byte2","tmp_byte3","tmp_16","ind_sub","BLOCKTYPE_MASK","LASTMETADATABLOCKFLAG_MASK","boxesFound","knownBlockTypes","flagAndType","entry","message_size","entity_id","esd_data","esd_parser","tmp_byte","nalu_array","numOfArrays","numNalus","item_count","item","extent_count","extent","item_assoc","association_count","p","count","ColorPoint","x","y","sample_count","datasize","roll_count","remaining","numReferences","dependencyInfo","Pixel","row","col","ref","tmp_32","subsegment_count","subsegment","range_count","entryCount","delta","tmp32","subsample_count","sampleInfo","subsample","readBytes","number_of_entries","absolute_time","absolute_duration","bitReader","strm","num_bits","cnstr1","cnstr2","val","VVC_NALU_OPI","VVC_NALU_DEC_PARAM","num_of_arrays","d","padding","baseCodec","reversed","hasByte","constraint_string","bytes","last_nonzero","base32_chars","held_bits","num_held_bits","oti","bitDepth","bitdepth","constant","UINT32_MAX","samples","m","box_a","box_b","VTTin4Parser","data","cues","cue","startTime","endTime","n","width","z","secToTimestamp","insec","ms","string","cueIn4","XMLSubtitlein4Parser","sample","Textin4Parser","textString","ISOFile","id","user","options","trak","fragTrack","extractTrack","parseBoxHeadersOnly","last","nextFileStart","movie","track","sample_desc","_1904","fragTrak","result","extractTrak","returnEarly","track_id","sampleNum","time","useRap","seek_offset","rap_seek_sample_num","seek_sample_num","moov","trak_seek_info","seek_info","box_index","a_box","b_box","merged","found","_options","mdia","minf","sample_description_entry","media_type","codes","avcC","hvcC","stbl","stream_","moof","sample_flags","traf","stco","stsc","stsz","stts","ctts","stss","sbgps","trak_sgpds","traf_sgpds","sample_group_info","sample_group_key","SampleGroupInfo","_parameter","_sbgp","sample_number","sample_groups_info","description","sdtp","stsd","subs","sgpds","stdp","chunk_run_index","chunk_index","last_chunk_in_run","offset_in_chunk","last_sample_in_chunk","last_sample_in_stts_run","stts_run_index","last_sample_in_ctts_run","ctts_run_index","last_stss_index","subs_entry_index","last_subs_sample_index","default_sample_description_index","default_sample_duration","default_sample_size","default_sample_flags","last_run_position","trex","trun","bdop","dbim","dop","bdo","sample_index","lengthAfterStart","codecs","items","entity_groups","meta","itemloc","ipma","association","propEntry","propbox","item_id","callback","file","trackOptions","trackId","outstream","sampleNumber","mdat","ftyp","total_duration","sample_duration","mvex","initSegs","seg","output","prev_indent","MP4Box","_keepMdatData","_stream","keepMdatData","Logs","NotSupportError","message","version","PlayMp4Video","video","fileReader","bs","onVideoEnd","sb","cleaned","mp4boxfile","activeSourceBuffers","nextLoadShouldPlay","resolve_ready","reject_ready","ready","resolve","reject","createNewMs","loadSegmentId","addBuffer","mp4track","codec","mime","trackDefault","trackDefaultSupport","onInitAppended","onUpdateEnd","isNotInit","isEndOfAppend","obj","is_last","doSeek","end","r","loadSegment","onSeeked","lastHadPaused","onTimeUpdate","onWaiting","cleanup","depth","controller","mstart"],"mappings":"uJAKA,IAAIA,EAAO,UAAW,CACpB,IAAIC,EAAQ,IAAI,KACZC,EAAmB,EACnBC,EAAqB,EACrBC,EAAmB,EACnBC,EAAmB,EACnBC,EAAYJ,EACZK,EAAY,CACf,YAAc,SAASC,EAAO,CACzBA,GAAS,KAAK,MAAOF,EAAYD,EAC5BG,GAAS,KAAK,KAAMF,EAAYF,EAChCI,GAAS,KAAK,KAAMF,EAAYH,GAChCK,GAAS,KAAK,MAAOF,EAAYJ,EAE1C,EACD,MAAQ,SAASO,EAAQC,EAAK,CACzB,QAAQ,QAAU,SACrB,QAAQ,MAAQ,QAAQ,KAErBL,GAAmBC,GACtB,QAAQ,MAAM,IAAIN,EAAI,kBAAkB,IAAI,KAAOC,EAAM,GAAI,EAAE,IAAI,IAAIQ,EAAO,IAAIC,CAAG,CAEtF,EACD,IAAM,SAASD,EAAQC,EAAK,CAC3B,KAAK,MAAMD,EAAO,GAAG,CACrB,EACD,KAAO,SAASA,EAAQC,EAAK,CACxBN,GAAkBE,GACrB,QAAQ,KAAK,IAAIN,EAAI,kBAAkB,IAAI,KAAOC,EAAM,GAAI,EAAE,IAAI,IAAIQ,EAAO,IAAIC,CAAG,CAErF,EACD,KAAO,SAASD,EAAQC,EAAK,CACxBP,GAAqBG,GACxB,QAAQ,KAAK,IAAIN,EAAI,kBAAkB,IAAI,KAAOC,EAAM,GAAI,EAAE,IAAI,IAAIQ,EAAO,IAAIC,CAAG,CAErF,EACD,MAAQ,SAASD,EAAQC,EAAK,CACzBR,GAAmBI,GACtB,QAAQ,MAAM,IAAIN,EAAI,kBAAkB,IAAI,KAAOC,EAAM,GAAI,EAAE,IAAI,IAAIQ,EAAO,IAAIC,CAAG,CAE1F,CACG,EACD,OAAOH,CACT,EAAK,EAGLP,EAAI,kBAAoB,SAASW,EAAUC,EAAY,CACtD,IAAIC,EAEJ,SAASC,EAAIC,EAAQC,EAAQ,CAG5B,QAFIC,EAAM,GAAKF,EACXG,EAAID,EAAI,MAAM,GAAG,EACdC,EAAE,CAAC,EAAE,OAASF,GACpBE,EAAE,CAAC,EAAI,IAAMA,EAAE,CAAC,EAEjB,OAAOA,EAAE,KAAK,GAAG,CACnB,CACKP,EAAW,GACdE,EAAM,GACNF,EAAW,CAACA,GAEZE,EAAM,GAEP,IAAIM,EAAYP,GAAc,EAC1BQ,EAAeT,EAASQ,EACxBE,EAAQ,KAAK,MAAMD,EAAa,IAAI,EACxCA,GAAgBC,EAAQ,KACxB,IAAIC,EAAU,KAAK,MAAMF,EAAa,EAAE,EACxCA,GAAgBE,EAAU,GAC1B,IAAIC,EAAOH,EAAa,IACxB,OAAAA,EAAe,KAAK,MAAMA,CAAY,EACtCG,GAAQH,EAAa,IACrBG,EAAO,KAAK,MAAMA,CAAI,GACdV,EAAM,IAAK,IAAIQ,EAAM,IAAIP,EAAIQ,EAAQ,CAAC,EAAE,IAAIR,EAAIM,EAAa,CAAC,EAAE,IAAIN,EAAIS,EAAK,CAAC,CACvF,EAGAvB,EAAI,YAAc,SAASwB,EAAQ,CAClC,IAAIR,EAASQ,EAAO,OACpB,GAAIR,EAAS,EAAG,CAEf,QADIC,EAAM,GACDQ,EAAI,EAAGA,EAAIT,EAAQS,IACtBA,EAAI,IAAGR,GAAO,KAClBA,GAAO,IAAIjB,EAAI,kBAAkBwB,EAAO,MAAMC,CAAC,CAAC,EAAG,IAAIzB,EAAI,kBAAkBwB,EAAO,IAAIC,CAAC,CAAC,EAAE,IAE9F,OAAOR,CACT,KACE,OAAO,SAET,EAGCS,MAAc1B,EAGf,IAAI2B,EAAe,SAASC,EAAa,CACvC,GAAIA,aAAuB,YACzB,KAAK,OAASA,EACd,KAAK,SAAW,IAAI,SAASA,CAAW,MAExC,MAAO,wBAET,KAAK,SAAW,CACjB,EAKDD,EAAa,UAAU,YAAc,UAAW,CAC9C,OAAO,KAAK,QACd,EAEAA,EAAa,UAAU,eAAiB,UAAW,CACjD,OAAO,KAAK,OAAO,UACrB,EAEAA,EAAa,UAAU,UAAY,UAAW,CAC5C,OAAO,KAAK,OAAO,UACrB,EAEAA,EAAa,UAAU,KAAO,SAAUE,EAAK,CAC3C,IAAIC,EAAO,KAAK,IAAI,EAAG,KAAK,IAAI,KAAK,OAAO,WAAYD,CAAG,CAAC,EAC5D,YAAK,SAAY,MAAMC,CAAI,GAAK,CAAC,SAASA,CAAI,EAAK,EAAIA,EAChD,EACT,EAEAH,EAAa,UAAU,MAAQ,UAAY,CACzC,OAAO,KAAK,eAAiB,KAAK,eAAgB,CACpD,EAKAA,EAAa,UAAU,WAAa,SAASI,EAAMC,EAAQ,CACzD,IAAIC,EAAM,EACV,GAAI,KAAK,SAAWF,GAAQ,KAAK,OAAO,WAAY,CAClD,OAAQA,EAAI,CACV,IAAK,GACCC,EACFC,EAAM,KAAK,SAAS,QAAQ,KAAK,QAAQ,EAEzCA,EAAM,KAAK,SAAS,SAAS,KAAK,QAAQ,EAE5C,MACF,IAAK,GACCD,EACFC,EAAM,KAAK,SAAS,SAAS,KAAK,QAAQ,EAE1CA,EAAM,KAAK,SAAS,UAAU,KAAK,QAAQ,EAE7C,MACF,IAAK,GACH,GAAID,EACF,KAAO,8CAEPC,EAAM,KAAK,SAAS,SAAS,KAAK,QAAQ,GAAK,GAC/CA,GAAO,KAAK,SAAS,SAAS,KAAK,SAAS,CAAC,GAAK,EAClDA,GAAO,KAAK,SAAS,SAAS,KAAK,SAAS,CAAC,EAE/C,MACF,IAAK,GACCD,EACFC,EAAM,KAAK,SAAS,SAAS,KAAK,QAAQ,EAE1CA,EAAM,KAAK,SAAS,UAAU,KAAK,QAAQ,EAE7C,MACF,IAAK,GACH,GAAID,EACF,KAAO,8CAEPC,EAAM,KAAK,SAAS,UAAU,KAAK,QAAQ,GAAK,GAChDA,GAAO,KAAK,SAAS,UAAU,KAAK,SAAS,CAAC,EAEhD,MACF,QACE,KAAO,4CAA4CF,CAC3D,CACI,YAAK,UAAWA,EACTE,CACX,KACI,MAAO,4BAEX,EAEAN,EAAa,UAAU,UAAY,UAAW,CAC5C,OAAO,KAAK,WAAW,EAAG,EAAK,CACjC,EAEAA,EAAa,UAAU,WAAa,UAAW,CAC7C,OAAO,KAAK,WAAW,EAAG,EAAK,CACjC,EAEAA,EAAa,UAAU,WAAa,UAAW,CAC7C,OAAO,KAAK,WAAW,EAAG,EAAK,CACjC,EAEAA,EAAa,UAAU,WAAa,UAAW,CAC7C,OAAO,KAAK,WAAW,EAAG,EAAK,CACjC,EAEAA,EAAa,UAAU,WAAa,UAAW,CAC7C,OAAO,KAAK,WAAW,EAAG,EAAK,CACjC,EAEAA,EAAa,UAAU,WAAa,SAASX,EAAQ,CACnD,GAAI,KAAK,SAAWA,GAAU,KAAK,OAAO,WAAY,CAEpD,QADIkB,EAAI,GACCT,EAAI,EAAGA,EAAIT,EAAQS,IAC1BS,GAAK,OAAO,aAAa,KAAK,UAAS,CAAE,EAE3C,OAAOA,CACX,KACI,MAAO,4BAEX,EAEAP,EAAa,UAAU,YAAc,UAAW,CAE9C,QADIQ,EAAM,CAAE,IACA,CACV,IAAIC,EAAI,KAAK,UAAW,EACxB,GAAIA,IAAM,EACRD,EAAI,KAAKC,CAAC,MAEV,MAEN,CACE,OAAO,OAAO,aAAa,MAAM,KAAMD,CAAG,CAC5C,EAEAR,EAAa,UAAU,SAAW,UAAW,CAC3C,OAAO,KAAK,WAAW,EAAG,EAAI,CAChC,EAEAA,EAAa,UAAU,UAAY,UAAW,CAC5C,OAAO,KAAK,WAAW,EAAG,EAAI,CAChC,EAEAA,EAAa,UAAU,UAAY,UAAW,CAC5C,OAAO,KAAK,WAAW,EAAG,EAAI,CAChC,EAEAA,EAAa,UAAU,UAAY,UAAW,CAC5C,OAAO,KAAK,WAAW,EAAG,EAAK,CACjC,EAEAA,EAAa,UAAU,eAAiB,SAASX,EAAQ,CAEvD,QADImB,EAAM,IAAI,WAAWnB,CAAM,EACtBS,EAAI,EAAGA,EAAIT,EAAQS,IAC1BU,EAAIV,CAAC,EAAI,KAAK,UAAW,EAE3B,OAAOU,CACT,EAEAR,EAAa,UAAU,eAAiB,SAASX,EAAQ,CAEvD,QADImB,EAAM,IAAI,WAAWnB,CAAM,EACtBS,EAAI,EAAGA,EAAIT,EAAQS,IAC1BU,EAAIV,CAAC,EAAI,KAAK,UAAW,EAE3B,OAAOU,CACT,EAEAR,EAAa,UAAU,gBAAkB,SAASX,EAAQ,CAExD,QADImB,EAAM,IAAI,WAAWnB,CAAM,EACtBS,EAAI,EAAGA,EAAIT,EAAQS,IAC1BU,EAAIV,CAAC,EAAI,KAAK,WAAY,EAE5B,OAAOU,CACT,EAEAR,EAAa,UAAU,gBAAkB,SAASX,EAAQ,CAExD,QADImB,EAAM,IAAI,YAAYnB,CAAM,EACvBS,EAAI,EAAGA,EAAIT,EAAQS,IAC1BU,EAAIV,CAAC,EAAI,KAAK,WAAY,EAE5B,OAAOU,CACT,EAEAR,EAAa,UAAU,eAAiB,SAASX,EAAQ,CAEvD,QADImB,EAAM,IAAI,WAAWnB,CAAM,EACtBS,EAAI,EAAGA,EAAIT,EAAQS,IAC1BU,EAAIV,CAAC,EAAI,KAAK,UAAW,EAE3B,OAAOU,CACT,EAGET,eAAuBC,EAUzB,IAAIU,EAAa,SAAST,EAAaU,EAAYC,EAAY,CAC7D,KAAK,YAAcD,GAAc,EAC7BV,aAAuB,YACzB,KAAK,OAASA,EACL,OAAOA,GAAe,UAC/B,KAAK,SAAWA,EACZU,IACF,KAAK,aAAeA,IAGtB,KAAK,OAAS,IAAI,YAAYV,GAAe,CAAC,EAEhD,KAAK,SAAW,EAChB,KAAK,WAAaW,GAAqBF,EAAW,aACnD,EACDA,EAAW,UAAY,CAAE,EAEzBA,EAAW,UAAU,YAAc,UAAW,CAC5C,OAAO,KAAK,QACd,EAOAA,EAAW,UAAU,SAAW,SAASG,EAAO,CAC9C,GAAK,KAAK,aAGV,KAAIC,EAAM,KAAK,YAAc,KAAK,SAAWD,EACzCE,EAAO,KAAK,QAAQ,WACxB,GAAID,GAAOC,EAAM,CACXD,EAAM,KAAK,cACb,KAAK,YAAcA,GAErB,MACJ,CAIE,IAHIC,EAAO,IACTA,EAAO,GAEFD,EAAMC,GACXA,GAAQ,EAEV,IAAIC,EAAM,IAAI,YAAYD,CAAI,EAC1BE,EAAM,IAAI,WAAW,KAAK,OAAO,EACjCC,EAAM,IAAI,WAAWF,EAAK,EAAGC,EAAI,MAAM,EAC3CC,EAAI,IAAID,CAAG,EACX,KAAK,OAASD,EACd,KAAK,YAAcF,EACpB,EAUDJ,EAAW,UAAU,WAAa,UAAW,CAC3C,GAAI,KAAK,aAAe,KAAK,QAAQ,WAGrC,KAAIM,EAAM,IAAI,YAAY,KAAK,WAAW,EACtCE,EAAM,IAAI,WAAWF,CAAG,EACxBC,EAAM,IAAI,WAAW,KAAK,QAAS,EAAGC,EAAI,MAAM,EACpDA,EAAI,IAAID,CAAG,EACX,KAAK,OAASD,EACf,EAODN,EAAW,WAAa,GAMxBA,EAAW,cAAgB,GAQ3BA,EAAW,UAAU,YAAc,EAMnC,OAAO,eAAeA,EAAW,UAAW,aAC1C,CAAE,IAAK,UAAW,CAChB,OAAO,KAAK,YAAc,KAAK,WACnC,CAAG,CAAC,EAOJ,OAAO,eAAeA,EAAW,UAAW,SAC1C,CAAE,IAAK,UAAW,CACd,YAAK,WAAY,EACV,KAAK,OACb,EACD,IAAK,SAASS,EAAG,CACf,KAAK,QAAUA,EACf,KAAK,UAAY,IAAI,SAAS,KAAK,QAAS,KAAK,WAAW,EAC5D,KAAK,YAAc,KAAK,QAAQ,UACtC,EAAO,EAOP,OAAO,eAAeT,EAAW,UAAW,aAC1C,CAAE,IAAK,UAAW,CACd,OAAO,KAAK,WACb,EACD,IAAK,SAASS,EAAG,CACf,KAAK,YAAcA,EACnB,KAAK,UAAY,IAAI,SAAS,KAAK,QAAS,KAAK,WAAW,EAC5D,KAAK,YAAc,KAAK,QAAQ,UACtC,EAAO,EAOP,OAAO,eAAeT,EAAW,UAAW,WAC1C,CAAE,IAAK,UAAW,CACd,OAAO,KAAK,SACb,EACD,IAAK,SAASS,EAAG,CACf,KAAK,YAAcA,EAAE,WACrB,KAAK,QAAUA,EAAE,OACjB,KAAK,UAAY,IAAI,SAAS,KAAK,QAAS,KAAK,WAAW,EAC5D,KAAK,YAAc,KAAK,YAAcA,EAAE,UAC9C,EAAO,EASPT,EAAW,UAAU,KAAO,SAASR,EAAK,CACxC,IAAIC,EAAO,KAAK,IAAI,EAAG,KAAK,IAAI,KAAK,WAAYD,CAAG,CAAC,EACrD,KAAK,SAAY,MAAMC,CAAI,GAAK,CAAC,SAASA,CAAI,EAAK,EAAIA,CACxD,EAQDO,EAAW,UAAU,MAAQ,UAAW,CACtC,OAAQ,KAAK,UAAY,KAAK,WAC/B,EAYDA,EAAW,UAAU,cAAgB,SAASrB,EAAQ,CACpD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,WAAW,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC5E,YAAK,UAAYA,EAAS,EACnBmB,CACR,EAUDE,EAAW,UAAU,eAAiB,SAASrB,EAAQ,EAAG,CACxDA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAAW,EAC3D,IAAImB,EAAM,IAAI,WAAWnB,CAAM,EAC/B,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9CE,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,eAAiB,SAASrB,EAAQ,EAAG,CACxDA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAAW,EAC3D,IAAImB,EAAM,IAAI,WAAWnB,CAAM,EAC/B,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9CE,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,cAAgB,SAASrB,EAAQ,CACpDA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAChD,IAAImB,EAAM,IAAI,UAAUnB,CAAM,EAC9B,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9C,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,gBAAkB,SAASrB,EAAQ,EAAG,CACzDA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAAW,EAC3D,IAAImB,EAAM,IAAI,YAAYnB,CAAM,EAChC,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9CE,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,gBAAkB,SAASrB,EAAQ,EAAG,CACzDA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAAW,EAC3D,IAAImB,EAAM,IAAI,YAAYnB,CAAM,EAChC,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9CE,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,eAAiB,SAASrB,EAAQ,CACrDA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAChD,IAAImB,EAAM,IAAI,WAAWnB,CAAM,EAC/B,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9C,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,iBAAmB,SAASrB,EAAQ,EAAG,CAC1DA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAAW,EAC3D,IAAImB,EAAM,IAAI,aAAanB,CAAM,EACjC,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9CE,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,iBAAmB,SAASrB,EAAQ,EAAG,CAC1DA,EAASA,GAAkB,KAAK,WAAW,KAAK,SAAW,EAC3D,IAAImB,EAAM,IAAI,aAAanB,CAAM,EACjC,OAAAqB,EAAW,OAAOF,EAAI,OAAQ,EACZ,KAAK,OAAQ,KAAK,WAAW,KAAK,SAClCnB,EAAOmB,EAAI,iBAAiB,EAC9CE,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYA,EAAI,WACdA,CACR,EASDE,EAAW,UAAU,UAAY,SAASU,EAAG,CAC3C,IAAID,EAAI,KAAK,UAAU,SAAS,KAAK,SAAUC,GAAY,KAAK,UAAc,EAC9E,YAAK,UAAY,EACVD,CACR,EAQDT,EAAW,UAAU,UAAY,SAASU,EAAG,CAC3C,IAAID,EAAI,KAAK,UAAU,SAAS,KAAK,SAAUC,GAAY,KAAK,UAAc,EAC9E,YAAK,UAAY,EACVD,CACR,EAODT,EAAW,UAAU,SAAW,UAAW,CACzC,IAAIS,EAAI,KAAK,UAAU,QAAQ,KAAK,QAAQ,EAC5C,YAAK,UAAY,EACVA,CACR,EAQDT,EAAW,UAAU,WAAa,SAASU,EAAG,CAC5C,IAAID,EAAI,KAAK,UAAU,UAAU,KAAK,SAAUC,GAAY,KAAK,UAAc,EAC/E,YAAK,UAAY,EACVD,CACR,EAQDT,EAAW,UAAU,WAAa,SAASU,EAAG,CAC5C,IAAID,EAAI,KAAK,UAAU,UAAU,KAAK,SAAUC,GAAY,KAAK,UAAc,EAC/E,YAAK,UAAY,EACVD,CACR,EAODT,EAAW,UAAU,UAAY,UAAW,CAC1C,IAAIS,EAAI,KAAK,UAAU,SAAS,KAAK,QAAQ,EAC7C,YAAK,UAAY,EACVA,CACR,EAQDT,EAAW,UAAU,YAAc,SAASU,EAAG,CAC7C,IAAID,EAAI,KAAK,UAAU,WAAW,KAAK,SAAUC,GAAY,KAAK,UAAc,EAChF,YAAK,UAAY,EACVD,CACR,EAQDT,EAAW,UAAU,YAAc,SAASU,EAAG,CAC7C,IAAID,EAAI,KAAK,UAAU,WAAW,KAAK,SAAUC,GAAY,KAAK,UAAc,EAChF,YAAK,UAAY,EACVD,CACR,EAQDT,EAAW,WAAa,IAAI,UAAU,IAAI,WAAW,CAAC,CAAC,CAAC,EAAE,MAAM,EAAE,CAAC,EAAI,EAYvEA,EAAW,OAAS,SAASQ,EAAKG,EAAWJ,EAAKK,EAAWC,EAAY,CACvE,IAAIC,EAAQ,IAAI,WAAWN,EAAKG,EAAWE,CAAU,EACjDE,EAAQ,IAAI,WAAWR,EAAKK,EAAWC,CAAU,EACrDC,EAAM,IAAIC,CAAK,CAChB,EAUDf,EAAW,cAAgB,SAASgB,EAAOC,EAAqB,CAC9D,OAAIA,GAAuB,KAAK,WACvBD,EAEA,KAAK,oBAAoBA,CAAK,CAExC,EAUDhB,EAAW,eAAiB,SAASgB,EAAOE,EAAc,CACxD,OAAI,KAAK,YAAcA,EACdF,EAEA,KAAK,oBAAoBA,CAAK,CAExC,EAQDhB,EAAW,oBAAsB,SAASgB,EAAO,CAE/C,QADIG,EAAK,IAAI,WAAWH,EAAM,OAAQA,EAAM,WAAYA,EAAM,UAAU,EAC/D5B,EAAE,EAAGA,EAAE4B,EAAM,WAAY5B,GAAG4B,EAAM,kBACzC,QAASI,EAAEhC,EAAE4B,EAAM,kBAAkB,EAAGK,EAAEjC,EAAGgC,EAAEC,EAAGD,IAAKC,IAAK,CAC1D,IAAIC,EAAMH,EAAGE,CAAC,EACdF,EAAGE,CAAC,EAAIF,EAAGC,CAAC,EACZD,EAAGC,CAAC,EAAIE,CACd,CAEE,OAAON,CACR,EAQDhB,EAAW,UAAU,gBAAkB,EAEvC,OAAO,kBAAoB,SAASuB,EAAU,CAE1C,QADIzB,EAAM,CAAE,EACHV,EAAI,EAAGA,EAAImC,EAAS,OAAQnC,IACnCU,EAAIV,CAAC,EAAImC,EAASnC,CAAC,EAErB,OAAO,OAAO,aAAa,MAAM,KAAMU,CAAG,CAC9C,EASAE,EAAW,UAAU,WAAa,SAASrB,EAAQ6C,EAAU,CAC3D,OAAIA,GAAY,MAAQA,GAAY,QAC3B,OAAO,kBAAkB,MAAM,KAAM,CAAC,KAAK,cAAc7C,GAAiB,KAAK,WAAW,KAAK,QAAiB,CAAC,CAAC,EAEjH,IAAI,YAAY6C,CAAQ,EAAG,OAAO,KAAK,cAAc7C,CAAM,CAAC,CAEvE,EASDqB,EAAW,UAAU,YAAc,SAASrB,EAAQ,CAClD,IAAI0B,EAAO,KAAK,WAAW,KAAK,SAC5Bc,EAAK,IAAI,WAAW,KAAK,QAAS,KAAK,YAAc,KAAK,QAAQ,EAClEM,EAAMpB,EACN1B,GAAU,OACZ8C,EAAM,KAAK,IAAI9C,EAAQ0B,CAAI,GAE7B,QAASjB,EAAI,EAAGA,EAAIqC,GAAON,EAAG/B,CAAC,IAAM,EAAGA,IAAI,CAC5C,IAAIS,EAAI,OAAO,kBAAkB,MAAM,KAAM,CAAC,KAAK,cAAcT,CAAC,CAAC,CAAC,EACpE,OAAIT,GAAU,KACZ,KAAK,UAAY8C,EAAIrC,EACZA,GAAKiB,IACd,KAAK,UAAY,GAEZR,CACR,EAMD,IAAI6B,EAAW,KAAK,IAAI,EAAG,EAAE,EAE7B1B,EAAW,UAAU,UAAY,UAAY,CAC3C,OAAQ,KAAK,UAAS,EAAG0B,EAAU,KAAK,WAAY,CACtD,EACA1B,EAAW,UAAU,WAAa,UAAY,CAC7C,OAAQ,KAAK,WAAU,EAAG0B,EAAU,KAAK,WAAY,CACtD,EAEA1B,EAAW,UAAU,UAAY,UAAY,CAC3C,OAAQ,KAAK,WAAU,EAAG0B,EAAU,KAAK,WAAY,CACvD,EAEA1B,EAAW,UAAU,WAAa,UAAY,CAC7C,OAAQ,KAAK,UAAW,GAAE,KAAK,KAAK,UAAS,GAAI,GAAG,KAAK,UAAW,CACrE,EAGEX,EAAA,WAAqBW,EAUvBA,EAAW,UAAU,KAAO,SAAS2B,EAAU,CAC7C,IAAIC,EAAO,IAAI,KAAK,CAAC,KAAK,MAAM,CAAC,EACjC,GAAI,OAAO,KAAO,IAAI,gBAAiB,CACnC,IAAIC,EAAM,OAAO,IAAI,gBAAgBD,CAAI,EACrC/C,EAAI,SAAS,cAAc,GAAG,EAElC,SAAS,KAAK,YAAYA,CAAC,EAC3BA,EAAE,aAAa,OAAQgD,CAAG,EAC1BhD,EAAE,aAAa,WAAY8C,CAAQ,EAEnC9C,EAAE,aAAa,SAAU,OAAO,EAChCA,EAAE,MAAO,EACT,OAAO,IAAI,gBAAgBgD,CAAG,CACpC,KACM,MAAM,2CAEX,EAQD7B,EAAW,UAAU,aAAe,GACpC,OAAO,eAAeA,EAAW,UAAW,cAC1C,CAAE,IAAK,UAAW,CACd,OAAO,KAAK,YACb,EACD,IAAK,SAASS,EAAG,CACVA,GACH,KAAK,WAAY,EAEnB,KAAK,aAAeA,CAC1B,EAAO,EAQPT,EAAW,UAAU,MAAQ,SAAS8B,EAAQ,CAC5C,IAAIxB,EAAM,IAAI,YAAY,KAAK,YAAYwB,CAAM,EAC7CtB,EAAM,IAAI,WAAWF,CAAG,EACxBC,EAAM,IAAI,WAAW,KAAK,QAASuB,EAAQtB,EAAI,MAAM,EACzDA,EAAI,IAAID,CAAG,EACX,KAAK,OAASD,EACd,KAAK,UAAYwB,CAClB,EAQD9B,EAAW,UAAU,gBAAkB,SAASF,EAAK,EAAG,CAEtD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,YACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,cAAcA,EAAI,OAAQ,CAAC,MAEhC,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,WAAWU,EAAIV,CAAC,EAAG,CAAC,CAG9B,EAQDY,EAAW,UAAU,gBAAkB,SAASF,EAAK,EAAG,CAEtD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,YACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,cAAcA,EAAI,OAAQ,CAAC,MAEhC,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,WAAWU,EAAIV,CAAC,EAAG,CAAC,CAG9B,EAODY,EAAW,UAAU,eAAiB,SAASF,EAAK,CAElD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,WACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,aAAaA,EAAI,MAAM,MAE5B,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,UAAUU,EAAIV,CAAC,CAAC,CAG1B,EAQDY,EAAW,UAAU,iBAAmB,SAASF,EAAK,EAAG,CAEvD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,aACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,eAAeA,EAAI,OAAQ,CAAC,MAEjC,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,YAAYU,EAAIV,CAAC,EAAG,CAAC,CAG/B,EAQDY,EAAW,UAAU,iBAAmB,SAASF,EAAK,EAAG,CAEvD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,aACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,eAAeA,EAAI,OAAQ,CAAC,MAEjC,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,YAAYU,EAAIV,CAAC,EAAG,CAAC,CAG/B,EAODY,EAAW,UAAU,gBAAkB,SAASF,EAAK,CAEnD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,YACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,cAAcA,EAAI,MAAM,MAE7B,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,WAAWU,EAAIV,CAAC,CAAC,CAG3B,EAQDY,EAAW,UAAU,kBAAoB,SAASF,EAAK,EAAG,CAExD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,cACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,gBAAgBA,EAAI,OAAQ,CAAC,MAElC,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,aAAaU,EAAIV,CAAC,EAAG,CAAC,CAGhC,EAQDY,EAAW,UAAU,kBAAoB,SAASF,EAAK,EAAG,CAExD,GADA,KAAK,SAASA,EAAI,OAAS,CAAC,EACxBA,aAAe,cACf,KAAK,WAAW,KAAK,SAAWA,EAAI,oBAAsB,EAC5DE,EAAW,OAAO,KAAK,QAAS,KAAK,WAAW,KAAK,SACnCF,EAAI,OAAQ,EACZA,EAAI,UAAU,EAChC,KAAK,gBAAgBA,EAAI,OAAQ,CAAC,MAElC,SAASV,EAAE,EAAGA,EAAEU,EAAI,OAAQV,IAC1B,KAAK,aAAaU,EAAIV,CAAC,EAAG,CAAC,CAGhC,EASDY,EAAW,UAAU,WAAa,SAASS,EAAG,EAAG,CAC/C,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,SAAS,KAAK,SAAUA,EAAG,GAAY,KAAK,UAAc,EACzE,KAAK,UAAY,CAClB,EAQDT,EAAW,UAAU,WAAa,SAASS,EAAG,EAAG,CAC/C,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,SAAS,KAAK,SAAUA,EAAG,GAAY,KAAK,UAAc,EACzE,KAAK,UAAY,CAClB,EAODT,EAAW,UAAU,UAAY,SAASS,EAAG,CAC3C,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,QAAQ,KAAK,SAAUA,CAAC,EACvC,KAAK,UAAY,CAClB,EAQDT,EAAW,UAAU,YAAc,SAASS,EAAG,EAAG,CAChD,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,UAAU,KAAK,SAAUA,EAAG,GAAY,KAAK,UAAc,EAC1E,KAAK,UAAY,CAClB,EAQDT,EAAW,UAAU,YAAc,SAASS,EAAG,EAAG,CAChD,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,UAAU,KAAK,SAAUA,EAAG,GAAY,KAAK,UAAc,EAC1E,KAAK,UAAY,CAClB,EAODT,EAAW,UAAU,WAAa,SAASS,EAAG,CAC5C,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,SAAS,KAAK,SAAUA,CAAC,EACxC,KAAK,UAAY,CAClB,EAQDT,EAAW,UAAU,aAAe,SAASS,EAAG,EAAG,CACjD,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,WAAW,KAAK,SAAUA,EAAG,GAAY,KAAK,UAAc,EAC3E,KAAK,UAAY,CAClB,EAQDT,EAAW,UAAU,aAAe,SAASS,EAAG,EAAG,CACjD,KAAK,SAAS,CAAC,EACf,KAAK,UAAU,WAAW,KAAK,SAAUA,EAAG,GAAY,KAAK,UAAc,EAC3E,KAAK,UAAY,CAClB,EAYDT,EAAW,UAAU,gBAAkB,SAASpB,EAAKsB,EAAY6B,EAAgB,CAC3EA,GAAkB,OACpBA,EAAiBnD,EAAI,QAEvB,QAASQ,EAAI,EAAGA,EAAIR,EAAI,QAAUQ,EAAI2C,EAAgB3C,IACpD,KAAK,YAAYR,EAAI,WAAWQ,CAAC,EAAGc,CAAU,EAEhD,KAAOd,EAAE2C,EAAgB3C,IACvB,KAAK,YAAY,CAAC,CAErB,EAUDY,EAAW,UAAU,YAAc,SAASH,EAAG2B,EAAU7C,EAAQ,CAC/D,IAAIS,EAAI,EACR,GAAIoC,GAAY,MAAQA,GAAY,QAClC,GAAI7C,GAAU,KAAM,CAClB,IAAI8C,EAAM,KAAK,IAAI5B,EAAE,OAAQlB,CAAM,EACnC,IAAKS,EAAE,EAAGA,EAAEqC,EAAKrC,IACf,KAAK,WAAWS,EAAE,WAAWT,CAAC,CAAC,EAEjC,KAAOA,EAAET,EAAQS,IACf,KAAK,WAAW,CAAC,CAEzB,KACM,KAAKA,EAAE,EAAGA,EAAES,EAAE,OAAQT,IACpB,KAAK,WAAWS,EAAE,WAAWT,CAAC,CAAC,OAInC,KAAK,gBAAiB,IAAI,YAAYoC,CAAQ,EAAG,OAAO3B,EAAE,UAAU,EAAGlB,CAAM,CAAC,CAAC,CAElF,EAWDqB,EAAW,UAAU,aAAe,SAASH,EAAGlB,EAAQ,CACtD,IAAIS,EAAI,EACR,GAAIT,GAAU,KAAM,CAClB,IAAI8C,EAAM,KAAK,IAAI5B,EAAE,OAAQlB,CAAM,EACnC,IAAKS,EAAE,EAAGA,EAAEqC,EAAKrC,IACf,KAAK,WAAWS,EAAE,WAAWT,CAAC,CAAC,EAEjC,KAAOA,EAAET,EAAQS,IACf,KAAK,WAAW,CAAC,CAEvB,KAAS,CACL,IAAKA,EAAE,EAAGA,EAAES,EAAE,OAAQT,IACpB,KAAK,WAAWS,EAAE,WAAWT,CAAC,CAAC,EAEjC,KAAK,WAAW,CAAC,CACrB,CACC,EAUDY,EAAW,UAAU,YAAc,SAASgC,EAAkBC,EAAQ,CACpE,QAAS7C,EAAI,EAAGA,EAAI4C,EAAiB,OAAQ5C,GAAG,EAAG,CACjD,IAAI8C,EAAIF,EAAiB5C,EAAE,CAAC,EAC5B,KAAK,UAAU8C,EAAGD,EAAOD,EAAiB5C,CAAC,CAAC,EAAG6C,CAAM,CACzD,CACC,EASDjC,EAAW,UAAU,UAAY,SAAS,EAAGS,EAAGwB,EAAQ,CACtD,IAAIE,EACJ,GAAI,OAAO,GAAK,WACd,OAAO,EAAE,KAAM1B,CAAC,EACX,GAAI,OAAO,GAAK,UAAY,EAAE,aAAa,OAChD,OAAO,EAAE,IAAI,KAAMA,EAAGwB,CAAM,EAE9B,IAAIF,EAAiB,KACjBK,EAAU,QACV5C,EAAM,KAAK,SAYf,OAXI,OAAO,GAAM,UAAY,IAAI,KAAK,CAAC,IACrC2C,EAAK,EAAE,MAAM,GAAG,EAChB,EAAIA,EAAG,CAAC,EACRJ,EAAiB,SAASI,EAAG,CAAC,CAAC,GAE7B,OAAO,GAAK,UAAY,IAAI,KAAK,CAAC,IACpCA,EAAK,EAAE,MAAM,GAAG,EAChB,EAAIA,EAAG,CAAC,EACRC,EAAU,SAASD,EAAG,CAAC,CAAC,GAGnB,EAAC,CACN,IAAK,QACH,KAAK,WAAW1B,CAAC,EACjB,MACF,IAAK,OACH,KAAK,UAAUA,CAAC,EAChB,MAEF,IAAK,SACH,KAAK,YAAYA,EAAG,KAAK,UAAU,EACnC,MACF,IAAK,QACH,KAAK,WAAWA,EAAG,KAAK,UAAU,EAClC,MACF,IAAK,SACH,KAAK,YAAYA,EAAG,KAAK,UAAU,EACnC,MACF,IAAK,QACH,KAAK,WAAWA,EAAG,KAAK,UAAU,EAClC,MACF,IAAK,UACH,KAAK,aAAaA,EAAG,KAAK,UAAU,EACpC,MACF,IAAK,UACH,KAAK,aAAaA,EAAG,KAAK,UAAU,EACpC,MAEF,IAAK,WACH,KAAK,YAAYA,EAAGT,EAAW,UAAU,EACzC,MACF,IAAK,UACH,KAAK,WAAWS,EAAGT,EAAW,UAAU,EACxC,MACF,IAAK,WACH,KAAK,YAAYS,EAAGT,EAAW,UAAU,EACzC,MACF,IAAK,UACH,KAAK,WAAWS,EAAGT,EAAW,UAAU,EACxC,MACF,IAAK,YACH,KAAK,aAAaS,EAAGT,EAAW,UAAU,EAC1C,MACF,IAAK,YACH,KAAK,aAAaS,EAAGT,EAAW,UAAU,EAC1C,MAEF,IAAK,WACH,KAAK,YAAYS,EAAGT,EAAW,aAAa,EAC5C,MACF,IAAK,UACH,KAAK,WAAWS,EAAGT,EAAW,aAAa,EAC3C,MACF,IAAK,WACH,KAAK,YAAYS,EAAGT,EAAW,aAAa,EAC5C,MACF,IAAK,UACH,KAAK,WAAWS,EAAGT,EAAW,aAAa,EAC3C,MACF,IAAK,YACH,KAAK,aAAaS,EAAGT,EAAW,aAAa,EAC7C,MACF,IAAK,YACH,KAAK,aAAaS,EAAGT,EAAW,aAAa,EAC7C,MAEF,IAAK,UACH,KAAK,aAAaS,EAAGsB,CAAc,EACnC,MAEF,IAAK,SACH,KAAK,YAAYtB,EAAG2B,EAASL,CAAc,EAC3C,MAEF,IAAK,YACH,KAAK,gBAAgBtB,EAAG,KAAK,WAAYsB,CAAc,EACvD,MAEF,IAAK,cACH,KAAK,gBAAgBtB,EAAGT,EAAW,cAAe+B,CAAc,EAChE,MAEF,IAAK,cACH,KAAK,gBAAgBtB,EAAGT,EAAW,WAAY+B,CAAc,EAC7D,MAEF,QACE,GAAI,EAAE,QAAU,EAAG,CAEjB,QADIM,EAAK,EAAE,CAAC,EACHjD,EAAE,EAAGA,EAAEqB,EAAE,OAAQrB,IACxB,KAAK,UAAUiD,EAAI5B,EAAErB,CAAC,CAAC,EAEzB,KACR,KAAa,CACL,KAAK,YAAY,EAAGqB,CAAC,EACrB,KACR,CACA,CACMsB,GAAkB,OACpB,KAAK,SAAWvC,EAChB,KAAK,SAASuC,CAAc,EAC5B,KAAK,SAAWvC,EAAMuC,EAEzB,EAGD/B,EAAW,UAAU,YAAc,SAAUS,EAAG,CAC/C,IAAI6B,EAAI,KAAK,MAAM7B,EAAIiB,CAAQ,EAC/B,KAAK,YAAYY,CAAC,EAClB,KAAK,YAAY7B,EAAI,UAAU,CAChC,EAEAT,EAAW,UAAU,YAAc,SAAUS,EAAG,CAC/C,KAAK,YAAYA,EAAI,WAAa,EAAE,EACpC,KAAK,YAAYA,EAAI,QAAa,CAAC,EACnC,KAAK,WAAYA,EAAI,GAAY,CAClC,EAEAT,EAAW,UAAU,aAAe,SAASuC,EAAUC,EAAO,CAC7D,IAAIhD,EAAM,KAAK,SACf,KAAK,KAAK+C,CAAQ,EAClB,KAAK,YAAYC,CAAK,EACtB,KAAK,KAAKhD,CAAG,CACd,EAcAQ,EAAW,UAAU,cAAgB,SAASrB,EAAQ,EAAG,CACvD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,WAAW,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC5E,OAAAqB,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYnB,EAAS,EACnBmB,CACR,EAcDE,EAAW,UAAU,cAAgB,SAASrB,EAAQ,EAAG,CACvD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,WAAW,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC5E,OAAAqB,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYnB,EAAS,EACnBmB,CACR,EAWDE,EAAW,UAAU,aAAe,SAASrB,EAAQ,CACnD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,UAAU,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC3E,YAAK,UAAYA,EAAS,EACnBmB,CACR,EAcDE,EAAW,UAAU,eAAiB,SAASrB,EAAQ,EAAG,CACxD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,YAAY,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC7E,OAAAqB,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYnB,EAAS,EACnBmB,CACR,EAcDE,EAAW,UAAU,eAAiB,SAASrB,EAAQ,EAAG,CACxD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,YAAY,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC7E,OAAAqB,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYnB,EAAS,EACnBmB,CACR,EAcDE,EAAW,UAAU,gBAAkB,SAASrB,EAAQ,EAAG,CACzD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,aAAa,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC9E,OAAAqB,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYnB,EAAS,EACnBmB,CACR,EAcDE,EAAW,UAAU,gBAAkB,SAASrB,EAAQ,EAAG,CACzD,KAAK,SAASA,EAAS,CAAC,EACxB,IAAImB,EAAM,IAAI,aAAa,KAAK,QAAS,KAAK,WAAW,KAAK,SAAUnB,CAAM,EAC9E,OAAAqB,EAAW,cAAcF,EAAK,GAAY,KAAK,UAAc,EAC7D,KAAK,UAAYnB,EAAS,EACnBmB,CACR,EAaD,IAAI2C,EAAoB,SAASC,EAAQ,CAExC,KAAK,QAAU,GACf,KAAK,YAAc,GACfA,IACH,KAAK,aAAaA,CAAM,EACxB,KAAK,YAAc,EAErB,EACAD,EAAkB,UAAY,IAAIzC,EAAW,IAAI,YAAe,EAAGA,EAAW,UAAU,EAMxFyC,EAAkB,UAAU,YAAc,UAAW,CACpD,IAAIE,EACJ,OAAI,KAAK,YAAc,GACf,GACG,KAAK,QAAQ,OAAS,GAChCA,EAAc,KAAK,QAAQ,CAAC,EACxBA,EAAY,YAAc,GAC7B,KAAK,OAASA,EACd,KAAK,YAAc,EACnBhF,EAAI,MAAM,oBAAqB,0BAA0B,EAClD,KAEPA,EAAI,KAAK,oBAAqB,+CAA+C,EAC7E,KAAK,eAAgB,EACd,MAGRA,EAAI,KAAK,oBAAqB,iCAAiC,EAC/D,KAAK,eAAgB,EACd,GAET,EAQA,YAAY,OAAS,SAASiF,EAASC,EAAS,CAC9ClF,EAAI,MAAM,cAAe,2CAA2CiF,EAAQ,WAAaC,EAAQ,WAAW,EAC5G,IAAIvB,EAAM,IAAI,WAAWsB,EAAQ,WAAaC,EAAQ,UAAU,EAChE,OAAAvB,EAAI,IAAI,IAAI,WAAWsB,CAAO,EAAG,CAAC,EAClCtB,EAAI,IAAI,IAAI,WAAWuB,CAAO,EAAGD,EAAQ,UAAU,EAC5CtB,EAAI,MACZ,EASDmB,EAAkB,UAAU,aAAe,SAASC,EAAQZ,EAAQgB,EAAW,CAC9E,IAAIC,EACJ,OAAAA,EAAS,IAAI,WAAWD,CAAS,EACjCC,EAAO,IAAI,IAAI,WAAWL,EAAQZ,EAAQgB,CAAS,CAAC,EACpDC,EAAO,OAAO,UAAYL,EAAO,UAAUZ,EAC3CiB,EAAO,OAAO,UAAY,EACnBA,EAAO,MACf,EAQAN,EAAkB,UAAU,aAAe,SAASO,EAAI,CAGvD,QAFIC,EAAS,GAEJ7D,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IAAK,CAC7C,IAAIW,EAAI,KAAK,QAAQX,CAAC,EACtB,GAAI4D,EAAG,WAAajD,EAAE,UAAW,CAEhC,GAAIiD,EAAG,YAAcjD,EAAE,UAEtB,GAAIiD,EAAG,WAAcjD,EAAE,WAAY,CAIlC,KAAK,QAAQ,OAAOX,EAAG,CAAC,EACxBA,IACA,QACL,MAEKzB,EAAI,KAAK,oBAAqB,sBAAsBqF,EAAG,UAAU,cAAcA,EAAG,WAAW,8BAA8B,OAKxHA,EAAG,UAAYA,EAAG,YAAcjD,EAAE,YAIrCiD,EAAK,KAAK,aAAaA,EAAI,EAAGjD,EAAE,UAAYiD,EAAG,SAAS,GAEzDrF,EAAI,MAAM,oBAAqB,oCAAoCqF,EAAG,UAAU,cAAcA,EAAG,WAAW,GAAG,EAC/G,KAAK,QAAQ,OAAO5D,EAAG,EAAG4D,CAAE,EAGxB5D,IAAM,IACT,KAAK,OAAS4D,GAGhBC,EAAS,GACT,KACH,SAAaD,EAAG,UAAYjD,EAAE,UAAYA,EAAE,WAAY,CAErD,IAAI+B,EAAS/B,EAAE,UAAYA,EAAE,WAAaiD,EAAG,UACzCF,EAAYE,EAAG,WAAalB,EAChC,GAAIgB,EAAY,EAEfE,EAAK,KAAK,aAAaA,EAAIlB,EAAQgB,CAAS,MACtC,CAENG,EAAS,GACT,KACJ,CACA,CACA,CAEKA,IACHtF,EAAI,MAAM,oBAAqB,oCAAoCqF,EAAG,UAAU,cAAcA,EAAG,WAAW,GAAG,EAC/G,KAAK,QAAQ,KAAKA,CAAE,EAGhB5D,IAAM,IACT,KAAK,OAAS4D,GAGjB,EAMAP,EAAkB,UAAU,eAAiB,SAASS,EAAM,CAC3D,IAAI9D,EACAsD,EACAS,EAAMC,EACNjE,EAAS,CAAE,EACXkE,EACAC,EAAiB,GAGrB,IAFAH,EAAO,EACPC,EAAQ,EACHhE,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IACpCsD,EAAS,KAAK,QAAQtD,CAAC,EACnBA,IAAM,GACTiE,EAAQ,CAAE,EACVlE,EAAO,KAAKkE,CAAK,EACjBA,EAAM,MAAQX,EAAO,UACrBW,EAAM,IAAMX,EAAO,UAAUA,EAAO,WACpCY,GAAkB,IAAID,EAAM,MAAM,KACxBA,EAAM,MAAQX,EAAO,UAC/BW,EAAM,IAAMX,EAAO,UAAUA,EAAO,YAEpCW,EAAQ,CAAE,EACVA,EAAM,MAAQX,EAAO,UACrBY,GAAmBnE,EAAOA,EAAO,OAAO,CAAC,EAAE,IAAI,EAAG,OAAOkE,EAAM,MAAM,IACrEA,EAAM,IAAMX,EAAO,UAAUA,EAAO,WACpCvD,EAAO,KAAKkE,CAAK,GAElBF,GAAQT,EAAO,UACfU,GAASV,EAAO,WAEbvD,EAAO,OAAS,IACnBmE,GAAmBD,EAAM,IAAI,EAAG,KAEjC,IAAIE,EAAOL,EAAOvF,EAAI,KAAOA,EAAI,MAC7B,KAAK,QAAQ,SAAW,EAC3B4F,EAAI,oBAAqB,0BAA0B,EAEnDA,EAAI,oBAAqB,GAAG,KAAK,QAAQ,OAAO,sBAAsBJ,EAAK,IAAIC,EAAM,+BAA+BE,CAAc,CAEpI,EAEAb,EAAkB,UAAU,aAAe,UAAY,CACtD,IAAIrD,EACAsD,EACJ,IAAKtD,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IACpCsD,EAAS,KAAK,QAAQtD,CAAC,EACnBsD,EAAO,YAAcA,EAAO,aAC/B/E,EAAI,MAAM,oBAAqB,oBAAoByB,CAAC,EACpD,KAAK,QAAQ,OAAOA,EAAG,CAAC,EACxBA,IAGH,EAEAqD,EAAkB,UAAU,gBAAkB,UAAW,CACxD,IAAIe,EACJ,GAAI,KAAK,YAAY,EAAI,KAAK,QAAQ,OAErC,GADAA,EAAc,KAAK,QAAQ,KAAK,YAAY,CAAC,EACzCA,EAAY,YAAc,KAAK,OAAO,UAAY,KAAK,OAAO,WAAY,CAC7E,IAAIC,EAAY,KAAK,OAAO,WACxBC,EAAe,KAAK,OAAO,UAC3BC,EAAe,KAAK,OAAO,UAC/B,YAAK,QAAQ,KAAK,WAAW,EAAI,YAAY,OAAO,KAAK,OAAQH,CAAW,EAC5E,KAAK,OAAS,KAAK,QAAQ,KAAK,WAAW,EAC3C,KAAK,QAAQ,OAAO,KAAK,YAAY,EAAG,CAAC,EACzC,KAAK,OAAO,UAAYE,EACxB,KAAK,OAAO,UAAYC,EACxBhG,EAAI,MAAM,UAAW,iDAAiD8F,EAAU,KAAK,KAAK,OAAO,WAAW,GAAG,EACxG,EACV,KACG,OAAO,OAGR,OAAO,EAET,EAgBAhB,EAAkB,UAAU,aAAe,SAASmB,EAAWC,EAAcC,EAAY,CACxF,IAAI1E,EACA2E,EAAU,KACVC,EAAQ,GAUZ,IAPIJ,IAAc,GAEjBxE,EAAI,EAEJA,EAAI,KAAK,YAGHA,EAAI,KAAK,QAAQ,SACvB2E,EAAU,KAAK,QAAQ3E,CAAC,EACpB2E,EAAQ,WAAaF,IAFM,CAG9BG,EAAQ5E,EACJ0E,IACCC,EAAQ,UAAYA,EAAQ,YAAcF,EAC7CE,EAAQ,UAAYA,EAAQ,WAE5BA,EAAQ,UAAYF,EAAeE,EAAQ,UAE5C,KAAK,eAAc,GAKrB3E,GACF,CAEC,OAAI4E,IAAU,IACbD,EAAU,KAAK,QAAQC,CAAK,EACxBD,EAAQ,UAAYA,EAAQ,YAAcF,GAC7ClG,EAAI,MAAM,oBAAqB,sCAAsCqG,CAAK,EACnEA,GAEA,IAGD,EAET,EASAvB,EAAkB,UAAU,qBAAuB,SAASwB,EAAY,CACvE,IAAI7E,EACA8E,EACAC,EACAH,EAASC,IAAe,OAAYA,EAAa,KAAK,YAG1D,GAFAC,EAAa,KAAK,QAAQF,CAAK,EAE3B,KAAK,QAAQ,OAASA,EAAM,EAC/B,IAAK5E,EAAI4E,EAAM,EAAG5E,EAAI,KAAK,QAAQ,SAClC+E,EAAU,KAAK,QAAQ/E,CAAC,EACpB+E,EAAQ,YAAcD,EAAW,UAAYA,EAAW,YAFlB9E,IAGzC8E,EAAaC,EAOhB,OAAOD,EAAW,UAAYA,EAAW,UAC1C,EAQAzB,EAAkB,UAAU,wBAA0B,SAASjD,EAAK,CACnE,IAAIwE,EAAQ,KAAK,aAAa,GAAMxE,EAAK,EAAK,EAC9C,OAAIwE,IAAU,GACN,KAAK,qBAAqBA,CAAK,EAE/BxE,CAET,EAUAiD,EAAkB,UAAU,aAAe,SAAS2B,EAAS,CAC5D,KAAK,OAAO,WAAaA,EACzB,KAAK,eAAgB,CACtB,EAKA3B,EAAkB,UAAU,gBAAkB,UAAW,CACxD,KAAK,OAAO,UAAY,KAAK,OAAO,WACpC,KAAK,eAAgB,CACtB,EAiBAA,EAAkB,UAAU,KAAO,SAASoB,EAAcD,EAAWE,EAAY,CAChF,IAAIE,EAEJ,OADAA,EAAQ,KAAK,aAAaJ,EAAWC,EAAcC,CAAU,EACzDE,IAAU,IACb,KAAK,OAAS,KAAK,QAAQA,CAAK,EAChC,KAAK,YAAcA,EACnB,KAAK,SAAWH,EAAe,KAAK,OAAO,UAC3ClG,EAAI,MAAM,oBAAqB,4CAA4C,KAAK,QAAQ,EACjF,KAEPA,EAAI,MAAM,oBAAqB,YAAYkG,EAAa,6BAA6B,EAC9E,GAET,EAMApB,EAAkB,UAAU,YAAc,UAAW,CACpD,GAAI,KAAK,cAAgB,IAAM,KAAK,QAAQ,KAAK,WAAW,IAAM,KACjE,KAAM,oDAEP,OAAO,KAAK,QAAQ,KAAK,WAAW,EAAE,UAAU,KAAK,QACtD,EAMAA,EAAkB,UAAU,UAAY,UAAW,CAClD,OAAO,KAAK,UACb,EAEAA,EAAkB,UAAU,eAAiB,UAAW,CACvD,GAAI,KAAK,cAAgB,IAAM,KAAK,QAAQ,KAAK,WAAW,IAAM,KACjE,KAAM,oDAEP,OAAO,KAAK,QAAQ,KAAK,WAAW,EAAE,UAAU,KAAK,UACtD,EAGCpD,oBAA4BoD,EAM7B,IAAI4B,EAAwB,UAAY,CACvC,IAAIC,EAAiB,EACjBC,EAAyB,EACzBC,EAAuB,EACvBC,EAAqB,EAErBC,EAAgB,CAAE,EACtBA,EAAcJ,CAAW,EAAQ,gBACjCI,EAAcH,CAAqB,EAAK,0BACxCG,EAAcF,CAAkB,EAAM,sBACtCE,EAAcD,CAAgB,EAAM,qBAEpC,KAAK,kBAAoB,SAASE,EAAK,CACtC,OAAOD,EAAcC,CAAG,CAC1B,EAEC,IAAIC,EAAO,KACPC,EAAU,CAAE,EAEhB,YAAK,mBAAqB,SAAUC,EAAQ,CAE3C,IAAIpF,EAAO,EACPiF,EACAI,EACAC,EAKJ,IAJAL,EAAMG,EAAO,UAAW,EAExBE,EAAWF,EAAO,UAAW,EAEtBE,EAAW,KACjBtF,GAAQA,GAAQ,IAAMsF,EAAW,KACjCA,EAAWF,EAAO,UAAW,EAG9B,OAAApF,GAAQA,GAAQ,IAAMsF,EAAW,KACjCrH,EAAI,MAAM,wBAAyB,UAAU+G,EAAcC,CAAG,GAAK,cAAcA,GAAK,UAAUjF,EAAK,gBAAgBoF,EAAO,YAAW,CAAE,EACrIJ,EAAcC,CAAG,EACpBI,EAAO,IAAIF,EAAQH,EAAcC,CAAG,CAAC,EAAEjF,CAAI,EAE3CqF,EAAO,IAAIF,EAAQ,WAAWnF,CAAI,EAEnCqF,EAAK,MAAMD,CAAM,EACVC,CACT,EAECF,EAAQ,WAAa,SAASI,EAAMC,EAAO,CAC1C,KAAK,IAAMD,EACX,KAAK,KAAOC,EACZ,KAAK,MAAQ,CAAE,CACjB,EAECL,EAAQ,WAAW,UAAU,MAAQ,SAAUC,EAAQ,CACtD,KAAK,KAAOA,EAAO,eAAe,KAAK,IAAI,CAC7C,EAECD,EAAQ,WAAW,UAAU,eAAiB,SAAUF,EAAK,CAC5D,QAASvF,EAAI,EAAGA,EAAI,KAAK,MAAM,OAAQA,IACtC,GAAI,KAAK,MAAMA,CAAC,EAAE,KAAOuF,EACxB,OAAO,KAAK,MAAMvF,CAAC,EAGrB,OAAO,IACT,EAECyF,EAAQ,WAAW,UAAU,0BAA4B,SAAUC,EAAQ,CAE1E,QADIlH,EAAQkH,EAAO,SACZA,EAAO,SAAWlH,EAAM,KAAK,MAAM,CACzC,IAAImH,EAAOH,EAAK,mBAAmBE,CAAM,EACzC,KAAK,MAAM,KAAKC,CAAI,CACvB,CACA,EAECF,EAAQ,cAAgB,SAAUnF,EAAM,CACvCmF,EAAQ,WAAW,KAAK,KAAMP,EAAa5E,CAAI,CACjD,EAECmF,EAAQ,cAAc,UAAY,IAAIA,EAAQ,WAE9CA,EAAQ,cAAc,UAAU,MAAQ,SAASC,EAAQ,CAUxD,GATA,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,MAAQA,EAAO,UAAW,EAC/B,KAAK,MAAQ,EACT,KAAK,MAAQ,KAChB,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,MAAQ,GAEb,KAAK,gBAAkB,EAEpB,KAAK,MAAQ,GAAM,CACtB,IAAIK,EAAIL,EAAO,UAAW,EAC1B,KAAK,IAAMA,EAAO,WAAWK,CAAC,EAC9B,KAAK,MAAQA,EAAE,CAClB,MACG,KAAK,IAAM,GAER,KAAK,MAAQ,IAChB,KAAK,UAAYL,EAAO,WAAY,EACpC,KAAK,MAAQ,GAEb,KAAK,UAAY,EAElB,KAAK,0BAA0BA,CAAM,CACvC,EAECD,EAAQ,cAAc,UAAU,OAAS,SAASC,EAAQ,CACzD,IAAIM,EAAM,KAAK,eAAeb,CAAqB,EACnD,OAAIa,EACIA,EAAI,IAEJ,CAEV,EAECP,EAAQ,cAAc,UAAU,eAAiB,SAASC,EAAQ,CACjE,IAAIM,EAAM,KAAK,eAAeb,CAAqB,EACnD,GAAI,CAACa,EAAK,OAAO,KACjB,IAAIC,EAAMD,EAAI,eAAeZ,CAAkB,EAC/C,GAAIa,GAAOA,EAAI,KAAM,CACpB,IAAIC,GAAmBD,EAAI,KAAK,CAAC,EAAG,MAAS,EAC7C,OAAIC,IAAoB,IAAMD,EAAI,KAAK,QAAU,IAChDC,EAAkB,KAAOD,EAAI,KAAK,CAAC,EAAI,IAAQ,KAAOA,EAAI,KAAK,CAAC,EAAI,MAAS,IAEvEC,CACV,KACG,QAAO,IAEV,EAECT,EAAQ,wBAA0B,SAAUnF,EAAM,CACjDmF,EAAQ,WAAW,KAAK,KAAMN,EAAuB7E,CAAI,CAC3D,EACCmF,EAAQ,wBAAwB,UAAY,IAAIA,EAAQ,WAExDA,EAAQ,wBAAwB,UAAU,MAAQ,SAASC,EAAQ,CAClE,KAAK,IAAMA,EAAO,UAAW,EAC7B,KAAK,WAAaA,EAAO,UAAW,EACpC,KAAK,UAAa,KAAK,YAAc,EAAK,KAAO,EACjD,KAAK,WAAa,KAAK,aAAe,EACtC,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,MAAQ,GACb,KAAK,0BAA0BA,CAAM,CACvC,EAECD,EAAQ,oBAAsB,SAAUnF,EAAM,CAC7CmF,EAAQ,WAAW,KAAK,KAAML,EAAoB9E,CAAI,CACxD,EACCmF,EAAQ,oBAAoB,UAAY,IAAIA,EAAQ,WAEpDA,EAAQ,mBAAqB,SAAUnF,EAAM,CAC5CmF,EAAQ,WAAW,KAAK,KAAMJ,EAAkB/E,CAAI,CACtD,EACCmF,EAAQ,mBAAmB,UAAY,IAAIA,EAAQ,WAE5C,IACR,EAGCxF,wBAAgCgF,EAOjC,IAAIkB,EAAY,CACf,iBAAmB,GACnB,oBAAsB,EACtB,GAAK,EAGL,YAAa,CACZ,CAAC,KAAM,OAAQ,KAAM,cAAc,EACnC,CAAC,KAAM,OAAQ,KAAM,aAAa,EAClC,CAAC,KAAM,OAAQ,KAAM,cAAc,EACnC,CAAC,KAAM,OAAQ,KAAM,cAAc,EACnC,CAAC,KAAM,OAAQ,KAAM,gCAAgC,EACrD,CAAC,KAAM,OAAQ,KAAM,aAAa,CAClC,EACD,WAAY,CACX,CAAC,KAAM,OAAQ,KAAM,oBAAoB,EACzC,CAAC,KAAM,OAAQ,KAAM,oBAAoB,EACzC,CAAC,KAAM,OAAQ,KAAM,qBAAqB,EAC1C,CAAC,KAAM,OAAQ,KAAM,QAAQ,EAC7B,CAAC,KAAM,OAAQ,KAAM,cAAc,EACnC,CAAC,KAAM,OAAQ,KAAM,mBAAmB,EACxC,CAAC,KAAM,OAAQ,KAAM,oBAAoB,CACzC,EACD,gBAAiB,CAChB,CAAC,CAAC,KAAM,OAAQ,KAAM,oBAAoB,EAAG,CAAC,OAAQ,MAAM,CAAC,EAC7D,CAAC,CAAC,KAAM,OAAQ,KAAM,UAAU,CAAC,EACjC,CAAC,CAAC,KAAM,OAAQ,KAAM,SAAS,CAAC,EAChC,CAAC,CAAC,KAAM,OAAQ,KAAM,UAAU,CAAC,EACjC,CAAC,CAAC,KAAM,OAAQ,KAAM,qBAAqB,CAAC,EAC5C,CAAC,CAAC,KAAM,OAAQ,KAAM,oBAAoB,CAAC,EAC3C,CAAC,CAAC,KAAM,OAAQ,KAAM,gBAAgB,EAAG,CAAC,OAAQ,MAAM,CAAC,EACzD,CAAC,CAAC,KAAM,OAAQ,KAAM,iBAAiB,EAAG,CAAC,MAAM,CAAC,EAClD,CAAC,CAAC,KAAM,OAAQ,KAAM,4BAA4B,EAAG,CAAC,MAAM,CAAC,EAC7D,CAAC,CAAC,KAAM,OAAQ,KAAM,kBAAkB,EAAG,CAAC,OAAQ,OAAQ,MAAM,CAAC,EACnE,CAAC,CAAC,KAAM,OAAQ,KAAM,WAAW,CAAC,EAClC,CAAC,CAAC,KAAM,OAAQ,KAAM,mBAAmB,CAAC,EAC1C,CAAC,CAAC,KAAM,OAAQ,KAAM,kBAAkB,CAAC,EACzC,CAAC,CAAC,KAAM,OAAQ,KAAM,8BAA8B,EAAG,CAAC,MAAM,CAAC,EAC/D,CAAC,CAAC,KAAM,OAAQ,KAAM,gCAAgC,CAAC,EACvD,CAAC,CAAC,KAAM,OAAQ,KAAM,sBAAsB,CAAC,EAC7C,CAAC,CAAC,KAAM,OAAQ,KAAM,mBAAmB,CAAC,EAC1C,CAAC,CAAC,KAAM,OAAQ,KAAM,aAAa,CAAC,EACpC,CAAC,CAAC,KAAM,OAAQ,KAAM,uBAAuB,CAAC,EAC9C,CAAC,CAAC,KAAM,OAAQ,KAAM,yBAAyB,CAAC,EAChD,CAAC,CAAC,KAAM,OAAQ,KAAM,yBAAyB,CAAC,EAChD,CAAC,CAAC,KAAM,OAAQ,KAAM,sBAAsB,CAAC,EAC7C,CAAC,CAAC,KAAM,OAAQ,KAAM,eAAe,CAAC,EACtC,CAAC,CAAC,KAAM,OAAQ,KAAM,aAAa,EAAG,CAAC,MAAM,CAAC,EAC9C,CAAC,CAAC,KAAM,OAAQ,KAAM,mBAAmB,EAAG,CAAC,MAAM,CAAC,EACpD,CAAC,CAAC,KAAM,OAAQ,KAAM,0BAA0B,CAAC,EACjD,CAAC,CAAC,KAAM,OAAQ,KAAM,eAAe,CAAC,EACtC,CAAC,CAAC,KAAM,OAAQ,KAAM,kBAAkB,CAAC,EACzC,CAAC,CAAC,KAAM,OAAQ,KAAM,iBAAiB,EAAG,CAAC,MAAM,CAAC,CAClD,EAED,SAAW,CAAE,EACb,aAAe,CAAE,EACjB,kBAAoB,CAAE,EACtB,iBAAmB,CAAE,EACrB,sBAAuB,CAAE,EACzB,gBAAiB,CAAE,EACnB,UAAW,CAAE,EACb,MAAO,CAAE,EACT,WAAY,UAAW,CACtBA,EAAU,QAAQ,UAAY,IAAIA,EAAU,IAC5CA,EAAU,aAAa,UAAY,IAAIA,EAAU,IACjDA,EAAU,YAAY,UAAY,IAAIA,EAAU,IAChDA,EAAU,kBAAkB,UAAY,IAAIA,EAAU,QAGtDA,EAAU,YAAY,QAAQ,SAASC,EAAK,CAC3CD,EAAU,cAAcC,EAAI,KAAMA,EAAI,IAAI,CAC7C,CAAG,EACDD,EAAU,WAAW,QAAQ,SAASC,EAAK,CAC1CD,EAAU,kBAAkBC,EAAI,KAAMA,EAAI,IAAI,CACjD,CAAG,EACDD,EAAU,gBAAgB,QAAQ,SAASE,EAAO,CACjDF,EAAU,uBAAuBE,EAAM,CAAC,EAAE,KAAMA,EAAM,CAAC,EAAE,KAAM,KAAMA,EAAM,CAAC,CAAC,CAChF,CAAG,CACD,EACD,IAAK,SAASC,EAAOR,EAAOS,EAAOC,EAAO,CACzC,KAAK,KAAOF,EACZ,KAAK,SAAWC,EAChB,KAAK,KAAOT,EACZ,KAAK,KAAOU,CACZ,EACD,QAAS,SAASC,EAAMnG,EAAMoG,EAAMC,EAAM,CACzCR,EAAU,IAAI,KAAK,KAAMM,EAAMnG,EAAMoG,EAAMC,CAAI,EAC/C,KAAK,MAAQ,EACb,KAAK,QAAU,CACf,EACD,aAAc,SAASF,EAAMnG,EAAMoG,EAAMC,EAAM,CAC9CR,EAAU,IAAI,KAAK,KAAMM,EAAMnG,EAAMoG,EAAMC,CAAI,EAC/C,KAAK,MAAQ,CAAE,CACf,EACD,YAAa,SAASF,EAAMnG,EAAMsG,EAAUpI,EAAO,CAClD2H,EAAU,aAAa,KAAK,KAAMM,EAAMnG,CAAI,EAC5C,KAAK,SAAWsG,EAChB,KAAK,MAAQpI,CACb,EACD,iBAAkB,SAASiI,EAAM,CAChC,KAAK,cAAgBA,CACrB,EACD,kBAAmB,SAASA,EAAMnG,EAAM,CACvC6F,EAAU,QAAQ,KAAK,KAAMM,EAAMnG,CAAI,CACvC,EACD,cAAe,SAASmG,EAAMC,EAAMG,EAAY,CAC/CV,EAAU,SAAS,KAAKM,CAAI,EAC5BN,EAAUM,EAAK,KAAK,EAAI,SAASnG,EAAM,CACtC6F,EAAU,IAAI,KAAK,KAAMM,EAAMnG,EAAMoG,CAAI,CAC5C,EACEP,EAAUM,EAAK,KAAK,EAAE,UAAY,IAAIN,EAAU,IAC5CU,IAAaV,EAAUM,EAAK,KAAK,EAAE,UAAU,MAAQI,EACzD,EACD,kBAAmB,SAASJ,EAAMC,EAAMG,EAAa,CAEpDV,EAAUM,EAAK,KAAK,EAAI,SAASnG,EAAM,CACtC6F,EAAU,QAAQ,KAAK,KAAMM,EAAMnG,EAAMoG,CAAI,CAChD,EACEP,EAAUM,EAAK,KAAK,EAAE,UAAY,IAAIN,EAAU,QAChDA,EAAUM,EAAK,KAAK,EAAE,UAAU,MAAQ,SAASf,EAAQ,CACxD,KAAK,gBAAgBA,CAAM,EACvBmB,GACHA,EAAY,KAAK,KAAMnB,CAAM,CAE9B,CACD,EACD,gBAAiB,SAASoB,EAAa,CACtC,GAAIA,EAAa,CAChB,KAAK,YAAcA,EAEnB,QADIC,EAAaD,EAAY,OACpB7E,EAAI,EAAGA,EAAE8E,EAAY9E,IAC7B,KAAK6E,EAAY7E,CAAC,EAAE,GAAG,EAAI,CAAE,CAEjC,CACE,EACD,uBAAwB,SAASwE,EAAMC,EAAMG,EAAaC,EAAa,CAEtEX,EAAUM,EAAK,KAAK,EAAI,SAASnG,EAAM,CACtC6F,EAAU,aAAa,KAAK,KAAMM,EAAMnG,EAAMoG,CAAI,EAClDP,EAAU,gBAAgB,KAAK,KAAMW,CAAW,CACnD,EACEX,EAAUM,EAAK,KAAK,EAAE,UAAY,IAAIN,EAAU,aAC5CU,IAAaV,EAAUM,EAAK,KAAK,EAAE,UAAU,MAAQI,EACzD,EACD,2BAA4B,SAASG,EAAWH,EAAaC,EAAa,CACzEX,EAAU,iBAAiBa,CAAS,EAAI,CAAE,EAC1Cb,EAAUa,EAAU,aAAa,EAAI,SAASP,EAAMnG,EAAM,CACzD6F,EAAU,YAAY,KAAK,KAAMM,EAAMnG,CAAI,EAC3C6F,EAAU,gBAAgB,KAAK,KAAMW,CAAW,CAChD,EACDX,EAAUa,EAAU,aAAa,EAAE,UAAY,IAAIb,EAAU,YACzDU,IAAaV,EAAUa,EAAU,aAAa,EAAE,UAAW,MAAQH,EACvE,EACD,sBAAuB,SAASG,EAAWP,EAAMI,EAAaC,EAAa,CAC1EX,EAAU,iBAAiBa,CAAS,EAAE,KAAKP,CAAI,EAC/CN,EAAUM,EAAK,aAAa,EAAI,SAASnG,EAAM,CAC9C6F,EAAUa,EAAU,aAAa,EAAE,KAAK,KAAMP,EAAMnG,CAAI,EACxD6F,EAAU,gBAAgB,KAAK,KAAMW,CAAW,CAChD,EACDX,EAAUM,EAAK,aAAa,EAAE,UAAY,IAAIN,EAAUa,EAAU,aAAa,EAC3EH,IAAaV,EAAUM,EAAK,aAAa,EAAE,UAAU,MAAQI,EACjE,EACD,+BAAgC,SAASG,EAAWP,EAAMI,EAAa,CACtEV,EAAU,sBAAsB,KAAK,KAAMa,EAAWP,EAAMI,EAAa,CAAC,MAAM,CAAC,CACjF,EACD,sBAAuB,SAASJ,EAAMI,EAAa,CAElDV,EAAUM,EAAK,kBAAkB,EAAI,SAASnG,EAAM,CACnD6F,EAAU,iBAAiB,KAAK,KAAMM,EAAMnG,CAAI,CACnD,EACE6F,EAAUM,EAAK,kBAAkB,EAAE,UAAY,IAAIN,EAAU,iBACzDU,IAAaV,EAAUM,EAAK,kBAAkB,EAAE,UAAU,MAAQI,EACtE,EACD,qBAAsB,SAASJ,EAAMI,EAAa,CAEjDV,EAAUM,EAAK,mBAAmB,EAAI,SAASnG,EAAM,CACpD6F,EAAU,kBAAkB,KAAK,KAAMM,EAAMnG,CAAI,CACpD,EACE6F,EAAUM,EAAK,mBAAmB,EAAE,UAAY,IAAIN,EAAU,kBAC1DU,IAAaV,EAAUM,EAAK,mBAAmB,EAAE,UAAU,MAAQI,EACvE,EACD,cAAe,SAASF,EAAMD,EAAMO,EAAWC,EAAgBL,EAAa,CAC3EV,EAAU,MAAM,KAAKQ,CAAI,EACzBR,EAAU,UAAUQ,CAAI,EAAI,SAASrG,EAAM,CACtC2G,EACHd,EAAU,QAAQ,KAAK,KAAM,OAAQ7F,EAAMoG,EAAMC,CAAI,EAEjDO,EACHf,EAAU,aAAa,KAAK,KAAM,OAAQ7F,EAAMoG,EAAMC,CAAI,EAE1DR,EAAU,IAAI,KAAK,KAAM,OAAQ7F,EAAMoG,EAAMC,CAAI,CAGtD,EACER,EAAU,UAAUQ,CAAI,EAAE,UAAaM,EAAY,IAAId,EAAU,QAAae,EAAiB,IAAIf,EAAU,aAAiB,IAAIA,EAAU,IACxIU,IACCI,EACHd,EAAU,UAAUQ,CAAI,EAAE,UAAU,MAAQ,SAASjB,EAAQ,CAC5D,KAAK,gBAAgBA,CAAM,EACvBmB,GACHA,EAAY,KAAK,KAAMnB,CAAM,CAEnC,EAEIS,EAAU,UAAUQ,CAAI,EAAE,UAAU,MAAQE,EAGhD,CACA,EAEAV,EAAU,WAAY,EAEtBA,EAAU,kBAAuB,EACjCA,EAAU,mBAAuB,EACjCA,EAAU,qBAAuB,EAEjCA,EAAU,2BAA6B,EACvCA,EAAU,sBAA0B,EACpCA,EAAU,qBAAyB,EACnCA,EAAU,sBAA0B,GACpCA,EAAU,uBAA0B,GACpCA,EAAU,oBAAwB,MAClCA,EAAU,+BAAgC,OAE1CA,EAAU,uBAAwB,EAClCA,EAAU,sBAAwB,EAClCA,EAAU,oBAAsB,IAChCA,EAAU,gBAAmB,IAC7BA,EAAU,iBAAoB,KAC9BA,EAAU,sBAAwB,KAElCA,EAAU,IAAI,UAAU,IAAM,SAASO,EAAM,CAC5C,OAAO,KAAK,OAAO,IAAIP,EAAUO,EAAK,KAAK,CAAG,CAC/C,EAEAP,EAAU,IAAI,UAAU,OAAS,SAASC,EAAK,CAC9C,YAAK,MAAM,KAAKA,CAAG,EACf,KAAKA,EAAI,KAAK,GAAG,EACpB,KAAKA,EAAI,KAAK,GAAG,EAAE,KAAKA,CAAG,EAE3B,KAAKA,EAAI,IAAI,EAAIA,EAEXA,CACR,EAEAD,EAAU,IAAI,UAAU,IAAM,SAASgB,EAAM/D,EAAO,CACnD,YAAK+D,CAAI,EAAI/D,EACN,IACR,EAEA+C,EAAU,IAAI,UAAU,SAAW,SAAS/C,EAAOgE,EAAO,CACzD,IAAID,EAAOC,GAAS,UACpB,OAAK,KAAKD,CAAI,IACb,KAAKA,CAAI,EAAI,CAAE,GAEhB,KAAKA,CAAI,EAAE,KAAK/D,CAAK,EACd,IACR,EAGCnD,YAAoBkG,EAOrBA,EAAU,UAAY,SAAST,EAAQ,CACtC,OAAOS,EAAU,WAAWT,CAAM,CACnC,EAEAS,EAAU,WAAa,SAAST,EAAQ,CAEvC,QADI2B,EAAQ,GACHrH,EAAI,EAAGA,EAAG,GAAIA,IAAK,CAC3B,IAAIsH,EAAM5B,EAAO,UAAS,EAAG,SAAS,EAAE,EACxC2B,GAAUC,EAAI,SAAW,EAAI,IAAIA,EAAMA,CACzC,CACC,OAAOD,CACR,EAEAlB,EAAU,YAAc,SAAST,EAAQ6B,EAAYC,EAAY,CAChE,IAAIpB,EACA5H,EAAQkH,EAAO,YAAa,EAC5BkB,EAAW,EACXa,EACAd,EACJ,GAAIjB,EAAO,iBAAmBlH,EAAQ,EACrC,OAAAD,EAAI,MAAM,YAAa,iEAAiE,EACjF,CAAE,KAAM4H,EAAU,mBAAqB,EAE/C,GAAIqB,GAAcA,EAAa,EAC9B,OAAAjJ,EAAI,MAAM,YAAa,4DAA4D,EAC5E,CAAE,KAAM4H,EAAU,mBAAqB,EAE/C,IAAI7F,EAAOoF,EAAO,WAAY,EAC1Be,EAAOf,EAAO,WAAW,CAAC,EAC1BgC,EAAWjB,EAGf,GAFAlI,EAAI,MAAM,YAAa,sBAAsBkI,EAAK,cAAcnG,EAAK,gBAAgB9B,CAAK,EAC1FoI,EAAW,EACPH,GAAQ,OAAQ,CACnB,GAAKf,EAAO,eAAgB,EAAGA,EAAO,cAAgB,IAAQ8B,EAAYZ,EAAW,GACpF,OAAAlB,EAAO,KAAKlH,CAAK,EACjBD,EAAI,MAAM,YAAa,6DAA6D,EAC7E,CAAE,KAAM4H,EAAU,mBAAqB,EAE/CQ,EAAOR,EAAU,UAAUT,CAAM,EACjCkB,GAAY,GACZc,EAAWf,CACb,CACC,GAAIrG,GAAQ,EAAG,CACd,GAAKoF,EAAO,eAAgB,EAAGA,EAAO,YAAW,EAAK,GAAO8B,GAAeA,EAAaZ,EAAY,EACpG,OAAAlB,EAAO,KAAKlH,CAAK,EACjBD,EAAI,KAAK,YAAa,gEAAiEkI,EAAK,OAAQ,EAC7F,CAAE,KAAMN,EAAU,mBAAqB,EAE/C7F,EAAOoF,EAAO,WAAY,EAC1BkB,GAAY,CACd,SAAYtG,IAAS,GAEnB,GAAIkH,EACHlH,EAAOkH,UAGHf,IAAS,OACZ,OAAAlI,EAAI,MAAM,YAAa,+CAA+CkI,EAAK,GAAG,EAC9EL,EAAM,IAAID,EAAU,IAAIM,EAAMnG,CAAI,EAC3B,CAAE,KAAM6F,EAAU,GAAI,IAAKC,EAAK,KAAMA,EAAI,IAAM,EAI1D,OAAI9F,IAAS,GAAKA,EAAOsG,GACxBrI,EAAI,MAAM,YAAa,eAAekI,EAAK,wBAAwBnG,EAAK,0BAA0B,EAC3F,CAAE,KAAM6F,EAAU,oBAAqB,KAAMM,EAAM,KAAMnG,EAAM,SAAUsG,EAAU,MAAOpI,CAAO,GAErG8B,IAAS,GAAKkH,GAAclH,EAAOkH,GACtCjJ,EAAI,MAAM,YAAa,gBAAgBkI,EAAK,gBAAgBnG,EAAK,oCAAoCkH,CAAU,EACxG,CAAE,KAAMrB,EAAU,oBAAqB,KAAMM,EAAM,KAAMnG,EAAM,SAAUsG,EAAU,MAAOpI,CAAO,GAErG8B,IAAS,GAAK9B,EAAQ8B,EAAOoF,EAAO,kBACvCA,EAAO,KAAKlH,CAAK,EACjBD,EAAI,KAAK,YAAa,kDAAkDkI,EAAK,OAAO,EAC7E,CAAE,KAAMN,EAAU,oBAAqB,KAAMM,EAAM,KAAMnG,EAAM,SAAUsG,EAAU,MAAOpI,CAAO,GAErG+I,EACI,CAAE,KAAMpB,EAAU,GAAI,KAAMM,EAAM,KAAMnG,EAAM,SAAUsG,EAAU,MAAOpI,CAAO,GAEnF2H,EAAUM,EAAK,KAAK,EACvBL,EAAM,IAAID,EAAUM,EAAK,KAAK,EAAEnG,CAAI,EAEhCmG,IAAS,QACZlI,EAAI,KAAK,YAAa,sBAAsBkI,EAAK,GAAG,EACpDL,EAAM,IAAID,EAAU,IAAIM,EAAMnG,CAAI,EAClC8F,EAAI,kBAAoB,IAEpBD,EAAU,UAAUQ,CAAI,EAC3BP,EAAM,IAAID,EAAU,UAAUQ,CAAI,EAAErG,CAAI,GAExC/B,EAAI,KAAK,YAAa,uBAAuBoI,EAAK,GAAG,EACrDP,EAAM,IAAID,EAAU,IAAIM,EAAMnG,CAAI,EAClC8F,EAAI,KAAOO,EACXP,EAAI,kBAAoB,IAK5BA,EAAI,SAAWQ,EAEfR,EAAI,MAAQ5H,EACR4H,EAAI,QAAUD,EAAU,IAAI,UAAU,OAASC,EAAI,OAAS,SAC/D7H,EAAI,KAAK,YAAa,IAAImJ,EAAS,oFAAoF,EACvHtB,EAAI,mBAAmBV,CAAM,GAE9BU,EAAI,MAAMV,CAAM,EAChB+B,EAAO/B,EAAO,YAAa,GAAIU,EAAI,MAAMA,EAAI,MACzCqB,EAAO,GACVlJ,EAAI,KAAK,YAAa,mBAAmBmJ,EAAS,8DAA+D,CAACD,EAAM,0BAA0B,EAClJ/B,EAAO,KAAKU,EAAI,MAAMA,EAAI,IAAI,GACpBqB,EAAO,IACjBlJ,EAAI,MAAM,YAAa,mBAAmBmJ,EAAS,UAAUD,EAAK,iEAAiE,EAC/HrB,EAAI,OAAS,GAAGV,EAAO,KAAKU,EAAI,MAAMA,EAAI,IAAI,GAE5C,CAAE,KAAMD,EAAU,GAAI,IAAKC,EAAK,KAAMA,EAAI,IAAM,EACxD,EAEAD,EAAU,IAAI,UAAU,MAAQ,SAAST,EAAQ,CAC5C,KAAK,MAAQ,OAChB,KAAK,KAAOA,EAAO,eAAe,KAAK,KAAK,KAAK,QAAQ,EAErD,KAAK,OAAS,EACjBA,EAAO,KAAKA,EAAO,gBAAgB,EAEnCA,EAAO,KAAK,KAAK,MAAM,KAAK,IAAI,CAGnC,EAIAS,EAAU,IAAI,UAAU,mBAAqB,SAAST,EAAQ,CAC7D,KAAK,KAAOA,EAAO,eAAe,KAAK,KAAK,KAAK,QAAQ,EAEzDA,EAAO,UAAY,KAAK,KAAK,KAAK,QACnC,EAEAS,EAAU,QAAQ,UAAU,mBAAqB,SAAST,EAAQ,CACjE,KAAK,gBAAgBA,CAAM,EAC3B,KAAK,KAAOA,EAAO,eAAe,KAAK,KAAK,KAAK,QAAQ,EAEzD,KAAK,UAAY,EAEjBA,EAAO,UAAY,KAAK,KAAK,KAAK,QACnC,EAEAS,EAAU,QAAQ,UAAU,gBAAkB,SAAUT,EAAQ,CAC/D,KAAK,QAAUA,EAAO,UAAW,EACjC,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,UAAY,CAClB,EAEAS,EAAU,QAAQ,UAAU,MAAQ,SAAUT,EAAQ,CACrD,KAAK,gBAAgBA,CAAM,EAC3B,KAAK,KAAOA,EAAO,eAAe,KAAK,KAAK,KAAK,QAAQ,CAC1D,EAEAS,EAAU,aAAa,UAAU,MAAQ,SAAST,EAAQ,CAGzD,QAFIiC,EACAvB,EACGV,EAAO,YAAa,EAAG,KAAK,MAAM,KAAK,MAE7C,GADAiC,EAAMxB,EAAU,YAAYT,EAAQ,GAAO,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACtFiC,EAAI,OAASxB,EAAU,GAI1B,GAHAC,EAAMuB,EAAI,IAEV,KAAK,MAAM,KAAKvB,CAAG,EACf,KAAK,aAAe,KAAK,YAAY,QAAQA,EAAI,IAAI,GAAK,GAC7D,KAAK,KAAK,YAAY,KAAK,YAAY,QAAQA,EAAI,IAAI,CAAC,EAAE,GAAG,EAAE,KAAKA,CAAG,MACjE,CACN,IAAIsB,EAAWtB,EAAI,OAAS,OAASA,EAAI,KAAOA,EAAI,KAChD,KAAKsB,CAAQ,EAChBnJ,EAAI,KAAK,eAAemJ,EAAS,uCAAuC,EAExE,KAAKA,CAAQ,EAAItB,CAEtB,KAEG,OAGH,EAEAD,EAAU,IAAI,UAAU,cAAgB,SAAST,EAAQ,CACxD,KAAK,SAAWA,EAAO,WAAY,EACnC,IAAIkC,EAAQ,CAAE,EACdA,EAAM,CAAC,EAAK,KAAK,UAAU,GAAI,GAC/BA,EAAM,CAAC,EAAK,KAAK,UAAU,EAAG,GAC9BA,EAAM,CAAC,EAAK,KAAK,SAAU,GAC3B,KAAK,eAAiB,OAAO,aAAaA,EAAM,CAAC,EAAE,GAAMA,EAAM,CAAC,EAAE,GAAMA,EAAM,CAAC,EAAE,EAAI,CACtF,EAGAzB,EAAU,yBAA6B,SACvCA,EAAU,wBAA4B,QACtCA,EAAU,uBAA2B,OACrCA,EAAU,2BAA8B,WACxCA,EAAU,2BAA8B,WACxCA,EAAU,yBAA6B,SACvCA,EAAU,uBAA2B,OAErCA,EAAU,YAAY,UAAU,YAAc,SAAST,EAAQ,CAC9DA,EAAO,eAAe,CAAC,EACvB,KAAK,qBAAuBA,EAAO,WAAY,EAC/C,KAAK,UAAY,CAClB,EAEAS,EAAU,YAAY,UAAU,MAAQ,SAAST,EAAQ,CACxD,KAAK,YAAYA,CAAM,EACvB,KAAK,KAAOA,EAAO,eAAe,KAAK,KAAO,KAAK,QAAQ,CAC5D,EAEAS,EAAU,YAAY,UAAU,mBAAqB,SAAST,EAAQ,CACrE,KAAK,YAAYA,CAAM,EACvB,KAAK,KAAOA,EAAO,eAAe,KAAK,KAAO,KAAK,QAAQ,EAE3D,KAAK,UAAY,EAEjBA,EAAO,UAAY,KAAK,KAAK,KAAK,QACnC,EAEAS,EAAU,YAAY,UAAU,YAAc,SAAST,EAAQ,CAC9DS,EAAU,aAAa,UAAU,MAAM,KAAK,KAAMT,CAAM,CACzD,EAGAS,EAAU,2BAA2BA,EAAU,sBAAsB,EACrEA,EAAU,2BAA2BA,EAAU,0BAA0B,EACzEA,EAAU,2BAA2BA,EAAU,0BAA0B,EACzEA,EAAU,2BAA2BA,EAAU,wBAAwB,EACvEA,EAAU,2BAA2BA,EAAU,sBAAsB,EAGrEA,EAAU,2BAA2BA,EAAU,yBAA0B,SAAST,EAAQ,CACzF,IAAImC,EACJ,KAAK,YAAYnC,CAAM,EACvBA,EAAO,WAAY,EACnBA,EAAO,WAAY,EACnBA,EAAO,gBAAgB,CAAC,EACxB,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,OAASA,EAAO,WAAY,EACjC,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,eAAiBA,EAAO,WAAY,EACzCA,EAAO,WAAY,EACnB,KAAK,YAAcA,EAAO,WAAY,EACtCmC,EAAwB,KAAK,IAAI,GAAInC,EAAO,UAAS,CAAE,EACvD,KAAK,eAAiBA,EAAO,WAAWmC,CAAqB,EACzDA,EAAwB,IAC3BnC,EAAO,WAAW,GAAKmC,CAAqB,EAE7C,KAAK,MAAQnC,EAAO,WAAY,EAChCA,EAAO,WAAY,EACnB,KAAK,YAAYA,CAAM,CACxB,CAAC,EAEDS,EAAU,2BAA2BA,EAAU,wBAAyB,SAAST,EAAQ,CACxF,KAAK,YAAYA,CAAM,EACvBA,EAAO,gBAAgB,CAAC,EACxB,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,WAAaA,EAAO,WAAY,EACrCA,EAAO,WAAY,EACnBA,EAAO,WAAY,EACnB,KAAK,WAAcA,EAAO,WAAU,EAAI,MACxC,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,yBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAC1EA,EAAU,sBAAsBA,EAAU,wBAA0B,MAAM,EAG1EA,EAAU,+BAA+BA,EAAU,yBAA2B,MAAM,EACpFA,EAAU,+BAA+BA,EAAU,wBAA0B,MAAM,EACnFA,EAAU,+BAA+BA,EAAU,2BAA6B,MAAM,EACtFA,EAAU,+BAA+BA,EAAU,yBAA2B,MAAM,EACpFA,EAAU,+BAA+BA,EAAU,uBAA0B,MAAM,EACnFA,EAAU,+BAA+BA,EAAU,2BAA6B,MAAM,EAEtFA,EAAU,cAAc,OAAQ,kCAAmC,SAAST,EAAQ,CACnF,IAAIoC,EAAapC,EAAO,UAAS,EAAK,EAClCqC,IAAgBD,EAAa,GAAK,GAAK,GAC3C,KAAK,WAAa,CAAE,EACpB,QAAS9H,EAAI,EAAGA,EAAI,EAAGA,IAClB+H,GAAe,GAClB,KAAK,WAAW/H,CAAC,EAAI0F,EAAO,WAAY,EAExC,KAAK,WAAW1F,CAAC,EAAI0F,EAAO,WAAY,CAG3C,CAAC,EACDS,EAAU,cAAc,OAAQ,iCAAkC,SAAST,EAAQ,CAClF,KAAK,SAAWA,EAAO,UAAW,CACnC,CAAC,EACDS,EAAU,kBAAkB,OAAQ,wBAAyB,SAAST,EAAQ,CAC7E,KAAK,SAAWA,EAAO,YAAa,EACpC,IAAIsC,EAAqB,KAAK,KAAO,KAAK,UAAY,KAAK,SAAS,OAAS,GAC7E,KAAK,YAActC,EAAO,eAAesC,CAAkB,CAC5D,CAAC,EACD7B,EAAU,cAAc,OAAQ,2BAA4B,SAAST,EAAQ,CAG5E,IAAIxD,EAAMwD,EAAO,UAAW,EAC5B,IAAKxD,GAAO,EAAI,KAAS,EAAG,CAC3B3D,EAAI,MAAM,qBAAqB,EAC/B,MACF,CAEC,GADA,KAAK,QAAU2D,EAAM,IACjB,KAAK,UAAY,EAAG,CACvB3D,EAAI,MAAM,gBAAgB,KAAK,QAAQ,gBAAgB,EACvD,MACF,CAcC,GAbA2D,EAAMwD,EAAO,UAAW,EACxB,KAAK,YAAexD,GAAO,EAAK,EAChC,KAAK,gBAAkBA,EAAM,GAC7BA,EAAMwD,EAAO,UAAW,EACxB,KAAK,WAAcxD,GAAO,EAAK,EAC/B,KAAK,cAAiBA,GAAO,EAAK,EAClC,KAAK,WAAcA,GAAO,EAAK,EAC/B,KAAK,WAAcA,GAAO,EAAK,EAC/B,KAAK,qBAAwBA,GAAO,EAAK,EACzC,KAAK,qBAAwBA,GAAO,EAAK,EACzC,KAAK,uBAA0BA,EAAM,EACrCA,EAAMwD,EAAO,UAAW,EACxB,KAAK,WAAcxD,GAAO,EAAK,EAC3B,KAAK,aAAe,EAAG,CAC1B3D,EAAI,MAAM,iCAAiC,EAC3C,MACF,CAEC,GADA,KAAK,mCAAsC2D,GAAO,EAAK,EACnD,KAAK,qCAAuC,EAC/C,KAAK,qCAAwCA,EAAM,WAEnD,KAAK,WAAcA,EAAM,GACrB,KAAK,aAAe,EAAG,CAC1B3D,EAAI,MAAM,iCAAiC,EAC3C,MACH,CAGC,IAAI0J,EAAoB,KAAK,KAAO,KAAK,SAAW,EACpD,KAAK,WAAavC,EAAO,eAAeuC,CAAiB,CAC1D,CAAC,EAGD,SAASC,EAAQC,EAAI,CACpB,IAAI3I,EAAM,8BACVA,GAAO,4DACPA,GAAO,UAEP,QAASQ,EAAE,EAAGA,EAAImI,EAAG,OAAQnI,IAAK,CACjC,IAAIoI,EAAOD,EAAGnI,CAAC,EACfR,GAAO,OACPA,GAAO,OAAO4I,EAAK,OAAO,QAC1B5I,GAAO,OACPA,GAAO4I,EAAK,KAAK,OAAO,SAAS5I,EAAK6I,EAAM,CAC3C,OAAO7I,EAAM6I,EAAK,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAC9C,EAAE,IAAI,EACP7I,GAAO,YACT,CACC,OAAAA,GAAO,mBACAA,CACR,CAEA2G,EAAU,cAAc,OAAQ,sBAAuB,SAAST,EAAQ,CACvE,IAAI1F,EACAsI,EAYJ,IAXA,KAAK,qBAAuB5C,EAAO,UAAW,EAC9C,KAAK,qBAAuBA,EAAO,UAAW,EAC9C,KAAK,sBAAwBA,EAAO,UAAW,EAC/C,KAAK,mBAAqBA,EAAO,UAAW,EAC5C,KAAK,mBAAsBA,EAAO,UAAS,EAAK,EAChD,KAAK,aAAgBA,EAAO,UAAS,EAAK,GAC1C4C,EAAU,KAAK,KAAO,KAAK,SAAW,EACtC,KAAK,IAAM,CAAE,EACb,KAAK,IAAI,SAAW,UAAY,CAC/B,OAAOJ,EAAQ,IAAI,CACrB,EACMlI,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,IAAIA,CAAC,EAAI,CAAE,EAChB,KAAK,IAAIA,CAAC,EAAE,OAAS0F,EAAO,WAAY,EACxC,KAAK,IAAI1F,CAAC,EAAE,KAAO0F,EAAO,eAAe,KAAK,IAAI1F,CAAC,EAAE,MAAM,EAC3DsI,GAAW,EAAE,KAAK,IAAItI,CAAC,EAAE,OAQ1B,IANA,KAAK,aAAe0F,EAAO,UAAW,EACtC4C,IACA,KAAK,IAAM,CAAE,EACb,KAAK,IAAI,SAAW,UAAY,CAC/B,OAAOJ,EAAQ,IAAI,CACrB,EACMlI,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,IAAIA,CAAC,EAAI,CAAE,EAChB,KAAK,IAAIA,CAAC,EAAE,OAAS0F,EAAO,WAAY,EACxC,KAAK,IAAI1F,CAAC,EAAE,KAAO0F,EAAO,eAAe,KAAK,IAAI1F,CAAC,EAAE,MAAM,EAC3DsI,GAAW,EAAE,KAAK,IAAItI,CAAC,EAAE,OAEtBsI,EAAQ,IACX,KAAK,IAAM5C,EAAO,eAAe4C,CAAO,EAE1C,CAAC,EAGDnC,EAAU,cAAc,OAAQ,aAAc,SAAST,EAAQ,CAC9D,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,WAAaA,EAAO,WAAY,CACtC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,uBAAwB,SAAST,EAAQ,CAC5E,IAAI6C,EAAQ7C,EAAO,UAAW,EAC9B,KAAK,oBAAuB6C,EAAQ,MAAS,IAC7C,KAAK,iBAAoBA,EAAQ,KAAS,GAC1C,KAAK,iBAAoBA,EAAQ,KAAS,EAC1C7C,EAAO,WAAY,CACpB,CAAC,EAGDS,EAAU,cAAc,OAAQ,yBAA0B,SAAST,EAAQ,CACvE,IAAI1F,EAKJ,IAJA,KAAK,cAAgB0F,EAAO,WAAY,EACxC,KAAK,gBAAkB,CAAE,EACzB,KAAK,cAAgB,CAAE,EACvB,KAAK,qBAAuB,CAAE,EACzB1F,EAAI,EAAGA,EAAI,KAAK,cAAeA,IAChC,KAAK,gBAAgB,KAAK0F,EAAO,WAAU,CAAE,EAC7C,KAAK,cAAc,KAAKA,EAAO,WAAU,CAAE,EAC3C,KAAK,qBAAqB,KAAKA,EAAO,WAAU,CAAE,CAE1D,CAAC,EAGDS,EAAU,cAAc,OAAQ,mBAAoB,SAAST,EAAQ,CACpE,KAAK,oBAAsBA,EAAO,WAAY,EAC9C,KAAK,oBAAsBA,EAAO,WAAY,EAC9C,KAAK,qBAAuBA,EAAO,WAAY,EAC/C,KAAK,qBAAuBA,EAAO,WAAY,EAC/C,KAAK,UAAYA,EAAO,WAAY,EACpC,KAAK,UAAYA,EAAO,WAAY,EACpC,KAAK,SAAWA,EAAO,WAAY,EACnC,KAAK,SAAWA,EAAO,WAAY,CACpC,CAAC,EACDS,EAAU,cAAc,OAAQ,uBAAwB,SAAST,EAAQ,CACxE,KAAK,wBAA0BA,EAAO,WAAY,EAC/C,KAAK,4BAA8BA,EAAO,WAAY,CAC1D,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,gCAAiC,SAAST,EAAQ,CACjF,KAAK,MAAQ,IAChB,KAAK,MAAQA,EAAO,UAAW,GAE5B,KAAK,MAAQ,IAChB,KAAK,MAAQA,EAAO,UAAW,GAE5B,KAAK,MAAQ,IAChB,KAAK,MAAQA,EAAO,UAAW,GAE5B,KAAK,MAAQ,IACZ,KAAK,SAAW,EACf,KAAK,MAAQ,IAChB,KAAK,OAASA,EAAO,UAAW,EAChC,KAAK,OAASA,EAAO,UAAW,EAChC,KAAK,OAASA,EAAO,UAAW,IAEhC,KAAK,OAASA,EAAO,UAAW,EAChC,KAAK,OAASA,EAAO,UAAW,EAChC,KAAK,OAASA,EAAO,UAAW,GAEvB,KAAK,SAAW,GAIxB,KAAK,MAAQ,KAChB,KAAK,GAAKA,EAAO,WAAY,EAE/B,CAAC,EAEDS,EAAU,kBAAkB,OAAQ,gCAAiC,SAAST,EAAQ,CACrF,KAAK,eAAiBA,EAAO,UAAW,EACxC,KAAK,kBAAoBA,EAAO,UAAW,EAC3C,KAAK,kBAAoBA,EAAO,UAAW,EACvC,KAAK,MAAQ,IAChB,KAAK,eAAiBA,EAAO,UAAW,EACxC,KAAK,YAAcA,EAAO,UAAW,EAEvC,CAAC,EACDS,EAAU,cAAc,OAAQ,yBAA0B,SAAST,EAAQ,CAI1E,IAHA,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,gBAAkB,CAAE,EACzB,KAAK,oBAAsB,CAAE,EACxB,EAAI,EAAG,EAAI,KAAK,gBAAiB,IAAK,CAC1C,IAAI8C,EAAiB9C,EAAO,WAAY,EACxC,KAAK,gBAAgB,KAAK8C,CAAc,EACpCA,GAAkB,OACrB,KAAK,oBAAoB,KAAK9C,EAAO,YAAW,CAAE,CAErD,CACA,CAAC,EACDS,EAAU,kBAAkB,OAAQ,sBAAuB,SAAST,EAAQ,CAC3E,IAAI+C,EACAzI,EAGJ,GAFAyI,EAAc/C,EAAO,WAAY,EACjC,KAAK,cAAgB,CAAE,EACnB,KAAK,UAAY,EACpB,IAAI1F,EAAE,EAAGA,EAAEyI,EAAazI,IACvB,KAAK,cAAc,KAAK0F,EAAO,WAAU,CAAE,CAG9C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,uBAAwB,SAAST,EAAQ,CAC5E,KAAK,OAASA,EAAO,WAAY,EAC9B,KAAK,QAAUA,EAAO,WAAY,CACtC,CAAC,EAGDS,EAAU,cAAc,OAAQ,uBAAwB,SAAST,EAAQ,CAExE,GADA,KAAK,YAAcA,EAAO,WAAW,CAAC,EAClC,KAAK,cAAgB,OAAQ,CAChC,KAAK,iBAAmBA,EAAO,WAAY,EAC3C,KAAK,yBAA2BA,EAAO,WAAY,EACnD,KAAK,oBAAsBA,EAAO,WAAY,EAC9C,IAAIxD,EAAMwD,EAAO,UAAW,EAC5B,KAAK,gBAAkBxD,GAAO,CAChC,MAAY,KAAK,cAAgB,OAC/B,KAAK,YAAcwD,EAAO,eAAe,KAAK,KAAO,CAAC,EAC5C,KAAK,cAAgB,SAC/B,KAAK,YAAcA,EAAO,eAAe,KAAK,KAAO,CAAC,EAExD,CAAC,EACDS,EAAU,kBAAkB,OAAQ,eAAgB,SAAUT,EAAQ,CACrE,KAAK,cAAcA,CAAM,EACzB,KAAK,OAASA,EAAO,YAAa,CACnC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,yBAA0B,SAAST,EAAQ,CAE1E,KAAK,UAAY,IACpB,KAAK,sBAAwBA,EAAO,YACpC,KAAK,0BAA4BA,EAAO,YACxC,KAAK,6BAA+BA,EAAO,YAC3C,KAAK,qBAAuBA,EAAO,YACnC,KAAK,mBAAqBA,EAAO,YAEnC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,uBAAwB,SAAST,EAAQ,CAC5E,IAAI+C,EACAzI,EAIJ,GAHAyI,EAAc/C,EAAO,WAAY,EACjC,KAAK,cAAgB,CAAE,EACvB,KAAK,eAAiB,CAAE,EACpB,KAAK,UAAY,EACpB,IAAI1F,EAAE,EAAGA,EAAEyI,EAAazI,IAAK,CAC5B,KAAK,cAAc,KAAK0F,EAAO,WAAU,CAAE,EAIxC,IAAItC,EAAQsC,EAAO,UAAW,EAC1BtC,EAAQ,GACV7E,EAAI,KAAK,YAAa,uDAAuD,EAElF,KAAK,eAAe,KAAK6E,CAAK,CACjC,SACY,KAAK,SAAW,EAC1B,IAAIpD,EAAE,EAAGA,EAAEyI,EAAazI,IACvB,KAAK,cAAc,KAAK0F,EAAO,WAAU,CAAE,EAC3C,KAAK,eAAe,KAAKA,EAAO,UAAW,CAAA,CAG9C,CAAC,EAGDS,EAAU,cAAc,OAAQ,iBAAkB,SAAST,EAAQ,CAClE,IAAIgD,EAAYhD,EAAO,UAAW,EAC9BiD,EAAYjD,EAAO,UAAW,EAC9BkD,EAAYlD,EAAO,UAAW,EAClC,KAAK,MAAQgD,GAAa,EAC1B,KAAK,KAAUA,GAAa,EAAK,GACjC,KAAK,OAAUA,EAAY,IAAS,EAAOC,GAAa,EAAK,EAC7D,KAAK,MAAUA,GAAa,EAAK,EACjC,KAAK,MAAUA,GAAa,EAAK,EACjC,KAAK,cAAiBA,EAAY,EAASC,GAAa,EAAK,CAC9D,CAAC,EAGDzC,EAAU,cAAc,OAAQ,iBAAkB,SAAST,EAAQ,CAClE,IAAImD,EAASnD,EAAO,WAAY,EAChC,KAAK,UAAYmD,GAAU,EAC3B,KAAK,YAAcA,EAAS,EAC5B,KAAK,SAAW,CAAE,EAClB,QAAS7I,EAAI,EAAGA,EAAI,KAAK,YAAY,EAAGA,IAAK,CAC5C,IAAI8I,EAAU,CAAE,EAChB,KAAK,SAAS,KAAKA,CAAO,EAC1B,IAAIJ,EAAYhD,EAAO,UAAW,EAC9BiD,EAAYjD,EAAO,UAAW,EAC9BkD,EAAYlD,EAAO,UAAW,EAClCoD,EAAQ,MAAQJ,GAAa,EAC7BI,EAAQ,KAAUJ,GAAa,EAAK,GACpCI,EAAQ,OAAUJ,EAAY,IAAQ,EAAOC,GAAa,EAAK,GAC/DG,EAAQ,MAAUH,GAAa,EAAK,EACpCG,EAAQ,MAASH,EAAY,EAC7BG,EAAQ,YAAgBF,GAAa,EAAK,GACtCE,EAAQ,YAAc,IACzBA,EAAQ,UAAaF,EAAY,IAAQ,EAAKlD,EAAO,UAAW,EAEnE,CACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACpE,IAAIqD,EAAiB,IACjBC,EAA6B,IAE7BC,EAAa,CAAE,EACfC,EAAkB,CAClB,aACA,UACA,cACA,YACA,iBACA,WACA,UACA,UACH,EAGD,EAAG,CACC,IAAIC,EAAczD,EAAO,UAAW,EAEhCe,EAAO,KAAK,IACX0C,EAAcJ,EACdG,EAAgB,OAAS,CAC7B,EAoBD,GAhBMzC,EAWFf,EAAO,eAAeA,EAAO,YAAY,GATzCA,EAAO,eAAe,EAAE,EAGxB,KAAK,WAAcA,EAAO,WAAU,GAAM,GAG1CA,EAAO,eAAe,EAAE,GAM5BuD,EAAW,KAAKC,EAAgBzC,CAAI,CAAC,EAE9B0C,EAAcH,EACjB,KAEZ,OAAa,IAET,KAAK,kBACDC,EAAW,OAAS,KAAOA,EAAW,KAAK,IAAI,EAAI,GAC3D,CAAC,EAED9C,EAAU,cAAc,OAAQ,yBAA0B,SAAST,EAAQ,CAC1E,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,cAAc,OAAQ,oBAAqB,SAAST,EAAQ,CACrE,KAAK,KAAOA,EAAO,WAAY,CAChC,CAAC,EAGDS,EAAU,cAAc,OAAQ,qBAAsB,SAAST,EAAQ,CACtE,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,cAAc,OAAQ,kBAAmB,SAAST,EAAQ,CAOnE,GANA,KAAK,QAAUA,EAAO,UAAW,EACjC,KAAK,mBAAqBA,EAAO,UAAW,EAC5C,KAAK,QAAUA,EAAO,WAAY,EAClC,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,WAAaA,EAAO,UAAW,EACpC,KAAK,qBAAuBA,EAAO,UAAW,EAC1C,KAAK,uBAAyB,EAAG,CACpC,KAAK,YAAcA,EAAO,UAAW,EACrC,KAAK,aAAeA,EAAO,UAAW,EACtC,KAAK,eAAiB,CAAE,EACxB,QAAS1F,EAAI,EAAGA,EAAI,KAAK,mBAAoBA,IAC5C,KAAK,eAAeA,CAAC,EAAI0F,EAAO,UAAW,CAE9C,CACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,mBAAoB,SAAST,EAAQ,CACxE,IAAIiC,EACAvB,EACJ,KAAK,QAAU,CAAE,EAEjB,QADIqC,EAAc/C,EAAO,WAAY,EAC5B1F,EAAI,EAAGA,EAAIyI,EAAazI,IAEhC,GADA2H,EAAMxB,EAAU,YAAYT,EAAQ,GAAO,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACtFiC,EAAI,OAASxB,EAAU,GAC1BC,EAAMuB,EAAI,IACV,KAAK,QAAQ,KAAKvB,CAAG,MAErB,OAGH,CAAC,EAGDD,EAAU,cAAc,OAAQ,wBAAyB,SAAST,EAAQ,CACzE,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,sBAAuB,SAAST,EAAQ,CAC3E,KAAK,kBAAoBA,EAAO,WAAW,KAAK,KAAK,KAAK,QAAQ,CACnE,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,cAAe,SAAST,EAAQ,CACnE,KAAK,QAAU,CAAE,EAEjB,QADI+C,EAAc/C,EAAO,WAAY,EAC5B1F,EAAI,EAAGA,EAAIyI,EAAazI,IAAK,CACrC,IAAIoJ,EAAQ,CAAE,EACd,KAAK,QAAQ,KAAKA,CAAK,EACnB,KAAK,UAAY,GACpBA,EAAM,iBAAmB1D,EAAO,WAAY,EAC5C0D,EAAM,WAAa1D,EAAO,UAAW,IAErC0D,EAAM,iBAAmB1D,EAAO,WAAY,EAC5C0D,EAAM,WAAa1D,EAAO,UAAW,GAEtC0D,EAAM,mBAAqB1D,EAAO,UAAW,EAC7C0D,EAAM,oBAAsB1D,EAAO,UAAW,CAChD,CACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACnE,KAAK,SAAW,GACnB,KAAK,UAAiBA,EAAO,WAAY,EACzC,KAAK,kBAAuBA,EAAO,WAAY,EAC/C,KAAK,eAAqBA,EAAO,WAAY,EAC7C,KAAK,GAAWA,EAAO,WAAY,EACnC,KAAK,cAAoBA,EAAO,YAAa,EAC7C,KAAK,MAAcA,EAAO,YAAa,IAEvC,KAAK,cAAoBA,EAAO,YAAa,EAC7C,KAAK,MAAcA,EAAO,YAAa,EACvC,KAAK,UAAiBA,EAAO,WAAY,EACzC,KAAK,wBAA2BA,EAAO,WAAY,EACnD,KAAK,eAAqBA,EAAO,WAAY,EAC7C,KAAK,GAAWA,EAAO,WAAY,GAEpC,IAAI2D,EAAe,KAAK,KAAO,KAAK,UAAY,EAAE,GAAK,KAAK,cAAc,OAAO,IAAM,KAAK,MAAM,OAAO,IACrG,KAAK,SAAW,IACnBA,GAAgB,GAEjB,KAAK,aAAe3D,EAAO,eAAe2D,CAAY,CACvD,CAAC,EAIDlD,EAAU,wBAA0B,SAASM,EAAMI,EAAa,CAC5DV,EAAUM,EAAK,KAAK,EAAI,SAASnG,EAAM,CACnC6F,EAAU,QAAQ,KAAK,KAAMM,EAAMnG,CAAI,CAC/C,EACI6F,EAAUM,EAAK,KAAK,EAAE,UAAY,IAAIN,EAAU,QAChDA,EAAUM,EAAK,KAAK,EAAE,UAAU,MAAQ,SAASf,EAAQ,CAErD,GADA,KAAK,gBAAgBA,CAAM,EACvBmB,EACAA,EAAY,KAAK,KAAMnB,CAAM,MAK7B,KAHA,KAAK,SAAWA,EAAO,WAAY,EACnC,KAAK,sBAAwBA,EAAO,WAAY,EAChD,KAAK,WAAa,CAAE,EACf,EAAI,EAAG,EAAI,KAAK,sBAAuB,IAAK,CAC7C,IAAI4D,EAAY5D,EAAO,WAAY,EACnC,KAAK,WAAW,KAAK4D,CAAS,CAC9C,CAEK,CACJ,EAGDnD,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,MAAM,EAGxCA,EAAU,wBAAwB,OAAQ,SAAST,EAAQ,CACvD,KAAK,SAAWA,EAAO,WAAY,EACnC,KAAK,sBAAwBA,EAAO,WAAY,EAChD,KAAK,WAAa,CAAE,EACpB,QAAS1F,EAAI,EAAGA,EAAI,KAAK,sBAAuBA,IAAK,CACjD,IAAIsJ,EAAY5D,EAAO,WAAY,EACnC,KAAK,WAAW,KAAK4D,CAAS,CACtC,CAOI,IALA,KAAK,YAAc5D,EAAO,WAAY,EACtC,KAAK,YAAcA,EAAO,WAAY,EACtC,KAAK,cAAgB,CAAE,EACvB,KAAK,6BAA+B,CAAE,EACtC,KAAK,0BAA4B,CAAE,EAC9B1F,EAAI,EAAGA,EAAI,KAAK,sBAAuBA,IACxC,KAAK,cAAcA,CAAC,EAAI0F,EAAO,WAAY,EAC3C,KAAK,0BAA0B1F,CAAC,EAAI0F,EAAO,WAAY,EACvD,KAAK,6BAA6B1F,CAAC,EAAI0F,EAAO,WAAY,CAElE,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,gCAAiC,SAAST,EAAQ,CACrF,IAAI6D,EAAW7D,EAAO,eAAe,KAAK,KAAK,KAAK,QAAQ,EAC5D,GAAI,OAAOT,EAA0B,IAAa,CACjD,IAAIuE,EAAa,IAAIvE,EACrB,KAAK,IAAMuE,EAAW,mBAAmB,IAAI5I,EAAW2I,EAAS,OAAQ,EAAG3I,EAAW,UAAU,CAAC,CACpG,CACA,CAAC,EAGDuF,EAAU,cAAc,OAAQ,mBAAoB,SAAST,EAAQ,CACpE,KAAK,WAAaA,EAAO,UAAW,EACpC,KAAK,cAAgBA,EAAO,UAAW,CACxC,CAAC,EAGDS,EAAU,cAAc,OAAQ,oBAAqB,SAAST,EAAQ,CACrE,KAAK,YAAcA,EAAO,WAAW,CAAC,CACvC,CAAC,EAGDS,EAAU,cAAc,OAAQ,cAAe,SAAST,EAAQ,CAC/D,IAAI4C,EAAU,KAAK,KAAO,KAAK,SAC/B,KAAK,YAAc5C,EAAO,WAAW,CAAC,EACtC,KAAK,cAAgBA,EAAO,WAAY,EACxC4C,GAAW,EACX,KAAK,kBAAoB,CAAE,EAE3B,QADItI,EAAI,EACDsI,GAAS,GACf,KAAK,kBAAkBtI,CAAC,EAAI0F,EAAO,WAAW,CAAC,EAC/C4C,GAAW,EACXtI,GAEF,CAAC,EAGDmG,EAAU,kBAAkB,OAAQ,aAAc,SAAST,EAAQ,CAC9D,KAAK,UAAY,IACpBA,EAAO,WAAY,EACnB,KAAK,QAAUA,EAAO,WAAW,CAAC,EAClCA,EAAO,gBAAgB,CAAC,EACxB,KAAK,KAAOA,EAAO,WAAW,KAAK,KAAK,KAAK,SAAS,EAAE,EACpD,KAAK,KAAK,KAAK,KAAK,OAAO,CAAC,IAAI,OACnC,KAAK,KAAO,KAAK,KAAK,MAAM,EAAE,EAAE,GAGnC,CAAC,EAGDS,EAAU,cAAc,OAAQ,uBAAwB,SAAST,EAAQ,CACxE,IAAI1F,EAAGgC,EAEHzC,EACAkK,EACJ,KAAK,qBAAuB/D,EAAO,UAAW,EAC9C+D,EAAW/D,EAAO,UAAW,EAC7B,KAAK,sBAAwB+D,GAAY,EACzC,KAAK,mBAAqBA,EAAW,KAAS,EAC9C,KAAK,oBAAuBA,EAAW,GACvC,KAAK,8BAAgC/D,EAAO,WAAY,EACxD,KAAK,6BAA+BA,EAAO,eAAe,CAAC,EAC3D,KAAK,kBAAoBA,EAAO,UAAW,EAC3C,KAAK,6BAA+BA,EAAO,WAAY,EAAG,KAC1D,KAAK,gBAAmBA,EAAO,UAAS,EAAK,EAC7C,KAAK,kBAAqBA,EAAO,UAAS,EAAK,EAC/C,KAAK,sBAAyBA,EAAO,UAAS,EAAK,EACnD,KAAK,wBAA2BA,EAAO,UAAS,EAAK,EACrD,KAAK,aAAeA,EAAO,WAAY,EACvC+D,EAAW/D,EAAO,UAAW,EAC7B,KAAK,kBAAqB+D,GAAY,EACtC,KAAK,mBAAqBA,EAAW,KAAQ,EAC7C,KAAK,kBAAoBA,EAAW,IAAQ,EAC5C,KAAK,mBAAsBA,EAAW,EAEtC,KAAK,YAAc,CAAE,EACrB,KAAK,YAAY,SAAW,UAAY,CACvC,IAAIjK,EAAM,8BACVA,GAAO,oFACPA,GAAO,UAEP,QAASQ,EAAE,EAAGA,EAAE,KAAK,OAAQA,IAAK,CACjC,IAAI0J,EAAa,KAAK1J,CAAC,EACvBR,GAAO,OACPA,GAAO,gBAAgBkK,EAAW,OAAO,KAAKA,EAAW,aAAa,QACtElK,GAAO,gBAAgBkK,EAAW,OAAO,KAAKA,EAAW,UAAU,QACnE,QAAS1H,EAAE,EAAGA,EAAE0H,EAAW,OAAQ1H,IAAK,CACvC,IAAIoG,EAAOsB,EAAW1H,CAAC,EACnBA,IAAM,IAAGxC,GAAO,QACpBA,GAAO,OACPA,GAAO4I,EAAK,KAAK,OAAO,SAAS5I,EAAK6I,EAAM,CAC3C,OAAO7I,EAAM6I,EAAK,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAC9C,EAAE,IAAI,EACP7I,GAAO,YACX,CACA,CACE,OAAAA,GAAO,mBACAA,CACT,EACC,IAAImK,EAAcjE,EAAO,UAAW,EACpC,IAAK1F,EAAI,EAAGA,EAAI2J,EAAa3J,IAAK,CACjC,IAAI0J,EAAa,CAAE,EACnB,KAAK,YAAY,KAAKA,CAAU,EAChCD,EAAW/D,EAAO,UAAS,EAC3BgE,EAAW,cAAgBD,EAAW,MAAS,EAC/CC,EAAW,UAAYD,EAAW,GAClC,IAAIG,EAAWlE,EAAO,WAAY,EAClC,IAAK1D,EAAI,EAAGA,EAAI4H,EAAU5H,IAAK,CAC9B,IAAIoG,EAAO,CAAA,EACXsB,EAAW,KAAKtB,CAAI,EACpB7I,EAASmG,EAAO,WAAY,EAC5B0C,EAAK,KAAS1C,EAAO,eAAenG,CAAM,CAC7C,CACA,CACA,CAAC,EAGD4G,EAAU,kBAAkB,OAAQ,cAAe,SAAST,EAAQ,CACnE,IAAIiC,EACA,KAAK,UAAY,EACpB,KAAK,YAAcjC,EAAO,WAAY,EAEtC,KAAK,YAAcA,EAAO,WAAY,EAEvC,KAAK,WAAa,CAAE,EACpB,QAAS1F,EAAI,EAAGA,EAAI,KAAK,YAAaA,IAErC,GADA2H,EAAMxB,EAAU,YAAYT,EAAQ,GAAO,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACtFiC,EAAI,OAASxB,EAAU,GACtBwB,EAAI,IAAI,OAAS,QACpBpJ,EAAI,MAAM,YAAa,4BAA4BoJ,EAAI,IAAI,IAAI,EAEhE,KAAK,WAAW3H,CAAC,EAAI2H,EAAI,QAEzB,OAGH,CAAC,EAGDxB,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACvE,IAAI2C,EACJA,EAAO3C,EAAO,UAAW,EACzB,KAAK,YAAe2C,GAAQ,EAAK,GACjC,KAAK,YAAcA,EAAO,GAC1BA,EAAO3C,EAAO,UAAW,EACzB,KAAK,iBAAoB2C,GAAQ,EAAK,GAClC,KAAK,UAAY,GAAK,KAAK,UAAY,EAC1C,KAAK,WAAaA,EAAO,GAEzB,KAAK,WAAa,EAGnB,KAAK,MAAQ,CAAE,EACf,IAAIwB,EAAa,EACjB,GAAI,KAAK,QAAU,EAClBA,EAAanE,EAAO,WAAY,UACtB,KAAK,UAAY,EAC3BmE,EAAanE,EAAO,WAAY,MAEhC,MAAM,oCAEP,QAAS1F,EAAI,EAAGA,EAAI6J,EAAY7J,IAAK,CACpC,IAAI8J,EAAO,CAAE,EAEb,GADA,KAAK,MAAM,KAAKA,CAAI,EAChB,KAAK,QAAU,EAClBA,EAAK,QAAUpE,EAAO,WAAY,UACxB,KAAK,UAAY,EAC3BoE,EAAK,QAAUpE,EAAO,WAAY,MAElC,MAAM,oCAQP,OANI,KAAK,UAAY,GAAK,KAAK,UAAY,EAC1CoE,EAAK,oBAAuBpE,EAAO,WAAU,EAAK,GAElDoE,EAAK,oBAAsB,EAE5BA,EAAK,qBAAuBpE,EAAO,WAAY,EACxC,KAAK,iBAAgB,CAC3B,IAAK,GACJoE,EAAK,YAAc,EACnB,MACD,IAAK,GACJA,EAAK,YAAcpE,EAAO,WAAY,EACtC,MACD,IAAK,GACJoE,EAAK,YAAcpE,EAAO,WAAY,EACtC,MACD,QACC,KAAM,gCACV,CACE,IAAIqE,EAAerE,EAAO,WAAY,EACtCoE,EAAK,QAAU,CAAE,EACjB,QAAS9H,EAAE,EAAGA,EAAI+H,EAAc/H,IAAK,CACpC,IAAIgI,EAAS,CAAE,EAEf,GADAF,EAAK,QAAQ,KAAKE,CAAM,EACpB,KAAK,UAAY,GAAK,KAAK,UAAY,EAC1C,OAAO,KAAK,WAAU,CACrB,IAAK,GACJA,EAAO,aAAe,EACtB,MACD,IAAK,GACJA,EAAO,aAAetE,EAAO,WAAY,EACzC,MACD,IAAK,GACJsE,EAAO,aAAetE,EAAO,WAAY,EACzC,MACD,QACC,KAAM,4BACZ,CAEG,OAAO,KAAK,YAAW,CACtB,IAAK,GACJsE,EAAO,cAAgB,EACvB,MACD,IAAK,GACJA,EAAO,cAAgBtE,EAAO,WAAY,EAC1C,MACD,IAAK,GACJsE,EAAO,cAAgBtE,EAAO,WAAY,EAC1C,MACD,QACC,KAAM,4BACX,CACG,OAAO,KAAK,YAAW,CACtB,IAAK,GACJsE,EAAO,cAAgB,EACvB,MACD,IAAK,GACJA,EAAO,cAAgBtE,EAAO,WAAY,EAC1C,MACD,IAAK,GACJsE,EAAO,cAAgBtE,EAAO,WAAY,EAC1C,MACD,QACC,KAAM,4BACX,CACA,CACA,CACA,CAAC,EAGDS,EAAU,cAAc,OAAQ,cAAe,SAAST,EAAQ,CAC/D,IAAIxD,EAAMwD,EAAO,UAAW,EAC5B,KAAK,SAAWxD,GAAO,EACvB,KAAK,KAAOA,EAAM,CACnB,CAAC,EACDiE,EAAU,kBAAkB,OAAQ,gBAAiB,SAAST,EAAQ,CAQrE,IAPI,KAAK,UAAY,GAAK,KAAK,UAAY,KAC1C,KAAK,QAAUA,EAAO,WAAY,EAClC,KAAK,sBAAwBA,EAAO,WAAY,EAChD,KAAK,UAAYA,EAAO,YAAa,EACrC,KAAK,aAAeA,EAAO,YAAa,EACxC,KAAK,iBAAmBA,EAAO,YAAa,GAEzC,KAAK,UAAY,EAAG,CACvB,KAAK,eAAiBA,EAAO,WAAW,CAAC,EACzCnH,EAAI,KAAK,YAAa,6BAA6B,EACnDmH,EAAO,KAAK,KAAK,MAAM,KAAK,IAAI,EAChC,MACF,CACK,KAAK,SAAW,IACf,KAAK,UAAY,EACpB,KAAK,QAAUA,EAAO,WAAY,EACxB,KAAK,UAAY,IAC3B,KAAK,QAAUA,EAAO,WAAY,GAEnC,KAAK,sBAAwBA,EAAO,WAAY,EAChD,KAAK,UAAYA,EAAO,WAAW,CAAC,EACpC,KAAK,UAAYA,EAAO,YAAa,EACjC,KAAK,YAAc,QACtB,KAAK,aAAeA,EAAO,YAAa,EACxC,KAAK,iBAAmBA,EAAO,YAAa,GAClC,KAAK,YAAc,SAC7B,KAAK,cAAgBA,EAAO,YAAa,GAG5C,CAAC,EAEDS,EAAU,kBAAkB,OAAQ,6BAA8B,SAAST,EAAQ,CAClF,IAAI1F,EAAGgC,EAGP,IAFA,YAAc0D,EAAO,WAAY,EACjC,KAAK,aAAe,CAAE,EAClB1F,EAAE,EAAGA,EAAE,YAAaA,IAAK,CAC5B,IAAIiK,EAAa,CAAE,EACnB,KAAK,aAAa,KAAKA,CAAU,EAC7B,KAAK,QAAU,EAClBA,EAAW,GAAKvE,EAAO,WAAY,EAEnCuE,EAAW,GAAKvE,EAAO,WAAY,EAEpC,IAAIwE,EAAoBxE,EAAO,UAAW,EAE1C,IADAuE,EAAW,MAAQ,CAAE,EAChBjI,EAAI,EAAGA,EAAIkI,EAAmBlI,IAAK,CACvC,IAAIE,EAAMwD,EAAO,UAAW,EACxByE,EAAI,CAAE,EACVF,EAAW,MAAM,KAAKE,CAAC,EACvBA,EAAE,WAAcjI,EAAM,MAAS,IAAO,EAClC,KAAK,MAAQ,EAChBiI,EAAE,gBAAkBjI,EAAM,MAAS,EAAIwD,EAAO,UAAW,EAEzDyE,EAAE,eAAkBjI,EAAM,GAE9B,CACA,CACA,CAAC,EAGDiE,EAAU,kBAAkB,OAAQ,mBAAoB,SAAST,EAAQ,CACxE,IAAIiC,EAEAvB,EAGJ,IAFA,KAAK,WAAa,CAAE,EAEbV,EAAO,YAAa,EAAG,KAAK,MAAM,KAAK,MAE7C,GADAiC,EAAMxB,EAAU,YAAYT,EAAQ,GAAM,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACrFiC,EAAI,OAASxB,EAAU,GACtB,KAAK,UAAY,EACpBC,EAAM,IAAID,EAAU,2BAA2BwB,EAAI,KAAMA,EAAI,KAAMA,EAAI,SAAUA,EAAI,KAAK,EAE1FvB,EAAM,IAAID,EAAU,gCAAgCwB,EAAI,KAAMA,EAAI,KAAMA,EAAI,SAAUA,EAAI,KAAK,EAE5FvB,EAAI,QAAUD,EAAU,IAAI,UAAU,OAASC,EAAI,OAAS,SAC/D7H,EAAI,KAAK,YAAa6H,EAAI,KAAK,mFAAmF,EAClHA,EAAI,mBAAmBV,CAAM,GAE9BU,EAAI,MAAMV,CAAM,EAChB,KAAK,WAAW,KAAKU,CAAG,MAExB,OAGH,CAAC,EAEDD,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,MAAQA,EAAO,UAAW,EAAG,CACnC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,8BAA+B,SAAST,EAAQ,CACnF,KAAK,YAAcA,EAAO,WAAY,EACtC,KAAK,aAAeA,EAAO,WAAY,CACxC,CAAC,EACDS,EAAU,kBAAkB,OAAQ,UAAW,SAAST,EAAQ,CAC/D,KAAK,UAAYA,EAAO,YAAa,EACrC,KAAK,MAAQA,EAAO,YAAa,CAClC,CAAC,EAEDS,EAAU,kBAAkB,OAAQ,qBAAsB,SAAST,EAAQ,CAC1E,IAAI0E,EAAQ1E,EAAO,UAAW,EAC9B,KAAK,OAAS,CAAE,EAChB,QAAS1F,EAAI,EAAGA,EAAIoK,EAAOpK,IAAK,CAC/B,IAAIjB,EAAQ,CAAE,EACd,KAAK,OAAOiB,CAAC,EAAIjB,EACjBA,EAAM,SAAW2G,EAAO,WAAY,EACpC,IAAI+D,EAAW/D,EAAO,UAAW,EAGjC,OAFA3G,EAAM,aAAe0K,GAAY,EACjC1K,EAAM,gBAAkB0K,EAAW,IAC3B1K,EAAM,gBAAe,CAC5B,IAAK,GACJA,EAAM,cAAgB2G,EAAO,WAAW,CAAC,EACzC,MACD,IAAK,GACJ3G,EAAM,cAAgB2G,EAAO,WAAW,CAAC,EACzC3G,EAAM,wBAA0B2G,EAAO,WAAY,EACnD,MACD,IAAK,GACJ,MACD,IAAK,GACJ,MACD,IAAK,GACJ3G,EAAM,aAAe2G,EAAO,WAAY,EACxC,MACD,QACCnH,EAAI,KAAK,YAAa,+BAA+B,CACzD,CACA,CACA,CAAC,EAGD4H,EAAU,cAAc,OAAQ,wBAAyB,SAAST,EAAQ,CACzE,IAAI1F,EAAGgC,EACHyH,EACJ,KAAK,qBAAuB/D,EAAO,UAAW,EAC9C,KAAK,6BAA+BA,EAAO,WAAY,EAAG,KAC1D,KAAK,gBAAmBA,EAAO,UAAS,EAAK,EAC7C+D,EAAW/D,EAAO,UAAW,EAC7B,KAAK,mBAAqB+D,EAAW,KAAQ,EAC7C,KAAK,kBAAoBA,EAAW,IAAQ,EAC5C,KAAK,mBAAsBA,EAAW,EAEtC,KAAK,YAAc,CAAE,EACrB,KAAK,YAAY,SAAW,UAAY,CACvC,IAAIjK,EAAM,8BACVA,GAAO,oFACPA,GAAO,UAEP,QAASQ,EAAE,EAAGA,EAAE,KAAK,OAAQA,IAAK,CACjC,IAAI0J,EAAa,KAAK1J,CAAC,EACvBR,GAAO,OACPA,GAAO,gBAAgBkK,EAAW,OAAO,KAAKA,EAAW,aAAa,QACtElK,GAAO,gBAAgBkK,EAAW,OAAO,KAAKA,EAAW,UAAU,QACnE,QAAS1H,EAAE,EAAGA,EAAE0H,EAAW,OAAQ1H,IAAK,CACvC,IAAIoG,EAAOsB,EAAW1H,CAAC,EACnBA,IAAM,IAAGxC,GAAO,QACpBA,GAAO,OACPA,GAAO4I,EAAK,KAAK,OAAO,SAAS5I,EAAK6I,EAAM,CAC3C,OAAO7I,EAAM6I,EAAK,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAC9C,EAAE,IAAI,EACP7I,GAAO,YACX,CACA,CACE,OAAAA,GAAO,mBACAA,CACT,EACC,IAAImK,EAAcjE,EAAO,UAAW,EACpC,IAAK1F,EAAI,EAAGA,EAAI2J,EAAa3J,IAAK,CACjC,IAAI0J,EAAa,CAAE,EACnB,KAAK,YAAY,KAAKA,CAAU,EAChCD,EAAW/D,EAAO,UAAS,EAC3BgE,EAAW,cAAgBD,EAAW,MAAS,EAC/CC,EAAW,UAAYD,EAAW,GAClC,IAAIG,EAAWlE,EAAO,WAAY,EAClC,IAAK1D,EAAI,EAAGA,EAAI4H,EAAU5H,IAAK,CAC9B,IAAIoG,EAAO,CAAA,EACXsB,EAAW,KAAKtB,CAAI,EACpB,IAAI7I,EAASmG,EAAO,WAAY,EAChC0C,EAAK,KAAQ1C,EAAO,eAAenG,CAAM,CAC5C,CACA,CACA,CAAC,EAGD4G,EAAU,cAAc,OAAQ,wBAAyB,SAAST,EAAQ,CACzE,KAAK,SAAWA,EAAO,WAAY,CACpC,CAAC,EACDS,EAAU,cAAc,OAAQ,cAAe,SAAST,EAAQ,CAC/D,KAAK,OAASA,EAAO,WAAY,EACjC,KAAK,MAAQA,EAAO,WAAY,CACjC,CAAC,EAGD,SAAS2E,EAAWC,EAAGC,EAAG,CACtB,KAAK,EAAID,EACT,KAAK,EAAIC,CACb,CAEAF,EAAW,UAAU,SAAW,UAAW,CACvC,MAAO,IAAI,KAAK,EAAE,IAAI,KAAK,EAAE,GACjC,EAEAlE,EAAU,cAAc,OAAQ,kCAAmC,SAAST,EAAQ,CAChF,KAAK,kBAAoB,CAAE,EAC3B,KAAK,kBAAkB,CAAC,EAAI,IAAI2E,EAAW3E,EAAO,WAAY,EAACA,EAAO,YAAY,EAClF,KAAK,kBAAkB,CAAC,EAAI,IAAI2E,EAAW3E,EAAO,WAAY,EAACA,EAAO,YAAY,EAClF,KAAK,kBAAkB,CAAC,EAAI,IAAI2E,EAAW3E,EAAO,WAAY,EAACA,EAAO,YAAY,EAClF,KAAK,YAAc,IAAI2E,EAAW3E,EAAO,aAAaA,EAAO,YAAY,EACzE,KAAK,gCAAkCA,EAAO,WAAY,EAC1D,KAAK,gCAAkCA,EAAO,WAAY,CAC9D,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CAClE,KAAK,SAAW,GACnB,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,UAAYA,EAAO,WAAY,EACpC,KAAK,SAAWA,EAAO,WAAY,IAEnC,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,UAAYA,EAAO,WAAY,EACpC,KAAK,SAAWA,EAAO,WAAY,GAEpC,KAAK,cAAcA,CAAM,EACzBA,EAAO,WAAY,CACpB,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,wBAAyB,SAAST,EAAQ,CACzE,KAAK,MAAQ,IAChBnH,EAAI,KAAK,YAAa,mEAAmE,EACzF,KAAK,QAAU,GAEZ,KAAK,SAAW,EACnB,KAAK,kBAAoBmH,EAAO,WAAY,EAE5C,KAAK,kBAAoBA,EAAO,WAAY,CAE9C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,UAAW,SAAST,EAAQ,CAC/D,KAAK,MAAQ,CAAE,EACfS,EAAU,aAAa,UAAU,MAAM,KAAK,KAAMT,CAAM,CACzD,CAAC,EAEDS,EAAU,kBAAkB,OAAQ,yBAA0B,SAAST,EAAQ,CAC9E,KAAK,gBAAkBA,EAAO,WAAY,CAC3C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,qCAAsC,SAAST,EAAQ,CAC1F,KAAK,MAAQA,EAAO,WAAY,CACjC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,4BAA6B,SAAST,EAAQ,CAC9E,KAAK,eAAiBA,EAAO,UAAW,CAC5C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CAClE,KAAK,SAAW,GACnB,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,UAAYA,EAAO,WAAY,EACpC,KAAK,SAAWA,EAAO,WAAY,IAEnC,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,UAAYA,EAAO,WAAY,EACpC,KAAK,SAAWA,EAAO,WAAY,GAEpC,KAAK,KAAOA,EAAO,WAAY,EAC/B,KAAK,OAASA,EAAO,WAAY,GAAE,EACnCA,EAAO,WAAY,EACnBA,EAAO,gBAAgB,CAAC,EACxB,KAAK,OAASA,EAAO,gBAAgB,CAAC,EACtCA,EAAO,gBAAgB,CAAC,EACxB,KAAK,cAAgBA,EAAO,WAAY,CACzC,CAAC,EAEDS,EAAU,cAAc,OAAQ,kBAAmB,SAAST,EAAQ,CACnE,KAAK,YAAcA,EAAO,WAAY,CACvC,CAAC,EAGDS,EAAU,cAAc,OAAQ,kBAAmB,SAAST,EAAQ,CACnE,KAAK,YAAcA,EAAO,WAAY,CACvC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CACtE,IAAI8E,EAAe9E,EAAO,WAAY,EACtC,KAAK,QAAU,CAAE,EACjB,QAAS1F,EAAI,EAAGA,EAAI,KAAK,OAAOwK,EAAa,GAAG,CAAC,EAAGxK,IACnD,KAAK,QAAU0F,EAAO,UAAW,CAEnC,CAAC,EAGDS,EAAU,cAAc,OAAQ,sBAAuB,SAAST,EAAQ,CACvE,KAAK,SAAWA,EAAO,WAAY,EACnC,KAAK,SAAWA,EAAO,WAAY,CACpC,CAAC,EACDS,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,KAAOA,EAAO,WAAW,KAAK,KAAO,KAAK,QAAQ,CACxD,CAAC,EAGDS,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,UAAYA,EAAO,WAAY,EACpC,IAAI0E,EAAQ1E,EAAO,UAAW,EAC9B,KAAK,cAAgBA,EAAO,WAAW0E,CAAK,CAC7C,CAAC,EAGDjE,EAAU,kBAAkB,OAAQ,6BAA8B,SAAST,EAAQ,CAClF,IAAI0E,GAAS,KAAK,KAAO,KAAK,UAAU,EACxC,KAAK,KAAO,CAAE,EACd,KAAK,cAAgB,CAAE,EACvB,QAASpK,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,KAAKA,CAAC,EAAI0F,EAAO,WAAY,EAClC,KAAK,cAAc1F,CAAC,EAAI0F,EAAO,WAAY,CAE7C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CAClE,KAAK,UAAY,EACpB,KAAK,QAAUA,EAAO,WAAY,EAElC,KAAK,QAAUA,EAAO,WAAY,CAEpC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,2BAA4B,SAAST,EAAQ,CAChF,IAAI1F,EAGJ,IAFA,KAAK,aAAe0F,EAAO,UAAW,EACtC,KAAK,kBAAoB,CAAE,EACtB1F,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,kBAAkBA,CAAC,EAAI0F,EAAO,UAAW,CAEhD,CAAC,EAGDS,EAAU,cAAc,OAAQ,oBAAqB,SAAST,EAAQ,CACrE,KAAK,MAAQA,EAAO,WAAY,CACjC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iDAAkD,SAAST,EAAQ,CAGtG,GAFA,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,WAAa,CAAE,EAChB,KAAK,MAAQ,EAChB,QAAS1F,EAAI,EAAGA,EAAI,KAAK,WAAYA,IACpC,KAAK,WAAWA,CAAC,EAAI0F,EAAO,WAAY,CAG3C,CAAC,EACDS,EAAU,kBAAkB,OAAQ,2BAA4B,SAAST,EAAQ,CAChF,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,cAAgBA,EAAO,WAAY,EACpC,KAAK,UAAY,EACpB,KAAK,WAAaA,EAAO,WAAY,EAErC,KAAK,WAAaA,EAAO,WAAY,CAEvC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,oCAAqC,SAAST,EAAQ,CAEzF,GADA,KAAK,UAAYS,EAAU,WAAWT,CAAM,EACxC,KAAK,QAAU,EAAG,CACrB,IAAI0E,EAAQ1E,EAAO,WAAY,EAC/B,KAAK,IAAM,CAAE,EACb,QAAS1F,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,IAAIA,CAAC,EAAImG,EAAU,WAAWT,CAAM,CAE5C,CACC,IAAI+E,EAAW/E,EAAO,WAAY,EAC9B+E,EAAW,IACd,KAAK,KAAO/E,EAAO,eAAe+E,CAAQ,EAE5C,CAAC,EAGDtE,EAAU,kBAAkB,OAAQ,kCAAmC,SAAST,EAAQ,CACvF,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,OAASA,EAAO,WAAY,CAClC,CAAC,EACDS,EAAU,kBAAkB,OAAQ,kCAAmC,SAAST,EAAQ,CACvF,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,OAASA,EAAO,WAAY,CAClC,CAAC,EACDS,EAAU,kBAAkB,OAAQ,uCAAwC,SAAST,EAAQ,CAC5F,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,OAASA,EAAO,WAAY,CAClC,CAAC,EACDS,EAAU,uBAAuB,OAAQ,iCAAkC,KAAM,CAAE,OAAQ,OAAQ,MAAM,CAAC,EAC1GA,EAAU,cAAc,OAAQ,0BAA2B,SAAST,EAAQ,CAC3E,KAAK,kBAAoBA,EAAO,WAAW,CAAC,EAC5C,KAAK,QAAUA,EAAO,WAAW,KAAK,KAAO,KAAK,SAAW,CAAC,CAC/D,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,uCAAwC,SAAST,EAAQ,CACxF,KAAK,MAAQ,IAChB,KAAK,cAAgBA,EAAO,WAAW,CAAC,EACxC,KAAK,wBAA0BA,EAAO,WAAY,GAEnD,IAAI0E,EAAQ1E,EAAO,WAAY,EAC/B,KAAK,OAAS,CAAE,EAChB,QAAS1F,EAAI,EAAGA,EAAIoK,EAAOpK,IACtB,KAAK,UAAY,EACpB,KAAK,OAAOA,CAAC,EAAI0F,EAAO,WAAY,EAEpC,KAAK,OAAO1F,CAAC,EAAI0F,EAAO,WAAY,CAGvC,CAAC,EAEDS,EAAU,kBAAkB,OAAQ,qCAAsC,SAAST,EAAQ,CAQ1F,GAPI,KAAK,MAAQ,IAChB,KAAK,cAAgBA,EAAO,WAAW,CAAC,EACxC,KAAK,wBAA0BA,EAAO,WAAY,GAEnD,KAAK,yBAA2BA,EAAO,UAAW,EAClD,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,iBAAmB,CAAE,EACtB,KAAK,2BAA6B,EACrC,QAAS1F,EAAI,EAAGA,EAAI,KAAK,aAAcA,IACtC,KAAK,iBAAiBA,CAAC,EAAI0F,EAAO,UAAW,CAGhD,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,iBAAmBA,EAAO,YAAa,EAC5C,KAAK,YAAcA,EAAO,YAAa,EACvC,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,iBAAmBA,EAAO,YAAa,EAC5C,KAAK,UAAYA,EAAO,YAAa,EACrC,KAAK,gBAAkBA,EAAO,YAAa,EAC3C,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,iBAAmBA,EAAO,YAAa,EAC5C,KAAK,YAAcA,EAAO,YAAa,EACvC,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,UAAYA,EAAO,YAAa,EACrC,KAAK,gBAAkBA,EAAO,YAAa,EAC3C,KAAK,qBAAuBA,EAAO,YAAa,EAChD,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,iBAAmBA,EAAO,YAAa,EAC5C,KAAK,YAAcA,EAAO,YAAa,EACvC,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,yBAA2BA,EAAO,SAAU,EACjD,KAAK,uBAAyBA,EAAO,SAAU,EAC/C,KAAK,cAAgBA,EAAO,eAAe,CAAC,EAC5C,KAAK,WAAaA,EAAO,eAAe,CAAC,EACzC,KAAK,aAAeA,EAAO,eAAe,EAAE,EAC5C,KAAK,YAAYA,CAAM,CACxB,CAAC,EAEDS,EAAU,sBAAsBA,EAAU,2BAA4B,OAAQ,SAAST,EAAQ,CAC9F,KAAK,YAAYA,CAAM,EACvB,KAAK,YAAYA,CAAM,CACxB,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,IAAI1F,EACA0K,EAAahF,EAAO,WAAY,EAGpC,IAFA,KAAK,oBAAsBA,EAAO,WAAY,EAC9C,KAAK,cAAgB,CAAE,EAClB1F,EAAI,EAAGA,EAAI0K,EAAY1K,IAC3B,KAAK,cAAcA,CAAC,EAAI0F,EAAO,WAAY,EAE5C,IAAIiF,EAAY,KAAK,mBAAqB,EAAI,EAAED,EAGhD,IAFA,KAAK,mBAAqB,CAAE,EAC5B,KAAK,kBAAoB,CAAE,EACtB1K,EAAI,EAAGA,EAAI2K,EAAU,EAAG3K,IAC5B,KAAK,mBAAmBA,CAAC,EAAI0F,EAAO,WAAY,EAChD,KAAK,kBAAkB1F,CAAC,EAAI0F,EAAO,WAAY,CAEjD,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,KAAK,YAAcA,EAAO,UAAW,EACrC,KAAK,uBAAyBA,EAAO,UAAW,EAChD,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,aAAeA,EAAO,WAAY,CACxC,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,KAAK,sBAAwBA,EAAO,WAAY,EAChD,KAAK,YAAcA,EAAO,UAAW,EACrC,IAAI+D,EAAW/D,EAAO,UAAW,EACjC,KAAK,aAAe+D,GAAY,EAChC,KAAK,YAAeA,GAAY,EAAK,EACjC,KAAK,eACR,KAAK,SAAW/D,EAAO,WAAY,GAEhC,KAAK,cACR,KAAK,uBAAyBA,EAAO,UAAW,EAChD,KAAK,WAAaA,EAAO,WAAY,EACrC,KAAK,aAAeA,EAAO,WAAY,GAExC,KAAK,WAAa,CAAE,EAEpB,QADIkF,EAAgBlF,EAAO,UAAW,EAC7B1F,EAAI,EAAGA,EAAI4K,EAAe5K,IAAK,CACvC,IAAI6K,EAAiB,CAAE,EACvB,KAAK,WAAW,KAAKA,CAAc,EACnCA,EAAe,oBAAsBnF,EAAO,UAAW,EACvDmF,EAAe,YAAcnF,EAAO,UAAW,EAC/CmF,EAAe,sBAAwBnF,EAAO,WAAY,CAC5D,CACA,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,KAAK,cAAgBA,EAAO,UAAW,CACxC,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,IAAI+D,EAAW/D,EAAO,UAAW,EACjC,KAAK,0BAA4B+D,GAAY,EAC7C,KAAK,oBAAsBA,EAAW,GACvC,CAAC,EAGDtD,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CAExD,GADA,KAAK,sBAAwBA,EAAO,WAAY,EAC5C,KAAK,qBAAuB,GAAG,KAAK,wBAA0B,EAAE,EAAE,KAAK,sBAAsB,GAAG,EACnGnH,EAAI,KAAK,YAAa,eAAe,KAAK,cAAc,sBAAsB,EAC9E,KAAK,KAAQmH,EAAO,eAAe,KAAK,mBAAmB,CAAC,MACtD,CACN,GAAI,KAAK,wBAA0B,EAClC,KAAK,kBAAoBA,EAAO,WAAY,MACtC,CACN,KAAK,kBAAoB,CAAE,EAC3B,KAAK,kBAAoB,CAAE,EAC3B,QAAS1F,EAAI,EAAGA,EAAI,KAAK,sBAAuBA,IAC/C,KAAK,kBAAkBA,CAAC,EAAI0F,EAAO,WAAY,EAC/C,KAAK,kBAAkB1F,CAAC,EAAI0F,EAAO,WAAY,CAEnD,CACE,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,iBAAmBA,EAAO,UAAW,CAC5C,CACA,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,KAAK,cAAgBA,EAAO,UAAW,CACxC,CAAC,EAGDS,EAAU,iBAAiB,UAAU,MAAQ,SAAST,EAAQ,CAC7DnH,EAAI,KAAK,YAAa,8BAA8B,KAAK,aAAa,EACtE,KAAK,KAAQmH,EAAO,eAAe,KAAK,kBAAkB,CAC3D,EAGAS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,KAAK,SAAWA,EAAO,UAAW,EAClC,IAAIxD,EAAMwD,EAAO,UAAW,EAC5B,KAAK,iBAAmBxD,GAAO,EAC/B,KAAK,gBAAkBA,EAAM,GAC7B,KAAK,YAAcwD,EAAO,UAAW,EACrC,KAAK,mBAAqBA,EAAO,UAAW,EAC5C,KAAK,IAAMS,EAAU,WAAWT,CAAM,EACtC,KAAK,iBAAmB,EACxB,KAAK,YAAc,EACf,KAAK,cAAgB,GAAK,KAAK,qBAAuB,IACzD,KAAK,iBAAmBA,EAAO,UAAW,EAC1C,KAAK,YAAcA,EAAO,eAAe,KAAK,gBAAgB,EAEhE,CAAC,EAGDS,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,IAAI+D,EAAW/D,EAAO,UAAW,EACjC,KAAK,cAAgB+D,EAAW,EACjC,CAAC,EAGDtD,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxD,IAAI+D,EAAW/D,EAAO,UAAW,EACjC,KAAK,8BAAgC+D,GAAY,CAClD,CAAC,EAGDtD,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,sBAAsB,OAAQ,SAAST,EAAQ,CACxDnH,EAAI,KAAK,YAAa,sBAAsB,KAAK,cAAc,mBAAmB,CACnF,CAAC,EAGD4H,EAAU,kBAAkB,OAAQ,mBAAoB,SAAST,EAAQ,CACxE,KAAK,cAAgBA,EAAO,WAAW,CAAC,EACpC,KAAK,UAAY,EACpB,KAAK,wBAA0BA,EAAO,WAAY,EAElD,KAAK,wBAA0B,EAEhC,KAAK,QAAU,CAAE,EAEjB,QADI+C,EAAc/C,EAAO,WAAY,EAC5B1F,EAAI,EAAGA,EAAIyI,EAAazI,IAAK,CACrC,IAAIoJ,EAAQ,CAAE,EACd,KAAK,QAAQ,KAAKA,CAAK,EACvBA,EAAM,aAAe1D,EAAO,UAAW,EACvC0D,EAAM,wBAA0B1D,EAAO,UAAW,CACpD,CACA,CAAC,EAGD,SAASoF,EAAMC,EAAKC,EAAK,CACxB,KAAK,cAAgBD,EACrB,KAAK,iBAAmBC,CACzB,CAEAF,EAAM,UAAU,SAAW,UAAyB,CACnD,MAAO,SAAW,KAAK,cAAgB,aAAe,KAAK,iBAAmB,GAC/E,EAEA3E,EAAU,kBAAkB,OAAQ,wBAAyB,SAAST,EAAQ,CAC7E,IAAI1F,EAGD,IAFH,KAAK,gBAAkB0F,EAAO,WAAY,EACvC,KAAK,gBAAkB,CAAE,EACpB1F,EAAI,EAAGA,EAAI,KAAK,gBAAiBA,IAClC,KAAK,gBAAgB,KAAK0F,EAAO,WAAU,CAAE,EAEpD,IAAI6C,EAAQ7C,EAAO,UAAW,EAQ9B,IAPA,KAAK,oBAA+B6C,EAAQ,MAAjB,IAC3B,KAAK,aAAe7C,EAAO,WAAY,EACvC,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,eAAiBA,EAAO,WAAY,EACzC,KAAK,SAAW,CAAE,EAClB,KAAK,YAAc,CAAE,EACrB,KAAK,WAAa,CAAE,EACf1F,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,SAAS,KAAK0F,EAAO,WAAU,CAAE,EAEvC,IAAK1F,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,YAAY,KAAK0F,EAAO,WAAU,CAAE,EAE1C,IAAK1F,EAAI,EAAGA,EAAI,KAAK,eAAgBA,IAAK,CACzC,IAAI+K,EAAMrF,EAAO,WAAY,EACzBsF,EAAMtF,EAAO,WAAY,EAC7B,KAAK,WAAW,KAAK,IAAIoF,EAAMC,EAAKC,CAAG,CAAC,CAC1C,CACA,CAAC,EAGD7E,EAAU,kBAAkB,OAAQ,gBAAiB,SAAST,EAAQ,CACrE,KAAK,YAAcA,EAAO,WAAW,CAAC,EACtC,KAAK,eAAiBA,EAAO,WAAY,EACrC,KAAK,MAAQ,IAChB,KAAK,WAAaA,EAAO,WAAW,KAAK,KAAO,KAAK,SAAW,CAAC,EAEnE,CAAC,EAGDS,EAAU,cAAc,OAAQ,6BAA8B,SAAST,EAAQ,CAC9E,KAAK,QAAUA,EAAO,WAAW,KAAK,KAAO,KAAK,QAAQ,CAC3D,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,0BAA2B,SAAST,EAAQ,CAC/E,IAAI+D,EACAW,EAAS,KAAK,KAAO,KAAK,SAC9B,KAAK,WAAa,CAAE,EACpB,KAAK,kBAAoB,CAAE,EAC3B,KAAK,sBAAwB,CAAE,EAC/B,KAAK,sBAAwB,CAAE,EAC/B,QAASpK,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1ByJ,EAAW/D,EAAO,UAAW,EAC7B,KAAK,WAAW1F,CAAC,EAAIyJ,GAAY,EACjC,KAAK,kBAAkBzJ,CAAC,EAAKyJ,GAAY,EAAK,EAC9C,KAAK,sBAAsBzJ,CAAC,EAAKyJ,GAAY,EAAK,EAClD,KAAK,sBAAsBzJ,CAAC,EAAIyJ,EAAW,CAE7C,CAAC,EAIDtD,EAAU,kBAAkB,OAAQ,qBAqBpC,EAEAA,EAAU,kBAAkB,OAAQ,4BAA6B,SAAST,EAAQ,CACjF,KAAK,cAAgBA,EAAO,WAAW,CAAC,EACxCnH,EAAI,MAAM,YAAa,+BAA+B,KAAK,aAAa,EACpE,KAAK,UAAY,EACpB,KAAK,eAAiBmH,EAAO,WAAY,EAEzC,KAAK,eAAiB,EAEnB,KAAK,SAAW,IACnB,KAAK,gCAAkCA,EAAO,WAAY,GAE3D,KAAK,QAAU,CAAE,EAEjB,QADI+C,EAAc/C,EAAO,WAAY,EAC5B1F,EAAI,EAAGA,EAAIyI,EAAazI,IAAK,CACrC,IAAIoJ,EACAjD,EAAU,KAAK,cAAc,kBAAkB,EAClDiD,EAAQ,IAAIjD,EAAU,KAAK,cAAc,kBAAkB,EAAE,KAAK,aAAa,EAE/EiD,EAAQ,IAAIjD,EAAU,iBAAiB,KAAK,aAAa,EAE1D,KAAK,QAAQ,KAAKiD,CAAK,EACnB,KAAK,UAAY,EAChB,KAAK,iBAAmB,EAC3BA,EAAM,mBAAqB1D,EAAO,WAAY,EAE9C0D,EAAM,mBAAqB,KAAK,eAGjCA,EAAM,mBAAqB,KAAK,eAE7BA,EAAM,QAAUjD,EAAU,iBAAiB,UAAU,QACxD5H,EAAI,KAAK,YAAa,wBAAwB,KAAK,cAAc,+EAA+E,EAEhJ6K,EAAM,KAAO1D,EAAO,eAAe0D,EAAM,kBAAkB,EAE3D1D,EAAO,UAAY0D,EAAM,oBAE1BA,EAAM,MAAM1D,CAAM,CACpB,CACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,4BAA6B,SAAST,EAAQ,CACjF,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,UAAYA,EAAO,WAAY,EAChC,KAAK,UAAY,GACpB,KAAK,2BAA6BA,EAAO,WAAY,EACrD,KAAK,aAAeA,EAAO,WAAY,IAEvC,KAAK,2BAA6BA,EAAO,WAAY,EACrD,KAAK,aAAeA,EAAO,WAAY,GAExCA,EAAO,WAAY,EACnB,KAAK,WAAa,CAAE,EAEpB,QADI0E,EAAQ1E,EAAO,WAAY,EACtB1F,EAAI,EAAGA,EAAIoK,EAAOpK,IAAK,CAC/B,IAAIiL,EAAM,CAAE,EACZ,KAAK,WAAW,KAAKA,CAAG,EACxB,IAAIC,EAASxF,EAAO,WAAY,EAChCuF,EAAI,eAAkBC,GAAU,GAAM,EACtCD,EAAI,gBAAkBC,EAAS,WAC/BD,EAAI,oBAAsBvF,EAAO,WAAY,EAC7CwF,EAASxF,EAAO,WAAY,EAC5BuF,EAAI,gBAAmBC,GAAU,GAAM,EACvCD,EAAI,SAAYC,GAAU,GAAM,EAChCD,EAAI,eAAiBC,EAAS,SAChC,CACA,CAAC,EAGD/E,EAAU,2BAA6B,SAASM,EAAMnG,EAAMsG,EAAUpI,EAAO,CAC5E2H,EAAU,IAAI,KAAK,KAAMM,EAAMnG,CAAI,EACnC,KAAK,SAAWsG,EAChB,KAAK,MAAQpI,CACd,EACA2H,EAAU,2BAA2B,UAAY,IAAIA,EAAU,IAC/DA,EAAU,2BAA2B,UAAU,MAAQ,SAAST,EAAQ,CACvE,KAAK,aAAeA,EAAO,WAAY,EACvC,IAAI0E,EAAS1E,EAAO,WAAY,EAChC,KAAK,WAAa,CAAE,EACpB,QAAQ1F,EAAI,EAAGA,EAAIoK,EAAOpK,IACzB,KAAK,WAAWA,CAAC,EAAI,CAAE,EACvB,KAAK,WAAWA,CAAC,EAAE,WAAa0F,EAAO,WAAY,CAErD,EAGAS,EAAU,gCAAkC,SAASM,EAAMnG,EAAMsG,EAAUpI,EAAO,CACjF2H,EAAU,IAAI,KAAK,KAAMM,EAAMnG,CAAI,EACnC,KAAK,SAAWsG,EAChB,KAAK,MAAQpI,CACd,EACA2H,EAAU,gCAAgC,UAAY,IAAIA,EAAU,IACpEA,EAAU,gCAAgC,UAAU,MAAQ,SAAST,EAAQ,CAC5E,KAAK,aAAeA,EAAO,WAAY,EACvC,IAAI0E,EAAS1E,EAAO,WAAY,EAChC,KAAK,WAAa,CAAE,EACpB,QAAQ1F,EAAI,EAAGA,EAAIoK,EAAOpK,IACzB,KAAK,WAAWA,CAAC,EAAI,CAAE,EACvB,KAAK,WAAWA,CAAC,EAAE,WAAa0F,EAAO,WAAY,CAErD,EAGAS,EAAU,kBAAkB,OAAQ,uCAAwC,SAAST,EAAQ,CAC5F,KAAK,uBAAyBA,EAAO,WAAY,EAC9C,KAAK,uBAAyBA,EAAO,WAAY,EACjD,KAAK,uBAAyBA,EAAO,WAAY,EACjD,KAAK,uBAAyBA,EAAO,WAAY,EACjD,KAAK,uBAAyBA,EAAO,WAAY,EACjD,KAAK,uBAAyBA,EAAO,WAAY,EACjD,KAAK,yBAA2BA,EAAO,WAAY,EACnD,KAAK,yBAA2BA,EAAO,WAAY,EACnD,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,aAAeA,EAAO,WAAY,CAC3C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,sBAAuB,SAAST,EAAQ,CAC3E,KAAK,QAAUA,EAAO,WAAY,EAClCA,EAAO,WAAY,CACpB,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,+BAAgC,SAAST,EAAQ,CACpF,KAAK,YAAc,CAAE,EAErB,QADIyF,EAAmBzF,EAAO,WAAY,EACjC1F,EAAI,EAAGA,EAAImL,EAAkBnL,IAAK,CAC1C,IAAIoL,EAAa,CAAE,EACnB,KAAK,YAAY,KAAKA,CAAU,EAChCA,EAAW,OAAS,CAAE,EAEtB,QADIC,EAAc3F,EAAO,WAAY,EAC5B1D,EAAI,EAAGA,EAAIqJ,EAAarJ,IAAK,CACrC,IAAIiC,EAAQ,CAAE,EACdmH,EAAW,OAAO,KAAKnH,CAAK,EAC5BA,EAAM,MAAQyB,EAAO,UAAW,EAChCzB,EAAM,WAAayB,EAAO,WAAY,CACzC,CACA,CACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CACtE,IAAI+C,EAGJ,GAFAA,EAAc/C,EAAO,WAAY,EACjC,KAAK,cAAgB,CAAE,EACnB,KAAK,UAAY,EACpB,QAAS1F,EAAI,EAAGA,EAAIyI,EAAazI,IAChC,KAAK,cAAc,KAAK0F,EAAO,WAAU,CAAE,CAG9C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,yBAA0B,SAAST,EAAQ,CAC9E,IAAI0E,GAAS,KAAK,KAAO,KAAK,UAAU,EACxC,KAAK,SAAW,CAAE,EAClB,QAASpK,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,SAASA,CAAC,EAAI0F,EAAO,WAAY,CAExC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,wBAAwB,EAG5DA,EAAU,kBAAkB,OAAQ,yBAA0B,SAAST,EAAQ,CAC9E,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,aAAeA,EAAO,WAAY,EACvC,IAAI0E,GAAS,KAAK,KAAO,KAAK,SAAW,GAAG,EAC5C,KAAK,eAAiB,CAAE,EACxB,QAASpK,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,eAAeA,CAAC,EAAI0F,EAAO,WAAY,CAE9C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,mBAAoB,SAAST,EAAQ,CACxE,IAAI+C,EACAzI,EAKJ,GAJAyI,EAAc/C,EAAO,WAAY,EACjC,KAAK,YAAc,CAAE,EACrB,KAAK,kBAAoB,CAAE,EAC3B,KAAK,yBAA2B,CAAE,EAC9B,KAAK,UAAY,EACpB,IAAI1F,EAAE,EAAGA,EAAEyI,EAAazI,IACvB,KAAK,YAAY,KAAK0F,EAAO,WAAU,CAAE,EACzC,KAAK,kBAAkB,KAAKA,EAAO,WAAU,CAAE,EAC/C,KAAK,yBAAyB,KAAKA,EAAO,WAAU,CAAE,CAGzD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,uBAAwB,SAAST,EAAQ,CAC5E,IAAI1F,EACA2H,EACA2D,EACAlF,EAGJ,IAFA,KAAK,QAAU,CAAE,EACjBkF,EAAa5F,EAAO,WAAY,EAC3B1F,EAAI,EAAGA,GAAKsL,EAAYtL,IAE5B,GADA2H,EAAMxB,EAAU,YAAYT,EAAQ,GAAM,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACrFiC,EAAI,OAASxB,EAAU,GACtBA,EAAUwB,EAAI,KAAK,aAAa,GACnCvB,EAAM,IAAID,EAAUwB,EAAI,KAAK,aAAa,EAAEA,EAAI,IAAI,EACpDvB,EAAI,SAAWuB,EAAI,SACnBvB,EAAI,MAAQuB,EAAI,QAEhBpJ,EAAI,KAAK,YAAa,8BAA8BoJ,EAAI,IAAI,EAC5DvB,EAAM,IAAID,EAAU,YAAYwB,EAAI,KAAMA,EAAI,KAAMA,EAAI,SAAUA,EAAI,KAAK,GAExEvB,EAAI,QAAUD,EAAU,YAAY,UAAU,QACjD5H,EAAI,KAAK,YAAa,eAAe6H,EAAI,KAAK,mFAAmF,EACjIA,EAAI,mBAAmBV,CAAM,GAE9BU,EAAI,MAAMV,CAAM,EAChB,KAAK,QAAQ,KAAKU,CAAG,MAErB,OAGH,CAAC,EAGDD,EAAU,kBAAkB,OAAQ,yBAA0B,SAAST,EAAQ,CAC9E,KAAK,cAAgBA,EAAO,WAAY,EACxC,IAAI0E,EAAQ1E,EAAO,WAAY,EAC/B,KAAK,wBAA0B,CAAE,EACjC,QAAS1F,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,wBAAwBA,CAAC,EAAI0F,EAAO,WAAY,CAEvD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,sBAAuB,SAAST,EAAQ,CAC3E,IAAI+C,EACAzI,EAIJ,GAHAyI,EAAc/C,EAAO,WAAY,EACjC,KAAK,wBAA0B,CAAE,EACjC,KAAK,oBAAsB,CAAE,EACzB,KAAK,UAAY,EACpB,IAAI1F,EAAE,EAAGA,EAAEyI,EAAazI,IACvB,KAAK,wBAAwB,KAAK0F,EAAO,WAAU,CAAE,EACrD,KAAK,oBAAoB,KAAKA,EAAO,WAAU,CAAE,CAGpD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,gBAAiB,SAAST,EAAQ,CACrE,IAAI1F,EACAyI,EAEJ,GADAA,EAAc/C,EAAO,WAAY,EAC7B,KAAK,UAAY,EAEpB,IADA,KAAK,eAAiB,CAAE,EACpB1F,EAAE,EAAGA,EAAEyI,EAAazI,IACvB,KAAK,eAAe,KAAK0F,EAAO,WAAU,CAAE,CAG/C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,gBAAiB,SAAST,EAAQ,CACrE,IAAI1F,EAEJ,GADA,KAAK,aAAe,CAAE,EAClB,KAAK,UAAY,EAGpB,IAFA,KAAK,YAAc0F,EAAO,WAAY,EACtC,KAAK,aAAeA,EAAO,WAAY,EAClC1F,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAC9B,KAAK,cAAgB,EACxB,KAAK,aAAa,KAAK0F,EAAO,WAAU,CAAE,EAE1C,KAAK,aAAa1F,CAAC,EAAI,KAAK,WAIhC,CAAC,EAGDmG,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACvE,IAAI+C,EACAzI,EACAuL,EAIJ,GAHA9C,EAAc/C,EAAO,WAAY,EACjC,KAAK,cAAgB,CAAE,EACvB,KAAK,cAAgB,CAAE,EACnB,KAAK,UAAY,EACpB,IAAI1F,EAAE,EAAGA,EAAEyI,EAAazI,IACvB,KAAK,cAAc,KAAK0F,EAAO,WAAU,CAAE,EAC3C6F,EAAQ7F,EAAO,UAAW,EACtB6F,EAAQ,IACXhN,EAAI,KAAK,YAAa,gFAAgF,EACtGgN,EAAQ,GAET,KAAK,cAAc,KAAKA,CAAK,CAGhC,CAAC,EAGDpF,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CACtE,IAAI8F,EAAQ9F,EAAO,WAAY,EAC/B,KAAK,oBAAsB8F,EAAQ,EACnC,KAAK,cAAgB9F,EAAO,WAAY,EACxC,IAAInG,EAASmG,EAAO,WAAY,EAChC,KAAK,uBAAyBA,EAAO,WAAWnG,CAAM,EACtD,IAAIoI,EACAvB,EAEJ,IADA,KAAK,MAAQ,CAAE,EACRV,EAAO,YAAa,EAAG,KAAK,MAAM,KAAK,MAE7C,GADAiC,EAAMxB,EAAU,YAAYT,EAAQ,GAAO,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACtFiC,EAAI,OAASxB,EAAU,GAC1BC,EAAMuB,EAAI,IACV,KAAK,MAAM,KAAKvB,CAAG,EACnB,KAAKA,EAAI,IAAI,EAAIA,MAEjB,OAGH,CAAC,EAGDD,EAAU,cAAc,OAAQ,iBAAkB,SAAST,EAAQ,CAClES,EAAU,QAAQ,UAAU,MAAM,KAAK,KAAMT,CAAM,CACpD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,uBAAwB,SAAST,EAAQ,CAC5E,IAAI1F,EAEAwK,EAEJ,GADA,KAAK,aAAe,CAAE,EAClB,KAAK,UAAY,EAIpB,GAHA,KAAK,SAAW9E,EAAO,WAAY,EACnC,KAAK,WAAaA,EAAO,UAAW,EACpC8E,EAAe9E,EAAO,WAAY,EAC9B,KAAK,aAAe,EACvB,IAAK1F,EAAI,EAAGA,EAAIwK,EAAcxK,GAAG,EAAG,CACnC,IAAIkC,EAAMwD,EAAO,UAAW,EAC5B,KAAK,aAAa1F,CAAC,EAAKkC,GAAO,EAAK,GACpC,KAAK,aAAalC,EAAE,CAAC,EAAIkC,EAAM,EACnC,SACa,KAAK,aAAe,EAC9B,IAAKlC,EAAI,EAAGA,EAAIwK,EAAcxK,IAC7B,KAAK,aAAaA,CAAC,EAAI0F,EAAO,UAAW,UAEhC,KAAK,aAAe,GAC9B,IAAK1F,EAAI,EAAGA,EAAIwK,EAAcxK,IAC7B,KAAK,aAAaA,CAAC,EAAI0F,EAAO,WAAY,OAG3CnH,EAAI,MAAM,YAAa,mCAAmC,CAG7D,CAAC,EAGD4H,EAAU,kBAAkB,OAAQ,0BAA2B,SAAST,EAAQ,CAC/E,IAAI1F,EAAEgC,EACFyG,EACAgD,EAGJ,IAFAhD,EAAc/C,EAAO,WAAY,EACjC,KAAK,QAAU,CAAE,EACZ1F,EAAI,EAAGA,EAAIyI,EAAazI,IAAK,CACjC,IAAI0L,EAAa,CAAE,EAKnB,GAJA,KAAK,QAAQ1L,CAAC,EAAI0L,EAClBA,EAAW,aAAehG,EAAO,WAAY,EAC7CgG,EAAW,WAAa,CAAE,EAC1BD,EAAkB/F,EAAO,WAAY,EACjC+F,EAAgB,EACnB,IAAKzJ,EAAI,EAAGA,EAAIyJ,EAAiBzJ,IAAK,CACrC,IAAI2J,EAAY,CAAE,EAClBD,EAAW,WAAW,KAAKC,CAAS,EAChC,KAAK,SAAW,EACnBA,EAAU,KAAOjG,EAAO,WAAY,EAEpCiG,EAAU,KAAOjG,EAAO,WAAY,EAErCiG,EAAU,SAAWjG,EAAO,UAAW,EACvCiG,EAAU,YAAcjG,EAAO,UAAW,EAC1CiG,EAAU,0BAA4BjG,EAAO,WAAY,CAC7D,CAEA,CACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,qBAAsB,SAAST,EAAQ,CAE1E,GADAA,EAAO,UAAS,EACZ,KAAK,UAAY,EACpBA,EAAO,UAAW,MACZ,CACN,IAAIxD,EAAMwD,EAAO,UAAW,EAC5B,KAAK,yBAA4BxD,GAAO,EAAK,GAC7C,KAAK,wBAA0BA,EAAM,EACvC,CACC,KAAK,oBAAsBwD,EAAO,UAAW,EAC7C,KAAK,2BAA6BA,EAAO,UAAW,EACpD,KAAK,YAAcS,EAAU,WAAWT,CAAM,EAC1C,KAAK,sBAAwB,GAAK,KAAK,6BAA+B,IACzE,KAAK,yBAA2BA,EAAO,UAAW,EAClD,KAAK,oBAAsBA,EAAO,eAAe,KAAK,wBAAwB,EAEhF,CAAC,EACDS,EAAU,kBAAkB,OAAQ,sCAAuC,SAAST,EAAQ,CACvF,KAAK,SAAW,EACnB,KAAK,oBAAsBA,EAAO,WAAY,EAE9C,KAAK,oBAAsBA,EAAO,WAAY,CAEhD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,yBAA0B,SAAST,EAAQ,CAC9E,IAAIkG,EAAY,EAChB,KAAK,SAAWlG,EAAO,WAAY,EAC/B,KAAK,KAAO,KAAK,SAAWkG,GAAc,KAAK,MAAQzF,EAAU,4BACpE,KAAK,iBAAmBT,EAAO,WAAY,EAC3CkG,GAAa,GAEb,KAAK,iBAAmB,EAErB,KAAK,KAAO,KAAK,SAAWA,GAAc,KAAK,MAAQzF,EAAU,uBACpE,KAAK,iCAAmCT,EAAO,WAAY,EAC3DkG,GAAa,GAEb,KAAK,iCAAmC,EAErC,KAAK,KAAO,KAAK,SAAWA,GAAc,KAAK,MAAQzF,EAAU,sBACpE,KAAK,wBAA0BT,EAAO,WAAY,EAClDkG,GAAa,GAEb,KAAK,wBAA0B,EAE5B,KAAK,KAAO,KAAK,SAAWA,GAAc,KAAK,MAAQzF,EAAU,uBACpE,KAAK,oBAAsBT,EAAO,WAAY,EAC9CkG,GAAa,GAEb,KAAK,oBAAsB,EAExB,KAAK,KAAO,KAAK,SAAWA,GAAc,KAAK,MAAQzF,EAAU,wBACpE,KAAK,qBAAuBT,EAAO,WAAY,EAC/CkG,GAAa,GAEb,KAAK,qBAAuB,CAE9B,CAAC,EAGDzF,EAAU,kBAAkB,OAAQ,+BAAgC,SAAST,EAAQ,CACpF,KAAK,SAAWA,EAAO,WAAY,EACnCA,EAAO,WAAY,EACnB,IAAI+D,EAAW/D,EAAO,UAAW,EACjC,KAAK,wBAA2B+D,GAAY,EAAK,EACjD,KAAK,wBAA2BA,GAAY,EAAK,EACjD,KAAK,0BAA6BA,EAAY,EAC9C,KAAK,QAAU,CAAE,EAEjB,QADIoC,EAAoBnG,EAAO,WAAY,EAClC1F,EAAI,EAAGA,EAAI6L,EAAmB7L,IAClC,KAAK,UAAY,GACpB,KAAK,KAAO0F,EAAO,WAAY,EAC/B,KAAK,YAAcA,EAAO,WAAY,IAEtC,KAAK,KAAOA,EAAO,WAAY,EAC/B,KAAK,YAAcA,EAAO,WAAY,GAEvC,KAAK,YAAcA,EAAO,WAAY,GAAG,KAAK,wBAAwB,EAAG,EAAG,EAC5E,KAAK,YAAcA,EAAO,WAAY,GAAG,KAAK,wBAAwB,EAAG,EAAG,EAC5E,KAAK,cAAgBA,EAAO,WAAY,GAAG,KAAK,0BAA0B,EAAG,EAAG,CAElF,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,iBAAkB,SAAST,EAAQ,CAClE,KAAK,SAAW,GACnB,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,SAAWA,EAAO,WAAY,EACnCA,EAAO,WAAY,EACnB,KAAK,SAAWA,EAAO,WAAY,IAEnC,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,SAAWA,EAAO,WAAY,EACnCA,EAAO,WAAY,EACnB,KAAK,SAAWA,EAAO,WAAY,GAEpCA,EAAO,gBAAgB,CAAC,EACxB,KAAK,MAAQA,EAAO,UAAW,EAC/B,KAAK,gBAAkBA,EAAO,UAAW,EACzC,KAAK,OAASA,EAAO,UAAW,GAAE,EAClCA,EAAO,WAAY,EACnB,KAAK,OAASA,EAAO,eAAe,CAAC,EACrC,KAAK,MAAQA,EAAO,WAAY,EAChC,KAAK,OAASA,EAAO,WAAY,CAClC,CAAC,EAGDS,EAAU,cAAc,OAAQ,sBAAuB,SAAST,EAAQ,CACvE,KAAK,KAAOA,EAAO,WAAY,CAChC,CAAC,EAGDS,EAAU,cAAc,OAAQ,sBAAuB,SAAST,EAAQ,CACvE,KAAK,KAAOA,EAAO,WAAY,CAChC,CAAC,EAGDS,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,kBAAkB,UAAU,MAAQ,SAAST,EAAQ,CAC9D,KAAK,gBAAgBA,CAAM,EAC3B,KAAK,eAAiBA,EAAO,WAAY,CAC1C,EAGAS,EAAU,qBAAqB,MAAM,EACrCA,EAAU,sBAAwB,SAASM,EAAMnG,EAAMsG,EAAUpI,EAAO,CACvE2H,EAAU,IAAI,KAAK,KAAMM,EAAMnG,CAAI,EACnC,KAAK,SAAWsG,EAChB,KAAK,MAAQpI,CACd,EACA2H,EAAU,sBAAsB,UAAY,IAAIA,EAAU,IAC1DA,EAAU,sBAAsB,UAAU,MAAQ,SAAST,EAAQ,CAClE,KAAK,UAAYA,EAAO,iBAAiB,KAAK,KAAK,KAAK,UAAU,CAAC,CACpE,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CAGpD,QAFIiC,EACAvB,EACGV,EAAO,YAAa,EAAG,KAAK,MAAM,KAAK,MAE7C,GADAiC,EAAMxB,EAAU,YAAYT,EAAQ,GAAM,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACrFiC,EAAI,OAASxB,EAAU,GAC1BC,EAAM,IAAID,EAAU,sBAAsBwB,EAAI,KAAMA,EAAI,KAAMA,EAAI,SAAUA,EAAI,KAAK,EACjFvB,EAAI,QAAUD,EAAU,IAAI,UAAU,OAASC,EAAI,OAAS,SAC/D7H,EAAI,KAAK,YAAa,kBAAkB6H,EAAI,KAAK,mFAAmF,EACpIA,EAAI,mBAAmBV,CAAM,GAE9BU,EAAI,MAAMV,CAAM,EAChB,KAAK,MAAM,KAAKU,CAAG,MAEnB,OAGH,EAGAD,EAAU,kBAAkB,OAAQ,8BAA+B,SAAST,EAAQ,CAGnF,IAFA,KAAK,SAAWA,EAAO,WAAY,EACnC,KAAK,MAAQ,CAAE,EACRA,EAAO,YAAa,EAAG,KAAK,MAAM,KAAK,MAE7C,GADA,IAAMS,EAAU,YAAYT,EAAQ,GAAO,KAAK,MAAQA,EAAO,YAAW,EAAK,KAAK,MAAM,EACtF,IAAI,OAASS,EAAU,GAC1B,IAAM,IAAI,IACV,KAAK,MAAM,KAAK,GAAG,MAEnB,OAGH,CAAC,EAGDA,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACvE,KAAK,SAAWA,EAAO,WAAY,EACnC,KAAK,iCAAmCA,EAAO,WAAY,EAC3D,KAAK,wBAA0BA,EAAO,WAAY,EAClD,KAAK,oBAAsBA,EAAO,WAAY,EAC9C,KAAK,qBAAuBA,EAAO,WAAY,CAChD,CAAC,EAGDS,EAAU,cAAc,OAAQ,gBAAiB,SAAST,EAAQ,CACjE,KAAK,UAAYA,EAAO,WAAY,CACrC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,cAAe,SAAST,EAAQ,CACnE,IAAIkG,EAAY,EAmBhB,GAlBA,KAAK,aAAelG,EAAO,WAAY,EACvCkG,GAAY,EACR,KAAK,KAAO,KAAK,SAAWA,GAAc,KAAK,MAAQzF,EAAU,wBACpE,KAAK,YAAcT,EAAO,YAC1BkG,GAAa,GAEb,KAAK,YAAc,EAEhB,KAAK,KAAO,KAAK,SAAWA,GAAc,KAAK,MAAQzF,EAAU,uBACpE,KAAK,mBAAqBT,EAAO,WAAY,EAC7CkG,GAAa,GAEb,KAAK,mBAAqB,EAE3B,KAAK,gBAAkB,CAAE,EACzB,KAAK,YAAc,CAAE,EACrB,KAAK,aAAe,CAAE,EACtB,KAAK,+BAAiC,CAAE,EACpC,KAAK,KAAO,KAAK,SAAWA,EAC/B,QAAS5L,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,MAAQmG,EAAU,sBAC1B,KAAK,gBAAgBnG,CAAC,EAAI0F,EAAO,WAAY,GAE1C,KAAK,MAAQS,EAAU,kBAC1B,KAAK,YAAYnG,CAAC,EAAI0F,EAAO,WAAY,GAEtC,KAAK,MAAQS,EAAU,mBAC1B,KAAK,aAAanG,CAAC,EAAI0F,EAAO,WAAY,GAEvC,KAAK,MAAQS,EAAU,wBACtB,KAAK,UAAY,EACpB,KAAK,+BAA+BnG,CAAC,EAAI0F,EAAO,WAAY,EAE5D,KAAK,+BAA+B1F,CAAC,EAAI0F,EAAO,UAAS,EAK9D,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,oBAAqB,SAAST,EAAQ,CACzE,KAAK,aAAeA,EAAO,WAAY,EACvC,IAAI0E,GAAS,KAAK,KAAO,KAAK,SAAW,GAAG,EAC5C,KAAK,eAAiB,CAAE,EACxB,QAASpK,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,eAAeA,CAAC,EAAI0F,EAAO,WAAY,CAE9C,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,gBAAiB,SAAST,EAAQ,CACrE,KAAK,OAASA,EAAO,YAAa,CACnC,CAAC,EAGDS,EAAU,cAAc,OAAQ,qBAAsB,SAAST,EAAQ,CACtE,IAAI0E,GAAS,KAAK,KAAO,KAAK,UAAY,EAC1C,KAAK,kBAAoB,CAAE,EAC3B,QAASpK,EAAI,EAAGA,EAAIoK,EAAOpK,IAC1B,KAAK,kBAAkBA,CAAC,EAAI0F,EAAO,WAAW,CAAC,CAEjD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,0BAA2B,SAAST,EAAQ,CAC/E,KAAK,KAAOA,EAAO,YAAa,EAChC,KAAK,KAAOA,EAAO,YAAa,EAChC,KAAK,YAAcA,EAAO,YAAa,EACvC,KAAK,KAAOA,EAAO,YAAa,CACjC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,6BAA8B,SAAST,EAAQ,CAC/E,IAAI1F,EAEJ,GADA,KAAK,QAAU0F,EAAO,WAAW,CAAC,EAC9B,KAAK,SAAW,GAEb,GAAI,KAAK,SAAW,EAAG,CAM1B,IALA,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,gBAAkB,CAAE,EACzB,KAAK,8BAAgC,CAAE,EACvC,KAAK,iBAAmB,CAAE,EAC1B,KAAK,qBAAuB,CAAE,EACzB1F,EAAI,EAAGA,EAAI,KAAK,gBAAiBA,IAClC,KAAK,gBAAgB,KAAK0F,EAAO,WAAU,CAAE,EAC7C,KAAK,8BAA8B,KAAKA,EAAO,UAAS,CAAE,EAC1D,KAAK,iBAAiB,KAAKA,EAAO,UAAS,CAAE,EAC7C,KAAK,qBAAqB,KAAKA,EAAO,UAAS,CAAE,EAErD,KAAK,cAAgBA,EAAO,UAAW,EACvC,KAAK,gBAAkBA,EAAO,UAAW,EACzC,KAAK,WAAaA,EAAO,UAAW,EACpC,IAAI6C,EAAQ7C,EAAO,UAAW,EAC9B,KAAK,wBAA2B6C,GAAS,EAAK,EAC9C,KAAK,cAAiBA,GAAS,EAAK,EACpC,KAAK,oBAAuBA,GAAS,EAAK,EAC1C,KAAK,eAAkBA,GAAS,EAAK,EACrC,KAAK,YAAeA,GAAS,EAAK,EAClC,KAAK,WAAa7C,EAAO,WAAY,EACrC,KAAK,eAAiBA,EAAO,WAAY,EACzC,KAAK,gBAAkBA,EAAO,WAAY,EAC1C,KAAK,wBAA0BA,EAAO,WAAY,EAClD,KAAK,wBAA0BA,EAAO,WAAY,CAC1D,EACA,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACnE,KAAK,QAAU,IAClB,KAAK,SAAWA,EAAO,YAAa,EAEtC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,kBAAmB,SAAST,EAAQ,CACvE,KAAK,KAAOA,EAAO,YAAa,EAC5B,KAAK,KAAO,KAAK,SAAW,KAAK,KAAK,OAAS,EAAI,IACtD,KAAK,SAAWA,EAAO,YAAa,EAEtC,CAAC,EAGDS,EAAU,cAAc,mCAAoC,wBAAyB,GAAM,GAAO,SAAST,EAAQ,CAC/G,KAAK,mBAAqBA,EAAO,WAAW,KAAK,KAAO,KAAK,QAAQ,EAChE,QAAQ,KAAM,OAAO,EACrB,QAAQ,KAAM,MAAM,EACpB,QAAQ,KAAM,MAAM,EACpB,QAAQ,KAAM,QAAQ,EACtB,QAAQ,KAAM,QAAQ,CAC/B,CAAC,EACDS,EAAU,cAAc,mCAAoC,wCAAyC,GAAM,GAAO,SAAST,EAAQ,CAClI,KAAK,UAAYS,EAAU,WAAWT,CAAM,EAC5C,IAAI+E,EAAW/E,EAAO,WAAY,EAC9B+E,EAAW,IACd,KAAK,KAAO/E,EAAO,eAAe+E,CAAQ,EAE5C,CAAC,EAGDtE,EAAU,cAAc,mCAAoC,0BAA2B,GAAM,EAuBzF,EAEJA,EAAU,cAAc,mCAAoC,yBAA0B,GAAM,GAAO,SAAST,EAAQ,CACnH,KAAK,oBAAsBA,EAAO,WAAY,EAC9C,KAAK,gBAAkBA,EAAO,UAAW,EACzC,KAAK,YAAcS,EAAU,WAAWT,CAAM,CAC/C,CAAC,EACDS,EAAU,cAAc,mCAAoC,UAAW,GAAM,GAAO,SAAST,EAAQ,CACjG,KAAK,eAAiBA,EAAO,UAAW,EACxC,KAAK,QAAU,CAAE,EAEjB,QAAS1F,EAAI,EAAGA,EAAI,KAAK,eAAgBA,IAAK,CAC1C,IAAIoJ,EAAQ,CAAE,EACV0C,EAAgB,EAChBC,EAAoB,EAEpB,KAAK,UAAY,GACjBD,EAAgBpG,EAAO,WAAY,EACnCqG,EAAoBrG,EAAO,WAAY,IAEvCoG,EAAgBpG,EAAO,WAAY,EACnCqG,EAAoBrG,EAAO,WAAY,GAG3C0D,EAAM,cAAgB0C,EACtB1C,EAAM,kBAAoB2C,EAE1B,KAAK,QAAQ,KAAK3C,CAAK,CAC/B,CACA,CAAC,EACDjD,EAAU,cAAc,mCAAoC,UAAW,GAAM,GAAO,SAAST,EAAQ,CAC7F,KAAK,UAAY,GAClB,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,SAAWA,EAAO,WAAY,IAEnC,KAAK,cAAgBA,EAAO,WAAY,EACxC,KAAK,SAAWA,EAAO,WAAY,EAE1C,CAAC,EACDS,EAAU,kBAAkB,OAAQ,sBAAuB,SAAST,EAAQ,CAC3E,KAAK,aAAeA,EAAO,WAAY,EACvC,KAAK,QAAUA,EAAO,gBAAgB,CAAC,CACxC,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,6BAA8B,SAAUT,EAAQ,CACnF,IAAIxD,EACA,KAAK,UAAY,GACpB,KAAK,QAAUwD,EAAO,UAAW,EACjC,KAAK,MAAQA,EAAO,UAAW,EAC/BxD,EAAMwD,EAAO,UAAW,EACxB,KAAK,SAAWxD,GAAO,EACvB,KAAK,kBAAqBA,GAAO,EAAK,EACtC,KAAK,mBAAqBA,EAAM,EAChC,KAAK,gBAAkBwD,EAAO,UAAW,EACzC,KAAK,wBAA0BA,EAAO,UAAW,EACjD,KAAK,mBAAqBA,EAAO,UAAW,EAC5C,KAAK,2BAA6BA,EAAO,WAAY,EACrD,KAAK,uBAAyBA,EAAO,eAAe,KAAK,0BAA0B,IAEnF,KAAK,QAAUA,EAAO,UAAW,EACjC,KAAK,MAAQA,EAAO,UAAW,EAC/BxD,EAAMwD,EAAO,UAAW,EACxB,KAAK,SAAYxD,GAAO,EAAK,GAC7B,KAAK,WAAaA,EAAM,GACxBA,EAAMwD,EAAO,UAAW,EACxB,KAAK,kBAAqBxD,GAAO,EAAK,GACtC,KAAK,iBAAoBA,GAAO,EAAK,EACrC,KAAK,mBAAqBA,EAAM,EAChC,KAAK,2BAA6BwD,EAAO,WAAY,EACrD,KAAK,uBAAyBA,EAAO,eAAe,KAAK,0BAA0B,EAErF,CAAC,EACDS,EAAU,cAAc,OAAQ,yBAA0B,SAAST,EAAQ,CAC1E,KAAK,KAAOA,EAAO,WAAW,KAAK,KAAO,KAAK,QAAQ,CACxD,CAAC,EAGDS,EAAU,kBAAkB,OAAQ,sBAAuB,SAAUT,EAAQ,CAC3E,IAAI1F,EAAGgC,EAGHgK,EAAY,CACd,UAAW,OACX,cAAe,EAEf,oBAAqB,SAAUC,EAAM,CACnC,KAAK,UAAYA,EAAK,UAAW,EACjC,KAAK,cAAgB,CACtB,EACD,oBAAqB,SAAUA,EAAM,CACnC,KAAK,UAAYA,EAAK,WAAY,EAClC,KAAK,cAAgB,EACtB,EAED,aAAc,SAAUC,EAAU,CAChC,IAAIvE,EAAO,KAAK,WAAc,KAAK,cAAgBuE,GAAe,GAAKA,GAAY,EACnF,YAAK,eAAiBA,EACfvE,CACb,CACG,EAQD,GALAqE,EAAU,oBAAoBtG,CAAM,EACpCsG,EAAU,aAAa,CAAC,EACxB,KAAK,mBAAqBA,EAAU,aAAa,CAAC,EAClD,KAAK,iBAAmBA,EAAU,aAAa,CAAC,EAE5C,KAAK,iBAAkB,CACzBA,EAAU,oBAAoBtG,CAAM,EACpC,KAAK,QAAUsG,EAAU,aAAa,CAAC,EACvC,KAAK,cAAgBA,EAAU,aAAa,CAAC,EAC7C,KAAK,oBAAsBA,EAAU,aAAa,CAAC,EACnD,KAAK,kBAAoBA,EAAU,aAAa,CAAC,EAEjDA,EAAU,oBAAoBtG,CAAM,EACpC,KAAK,iBAAmBsG,EAAU,aAAa,CAAC,EAChDA,EAAU,aAAa,CAAC,EAGxB,CAcE,GAbAA,EAAU,oBAAoBtG,CAAM,EACpCsG,EAAU,aAAa,CAAC,EACxB,KAAK,0BAA4BA,EAAU,aAAa,CAAC,EACzD,KAAK,oBAAsBA,EAAU,aAAa,CAAC,EACnD,KAAK,kBAAoBA,EAAU,aAAa,CAAC,EAEjD,KAAK,kBAAoBtG,EAAO,UAAW,EAE3CsG,EAAU,oBAAoBtG,CAAM,EACpC,KAAK,+BAAiCsG,EAAU,aAAa,CAAC,EAC9D,KAAK,4BAA8BA,EAAU,aAAa,CAAC,EAE3D,KAAK,wBAA0B,IAAI,WAAW,KAAK,yBAAyB,EACxE,KAAK,0BAA2B,CAClC,IAAKhM,EAAI,EAAGA,EAAI,KAAK,0BAA4B,EAAGA,IAAK,CACvD,IAAImM,EAASH,EAAU,aAAa,CAAC,EACrCA,EAAU,oBAAoBtG,CAAM,EACpC,IAAI0G,EAASJ,EAAU,aAAa,CAAC,EAErC,KAAK,wBAAwBhM,CAAC,EAAMmM,GAAU,EAAKC,CAC7D,CACQ,KAAK,wBAAwB,KAAK,0BAA4B,CAAC,EAAIJ,EAAU,aAAa,CAAC,CACnG,MAEQA,EAAU,aAAa,CAAC,EAG1B,GAAI,KAAK,cAAgB,EAAG,CAG1B,IAFAA,EAAU,oBAAoBtG,CAAM,EACpC,KAAK,0BAA4B,EAC5B1D,EAAI,KAAK,cAAgB,EAAGA,GAAK,EAAG,EAAEA,EAAG,CAC5C,IAAIqK,EAAML,EAAU,aAAa,CAAC,EAClC,KAAK,2BAA6BK,GAAOrK,CACnD,CACQ,IAAKA,EAAI,KAAK,cAAeA,GAAK,GAAK,KAAK,cAAgB,EAAG,EAAEA,EAC/DgK,EAAU,aAAa,CAAC,EAI1B,IADA,KAAK,mBAAqB,CAAE,EACvBhK,EAAI,KAAK,cAAgB,EAAGA,GAAK,EAAG,EAAEA,EACrC,KAAK,0BAA6B,GAAKA,IACzC,KAAK,mBAAmBA,CAAC,EAAI0D,EAAO,UAAW,EAG3D,CAIM,GAFA,KAAK,qBAAuBA,EAAO,UAAW,EAC9C,KAAK,wBAA0B,CAAE,EAC7B,KAAK,qBACP,IAAK1F,EAAI,EAAGA,EAAI,KAAK,qBAAsBA,IACzC,KAAK,wBAAwB,KAAK0F,EAAO,WAAU,CAAE,CAG1D,CAED,KAAK,kBAAoBA,EAAO,WAAY,EAC5C,KAAK,mBAAqBA,EAAO,WAAY,EAC7C,KAAK,eAAiBA,EAAO,WAAY,CAC7C,CAEE,IAAI4G,EAAe,GACfC,EAAqB,GAEzB,KAAK,YAAc,CAAE,EACrB,IAAIC,EAAgB9G,EAAO,UAAW,EACtC,IAAK1F,EAAI,EAAGA,EAAIwM,EAAexM,IAAK,CAClC,IAAI0J,EAAa,CAAE,EACnB,KAAK,YAAY,KAAKA,CAAU,EAEhCsC,EAAU,oBAAoBtG,CAAM,EACpCgE,EAAW,aAAesC,EAAU,aAAa,CAAC,EAClDA,EAAU,aAAa,CAAC,EACxBtC,EAAW,UAAYsC,EAAU,aAAa,CAAC,EAE/C,IAAIpC,EAAW,EAKf,IAJIF,EAAW,WAAa6C,GAAsB7C,EAAW,WAAa4C,IACxE1C,EAAWlE,EAAO,WAAY,GAG3B1D,EAAI,EAAGA,EAAI4H,EAAU5H,IAAK,CAC7B,IAAIK,EAAMqD,EAAO,WAAY,EAC7BgE,EAAW,KAAK,CACd,KAAMhE,EAAO,eAAerD,CAAG,EAC/B,OAAQA,CAChB,CAAO,CACP,CACA,CACA,CAAC,EAED8D,EAAU,kBAAkB,OAAQ,mBAAoB,SAAUT,EAAQ,CAExE,IAAIxD,EAAM,KAAK,UAAW,EAC1B,KAAK,mBAAsBA,EAAM,CACnC,CAAC,EAEDiE,EAAU,YAAY,UAAU,QAAU,UAAW,CACpD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,QAAU,UAAW,CACpD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,WAAa,UAAW,CACvD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,WAAa,UAAW,CACvD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,OAAS,UAAW,CACnD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,SAAW,UAAW,CACrD,OAAO,KAAK,KAAK,QAAQ,IAAI,EAAE,CAChC,EAEAA,EAAU,YAAY,UAAU,SAAW,UAAW,CACrD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,UAAY,UAAW,CACtD,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,gBAAkB,UAAW,CAC5D,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,cAAgB,UAAW,CAC1D,MAAO,EACR,EAEAA,EAAU,YAAY,UAAU,cAAgB,UAAW,CAC1D,MAAO,EACR,EAEAA,EAAU,kBAAkB,UAAU,QAAU,UAAW,CAC1D,MAAO,EACR,EAEAA,EAAU,kBAAkB,UAAU,SAAW,UAAW,CAC3D,OAAO,KAAK,KACb,EAEAA,EAAU,kBAAkB,UAAU,UAAY,UAAW,CAC5D,OAAO,KAAK,MACb,EAEAA,EAAU,iBAAiB,UAAU,QAAU,UAAW,CACzD,MAAO,EACR,EAEAA,EAAU,iBAAiB,UAAU,gBAAkB,UAAW,CACjE,OAAO,KAAK,aACb,EAEAA,EAAU,iBAAiB,UAAU,cAAgB,UAAW,CAC/D,OAAO,KAAK,UACb,EAEAA,EAAU,iBAAiB,UAAU,cAAgB,UAAW,CAC/D,OAAO,KAAK,UACb,EAEAA,EAAU,oBAAoB,UAAU,WAAa,UAAW,CAC/D,MAAO,EACR,EAEAA,EAAU,oBAAoB,UAAU,WAAa,UAAW,CAC/D,MAAO,EACR,EAGAA,EAAU,aAAe,SAASsG,EAAGC,EAAS,CAC7C,IAAIpF,EAAM,OAAOmF,CAAC,EAAE,SAAS,EAAE,EAE/B,IADAC,EAAU,OAAQA,EAAa,KAAeA,IAAY,KAAOA,EAAU,EAAIA,EACxEpF,EAAI,OAASoF,GACnBpF,EAAM,IAAMA,EAEb,OAAOA,CACR,EAEAnB,EAAU,gBAAgB,UAAU,SACpCA,EAAU,gBAAgB,UAAU,SACpCA,EAAU,gBAAgB,UAAU,SACpCA,EAAU,gBAAgB,UAAU,SAAW,UAAW,CACzD,IAAIwG,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAClE,OAAI,KAAK,KACDwG,EAAU,IAAIxG,EAAU,aAAa,KAAK,KAAK,oBAAoB,EACjEA,EAAU,aAAa,KAAK,KAAK,qBAAqB,EACtDA,EAAU,aAAa,KAAK,KAAK,kBAAkB,EAErDwG,CAET,EAEAxG,EAAU,gBAAgB,UAAU,SACpCA,EAAU,gBAAgB,UAAU,SAAW,UAAW,CACzD,IAAInG,EACA2M,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAClE,GAAI,KAAK,KAAM,CAEd,OADAwG,GAAa,IACL,KAAK,KAAK,sBAAqB,CACtC,IAAK,GACJA,GAAa,GACb,MACD,IAAK,GACJA,GAAa,IACb,MACD,IAAK,GACJA,GAAa,IACb,MACD,IAAK,GACJA,GAAa,IACb,KACJ,CACEA,GAAa,KAAK,KAAK,oBACvBA,GAAa,IACb,IAAIN,EAAM,KAAK,KAAK,8BAChBO,EAAW,EACf,IAAK5M,EAAE,EAAGA,EAAE,KACX4M,GAAYP,EAAM,EACdrM,GAAG,IAFQA,IAGf4M,IAAa,EACbP,IAAO,EAERM,GAAaxG,EAAU,aAAayG,EAAU,CAAC,EAC/CD,GAAa,IACT,KAAK,KAAK,oBAAsB,EACnCA,GAAa,IAEbA,GAAa,IAEdA,GAAa,KAAK,KAAK,kBACvB,IAAIE,EAAU,GACVC,EAAoB,GACxB,IAAK9M,EAAI,EAAGA,GAAK,EAAGA,KACf,KAAK,KAAK,6BAA6BA,CAAC,GAAK6M,KAChDC,EAAoB,IAAI3G,EAAU,aAAa,KAAK,KAAK,6BAA6BnG,CAAC,EAAG,CAAC,EAAE8M,EAC7FD,EAAU,IAGZF,GAAaG,CACf,CACC,OAAOH,CACR,EAEAxG,EAAU,gBAAgB,UAAU,SACpCA,EAAU,gBAAgB,UAAU,SAAW,UAAY,CAC1D,IAAInG,EACA2M,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAClE,GAAI,KAAK,KAAM,CACdwG,GAAa,IAAM,KAAK,KAAK,oBACzB,KAAK,KAAK,kBACbA,GAAa,KAEbA,GAAa,KAEdA,GAAa,KAAK,KAAK,kBAEvB,IAAIG,EAAoB,GACxB,GAAI,KAAK,KAAK,wBAAyB,CACtC,IAAIC,EAAQ,CAAE,EACV1E,EAAO,EACXA,GAAQ,KAAK,KAAK,2BAA6B,EAC/CA,GAAQ,KAAK,KAAK,wBAA0B,EAC5C,IAAI2E,EACJ,IAAKhN,EAAI,EAAGA,EAAI,KAAK,KAAK,wBAAwB,OAAQ,EAAEA,EAC3DqI,GAAS,KAAK,KAAK,wBAAwBrI,CAAC,GAAK,EAAK,GACtD+M,EAAM,KAAK1E,CAAI,EACXA,IACH2E,EAAehN,GAGhBqI,EAAQ,KAAK,KAAK,wBAAwBrI,CAAC,GAAK,EAAK,EAGtD,GAAIgN,IAAiB,OACpBF,EAAoB,UAEhB,CACJA,EAAoB,KACpB,IAAIG,EAAe,mCACfC,EAAY,EACZC,EAAgB,EACpB,IAAKnN,EAAI,EAAGA,GAAKgN,EAAc,EAAEhN,EAIhC,IAHAkN,EAAaA,GAAa,EAAKH,EAAM/M,CAAC,EACtCmN,GAAiB,EAEVA,GAAiB,GAAG,CAC1B,IAAId,EAAOa,GAAcC,EAAgB,EAAM,GAC/CL,GAAqBG,EAAaZ,CAAG,EAErCc,GAAiB,EACjBD,IAAc,GAAKC,GAAiB,CAC1C,CAEQA,IACHD,IAAe,EAAIC,EACnBL,GAAqBG,EAAaC,EAAY,EAAI,EAEvD,CACA,CACEP,GAAaG,CACf,CACC,OAAOH,CACR,EAEAxG,EAAU,gBAAgB,UAAU,SAAW,UAAW,CACzD,IAAIwG,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAClE,GAAI,KAAK,MAAQ,KAAK,KAAK,IAAK,CAC/B,IAAIiH,EAAM,KAAK,KAAK,IAAI,OAAQ,EAC5BnH,EAAM,KAAK,KAAK,IAAI,eAAgB,EACxC,OAAO0G,EAAU,IAAIxG,EAAU,aAAaiH,CAAG,GAAGnH,EAAM,IAAIA,EAAK,GACnE,KACE,QAAO0G,CAET,EAEAxG,EAAU,gBAAgB,UAAU,SAAW,UAAW,CACzD,IAAIwG,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAClE,OAAG,KAAK,YACAwG,EAAY,IAAM,KAAK,YAEvBA,CAET,EAEAxG,EAAU,gBAAgB,UAAU,SACpCA,EAAU,gBAAgB,UAAU,SAAW,UAAW,CACzD,IAAIwG,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAC9DpH,EAAQ,KAAK,KAAK,MAClBA,GAAS,IACZA,EAAQ,MAET,IAAIsO,EAAW,KAAK,KAAK,SACzB,OAAIA,GAAY,IACfA,EAAW,MAELV,EAAY,KAAO,KAAK,KAAK,QAAU,IAAM5N,EAAQ,IAAMsO,CACnE,EAEAlH,EAAU,gBAAgB,UAAU,SAAW,UAAW,CACzD,IAAIwG,EAAYxG,EAAU,YAAY,UAAU,SAAS,KAAK,IAAI,EAC9DpH,EAAQ,KAAK,KAAK,gBAClBA,EAAQ,KACXA,EAAQ,IAAMA,GAEf,IAAIuO,EACJ,OAAI,KAAK,KAAK,cAAgB,GAAK,KAAK,KAAK,gBAAkB,EAC9DA,EAAY,KAAK,KAAK,aAAe,EAAK,KAAO,KACtC,KAAK,KAAK,aAAe,IACpCA,EAAY,KAAK,KAAK,gBAAkB,EAAK,KAAO,MAG9CX,EAAU,IAAI,KAAK,KAAK,YAAY,IAAI5N,GAAO,KAAK,KAAK,WAAW,IAAI,KAAK,IAAIuO,CACzF,EAMAnH,EAAU,IAAI,UAAU,YAAc,SAAST,EAAQzG,EAAK,CAC3D,KAAK,MAAQ,EACT,KAAK,KAAOqD,IACf,KAAK,MAAQ,GAEV,KAAK,OAAS,SACjB,KAAK,MAAQ,IAEd/D,EAAI,MAAM,YAAa,eAAe,KAAK,KAAK,aAAa,KAAK,KAAK,gBAAgBmH,EAAO,YAAW,GAAIzG,GAAO,GAAG,EACnH,KAAK,KAAOqD,EACfoD,EAAO,YAAY,CAAC,GAEpB,KAAK,aAAeA,EAAO,YAAa,EACxCA,EAAO,YAAY,KAAK,IAAI,GAE7BA,EAAO,YAAY,KAAK,KAAM,KAAM,CAAC,EACjC,KAAK,OAAS,QACjBA,EAAO,gBAAgB,KAAK,IAAI,EAE7B,KAAK,KAAOpD,GACfoD,EAAO,YAAY,KAAK,IAAI,CAE9B,EAEAS,EAAU,QAAQ,UAAU,YAAc,SAAST,EAAQ,CAC1D,KAAK,MAAQ,EACbS,EAAU,IAAI,UAAU,YAAY,KAAK,KAAMT,EAAQ,MAAM,KAAK,QAAQ,MAAM,KAAK,KAAK,EAC1FA,EAAO,WAAW,KAAK,OAAO,EAC9BA,EAAO,YAAY,KAAK,KAAK,CAC9B,EAEAS,EAAU,IAAI,UAAU,MAAQ,SAAST,EAAQ,CAC5C,KAAK,OAAS,OAEb,KAAK,OACR,KAAK,KAAO,KAAK,KAAK,OACtB,KAAK,YAAYA,CAAM,EACvBA,EAAO,gBAAgB,KAAK,IAAI,IAGjC,KAAK,KAAQ,KAAK,KAAO,KAAK,KAAK,OAAS,EAC5C,KAAK,YAAYA,CAAM,EACnB,KAAK,MACRA,EAAO,gBAAgB,KAAK,IAAI,EAGnC,EAEAS,EAAU,aAAa,UAAU,MAAQ,SAAST,EAAQ,CACzD,KAAK,KAAO,EACZ,KAAK,YAAYA,CAAM,EACvB,QAAS1F,EAAE,EAAGA,EAAE,KAAK,MAAM,OAAQA,IAC9B,KAAK,MAAMA,CAAC,IACf,KAAK,MAAMA,CAAC,EAAE,MAAM0F,CAAM,EAC1B,KAAK,MAAQ,KAAK,MAAM1F,CAAC,EAAE,MAI7BzB,EAAI,MAAM,YAAa,iBAAiB,KAAK,KAAK,kBAAkB,KAAK,IAAI,EAC7EmH,EAAO,aAAa,KAAK,aAAc,KAAK,IAAI,CACjD,EAEAS,EAAU,sBAAsB,UAAU,MAAQ,SAAST,EAAQ,CAClE,KAAK,KAAO,KAAK,UAAU,OAAO,EAClC,KAAK,YAAYA,CAAM,EACvBA,EAAO,iBAAiB,KAAK,SAAS,CACvC,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAEJ,IADA,KAAK,KAAO,EACPA,EAAI,EAAGA,EAAI,KAAK,IAAI,OAAQA,IAChC,KAAK,MAAQ,EAAE,KAAK,IAAIA,CAAC,EAAE,OAE5B,IAAKA,EAAI,EAAGA,EAAI,KAAK,IAAI,OAAQA,IAChC,KAAK,MAAQ,EAAE,KAAK,IAAIA,CAAC,EAAE,OAY5B,IAVI,KAAK,MACR,KAAK,MAAQ,KAAK,IAAI,QAEvB,KAAK,YAAY0F,CAAM,EACvBA,EAAO,WAAW,KAAK,oBAAoB,EAC3CA,EAAO,WAAW,KAAK,oBAAoB,EAC3CA,EAAO,WAAW,KAAK,qBAAqB,EAC5CA,EAAO,WAAW,KAAK,kBAAkB,EACzCA,EAAO,WAAW,KAAK,mBAAsB,GAAM,EACnDA,EAAO,WAAW,KAAK,IAAI,OAAU,GAAK,EACrC1F,EAAI,EAAGA,EAAI,KAAK,IAAI,OAAQA,IAChC0F,EAAO,YAAY,KAAK,IAAI1F,CAAC,EAAE,MAAM,EACrC0F,EAAO,gBAAgB,KAAK,IAAI1F,CAAC,EAAE,IAAI,EAGxC,IADA0F,EAAO,WAAW,KAAK,IAAI,MAAM,EAC5B1F,EAAI,EAAGA,EAAI,KAAK,IAAI,OAAQA,IAChC0F,EAAO,YAAY,KAAK,IAAI1F,CAAC,EAAE,MAAM,EACrC0F,EAAO,gBAAgB,KAAK,IAAI1F,CAAC,EAAE,IAAI,EAEpC,KAAK,KACR0F,EAAO,gBAAgB,KAAK,GAAG,CAEjC,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAMJ,IALA,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,cAAc,OACnC,KAAK,YAAY0F,CAAM,EACvBA,EAAO,YAAY,KAAK,cAAc,MAAM,EACxC1F,EAAE,EAAGA,EAAE,KAAK,cAAc,OAAQA,IACrC0F,EAAO,YAAY,KAAK,cAAc1F,CAAC,CAAC,CAE1C,EAGAmG,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CAEpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EACd,KAAK,YAAYA,CAAM,EACvBA,EAAO,WAAW,KAAK,qBAAqB,EAC5CA,EAAO,WAAW,KAAK,yBAAyB,EAChDA,EAAO,WAAW,KAAK,4BAA4B,EACnDA,EAAO,WAAW,KAAK,oBAAoB,EAC3CA,EAAO,WAAW,KAAK,kBAAkB,CAC1C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAMJ,IALA,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,cAAc,OACnC,KAAK,YAAY0F,CAAM,EACvBA,EAAO,YAAY,KAAK,cAAc,MAAM,EACxC1F,EAAE,EAAGA,EAAE,KAAK,cAAc,OAAQA,IACrC0F,EAAO,YAAY,KAAK,cAAc1F,CAAC,CAAC,EACpC,KAAK,UAAY,EACpB0F,EAAO,WAAW,KAAK,eAAe1F,CAAC,CAAC,EAExC0F,EAAO,YAAY,KAAK,eAAe1F,CAAC,CAAC,CAG5C,EAGAmG,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EACZ,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,QAAQ,MAAM,EACtC,QAAS1F,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IACxC,KAAK,QAAQA,CAAC,EAAE,MAAM0F,CAAM,EAC5B,KAAK,MAAQ,KAAK,QAAQ1F,CAAC,EAAE,KAG9BzB,EAAI,MAAM,YAAa,iBAAiB,KAAK,KAAK,kBAAkB,KAAK,IAAI,EAC7EmH,EAAO,aAAa,KAAK,aAAc,KAAK,IAAI,CACjD,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,KAAK,kBAAkB,OACnC,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,iBAAiB,CAC1C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,GAAG,KAAK,QAAQ,OAC9B,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,QAAQ,MAAM,EACtC,QAAS1F,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IAAK,CAC7C,IAAIoJ,EAAQ,KAAK,QAAQpJ,CAAC,EAC1B0F,EAAO,YAAY0D,EAAM,gBAAgB,EACzC1D,EAAO,WAAW0D,EAAM,UAAU,EAClC1D,EAAO,WAAW0D,EAAM,kBAAkB,EAC1C1D,EAAO,WAAW0D,EAAM,mBAAmB,CAC7C,CACA,EAGAjD,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,aAAa,QAAQ,KAAK,cAAc,OAAO,IAAI,KAAK,MAAM,OAAO,GAC1F,KAAK,YAAYA,CAAM,EACvBA,EAAO,aAAa,KAAK,aAAa,EACtCA,EAAO,aAAa,KAAK,KAAK,EAC9BA,EAAO,YAAY,KAAK,SAAS,EACjCA,EAAO,YAAY,KAAK,uBAAuB,EAC/CA,EAAO,YAAY,KAAK,cAAc,EACtCA,EAAO,YAAY,KAAK,EAAE,EAC1BA,EAAO,gBAAgB,KAAK,YAAY,CACzC,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,KAAO,EAAE,EAAE,KAAK,kBAAkB,OACvC,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,YAAa,KAAM,CAAC,EAC5CA,EAAO,YAAY,KAAK,aAAa,EACrC,QAAS1F,EAAI,EAAGA,EAAI,KAAK,kBAAkB,OAAQA,IAClD0F,EAAO,YAAY,KAAK,kBAAkB1F,CAAC,EAAG,KAAM,CAAC,CAEvD,EAGAmG,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,KAAO,EAAE,EAAE,KAAK,KAAK,OAAO,EACjC,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,QAAS,KAAM,CAAC,EACxCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,aAAa,KAAK,IAAI,CAC9B,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACjD,IAAI1F,EAAEgC,EAGN,IAFA,KAAK,KAAO,GAEPhC,EAAI,EAAGA,EAAI,KAAK,YAAY,OAAQA,IAEvC,IADA,KAAK,MAAQ,EACRgC,EAAI,EAAGA,EAAI,KAAK,YAAYhC,CAAC,EAAE,OAAQgC,IAC1C,KAAK,MAAQ,EAAI,KAAK,YAAYhC,CAAC,EAAEgC,CAAC,EAAE,KAAK,OAwBjD,IApBA,KAAK,YAAY0D,CAAM,EAEvBA,EAAO,WAAW,KAAK,oBAAoB,EAC3CA,EAAO,YAAY,KAAK,uBAAyB,IAC9B,KAAK,mBAAqB,GAC3B,KAAK,mBAAmB,EAC1CA,EAAO,YAAY,KAAK,6BAA6B,EACrDA,EAAO,gBAAgB,KAAK,4BAA4B,EACxDA,EAAO,WAAW,KAAK,iBAAiB,EACxCA,EAAO,YAAY,KAAK,8BAAgC,IAAI,GAAG,EAC/DA,EAAO,WAAW,KAAK,gBAAmB,GAAM,EAChDA,EAAO,WAAW,KAAK,kBAAqB,GAAM,EAClDA,EAAO,WAAW,KAAK,sBAAyB,GAAM,EACtDA,EAAO,WAAW,KAAK,wBAA2B,GAAM,EACxDA,EAAO,YAAY,KAAK,YAAY,EACpCA,EAAO,YAAY,KAAK,mBAAmB,IAC3B,KAAK,mBAAmB,IACxB,KAAK,kBAAkB,GACxB,KAAK,kBAAkB,EACtCA,EAAO,WAAW,KAAK,YAAY,MAAM,EACpC1F,EAAI,EAAGA,EAAI,KAAK,YAAY,OAAQA,IAKvC,IAHA0F,EAAO,YAAY,KAAK,YAAY1F,CAAC,EAAE,cAAc,GAClC,KAAK,YAAYA,CAAC,EAAE,SAAS,EAChD0F,EAAO,YAAY,KAAK,YAAY1F,CAAC,EAAE,MAAM,EACxCgC,EAAI,EAAGA,EAAI,KAAK,YAAYhC,CAAC,EAAE,OAAQgC,IAC1C0D,EAAO,YAAY,KAAK,YAAY1F,CAAC,EAAEgC,CAAC,EAAE,KAAK,MAAM,EACrD0D,EAAO,gBAAgB,KAAK,YAAY1F,CAAC,EAAEgC,CAAC,EAAE,IAAI,CAG1D,EAEAmE,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAQ,KAAK,UAAU,OAAO,GAAI,KAAK,MAAM,OAAO,GACzD,KAAK,YAAYA,CAAM,EACvBA,EAAO,aAAa,KAAK,SAAS,EAClCA,EAAO,aAAa,KAAK,KAAK,CAC/B,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,KAAO,EAAE,EAAE,EAAE,EAClB,KAAK,MAAQ,EACb,KAAK,QAAU,EACf,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,aAAa,EACrCA,EAAO,YAAY,KAAK,iBAAiB,EACzCA,EAAO,YAAY,KAAK,SAAS,EACjCA,EAAO,YAAY,KAAK,QAAQ,EAChCA,EAAO,YAAY,KAAK,QAAQ,EAChCA,EAAO,YAAY,CAAC,CACrB,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EACZ,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,iBAAiB,CAC1C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EACZ,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,eAAe,CACxC,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,GAAG,EAAE,EAAE,EACnB,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,aAAa,EACrCA,EAAO,YAAY,KAAK,iBAAiB,EACzCA,EAAO,YAAY,KAAK,SAAS,EACjCA,EAAO,YAAY,KAAK,QAAQ,EAChCA,EAAO,YAAY,KAAK,IAAI,EAC5BA,EAAO,YAAY,KAAK,QAAQ,CAAC,EACjCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,iBAAiB,KAAK,MAAM,EACnCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,aAAa,CACtC,EAGAS,EAAU,YAAY,UAAU,YAAc,SAAST,EAAQ,CAC9D,KAAK,KAAO,EACZS,EAAU,IAAI,UAAU,YAAY,KAAK,KAAMT,CAAM,EACrDA,EAAO,WAAW,CAAC,EACnBA,EAAO,WAAW,CAAC,EACnBA,EAAO,WAAW,CAAC,EACnBA,EAAO,WAAW,CAAC,EACnBA,EAAO,WAAW,CAAC,EACnBA,EAAO,WAAW,CAAC,EACnBA,EAAO,YAAY,KAAK,oBAAoB,CAC7C,EAEAS,EAAU,YAAY,UAAU,YAAc,SAAST,EAAQ,CAC9D,QAAS1F,EAAE,EAAGA,EAAE,KAAK,MAAM,OAAQA,IAClC,KAAK,MAAMA,CAAC,EAAE,MAAM0F,CAAM,EAC1B,KAAK,MAAQ,KAAK,MAAM1F,CAAC,EAAE,KAE5BzB,EAAI,MAAM,YAAa,iBAAiB,KAAK,KAAK,kBAAkB,KAAK,IAAI,EAC7EmH,EAAO,aAAa,KAAK,aAAc,KAAK,IAAI,CACjD,EAEAS,EAAU,YAAY,UAAU,MAAQ,SAAST,EAAQ,CACxD,KAAK,YAAYA,CAAM,EACvBA,EAAO,gBAAgB,KAAK,IAAI,EAChC,KAAK,MAAQ,KAAK,KAAK,OACvBnH,EAAI,MAAM,YAAa,iBAAiB,KAAK,KAAK,kBAAkB,KAAK,IAAI,EAC7EmH,EAAO,aAAa,KAAK,aAAc,KAAK,IAAI,CACjD,EAEAS,EAAU,kBAAkB,UAAU,MAAQ,SAAST,EAAQ,CAC9D,KAAK,YAAYA,CAAM,EACvB,KAAK,MAAQ,EAAE,EAAE,EAAE,EAAE,GACrBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,KAAK,EAC7BA,EAAO,YAAY,KAAK,MAAM,EAC9BA,EAAO,YAAY,KAAK,eAAe,EACvCA,EAAO,YAAY,KAAK,cAAc,EACtCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,WAAW,EACnCA,EAAO,WAAW,KAAK,IAAI,GAAI,KAAK,eAAe,MAAM,CAAC,EAC1DA,EAAO,YAAY,KAAK,eAAgB,KAAM,EAAE,EAChDA,EAAO,YAAY,KAAK,KAAK,EAC7BA,EAAO,WAAW,EAAE,EACpB,KAAK,YAAYA,CAAM,CACxB,EAEAS,EAAU,iBAAiB,UAAU,MAAQ,SAAST,EAAQ,CAC7D,KAAK,YAAYA,CAAM,EACvB,KAAK,MAAQ,EAAE,EAAE,EAAE,EACnBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,aAAa,EACrCA,EAAO,YAAY,KAAK,UAAU,EAClCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,YAAY,EAAE,EACtC,KAAK,YAAYA,CAAM,CACxB,EAEAS,EAAU,gBAAgB,UAAU,MAAQ,SAAST,EAAQ,CAC5D,KAAK,YAAYA,CAAM,EACvB,KAAK,MAAQ,KAAK,UAAU,OAAO,EAC/B,KAAK,gBAAgB,OAAO,EAC5B,KAAK,qBAAqB,OAAO,EACrCA,EAAO,aAAa,KAAK,SAAS,EAClCA,EAAO,aAAa,KAAK,eAAe,EACxCA,EAAO,aAAa,KAAK,oBAAoB,EAC7C,KAAK,YAAYA,CAAM,CACxB,EAGAS,EAAU,iBAAiB,UAAU,MAAQ,SAAST,EAAQ,CAC7DA,EAAO,gBAAgB,KAAK,IAAI,CACjC,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,GAAG,EAAE,KAAK,QAAQ,OAC9B,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,cAAe,KAAM,CAAC,EAC9CA,EAAO,YAAY,KAAK,uBAAuB,EAC/CA,EAAO,YAAY,KAAK,QAAQ,MAAM,EACtC,QAAS1F,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IAAK,CAC7C,IAAIoJ,EAAQ,KAAK,QAAQpJ,CAAC,EAC1B0F,EAAO,WAAW0D,EAAM,YAAY,EACpC1D,EAAO,WAAW0D,EAAM,uBAAuB,CACjD,CACA,EAGAjD,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EACAoJ,EAKJ,IAFA,KAAK,MAAQ,EACb,KAAK,KAAO,GACPpJ,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IACpCoJ,EAAQ,KAAK,QAAQpJ,CAAC,EAClB,KAAK,UAAY,IAChB,KAAK,iBAAmB,IAC3B,KAAK,MAAQ,GAEd,KAAK,MAAQoJ,EAAM,KAAK,QAY1B,IATA,KAAK,YAAY1D,CAAM,EACvBA,EAAO,YAAY,KAAK,cAAe,KAAM,CAAC,EAC1C,KAAK,UAAY,GACpBA,EAAO,YAAY,KAAK,cAAc,EAEnC,KAAK,SAAW,GACnBA,EAAO,YAAY,KAAK,gCAAgC,EAEzDA,EAAO,YAAY,KAAK,QAAQ,MAAM,EACjC1F,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IACpCoJ,EAAQ,KAAK,QAAQpJ,CAAC,EAClB,KAAK,UAAY,GAChB,KAAK,iBAAmB,GAC3B0F,EAAO,YAAY0D,EAAM,kBAAkB,EAG7CA,EAAM,MAAM1D,CAAM,CAEpB,EAIAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,EAAE,EAAE,GAAG,KAAK,WAAW,OACvC,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,YAAY,EACpCA,EAAO,YAAY,KAAK,SAAS,EACjCA,EAAO,YAAY,KAAK,0BAA0B,EAClDA,EAAO,YAAY,KAAK,YAAY,EACpCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,WAAW,MAAM,EACzC,QAAS1F,EAAI,EAAGA,EAAI,KAAK,WAAW,OAAQA,IAAK,CAChD,IAAIiL,EAAM,KAAK,WAAWjL,CAAC,EAC3B0F,EAAO,YAAYuF,EAAI,gBAAkB,GAAKA,EAAI,eAAe,EACjEvF,EAAO,YAAYuF,EAAI,mBAAmB,EAC1CvF,EAAO,YAAYuF,EAAI,iBAAmB,GAAKA,EAAI,UAAY,GAAKA,EAAI,cAAc,CACxF,CACA,EAGA9E,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CAEnD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EACZ,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,OAAO,EAC/BA,EAAO,YAAY,CAAC,CACtB,EAEAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,cAAc,OACnC,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,cAAc,MAAM,EAC5CA,EAAO,iBAAiB,KAAK,aAAa,CAC3C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAMJ,IALA,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,GAAG,KAAK,YAAY,OAClC,KAAK,YAAY0F,CAAM,EACvBA,EAAO,YAAY,KAAK,YAAY,MAAM,EACtC1F,EAAE,EAAGA,EAAE,KAAK,YAAY,OAAQA,IACnC0F,EAAO,YAAY,KAAK,YAAY1F,CAAC,CAAC,EACtC0F,EAAO,YAAY,KAAK,kBAAkB1F,CAAC,CAAC,EAC5C0F,EAAO,YAAY,KAAK,yBAAyB1F,CAAC,CAAC,CAErD,EAGAmG,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAOJ,IANA,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EACZ,KAAK,YAAY0F,CAAM,EACvBA,EAAO,YAAY,KAAK,QAAQ,MAAM,EACtC,KAAK,MAAQ,EACR1F,EAAI,EAAGA,EAAI,KAAK,QAAQ,OAAQA,IACpC,KAAK,QAAQA,CAAC,EAAE,MAAM0F,CAAM,EAC5B,KAAK,MAAQ,KAAK,QAAQ1F,CAAC,EAAE,KAG9BzB,EAAI,MAAM,YAAa,iBAAiB,KAAK,KAAK,kBAAkB,KAAK,IAAI,EAC7EmH,EAAO,aAAa,KAAK,aAAc,KAAK,IAAI,CACjD,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAMJ,IALA,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,wBAAwB,OAC7C,KAAK,YAAY0F,CAAM,EACvBA,EAAO,YAAY,KAAK,wBAAwB,MAAM,EAClD1F,EAAE,EAAGA,EAAE,KAAK,wBAAwB,OAAQA,IAC/C0F,EAAO,YAAY,KAAK,wBAAwB1F,CAAC,CAAC,EAClD0F,EAAO,YAAY,KAAK,oBAAoB1F,CAAC,CAAC,CAEhD,EAGAmG,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,eAAe,OACpC,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,eAAe,MAAM,EAC7CA,EAAO,iBAAiB,KAAK,cAAc,CAC5C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EACAuN,EAAW,GAGf,GAFA,KAAK,QAAU,EACf,KAAK,MAAQ,EACT,KAAK,aAAa,OAAS,EAE9B,IADAvN,EAAI,EACGA,EAAE,EAAI,KAAK,aAAa,QAC9B,GAAI,KAAK,aAAaA,EAAE,CAAC,IAAO,KAAK,aAAa,CAAC,EAAG,CACrDuN,EAAW,GACX,KACJ,MACIvN,SAIFuN,EAAW,GAEZ,KAAK,KAAO,EACPA,IACJ,KAAK,MAAQ,EAAE,KAAK,aAAa,QAElC,KAAK,YAAY7H,CAAM,EAClB6H,EAGJ7H,EAAO,YAAY,KAAK,aAAa,CAAC,CAAC,EAFvCA,EAAO,YAAY,CAAC,EAIrBA,EAAO,YAAY,KAAK,aAAa,MAAM,EACtC6H,GACJ7H,EAAO,iBAAiB,KAAK,YAAY,CAE3C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI1F,EAMJ,IALA,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EAAE,KAAK,cAAc,OACnC,KAAK,YAAY0F,CAAM,EACvBA,EAAO,YAAY,KAAK,cAAc,MAAM,EACxC1F,EAAE,EAAGA,EAAE,KAAK,cAAc,OAAQA,IACrC0F,EAAO,YAAY,KAAK,cAAc1F,CAAC,CAAC,EACxC0F,EAAO,YAAY,KAAK,cAAc1F,CAAC,CAAC,CAE1C,EAGAmG,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,IAAI8H,EAAa,KAAK,IAAI,EAAG,EAAE,EAAI,EAEnC,KAAK,QAAU,KAAK,oBAAsBA,EAAa,EAAI,EAC3D,KAAK,MAAQ,EACb,KAAK,KAAO,EACR,KAAK,UAAY,IACpB,KAAK,MAAQ,GAEd,KAAK,YAAY9H,CAAM,EACnB,KAAK,UAAY,EACpBA,EAAO,YAAY,KAAK,mBAAmB,EAE3CA,EAAO,YAAY,KAAK,mBAAmB,CAE7C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,KAAO,EACR,KAAK,MAAQS,EAAU,6BAC1B,KAAK,MAAQ,GAEV,KAAK,MAAQA,EAAU,wBAC1B,KAAK,MAAQ,GAEV,KAAK,MAAQA,EAAU,uBAC1B,KAAK,MAAQ,GAEV,KAAK,MAAQA,EAAU,wBAC1B,KAAK,MAAQ,GAEV,KAAK,MAAQA,EAAU,yBAC1B,KAAK,MAAQ,GAEd,KAAK,YAAYT,CAAM,EACvBA,EAAO,YAAY,KAAK,QAAQ,EAC5B,KAAK,MAAQS,EAAU,4BAC1BT,EAAO,YAAY,KAAK,gBAAgB,EAErC,KAAK,MAAQS,EAAU,uBAC1BT,EAAO,YAAY,KAAK,gCAAgC,EAErD,KAAK,MAAQS,EAAU,sBAC1BT,EAAO,YAAY,KAAK,uBAAuB,EAE5C,KAAK,MAAQS,EAAU,uBAC1BT,EAAO,YAAY,KAAK,mBAAmB,EAExC,KAAK,MAAQS,EAAU,wBAC1BT,EAAO,YAAY,KAAK,oBAAoB,CAE9C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EAEf,KAAK,KAAO,EAAE,GAAG,EAAE,EACnB,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,aAAa,EACrCA,EAAO,YAAY,KAAK,iBAAiB,EACzCA,EAAO,YAAY,KAAK,QAAQ,EAChCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,KAAK,QAAQ,EAChCA,EAAO,YAAY,CAAC,EACpBA,EAAO,YAAY,CAAC,EACpBA,EAAO,WAAW,KAAK,KAAK,EAC5BA,EAAO,WAAW,KAAK,eAAe,EACtCA,EAAO,WAAW,KAAK,QAAQ,CAAC,EAChCA,EAAO,YAAY,CAAC,EACpBA,EAAO,gBAAgB,KAAK,MAAM,EAClCA,EAAO,YAAY,KAAK,KAAK,EAC7BA,EAAO,YAAY,KAAK,MAAM,CAC/B,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EAAE,EACd,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,QAAQ,EAChCA,EAAO,YAAY,KAAK,gCAAgC,EACxDA,EAAO,YAAY,KAAK,uBAAuB,EAC/CA,EAAO,YAAY,KAAK,mBAAmB,EAC3CA,EAAO,YAAY,KAAK,oBAAoB,CAC7C,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CACpD,KAAK,QAAU,EACf,KAAK,KAAO,EACR,KAAK,MAAQS,EAAU,yBAC1B,KAAK,MAAQ,GAEV,KAAK,MAAQA,EAAU,wBAC1B,KAAK,MAAQ,GAEV,KAAK,MAAQA,EAAU,sBAC1B,KAAK,MAAQ,EAAE,KAAK,gBAAgB,QAEjC,KAAK,MAAQA,EAAU,kBAC1B,KAAK,MAAQ,EAAE,KAAK,YAAY,QAE7B,KAAK,MAAQA,EAAU,mBAC1B,KAAK,MAAQ,EAAE,KAAK,aAAa,QAE9B,KAAK,MAAQA,EAAU,wBAC1B,KAAK,MAAQ,EAAE,KAAK,+BAA+B,QAEpD,KAAK,YAAYT,CAAM,EACvBA,EAAO,YAAY,KAAK,YAAY,EAChC,KAAK,MAAQS,EAAU,yBAC1B,KAAK,qBAAuBT,EAAO,YAAa,EAChDA,EAAO,WAAW,KAAK,WAAW,GAE/B,KAAK,MAAQS,EAAU,uBAC1BT,EAAO,YAAY,KAAK,kBAAkB,EAE3C,QAAS1F,EAAI,EAAGA,EAAI,KAAK,aAAcA,IAClC,KAAK,MAAQmG,EAAU,qBAC1BT,EAAO,YAAY,KAAK,gBAAgB1F,CAAC,CAAC,EAEvC,KAAK,MAAQmG,EAAU,iBAC1BT,EAAO,YAAY,KAAK,YAAY1F,CAAC,CAAC,EAEnC,KAAK,MAAQmG,EAAU,kBAC1BT,EAAO,YAAY,KAAK,aAAa1F,CAAC,CAAC,EAEpC,KAAK,MAAQmG,EAAU,wBACtB,KAAK,UAAY,EACpBT,EAAO,YAAY,KAAK,+BAA+B1F,CAAC,CAAC,EAEzD0F,EAAO,WAAW,KAAK,+BAA+B1F,CAAC,CAAC,EAI5D,EAGAmG,EAAU,SAAS,EAAE,UAAU,MAAQ,SAAST,EAAQ,CACvD,KAAK,QAAU,EACX,KAAK,UACR,KAAK,MAAQ,EACb,KAAK,KAAO,KAAK,SAAS,OAAO,IAEjC,KAAK,MAAQ,EACb,KAAK,KAAO,GAEb,KAAK,YAAYA,CAAM,EACnB,KAAK,UACRA,EAAO,aAAa,KAAK,QAAQ,CAEnC,EAGAS,EAAU,SAAS,EAAE,UAAU,MAAQ,SAAST,EAAQ,CACvD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,KAAK,KAAK,OAAO,GAAG,KAAK,SAAW,KAAK,SAAS,OAAO,EAAI,GACzE,KAAK,YAAYA,CAAM,EACvBA,EAAO,aAAa,KAAK,IAAI,EACzB,KAAK,UACRA,EAAO,aAAa,KAAK,QAAQ,CAEnC,EAGAS,EAAU,QAAQ,UAAU,MAAQ,SAAST,EAAQ,CAEpD,KAAK,QAAU,EACf,KAAK,MAAQ,EACb,KAAK,KAAO,EACZ,KAAK,YAAYA,CAAM,EACvBA,EAAO,YAAY,KAAK,YAAY,EACpCA,EAAO,iBAAiB,KAAK,OAAO,CACrC,EAOAS,EAAU,QAAQ,UAAU,OAAS,SAASsH,EAAS,CACtD,IAAIzN,EAAGgC,EAAGC,EAEV,IADAA,EAAI,EACCjC,EAAI,EAAGA,EAAI,KAAK,cAAc,OAAQA,IAC1C,IAAKgC,EAAI,EAAGA,EAAI,KAAK,cAAchC,CAAC,EAAGgC,IACtCyL,EAAQxL,CAAC,EAAE,IAAMwL,EAAQxL,CAAC,EAAE,IAAM,KAAK,eAAejC,CAAC,EACvDiC,GAGH,EAEAkE,EAAU,QAAQ,UAAU,OAAS,SAASsH,EAAS,CACtD,IAAIzN,EAAGgC,EAAGC,EAEV,IADAA,EAAI,EACCjC,EAAI,EAAGA,EAAI,KAAK,cAAc,OAAQA,IAC1C,IAAKgC,EAAI,EAAGA,EAAI,KAAK,cAAchC,CAAC,EAAGgC,IAClCC,IAAM,EACTwL,EAAQxL,CAAC,EAAE,IAAM,EAEjBwL,EAAQxL,CAAC,EAAE,IAAMwL,EAAQxL,EAAE,CAAC,EAAE,IAAM,KAAK,cAAcjC,CAAC,EAEzDiC,GAGH,EAEAkE,EAAU,QAAQ,UAAU,OAAS,SAASsH,EAAS,CACtD,IAAIzN,EACJ,IAAKA,EAAI,EAAGA,EAAI,KAAK,cAAc,OAAQA,IAC1CyN,EAAQzN,CAAC,EAAE,OAAS,KAAK,cAAcA,CAAC,CAE1C,EAEAmG,EAAU,QAAQ,UAAU,OAAS,SAASsH,EAAS,CACtD,IAAIzN,EAAGgC,EAAGC,EAAG8D,EAAG2H,EAGhB,IAFA3H,EAAI,EACJ2H,EAAI,EACC1N,EAAI,EAAGA,EAAI,KAAK,YAAY,OAAQA,IACxC,IAAKgC,EAAI,EAAGA,GAAKhC,EAAE,EAAI,KAAK,YAAY,OAAS,KAAK,YAAYA,EAAE,CAAC,EAAI,KAAWgC,IAEnF,IADA0L,IACKzL,EAAI,EAAGA,EAAI,KAAK,kBAAkBjC,CAAC,EAAGiC,IAAK,CAC/C,GAAIwL,EAAQ1H,CAAC,EACZ0H,EAAQ1H,CAAC,EAAE,kBAAoB,KAAK,yBAAyB/F,CAAC,EAC9DyN,EAAQ1H,CAAC,EAAE,YAAc2H,MAEzB,QAED3H,GACA,CAGJ,EAEAI,EAAU,QAAQ,UAAU,OAAS,SAASsH,EAAS,CACtD,IAAIzN,EACJ,IAAKA,EAAI,EAAGA,EAAI,KAAK,aAAa,OAAQA,IACzCyN,EAAQzN,CAAC,EAAE,KAAO,KAAK,aAAaA,CAAC,CAEvC,EAGAmG,EAAU,sBAAwB,CAAE,QAAS,UAAW,aAAc,aAC9D,QAAS,aAAc,UAAW,eAClC,cAAe,SAAU,YAAa,aACtC,MAAO,QAAQ,EAEvBA,EAAU,gCAAkC,CAAE,oBAAqB,SAAU,UAAW,gBAAiB,gBACzG,cAAe,oBAAqB,eAAgB,gBAAiB,iBAAkB,2BAA4B,iBAAmB,EAEtIA,EAAU,eAAiB,SAASwH,EAAOC,EAAO,CACjD,GAAID,GAAS,CAACC,EAAO,MAAO,GAC5B,IAAIzG,EACJ,IAAKA,KAAQwG,EACZ,GAAI,EAAAxH,EAAU,sBAAsB,QAAQgB,CAAI,EAAI,IAI7C,IAAIwG,EAAMxG,CAAI,YAAahB,EAAU,KAAOyH,EAAMzG,CAAI,YAAahB,EAAU,IACnF,SACM,GAAI,OAAOwH,EAAMxG,CAAI,EAAM,KAAe,OAAOyG,EAAMzG,CAAI,EAAM,IACvE,SACM,GAAI,OAAOwG,EAAMxG,CAAI,GAAM,YAAc,OAAOyG,EAAMzG,CAAI,GAAM,WACtE,SACM,GACLwG,EAAM,aAAeA,EAAM,YAAY,QAAQxG,EAAK,MAAM,EAAE,CAAC,CAAC,EAAI,IAClEyG,EAAM,aAAeA,EAAM,YAAY,QAAQzG,EAAK,MAAM,EAAE,CAAC,CAAC,EAAI,GACnE,SAEA,GAAIA,IAAS,QAAUA,IAAS,SAAWA,IAAS,QAAUA,IAAS,iBAAmBA,IAAS,oBAClG,SACM,GAAIhB,EAAU,gCAAgC,QAAQgB,CAAI,EAAI,GACpE,SAEA,GAAIwG,EAAMxG,CAAI,IAAMyG,EAAMzG,CAAI,EAC7B,MAAO,GAKX,MAAO,EACR,EAEAhB,EAAU,SAAW,SAASwH,EAAOC,EAAO,CAC3C,GAAI,CAACzH,EAAU,eAAewH,EAAOC,CAAK,EACzC,MAAO,GAER,QAAS5L,EAAI,EAAGA,EAAImE,EAAU,sBAAsB,OAAQnE,IAAK,CAChE,IAAI0E,EAAOP,EAAU,sBAAsBnE,CAAC,EAC5C,GAAI2L,EAAMjH,CAAI,GAAKkH,EAAMlH,CAAI,GACxB,CAACP,EAAU,SAASwH,EAAMjH,CAAI,EAAGkH,EAAMlH,CAAI,CAAC,EAC/C,MAAO,EAGX,CACC,MAAO,EACR,EAMA,IAAImH,EAAe,UAAW,CAC9B,EAEAA,EAAa,UAAU,YAAc,SAASC,EAAM,CACnD,IAAIC,EAAMC,EACNtI,EAAS,IAAIxF,EAAa4N,EAAK,MAAM,EAEzC,IADAC,EAAO,CAAE,EACF,CAACrI,EAAO,SACdsI,EAAM7H,EAAU,YAAYT,EAAQ,EAAK,EACrCsI,EAAI,OAAS7H,EAAU,IAAM6H,EAAI,IAAI,OAAS,QACjDD,EAAK,KAAKC,EAAI,GAAG,EAGnB,OAAOD,CACR,EAEAF,EAAa,UAAU,QAAU,SAAUI,EAAWC,EAASJ,EAAM,CACpE,SAASzO,EAAI8O,EAAGC,EAAOC,EAAG,CACxB,OAAAA,EAAIA,GAAK,IACTF,EAAIA,EAAI,GACDA,EAAE,QAAUC,EAAQD,EAAI,IAAI,MAAMC,EAAQD,EAAE,OAAS,CAAC,EAAE,KAAKE,CAAC,EAAIF,CAC5E,CACC,SAASG,EAAeC,EAAO,CAC9B,IAAIrL,EAAI,KAAK,MAAMqL,EAAM,IAAI,EACzBb,EAAI,KAAK,OAAOa,EAAQrL,EAAE,MAAM,EAAE,EAClCzC,EAAI,KAAK,MAAM8N,EAAQrL,EAAE,KAAOwK,EAAE,EAAE,EACpCc,EAAK,KAAK,OAAOD,EAAQrL,EAAE,KAAOwK,EAAE,GAAKjN,GAAG,GAAI,EACpD,MAAO,GAAGpB,EAAI6D,EAAG,CAAC,EAAE,IAAI7D,EAAIqO,EAAE,CAAC,EAAE,IAAIrO,EAAIoB,EAAG,CAAC,EAAE,IAAIpB,EAAImP,EAAI,CAAC,CAC9D,CAGC,QAFIT,EAAO,KAAK,YAAYD,CAAI,EAC5BW,EAAS,GACJzO,EAAI,EAAGA,EAAI+N,EAAK,OAAQ/N,IAAK,CACrC,IAAI0O,EAASX,EAAK/N,CAAC,EACnByO,GAAUH,EAAeL,CAAS,EAAE,QAAQK,EAAeJ,CAAO,EAAE;AAAA,EACpEO,GAAUC,EAAO,KAAK,IACxB,CACC,OAAOD,CACR,EAEA,IAAIE,EAAuB,UAAW,CACtC,EAEAA,EAAqB,UAAU,YAAc,SAASC,EAAQ,CAC7D,IAAIpO,EAAM,CAAA,EACNR,EACJQ,EAAI,UAAY,CAAE,EAClB,IAAIkF,EAAS,IAAIxF,EAAa0O,EAAO,KAAK,MAAM,EAChD,GAAI,CAACA,EAAO,YAAcA,EAAO,WAAW,SAAW,EACtDpO,EAAI,eAAiBkF,EAAO,WAAWkJ,EAAO,KAAK,MAAM,UAEzDpO,EAAI,eAAiBkF,EAAO,WAAWkJ,EAAO,WAAW,CAAC,EAAE,IAAI,EAC5DA,EAAO,WAAW,OAAS,EAC9B,IAAK5O,EAAI,EAAGA,EAAI4O,EAAO,WAAW,OAAQ5O,IACzCQ,EAAI,UAAUR,CAAC,EAAI0F,EAAO,eAAekJ,EAAO,WAAW5O,CAAC,EAAE,IAAI,EAIrE,OAAI,OAAQ,UAAe,MAC1BQ,EAAI,SAAY,IAAI,UAAS,EAAI,gBAAgBA,EAAI,eAAgB,iBAAiB,GAEhFA,CACR,EAEA,IAAIqO,EAAgB,UAAW,CAC/B,EAEAA,EAAc,UAAU,YAAc,SAASD,EAAQ,CACtD,IAAIE,EACApJ,EAAS,IAAIxF,EAAa0O,EAAO,KAAK,MAAM,EAChD,OAAAE,EAAapJ,EAAO,WAAWkJ,EAAO,KAAK,MAAM,EAC1CE,CACR,EAEAD,EAAc,UAAU,YAAc,SAASf,EAAM,CACpD,IAAIgB,EACApJ,EAAS,IAAIxF,EAAa4N,EAAK,MAAM,EACzC,OAAApI,EAAO,WAAU,EACjBoJ,EAAapJ,EAAO,YAAa,EAC1BoJ,CACR,EAGC7O,eAAuB4N,EACvB5N,uBAA+B0O,EAC/B1O,gBAAwB4O,EAOzB,IAAIE,EAAU,SAAUrJ,EAAQ,CAE/B,KAAK,OAASA,GAAU,IAAIrC,EAE5B,KAAK,MAAQ,CAAE,EAEf,KAAK,MAAQ,CAAE,EAEf,KAAK,MAAQ,CAAE,EAEf,KAAK,cAAgB,GAErB,KAAK,eAAiB,GAEtB,KAAK,YAAc,KAEnB,KAAK,cAAgB,GAErB,KAAK,QAAU,KAEf,KAAK,UAAY,GAEjB,KAAK,UAAY,KAEjB,KAAK,UAAY,KAEjB,KAAK,QAAU,KAEf,KAAK,gBAAkB,GAEvB,KAAK,iBAAmB,CAAE,EAE1B,KAAK,gBAAkB,CAAE,EAEzB,KAAK,2BAA6B,GAElC,KAAK,wBAA0B,GAE/B,KAAK,eAAiB,EAEtB,KAAK,cAAgB,GAErB,KAAK,MAAQ,CAAE,EAEf,KAAK,cAAgB,CAAE,EAEvB,KAAK,OAAS,KAEd,KAAK,SAAW,EACjB,EAEA0L,EAAQ,UAAU,kBAAoB,SAASC,EAAIC,EAAMC,EAAS,CACjE,IAAIC,EAAO,KAAK,aAAaH,CAAE,EAC/B,GAAIG,EAAM,CACT,IAAIC,EAAY,CAAE,EAClB,KAAK,iBAAiB,KAAKA,CAAS,EACpCA,EAAU,GAAKJ,EACfI,EAAU,KAAOH,EACjBG,EAAU,KAAOD,EACjBA,EAAK,WAAa,EAClBC,EAAU,cAAgB,KAC1BA,EAAU,WAAa,IACvBA,EAAU,cAAgB,GACtBF,IACCA,EAAQ,YAAWE,EAAU,WAAaF,EAAQ,WAClDA,EAAQ,gBAAeE,EAAU,cAAgBF,EAAQ,eAEhE,CACA,EAEAH,EAAQ,UAAU,oBAAsB,SAASC,EAAI,CAEpD,QADIpK,EAAQ,GACH5E,EAAI,EAAGA,EAAI,KAAK,iBAAiB,OAAQA,IAAK,CACtD,IAAIoP,EAAY,KAAK,iBAAiBpP,CAAC,EACnCoP,EAAU,IAAMJ,IACnBpK,EAAQ5E,EAEX,CACK4E,EAAQ,IACX,KAAK,iBAAiB,OAAOA,EAAO,CAAC,CAEvC,EAEAmK,EAAQ,UAAU,qBAAuB,SAASC,EAAIC,EAAMC,EAAS,CACpE,IAAIC,EAAO,KAAK,aAAaH,CAAE,EAC/B,GAAIG,EAAM,CACT,IAAIE,EAAe,CAAE,EACrB,KAAK,gBAAgB,KAAKA,CAAY,EACtCA,EAAa,GAAKL,EAClBK,EAAa,KAAOJ,EACpBI,EAAa,KAAOF,EACpBA,EAAK,WAAa,EAClBE,EAAa,WAAa,IAC1BA,EAAa,QAAU,CAAE,EACrBH,GACCA,EAAQ,YAAWG,EAAa,WAAaH,EAAQ,UAE5D,CACA,EAEAH,EAAQ,UAAU,uBAAyB,SAASC,EAAI,CAEvD,QADIpK,EAAQ,GACH5E,EAAI,EAAGA,EAAI,KAAK,gBAAgB,OAAQA,IAAK,CACrD,IAAIqP,EAAe,KAAK,gBAAgBrP,CAAC,EACrCqP,EAAa,IAAML,IACtBpK,EAAQ5E,EAEX,CACK4E,EAAQ,IACX,KAAK,gBAAgB,OAAOA,EAAO,CAAC,CAEtC,EAEAmK,EAAQ,UAAU,MAAQ,UAAW,CAEpC,IAAIpH,EACAvB,EACAkJ,EAAsB,GAE1B,GAAI,OAAK,sBACJ,CAAC,KAAK,wBAKX,OAEC,GAAI,KAAK,mBAAqB,KAAK,kBAAiB,EAAI,CACvD,GAAI,KAAK,wBACR,SAEA,MAEJ,SACO,KAAK,mBACR,KAAK,kBAAmB,EAEzB3H,EAAMxB,EAAU,YAAY,KAAK,OAAQmJ,CAAmB,EACxD3H,EAAI,OAASxB,EAAU,oBAC1B,GAAI,KAAK,qBAAsB,CAC9B,GAAI,KAAK,qBAAqBwB,CAAG,EAChC,SAEA,MAEN,KACK,YAEK,CACN,IAAID,EAOJ,OALAtB,EAAMuB,EAAI,IACVD,EAAYtB,EAAI,OAAS,OAASA,EAAI,KAAOA,EAAI,KAEjD,KAAK,MAAM,KAAKA,CAAG,EAEXsB,EAAQ,CACf,IAAK,OACJ,KAAK,MAAM,KAAKtB,CAAG,EACnB,MACD,IAAK,OACJ,KAAK,MAAM,KAAKA,CAAG,EACnB,MACD,IAAK,OACJ,KAAK,eAAiB,GAClB,KAAK,MAAM,SAAW,IACzB,KAAK,cAAgB,IAIvB,QACK,KAAKsB,CAAQ,IAAM,QACtBnJ,EAAI,KAAK,UAAW,0BAA0BmJ,EAAS,kCAAkC,EAE1F,KAAKA,CAAQ,EAAItB,EACjB,KACN,CACQ,KAAK,iBACR,KAAK,gBAAgBA,EAAKuB,CAAG,CAElC,CAGA,EAEAoH,EAAQ,UAAU,YAAc,SAAUnL,EAAI,CAC7C,GAAIA,GAAO,KACV,KAAM,uCAEP,GAAIA,EAAG,YAAc,OACpB,KAAM,wCAEP,OAAIA,EAAG,aAAe,GACrBrF,EAAI,KAAK,UAAW,qCAAqCqF,EAAG,UAAU,GAAG,EACzE,KAAK,OAAO,eAAgB,EACrB,KAERrF,EAAI,KAAK,UAAW,iCAAiCqF,EAAG,UAAU,GAAG,EAGrEA,EAAG,UAAY,EACf,KAAK,OAAO,aAAaA,CAAE,EAC3B,KAAK,OAAO,eAAgB,EAEvB,KAAK,OAAO,cAIV,IAHNrF,EAAI,KAAK,UAAW,4BAA4B,EACzC,IAGT,EAIAwQ,EAAQ,UAAU,aAAe,SAASnL,EAAI2L,EAAM,CACnD,IAAIC,EACJ,GAAK,KAAK,YAAY5L,CAAE,EAKxB,YAAK,MAAO,EAGR,KAAK,gBAAkB,CAAC,KAAK,gBAChC,KAAK,cAAgB,GACjB,KAAK,aAAa,KAAK,YAAa,GAGrC,KAAK,MAIH,KAAK,kBACT,KAAK,iBAAkB,EACvB,KAAK,gBAAkB,IAIxB,KAAK,kBAAmB,EAIpB,KAAK,SAAW,CAAC,KAAK,YACzB,KAAK,UAAY,GACjB,KAAK,QAAQ,KAAK,SAAS,GAI5B,KAAK,eAAe2L,CAAI,EAGpB,KAAK,kBACRC,EAAgB,KAAK,iBACrB,KAAK,iBAAmB,QAExBA,EAAgB,KAAK,kBAElB,KAAK,OAAO,0BACfA,EAAgB,KAAK,OAAO,wBAAwBA,CAAa,IAG9D,KAAK,kBAGRA,EAAgB,KAAK,kBAGrBA,EAAgB,EAGd,KAAK,MACJ,KAAK,QAAU,CAAC,KAAK,WACxB,KAAK,OAAO,KAAK,IAAI,EACrB,KAAK,SAAW,IAGd,KAAK,OACJ,KAAK,iBAAmB,CAAC,KAAK,gBACjC,KAAK,gBAAiB,EACtB,KAAK,cAAgB,IAElB,KAAK,cACR,KAAK,aAAa,KAAK,MAAM,GAI3B,KAAK,OAAO,eACfjR,EAAI,KAAK,UAAW,sCAAsCqF,EAAG,UAAU,gEAAgE4L,CAAa,EACpJ,KAAK,OAAO,eAAgB,EAC5B,KAAK,OAAO,aAAc,EAC1B,KAAK,OAAO,eAAe,EAAI,EAC/BjR,EAAI,KAAK,UAAW,+BAA+B,KAAK,2BAA0B,CAAE,GAE9EiR,CACR,EAEAT,EAAQ,UAAU,QAAU,UAAW,CACtC,IAAI/O,EAAGgC,EACHyN,EAAQ,CAAE,EACVN,EACAO,EACAzE,EACA0E,EACAC,EAAS,IAAI,KAAK,sBAAsB,EAAE,QAAO,EAErD,GAAI,KAAK,KAsBR,IArBAH,EAAM,QAAU,GAChBA,EAAM,SAAW,KAAK,KAAK,KAAK,SAChCA,EAAM,UAAY,KAAK,KAAK,KAAK,UACjCA,EAAM,aAAgB,KAAK,KAAK,MAAQ,KACpCA,EAAM,cAAgB,KAAK,KAAK,KAAK,OACxCA,EAAM,kBAAoB,KAAK,KAAK,KAAK,KAAK,mBAE/CA,EAAM,cAAgB,KAAK,cAC3BA,EAAM,OAAU,KAAK,KAAK,MAAQ,KAClCA,EAAM,OAAS,CAAE,EACjBA,EAAM,OAAO,KAAK,KAAK,KAAK,WAAW,EACvCA,EAAM,OAASA,EAAM,OAAO,OAAO,KAAK,KAAK,iBAAiB,EAC9DA,EAAM,QAAU,IAAI,KAAKG,EAAM,KAAK,KAAK,KAAK,cAAc,GAAI,EAChEH,EAAM,SAAW,IAAI,KAAKG,EAAM,KAAK,KAAK,KAAK,kBAAkB,GAAI,EACrEH,EAAM,OAAS,CAAE,EACjBA,EAAM,YAAc,CAAE,EACtBA,EAAM,YAAc,CAAE,EACtBA,EAAM,eAAiB,CAAE,EACzBA,EAAM,eAAiB,CAAE,EACzBA,EAAM,WAAa,CAAE,EACrBA,EAAM,YAAc,CAAE,EACjBzP,EAAI,EAAGA,EAAI,KAAK,KAAK,MAAM,OAAQA,IAAK,CAQ5C,GAPAmP,EAAO,KAAK,KAAK,MAAMnP,CAAC,EACxB2P,EAAcR,EAAK,KAAK,KAAK,KAAK,KAAK,QAAQ,CAAC,EAChDO,EAAQ,CAAE,EACVD,EAAM,OAAO,KAAKC,CAAK,EACvBA,EAAM,GAAKP,EAAK,KAAK,SACrBO,EAAM,KAAOP,EAAK,KAAK,KAAK,KAC5BO,EAAM,WAAa,CAAE,EACjBP,EAAK,KACR,IAAKnN,EAAI,EAAGA,EAAImN,EAAK,KAAK,MAAM,OAAQnN,IACvCiJ,EAAM,CAAE,EACRyE,EAAM,WAAW,KAAKzE,CAAG,EACzBA,EAAI,KAAOkE,EAAK,KAAK,MAAMnN,CAAC,EAAE,KAC9BiJ,EAAI,UAAYkE,EAAK,KAAK,MAAMnN,CAAC,EAAE,UAGjCmN,EAAK,OACRO,EAAM,MAAQP,EAAK,KAAK,KAAK,SAE9BO,EAAM,QAAU,IAAI,KAAKE,EAAMT,EAAK,KAAK,cAAc,GAAI,EAC3DO,EAAM,SAAW,IAAI,KAAKE,EAAMT,EAAK,KAAK,kBAAkB,GAAI,EAChEO,EAAM,eAAiBP,EAAK,KAAK,SACjCO,EAAM,gBAAkBD,EAAM,UAC9BC,EAAM,MAAQP,EAAK,KAAK,MACxBO,EAAM,gBAAkBP,EAAK,KAAK,gBAClCO,EAAM,OAASP,EAAK,KAAK,OACzBO,EAAM,OAASP,EAAK,KAAK,OACzBO,EAAM,YAAcP,EAAK,KAAK,MAAO,MACrCO,EAAM,aAAeP,EAAK,KAAK,OAAQ,MACvCO,EAAM,UAAYP,EAAK,KAAK,KAAK,UACjCO,EAAM,UAAYP,EAAK,KAAK,KAAK,KAAK,KACtCO,EAAM,SAAWP,EAAK,KAAK,KAAK,SAChCO,EAAM,iBAAmBP,EAAK,iBAC9BO,EAAM,MAAQC,EAAY,SAAU,EACpCD,EAAM,KAAQP,EAAK,MAAQA,EAAK,KAAK,MAAM,OAASA,EAAK,KAAK,MAAM,CAAC,EAAI,CAAE,UAAW,GAAI,MAAO,EAAE,EACnGO,EAAM,SAAYP,EAAK,KAAK,KAAOA,EAAK,KAAK,KAAK,kBAAoBA,EAAK,KAAK,KAAK,eACrFO,EAAM,WAAaP,EAAK,QAAQ,OAChCO,EAAM,KAAOP,EAAK,aAClBO,EAAM,QAAWA,EAAM,KAAK,EAAEA,EAAM,UAAWA,EAAM,iBACjDC,EAAY,WACfD,EAAM,KAAO,QACbD,EAAM,YAAY,KAAKC,CAAK,EAC5BA,EAAM,MAAQ,CAAE,EAChBA,EAAM,MAAM,YAAcC,EAAY,cAAe,EACrDD,EAAM,MAAM,cAAgBC,EAAY,gBAAiB,EACzDD,EAAM,MAAM,YAAcC,EAAY,cAAe,GAC3CA,EAAY,WACtBD,EAAM,KAAO,QACbD,EAAM,YAAY,KAAKC,CAAK,EAC5BA,EAAM,MAAQ,CAAE,EAChBA,EAAM,MAAM,MAAQC,EAAY,SAAU,EAC1CD,EAAM,MAAM,OAASC,EAAY,UAAW,GAClCA,EAAY,cACtBD,EAAM,KAAO,YACbD,EAAM,eAAe,KAAKC,CAAK,GACrBC,EAAY,UACtBD,EAAM,KAAO,WACbD,EAAM,WAAW,KAAKC,CAAK,GACjBC,EAAY,cACtBD,EAAM,KAAO,WACbD,EAAM,eAAe,KAAKC,CAAK,IAE/BA,EAAM,KAAO,WACbD,EAAM,YAAY,KAAKC,CAAK,EAEhC,MAEED,EAAM,QAAU,GAGjB,GADAA,EAAM,KAAO,GACTA,EAAM,SAAWA,EAAM,OAAQ,CAQlC,IAPIA,EAAM,aAAeA,EAAM,YAAY,OAAS,EACnDA,EAAM,MAAQ,sBACJA,EAAM,aAAeA,EAAM,YAAY,OAAS,EAC1DA,EAAM,MAAQ,sBAEdA,EAAM,MAAQ,4BAEVzP,EAAI,EAAGA,EAAIyP,EAAM,OAAO,OAAQzP,IAChCA,IAAM,IAAGyP,EAAM,MAAQ,KAC3BA,EAAM,MAAOA,EAAM,OAAOzP,CAAC,EAAE,MAE9ByP,EAAM,MAAQ,gBACdA,EAAM,MAAQ,KAAK,KAAK,kBAAkB,KAAM,EAChDA,EAAM,MAAQ,GAChB,CACC,OAAOA,CACR,EAEAV,EAAQ,UAAU,8BAAgC,SAAUH,EAAQ,CAC9DA,IAGD,KAAK,iBACR,KAAK,iBAAmB,KAAK,IAAIA,EAAO,OAAOA,EAAO,YAAY,KAAK,gBAAgB,EAEvF,KAAK,iBAAmBA,EAAO,OAAOA,EAAO,YAE/C,EAEAG,EAAQ,UAAU,eAAiB,SAASQ,EAAM,CACjD,IAAIvP,EACAmP,EACJ,GAAK,KAAK,wBAKV,IAAI,KAAK,4BAA8B,KAAK,YAAc,KACzD,IAAKnP,EAAI,EAAGA,EAAI,KAAK,iBAAiB,OAAQA,IAAK,CAClD,IAAI6P,EAAW,KAAK,iBAAiB7P,CAAC,EAEtC,IADAmP,EAAOU,EAAS,KACTV,EAAK,WAAaA,EAAK,QAAQ,QAAU,KAAK,yBAAyB,CAG7E5Q,EAAI,MAAM,UAAW,qCAAqCsR,EAAS,GAAI,eAAeV,EAAK,UAAU,EACrG,IAAIW,EAAS,KAAK,eAAeD,EAAS,GAAIV,EAAK,WAAYU,EAAS,aAAa,EACrF,GAAIC,EACHD,EAAS,cAAgBC,EACzBX,EAAK,iBAGL,OAID,IAAIA,EAAK,WAAaU,EAAS,aAAe,GAAMN,GAAQJ,EAAK,YAAcA,EAAK,QAAQ,UAC3F5Q,EAAI,KAAK,UAAW,qCAAqCsR,EAAS,GAAG,iBAAiB,KAAK,IAAI,EAAEV,EAAK,WAAWU,EAAS,UAAU,EAAE,KAAKV,EAAK,WAAW,GAAG,GAAG,EACjK5Q,EAAI,KAAK,UAAW,+BAA+B,KAAK,2BAA0B,CAAE,EAChF,KAAK,WACR,KAAK,UAAUsR,EAAS,GAAIA,EAAS,KAAMA,EAAS,cAAc,OAAQV,EAAK,WAAaI,GAAQJ,EAAK,YAAcA,EAAK,QAAQ,MAAQ,EAG7IU,EAAS,cAAgB,KACrBA,IAAa,KAAK,iBAAiB7P,CAAC,GAEvC,KAGN,CACA,CAGC,GAAI,KAAK,YAAc,KAGtB,IAAKA,EAAI,EAAGA,EAAI,KAAK,gBAAgB,OAAQA,IAAK,CACjD,IAAI+P,EAAc,KAAK,gBAAgB/P,CAAC,EAExC,IADAmP,EAAOY,EAAY,KACZZ,EAAK,WAAaA,EAAK,QAAQ,QAAU,KAAK,yBAAyB,CAC7E5Q,EAAI,MAAM,UAAW,uBAAuBwR,EAAY,GAAI,YAAYZ,EAAK,UAAU,EACvF,IAAIP,EAAS,KAAK,UAAUO,EAAMA,EAAK,UAAU,EACjD,GAAIP,EACHO,EAAK,aACLY,EAAY,QAAQ,KAAKnB,CAAM,MACzB,CACN,KAAK,8BAA8BO,EAAK,QAAQA,EAAK,UAAU,CAAC,EAChE,KACL,CACI,IAAIA,EAAK,WAAaY,EAAY,aAAe,GAAKZ,EAAK,YAAcA,EAAK,QAAQ,UACrF5Q,EAAI,MAAM,UAAW,6BAA6BwR,EAAY,GAAG,eAAeZ,EAAK,UAAU,EAC3F,KAAK,WACR,KAAK,UAAUY,EAAY,GAAIA,EAAY,KAAMA,EAAY,OAAO,EAErEA,EAAY,QAAU,CAAE,EACpBA,IAAgB,KAAK,gBAAgB/P,CAAC,GAEzC,KAGN,CACA,EAEA,EAGA+O,EAAQ,UAAU,OAAS,SAAStI,EAAM,CACxC,IAAIqJ,EAAS,KAAK,SAASrJ,EAAM,EAAI,EACrC,OAAQqJ,EAAO,OAASA,EAAO,CAAC,EAAI,IACtC,EAEAf,EAAQ,UAAU,SAAW,SAAStI,EAAMuJ,EAAa,CACvD,IAAIF,EAAS,CAAE,EACf,OAAAf,EAAQ,OAAO,KAAK,KAAMtI,EAAMqJ,EAAQE,CAAW,EAC5CF,CACT,EAEAf,EAAQ,OAAS,SAAStI,EAAMqJ,EAAQE,EAAa,CAC/C,KAAK,MAAQ,KAAK,MAAQvJ,GAAMqJ,EAAO,KAAK,IAAI,EACpD,QAAS1J,KAAO,KAAK,MAAO,CAC1B,GAAI0J,EAAO,QAAUE,EAAa,OAClCjB,EAAQ,OAAO,KAAK,KAAK,MAAM3I,CAAG,EAAGK,EAAMqJ,EAAQE,CAAW,CAClE,CACA,EAEAjB,EAAQ,UAAU,oBAAsB,SAASkB,EAAU,CAC1D,IAAIP,EAAQ,KAAK,aAAaO,CAAQ,EACtC,GAAIP,EACH,OAAOA,EAAM,OAIf,EAEAX,EAAQ,UAAU,eAAiB,SAASkB,EAAU3Q,EAAQ,CAC7D,IAAIoQ,EAAQ,KAAK,aAAaO,CAAQ,EAClCrB,EAAS,KAAK,UAAUc,EAAOpQ,CAAM,EACzC,OAAOsP,CACR,EAGAG,EAAQ,UAAU,mBAAqB,SAAUC,EAAIkB,EAAW,CAC/D,IAAI5P,EAAO,EACP6O,EAAO,KAAK,aAAaH,CAAE,EAC1BG,EAAK,kBAAiBA,EAAK,gBAAkB,GAClD,QAASnP,EAAImP,EAAK,gBAAiBnP,EAAIkQ,EAAWlQ,IACjDM,GAAM,KAAK,cAAc6O,EAAMnP,CAAC,EAEjCzB,EAAI,KAAK,UAAW,UAAUyQ,EAAG,2BAA2BkB,EAAU,oBAAoB5P,EAAK,gBAAgB,KAAK,gBAAgB,GAAG,EACvI6O,EAAK,gBAAkBe,CACxB,EAEAnB,EAAQ,UAAU,MAAQ,UAAW,CACpC,KAAK,wBAA0B,GAC/B,KAAK,eAAe,EAAK,CAC1B,EAEAA,EAAQ,UAAU,KAAO,UAAW,CACnC,KAAK,wBAA0B,EAChC,EAGAA,EAAQ,UAAU,MAAQ,UAAW,CACpCxQ,EAAI,KAAK,UAAW,4BAA4B,EAChD,KAAK,kBAAmB,EACxB,KAAK,eAAe,EAAI,EACxB,KAAK,OAAO,aAAc,EAC1B,KAAK,OAAO,eAAe,EAAI,CAChC,EAIAwQ,EAAQ,UAAU,UAAY,SAASoB,EAAMC,EAAQjB,EAAM,CAC1D,IAAInN,EACA4M,EACAyB,EAAc,IACdC,EAAsB,EACtBC,EAAkB,EAClB7Q,EAEJ,GAAIyP,EAAK,QAAQ,SAAW,EAC3B,OAAA5Q,EAAI,KAAK,UAAW,+CAA+CA,EAAI,kBAAkB,EAAG,CAAC,EAAG,gBAAiB,EAC1G,CAAE,OAAQ,EAAG,KAAM,CAAG,EAG9B,IAAKyD,EAAI,EAAGA,EAAImN,EAAK,QAAQ,OAAQnN,IAAK,CAEzC,GADA4M,EAASO,EAAK,QAAQnN,CAAC,EACnBA,IAAM,EACTuO,EAAkB,EAClB7Q,EAAYkP,EAAO,kBACTA,EAAO,IAAMuB,EAAOvB,EAAO,UAAW,CAChD2B,EAAkBvO,EAAE,EACpB,KACH,CACMoO,GAAUxB,EAAO,UACpB0B,EAAsBtO,EAEzB,CAMC,IALIoO,IACHG,EAAkBD,GAEnBH,EAAOhB,EAAK,QAAQoB,CAAe,EAAE,IACrCpB,EAAK,WAAaoB,EACXpB,EAAK,QAAQoB,CAAe,EAAE,cAAgBpB,EAAK,QAAQoB,CAAe,EAAE,MAE7EpB,EAAK,QAAQoB,EAAkB,CAAC,GAGrCA,IAED,OAAAF,EAAclB,EAAK,QAAQoB,CAAe,EAAE,OAAOpB,EAAK,QAAQoB,CAAe,EAAE,YACjFhS,EAAI,KAAK,UAAW,eAAe6R,EAAS,MAAO,IAAI,YAAYjB,EAAK,WAAW,aAAaA,EAAK,KAAK,SAAS,UAAU5Q,EAAI,kBAAkB4R,EAAMzQ,CAAS,EAAG,gBAAgB2Q,CAAW,EACzL,CAAE,OAAQA,EAAa,KAAMF,EAAKzQ,CAAW,CACrD,EAEAqP,EAAQ,UAAU,iBAAmB,SAAUI,EAAM,CACpD,IAAIP,EAEJ,OAAKO,EAAK,SAGVP,EAASO,EAAK,QAAQA,EAAK,QAAQ,OAAS,CAAC,GACrCP,EAAO,IAAMA,EAAO,UAAYA,EAAO,WAHvC,GAIT,EAGAG,EAAQ,UAAU,KAAO,SAASoB,EAAMC,EAAQ,CAC/C,IAAII,EAAO,KAAK,KACZrB,EACAsB,EACAzQ,EACA0Q,EAAY,CAAE,OAAQ,IAAU,KAAM,GAAU,EACpD,GAAK,KAAK,KAEH,CACN,IAAK1Q,EAAI,EAAGA,EAAEwQ,EAAK,MAAM,OAAQxQ,IAChCmP,EAAOqB,EAAK,MAAMxQ,CAAC,EACf,EAAAmQ,EAAO,KAAK,iBAAiBhB,CAAI,KAGrCsB,EAAiB,KAAK,UAAUN,EAAMC,EAAQjB,CAAI,EAC9CsB,EAAe,OAASC,EAAU,SACrCA,EAAU,OAASD,EAAe,QAE/BA,EAAe,KAAOC,EAAU,OACnCA,EAAU,KAAOD,EAAe,OAGlC,OAAAlS,EAAI,KAAK,UAAW,mBAAmBA,EAAI,kBAAkBmS,EAAU,KAAM,CAAC,EAAE,gDAAgDA,EAAU,MAAM,EAC5IA,EAAU,SAAW,IAExBA,EAAY,CAAE,OAAQ,KAAK,kBAAmB,KAAM,CAAG,EAKvDA,EAAU,OAAS,KAAK,OAAO,wBAAwBA,EAAU,MAAM,EAExEnS,EAAI,KAAK,UAAW,mEAAmEmS,EAAU,MAAM,EAChGA,CACT,KA3BE,MAAM,iCA4BR,EAEA3B,EAAQ,UAAU,MAAQ,SAASpO,EAAG,CAErC,QADIgQ,EAAY,EACTA,EAAY,KAAK,MAAM,QAAUA,EAAYhQ,EAAE,MAAM,QAAQ,CACnE,IAAIiQ,EAAQ,KAAK,MAAMD,CAAS,EAC5BE,EAAQlQ,EAAE,MAAMgQ,CAAS,EAC7B,GAAI,CAACxK,EAAU,SAASyK,EAAOC,CAAK,EACnC,MAAO,GAERF,GACF,CACC,MAAO,EACR,EAGC1Q,UAAkB8O,EAInBA,EAAQ,UAAU,qBAAuB,EAEzCA,EAAQ,UAAU,YAAc,KAMhCA,EAAQ,UAAU,kBAAoB,EAEtCA,EAAQ,UAAU,gBAAkB,GAEpCA,EAAQ,UAAU,qBAAuB,SAASpH,EAAK,CACtD,IAAIvB,EACA0K,EACAC,EAGJ,OAAIpJ,EAAI,OAAS,QAKhBvB,EAAM,IAAID,EAAUwB,EAAI,KAAK,KAAK,EAAEA,EAAI,IAAI,EAC5C,KAAK,YAAcvB,EACnB,KAAK,MAAM,KAAKA,CAAG,EACnB,KAAK,MAAM,KAAKA,CAAG,EACnBA,EAAI,MAAQuB,EAAI,MAChBvB,EAAI,SAAWuB,EAAI,SACnB,KAAK,OAAO,aAAavB,EAAI,QAAQ,EAGrC,KAAK,qBAAuBA,EAAI,MAAQA,EAAI,KAE5C2K,EAAQ,KAAK,OAAO,KAAK3K,EAAI,MAAQA,EAAI,KAAM,GAAO,KAAK,eAAe,EACtE2K,GAEH,KAAK,YAAc,KAEZ,KAIF,KAAK,eAQT,KAAK,kBAAoB,KAAK,OAAO,qBAAsB,EAJ3D,KAAK,kBAAoB3K,EAAI,MAAQA,EAAI,KAOnC,MAIJuB,EAAI,OAAS,SAEhB,KAAK,eAAiB,GAClB,KAAK,MAAM,SAAW,IACzB,KAAK,cAAgB,KAOvBmJ,EAAU,KAAK,OAAO,gBAAkB,KAAK,OAAO,gBAAiB,EAAG,GACpEA,GAIH,KAAK,kBAAoB,KAAK,OAAO,eAAgB,EAC9C,KAIFnJ,EAAI,KAQJ,KAAK,eACR,KAAK,kBAAoB,KAAK,OAAO,eAAgB,EAErD,KAAK,kBAAoB,KAAK,OAAO,YAAW,EAAKA,EAAI,KAR1D,KAAK,kBAAoB,KAAK,OAAO,eAAgB,EAW/C,IAGV,EAEAoH,EAAQ,UAAU,kBAAoB,UAAY,CACjD,OAAQ,KAAK,cAAgB,IAC9B,EAEAA,EAAQ,UAAU,sBAAwB,UAAY,CACrD,IAAI3I,EACA2K,EAMJ,OAHA3K,EAAM,KAAK,YAEX2K,EAAQ,KAAK,OAAO,KAAK3K,EAAI,MAAQA,EAAI,KAAM,GAAO,KAAK,eAAe,EACtE2K,GACHxS,EAAI,MAAM,UAAW,mCAAmC,EAExD,KAAK,YAAc,KAEZ,KAKP,KAAK,kBAAoB,KAAK,OAAO,qBAAsB,EACpD,GAET,EAEAwQ,EAAQ,UAAU,qBAAuB,UAAW,CAEnD,OAAO,KAAK,OAAO,KAAK,KAAK,qBAAsB,GAAM,KAAK,eAAe,CAC9E,EAEAA,EAAQ,UAAU,kBAAoB,UAAW,CAEhD,KAAK,qBAAuB,KAAK,OAAO,YAAW,CACpD,EAEAA,EAAQ,UAAU,gBAAkB,SAAS3I,EAAKuB,EAAK,CAClD,KAAK,OAAO,eACXvB,EAAI,OAAS,QAEhB,KAAK,OAAO,aAAaA,EAAI,QAAQ,EACjC,KAAK,iBACR,KAAK,OAAO,aAAaA,EAAI,KAAKA,EAAI,QAAQ,GAI/C,KAAK,OAAO,aAAaA,EAAI,IAAI,EAGpC,EAEA2I,EAAQ,UAAU,IAAM5I,EAAU,IAAI,UAAU,IAChD4I,EAAQ,UAAU,OAAS5I,EAAU,IAAI,UAAU,OAEnD4I,EAAQ,UAAU,KAAO,SAAUiC,EAAU,CAC5C,IAAI9B,EAAU8B,GAAY,GACf,KAAK,IAAI,MAAM,EAAE,IAAI,cAAgB9B,EAAQ,QAAUA,EAAQ,OAAO,CAAC,GAAM,MAAM,EACpF,IAAI,gBAAiB,CAAC,EACtB,IAAI,oBAAqBA,EAAQ,QAAU,CAAC,MAAM,CAAC,EAC7D,IAAIsB,EAAO,KAAK,IAAI,MAAM,EAC1B,OAAAA,EAAK,IAAI,MAAM,EAAE,IAAI,YAAatB,EAAQ,WAAa,GAAG,EACrD,IAAI,OAAQA,EAAQ,MAAQ,KAAK,EACjC,IAAI,gBAAiB,CAAC,EACtB,IAAI,oBAAqB,CAAC,EAC1B,IAAI,WAAYA,EAAQ,UAAY,CAAC,EACrC,IAAI,SAAWA,EAAQ,MAAS,EAAI,GAAM,EAC1C,IAAI,SAAU,CAAE,MAAO,EAAG,EAAG,EAAG,MAAO,EAAG,EAAG,EAAG,UAAU,CAAC,EAC3D,IAAI,gBAAiB,CAAC,EAC3BsB,EAAK,IAAI,MAAM,EACR,IACR,EAEAzB,EAAQ,UAAU,SAAW,SAAUiC,EAAU,CAC3C,KAAK,MACT,KAAK,KAAKA,CAAQ,EAGnB,IAAI9B,EAAU8B,GAAY,GAC1B9B,EAAQ,MAAQA,EAAQ,OAAS,IACjCA,EAAQ,OAASA,EAAQ,QAAU,IACnCA,EAAQ,GAAKA,EAAQ,IAAM,KAAK,KAAK,KAAK,cAC1CA,EAAQ,KAAOA,EAAQ,MAAQ,OAE/B,IAAIC,EAAO,KAAK,KAAK,IAAI,MAAM,EAC/B,KAAK,KAAK,KAAK,cAAgBD,EAAQ,GAAG,EAC1CC,EAAK,IAAI,MAAM,EAAE,IAAI,QAAQhJ,EAAU,kBAC/BA,EAAU,mBACVA,EAAU,oBAAoB,EACjC,IAAI,gBAAgB,CAAC,EACrB,IAAI,oBAAqB,CAAC,EAC1B,IAAI,WAAY+I,EAAQ,EAAE,EAC1B,IAAI,WAAYA,EAAQ,UAAY,CAAC,EACrC,IAAI,QAASA,EAAQ,OAAS,CAAC,EAC/B,IAAI,kBAAmB,CAAC,EACxB,IAAI,SAAU,CAAC,EACf,IAAI,SAAU,CAAE,MAAO,EAAG,EAAG,EAAG,MAAO,EAAG,EAAG,EAAG,UAAY,CAAA,EAC5D,IAAI,QAASA,EAAQ,OAAS,EAAE,EAChC,IAAI,SAAUA,EAAQ,QAAU,EAAE,EAEvC,IAAI+B,EAAO9B,EAAK,IAAI,MAAM,EAC1B8B,EAAK,IAAI,MAAM,EAAE,IAAI,gBAAiB,CAAC,EAClC,IAAI,oBAAqB,CAAC,EAC1B,IAAI,YAAa/B,EAAQ,WAAa,CAAC,EACvC,IAAI,WAAYA,EAAQ,gBAAkB,CAAC,EAC3C,IAAI,WAAYA,EAAQ,UAAY,KAAK,EAE9C+B,EAAK,IAAI,MAAM,EAAE,IAAI,UAAW/B,EAAQ,MAAQ,MAAM,EACjD,IAAI,OAAQA,EAAQ,MAAQ,8BAA8B,EAE/D+B,EAAK,IAAI,MAAM,EAAE,IAAI,oBAAqB/B,EAAQ,UAAY,OAAO,EAErE,IAAIgC,EAAOD,EAAK,IAAI,MAAM,EAC1B,GAAI9K,EAAU+I,EAAQ,KAAK,aAAa,IAAM,OAC9C,KAAIiC,EAA2B,IAAIhL,EAAU+I,EAAQ,KAAK,aAAa,EACvEiC,EAAyB,qBAAuB,EAChD,IAAIC,EAAa,GACjB,QAASpK,KAAab,EAAU,iBAE/B,QADIkL,EAAQlL,EAAU,iBAAiBa,CAAS,EACvChH,EAAI,EAAGA,EAAIqR,EAAM,OAAQrR,IACjC,GAAIqR,EAAM,QAAQnC,EAAQ,IAAI,EAAI,GAAI,CACrCkC,EAAapK,EACb,KACJ,CAGC,OAAOoK,EAAU,CAChB,IAAK,SASJ,GARAF,EAAK,IAAI,MAAM,EAAE,IAAI,eAAe,CAAC,EAAE,IAAI,UAAW,CAAE,EAAG,EAAG,CAAC,CAAE,EACjEC,EAAyB,IAAI,QAASjC,EAAQ,KAAK,EAC/C,IAAI,SAAUA,EAAQ,MAAM,EAC5B,IAAI,kBAAmB,IAAM,EAAE,EAC/B,IAAI,iBAAkB,IAAM,EAAE,EAC9B,IAAI,cAAe,CAAC,EACpB,IAAI,iBAAkBA,EAAQ,KAAK,aAAa,EAChD,IAAI,QAAS,EAAI,EACjBA,EAAQ,uBAAwB,CACnC,IAAIoC,EAAO,IAAInL,EAAU,QACzBmL,EAAK,MAAM,IAAIpR,EAAagP,EAAQ,sBAAsB,CAAC,EAC3DiC,EAAyB,OAAOG,CAAI,CACxC,SAAcpC,EAAQ,wBAAyB,CAC3C,IAAIqC,EAAO,IAAIpL,EAAU,QACzBoL,EAAK,MAAM,IAAIrR,EAAagP,EAAQ,uBAAuB,CAAC,EAC5DiC,EAAyB,OAAOI,CAAI,CACxC,CACG,MACD,IAAK,QACJL,EAAK,IAAI,MAAM,EAAE,IAAI,UAAWhC,EAAQ,SAAW,CAAC,EACpDiC,EAAyB,IAAI,gBAAiBjC,EAAQ,eAAiB,CAAC,EACpE,IAAI,aAAcA,EAAQ,YAAc,EAAE,EAC1C,IAAI,aAAcA,EAAQ,YAAc,KAAK,EACjD,MACD,IAAK,OACJgC,EAAK,IAAI,MAAM,EACf,MACD,IAAK,WAEJ,OADAA,EAAK,IAAI,MAAM,EACPhC,EAAQ,KAAI,CACnB,IAAK,OACJiC,EAAyB,IAAI,YAAajC,EAAQ,WAAa,aAAa,EACxE,IAAI,kBAAmBA,EAAQ,iBAAmB,EAAE,EACpD,IAAI,uBAAwBA,EAAQ,sBAAwB,EAAE,EAClE,KACL,CACG,MACD,IAAK,WACJgC,EAAK,IAAI,MAAM,EACf,MACD,IAAK,SACJA,EAAK,IAAI,MAAM,EACf,MACD,QACCA,EAAK,IAAI,MAAM,EACf,KACH,CACKhC,EAAQ,aACXiC,EAAyB,OAAOjC,EAAQ,WAAW,EAEhDA,EAAQ,mBACXA,EAAQ,kBAAkB,QAAQ,SAAUvO,EAAG,CAC9CwQ,EAAyB,OAAOxQ,CAAC,CACpC,CAAG,EAEFuQ,EAAK,IAAI,MAAM,EAAE,IAAI,MAAM,EAAE,SAAU,IAAI/K,EAAU,SAAS,EAAG,EAAE,IAAI,QAAS,CAAG,CAAC,EACpF,IAAIqL,EAAON,EAAK,IAAI,MAAM,EAC1B,OAAAM,EAAK,IAAI,MAAM,EAAE,SAASL,CAAwB,EAClDK,EAAK,IAAI,MAAM,EAAE,IAAI,gBAAiB,CAAE,CAAA,EACnC,IAAI,gBAAiB,EAAE,EAC5BA,EAAK,IAAI,MAAM,EAAE,IAAI,cAAe,CAAE,CAAA,EACjC,IAAI,oBAAqB,CAAE,CAAA,EAC3B,IAAI,2BAA4B,EAAE,EACvCA,EAAK,IAAI,MAAM,EAAE,IAAI,gBAAiB,CAAA,CAAE,EACxCA,EAAK,IAAI,MAAM,EAAE,IAAI,eAAgB,CAAA,CAAE,EAEvC,KAAK,KAAK,KAAK,IAAI,MAAM,EAAE,IAAI,WAAYtC,EAAQ,EAAE,EAC5C,IAAI,mCAAoCA,EAAQ,kCAAoC,CAAC,EACrF,IAAI,0BAA2BA,EAAQ,yBAA2B,CAAC,EACnE,IAAI,sBAAuBA,EAAQ,qBAAuB,CAAC,EAC3D,IAAI,uBAAwBA,EAAQ,sBAAwB,CAAC,EACtE,KAAK,qBAAqBC,CAAI,EACvBD,EAAQ,GAChB,EAEA/I,EAAU,IAAI,UAAU,YAAc,SAASsL,EAAS,CACvD,IAAI/L,EAAS+L,GAAW,IAAI7Q,EAC5B8E,EAAO,WAAa9E,EAAW,WAC/B,KAAK,MAAM8E,CAAM,CAClB,EAEAqJ,EAAQ,UAAU,UAAY,SAAUkB,EAAUnC,EAAMkD,EAAU,CACjE,IAAI9B,EAAU8B,GAAY,CAAE,EACxBpC,EAAS,CAAE,EACXO,EAAO,KAAK,aAAac,CAAQ,EACrC,GAAId,IAAS,KACV,CAAAP,EAAO,OAASO,EAAK,QAAQ,OAChCP,EAAO,SAAWO,EAAK,KAAK,SAC5BP,EAAO,UAAYO,EAAK,KAAK,KAAK,UAClCP,EAAO,kBAAqBM,EAAQ,yBAA2BA,EAAQ,yBAA2B,EAAG,EACrGN,EAAO,YAAcO,EAAK,KAAK,KAAK,KAAK,KAAK,QAAQP,EAAO,iBAAiB,EAC9EA,EAAO,KAAOd,EACdc,EAAO,KAAOd,EAAK,WACnBc,EAAO,YAAcA,EAAO,KAC5BA,EAAO,SAAWM,EAAQ,UAAY,EACtCN,EAAO,IAAMM,EAAQ,KAAO,EAC5BN,EAAO,IAAMM,EAAQ,KAAO,EAC5BN,EAAO,QAAUM,EAAQ,SAAW,GACpCN,EAAO,WAAaM,EAAQ,YAAc,EAC1CN,EAAO,WAAaM,EAAQ,YAAc,EAC1CN,EAAO,eAAiBM,EAAQ,gBAAkB,EAClDN,EAAO,eAAiBM,EAAQ,gBAAkB,EAClDN,EAAO,qBAAuBM,EAAQ,sBAAwB,EAC9DN,EAAO,OAAS,EAChBA,EAAO,WAAaM,EAAQ,WAC5BC,EAAK,QAAQ,KAAKP,CAAM,EACxBO,EAAK,cAAgBP,EAAO,KAC5BO,EAAK,kBAAoBP,EAAO,SAC5BO,EAAK,YAAc,SACtBA,EAAK,UAAYD,EAAQ,KAG1B,KAAK,eAAgB,EAErB,IAAIwC,EAAO,KAAK,uBAAuB9C,CAAM,EAC7C,YAAK,OAAO8C,CAAI,EAChBA,EAAK,YAAa,EAElBA,EAAK,MAAM,CAAC,EAAE,MAAM,CAAC,EAAE,YAAcA,EAAK,KAAK,EAC/C,KAAK,IAAI,MAAM,EAAE,KAAO,IAAI,WAAW5D,CAAI,EACpCc,EACR,EAEAG,EAAQ,UAAU,uBAAyB,SAASH,EAAQ,CAC3D,IAAI+C,EAAe,EACf/C,EAAO,QACV+C,EAAgB,GAAK,GAErBA,EAAgB,MAEjB,IAAID,EAAO,IAAIvL,EAAU,QACzBuL,EAAK,IAAI,MAAM,EAAE,IAAI,kBAAmB,KAAK,cAAc,EAC3D,KAAK,iBACL,IAAIE,EAAOF,EAAK,IAAI,MAAM,EACtBvC,EAAO,KAAK,aAAaP,EAAO,QAAQ,EAC5C,OAAAgD,EAAK,IAAI,MAAM,EAAE,IAAI,WAAYhD,EAAO,QAAQ,EAC3C,IAAI,QAASzI,EAAU,8BAA8B,EAC1DyL,EAAK,IAAI,MAAM,EAAE,IAAI,sBAAwBhD,EAAO,KAAOO,EAAK,WAAa,EAAI,EACjFyC,EAAK,IAAI,MAAM,EAAE,IAAI,QAASzL,EAAU,uBAAyBA,EAAU,oBACjEA,EAAU,gBAAkBA,EAAU,iBACtCA,EAAU,qBAAqB,EACpC,IAAI,cAAc,CAAC,EACnB,IAAI,qBAAqB,CAAC,EAC1B,IAAI,eAAe,CAAC,EACpB,IAAI,kBAAkB,CAACyI,EAAO,QAAQ,CAAC,EACvC,IAAI,cAAc,CAACA,EAAO,IAAI,CAAC,EAC/B,IAAI,eAAe,CAAC+C,CAAY,CAAC,EACjC,IAAI,iCAAkC,CAAC/C,EAAO,IAAMA,EAAO,GAAG,CAAC,EAC7D8C,CACR,EAIA3C,EAAQ,UAAU,cAAgB,EAGlCA,EAAQ,UAAU,gBAAkB,EAGpCA,EAAQ,UAAU,YAAc,UAAY,CAC3C,IAAI/O,EACAmP,EAAM0C,EAAMC,EAAMC,EAAMC,EAAMC,EAAMC,EAGxC,IAFA,KAAK,iBAAmB,KAAK,KAAK,KAAK,SACvC,KAAK,KAAK,KAAK,SAAW,EACrBlS,EAAI,EAAGA,EAAI,KAAK,KAAK,MAAM,OAAQA,IAAK,CAC5CmP,EAAO,KAAK,KAAK,MAAMnP,CAAC,EACxBmP,EAAK,KAAK,SAAW,EACrBA,EAAK,KAAK,KAAK,SAAW,EAC1B0C,EAAO1C,EAAK,KAAK,KAAK,KAAK,MAAQA,EAAK,KAAK,KAAK,KAAK,KACvD0C,EAAK,cAAgB,CAAE,EACvBC,EAAO3C,EAAK,KAAK,KAAK,KAAK,KAC3B2C,EAAK,YAAc,CAAE,EACrBA,EAAK,kBAAoB,CAAE,EAC3BA,EAAK,yBAA2B,CAAE,EAClCC,EAAO5C,EAAK,KAAK,KAAK,KAAK,MAAQA,EAAK,KAAK,KAAK,KAAK,KACvD4C,EAAK,aAAe,CAAE,EACtBC,EAAO7C,EAAK,KAAK,KAAK,KAAK,KAC3B6C,EAAK,cAAgB,CAAE,EACvBA,EAAK,cAAgB,CAAE,EACvBC,EAAO9C,EAAK,KAAK,KAAK,KAAK,KACvB8C,IACHA,EAAK,cAAgB,CAAE,EACvBA,EAAK,eAAiB,CAAE,GAEzBC,EAAO/C,EAAK,KAAK,KAAK,KAAK,KAC3B,IAAIlN,EAAIkN,EAAK,KAAK,KAAK,KAAK,MAAM,QAAQ+C,CAAI,EAC1CjQ,GAAK,KAAIkN,EAAK,KAAK,KAAK,KAAK,MAAMlN,CAAC,EAAI,KAC9C,CACA,EAEA8M,EAAQ,iBAAmB,SAASI,EAAMyC,EAAMO,EAAOC,EAAYC,EAAY,CAC9E,IAAItM,EACA9D,EAEAqQ,EACAC,EACJ,SAASC,EAAgBlM,EAAOmM,EAAYC,EAAO,CAClD,KAAK,cAAgBpM,EACrB,KAAK,wBAA0BmM,EAC/B,KAAK,KAAOC,EACZ,KAAK,mBAAqB,GAC1B,KAAK,YAAc,EACrB,CAOC,IANId,IACHA,EAAK,mBAAqB,CAAE,GAExBzC,EAAK,qBACTA,EAAK,mBAAqB,CAAE,GAExBlN,EAAI,EAAGA,EAAIkQ,EAAM,OAAQlQ,IAAK,CASlC,IARAsQ,EAAmBJ,EAAMlQ,CAAC,EAAE,cAAe,IAAKkQ,EAAMlQ,CAAC,EAAE,wBACzDqQ,EAAoB,IAAIE,EAAgBL,EAAMlQ,CAAC,EAAE,cAAekQ,EAAMlQ,CAAC,EAAE,wBAAyBkQ,EAAMlQ,CAAC,CAAC,EACtG2P,IACHA,EAAK,mBAAmBW,CAAgB,EAAID,GAExCnD,EAAK,mBAAmBoD,CAAgB,IAC5CpD,EAAK,mBAAmBoD,CAAgB,EAAID,GAExCvM,EAAE,EAAGA,EAAGqM,EAAW,OAAQrM,IAC3BqM,EAAWrM,CAAC,EAAE,gBAAkBoM,EAAMlQ,CAAC,EAAE,gBAC5CqQ,EAAkB,YAAcF,EAAWrM,CAAC,EAC5CuM,EAAkB,YAAY,KAAO,IAGvC,GAAID,EACH,IAAKtM,EAAE,EAAGA,EAAGsM,EAAW,OAAQtM,IAC3BsM,EAAWtM,CAAC,EAAE,gBAAkBoM,EAAMlQ,CAAC,EAAE,gBAC5CqQ,EAAkB,qBAAuBD,EAAWtM,CAAC,EACrDuM,EAAkB,qBAAqB,KAAO,GAC9CA,EAAkB,YAAc,GAIrC,CACC,GAAKV,GAWJ,GAAIS,EACH,IAAKpQ,EAAI,EAAGA,EAAIoQ,EAAW,OAAQpQ,IAC9B,CAACoQ,EAAWpQ,CAAC,EAAE,MAAQoQ,EAAWpQ,CAAC,EAAE,SAAW,IACnDsQ,EAAmBF,EAAWpQ,CAAC,EAAE,cAAe,KAChDqQ,EAAoB,IAAIE,EAAgBH,EAAWpQ,CAAC,EAAE,cAAe,CAAC,EACtEqQ,EAAkB,YAAc,GAC3BV,EAAK,mBAAmBW,CAAgB,IAC5CX,EAAK,mBAAmBW,CAAgB,EAAID,QAjBhD,KAAKrQ,EAAI,EAAGA,EAAImQ,EAAW,OAAQnQ,IAC9B,CAACmQ,EAAWnQ,CAAC,EAAE,MAAQmQ,EAAWnQ,CAAC,EAAE,SAAW,IACnDsQ,EAAmBH,EAAWnQ,CAAC,EAAE,cAAe,KAChDqQ,EAAoB,IAAIE,EAAgBJ,EAAWnQ,CAAC,EAAE,cAAe,CAAC,EACjEkN,EAAK,mBAAmBoD,CAAgB,IAC5CpD,EAAK,mBAAmBoD,CAAgB,EAAID,GAkBjD,EAEAvD,EAAQ,yBAA2B,SAASI,EAAMP,EAAQ+D,EAAeC,EAAoB,CAC5F,IAAI3Q,EACA2C,EACJgK,EAAO,cAAgB,CAAE,EACzB,IAAK3M,KAAK2Q,EAkBT,GAjBAhE,EAAO,cAAc3M,CAAC,EAAI,CAAE,EAC5B2M,EAAO,cAAc3M,CAAC,EAAE,cAAgB2Q,EAAmB3Q,CAAC,EAAE,cAC9D2M,EAAO,cAAc3M,CAAC,EAAE,wBAA0B2Q,EAAmB3Q,CAAC,EAAE,wBACpE0Q,GAAiBC,EAAmB3Q,CAAC,EAAE,qBACtC2Q,EAAmB3Q,CAAC,EAAE,mBAAqB,IAC9C2Q,EAAmB3Q,CAAC,EAAE,mBAAqB,GAE5C2Q,EAAmB3Q,CAAC,EAAE,cAClB2Q,EAAmB3Q,CAAC,EAAE,aAAe2Q,EAAmB3Q,CAAC,EAAE,KAAK,QAAQ,OAAS,IACpF2Q,EAAmB3Q,CAAC,EAAE,oBAAsB2Q,EAAmB3Q,CAAC,EAAE,KAAK,QAAQ2Q,EAAmB3Q,CAAC,EAAE,WAAW,EAAE,eAGhH2Q,EAAmB3Q,CAAC,EAAE,aAAe2Q,EAAmB3Q,CAAC,EAAE,KAAK,QAAQ,OAAS,EACpF2M,EAAO,cAAc3M,CAAC,EAAE,wBAA0B2Q,EAAmB3Q,CAAC,EAAE,KAAK,QAAQ2Q,EAAmB3Q,CAAC,EAAE,WAAW,EAAE,wBAExH2M,EAAO,cAAc3M,CAAC,EAAE,wBAA0B,GAE/C2M,EAAO,cAAc3M,CAAC,EAAE,0BAA4B,EAAG,CAC1D,IAAI4Q,EACAD,EAAmB3Q,CAAC,EAAE,qBACzB4Q,EAAcD,EAAmB3Q,CAAC,EAAE,qBAEpC4Q,EAAcD,EAAmB3Q,CAAC,EAAE,YAEjC2M,EAAO,cAAc3M,CAAC,EAAE,wBAA0B,GACjD2M,EAAO,cAAc3M,CAAC,EAAE,wBAA0B,MACrD2C,GAASgK,EAAO,cAAc3M,CAAC,EAAE,yBAA2B,IAAI,EAEhE2C,EAAQgK,EAAO,cAAc3M,CAAC,EAAE,wBAAwB,EAErD4Q,GAAejO,GAAS,IAC3BgK,EAAO,cAAc3M,CAAC,EAAE,YAAc4Q,EAAY,QAAQjO,CAAK,IAG5DiO,GAAeA,EAAY,SAAW,GACrCA,EAAY,gCAAkC,IACjDjE,EAAO,cAAc3M,CAAC,EAAE,YAAc4Q,EAAY,QAAQA,EAAY,gCAAgC,CAAC,EAI7G,CAEA,EAEA9D,EAAQ,aAAe,SAAU+D,EAAMlE,EAAQtP,EAAQ,CACjDsP,IAGDkE,GACHlE,EAAO,WAAakE,EAAK,WAAWxT,CAAM,EAC1CsP,EAAO,WAAakE,EAAK,kBAAkBxT,CAAM,EACjDsP,EAAO,eAAiBkE,EAAK,sBAAsBxT,CAAM,EACzDsP,EAAO,eAAiBkE,EAAK,sBAAsBxT,CAAM,IAEzDsP,EAAO,WAAa,EACpBA,EAAO,WAAa,EACpBA,EAAO,eAAiB,EACxBA,EAAO,eAAiB,GAE1B,EAGAG,EAAQ,UAAU,iBAAmB,UAAW,CAC/C,IAAI/O,EACAmP,EACJ,IAAKnP,EAAI,EAAGA,EAAI,KAAK,KAAK,MAAM,OAAQA,IACvCmP,EAAO,KAAK,KAAK,MAAMnP,CAAC,EACxB,KAAK,qBAAqBmP,CAAI,CAEhC,EAEAJ,EAAQ,UAAU,qBAAuB,SAASI,EAAM,CACvD,IAAInN,EACA6P,EAAMC,EAAMC,EAAMC,EAAMC,EAAMC,EAAMa,EAAMC,EAAMb,EAAOc,EAAOC,EAC9DC,EAAiBC,EAAaC,EAAmBC,EAAiBC,EAClEC,EAAyBC,EAAgBC,EAAyBC,EAAgBC,EAAkCC,EAAkBC,EA2B1I,GAzBA3E,EAAK,QAAU,CAAE,EACjBA,EAAK,iBAAmB,EACxBA,EAAK,aAAe,EACpB0C,EAAO1C,EAAK,KAAK,KAAK,KAAK,MAAQA,EAAK,KAAK,KAAK,KAAK,KACvD2C,EAAO3C,EAAK,KAAK,KAAK,KAAK,KAC3B4C,EAAO5C,EAAK,KAAK,KAAK,KAAK,MAAQA,EAAK,KAAK,KAAK,KAAK,KACvD6C,EAAO7C,EAAK,KAAK,KAAK,KAAK,KAC3B8C,EAAO9C,EAAK,KAAK,KAAK,KAAK,KAC3B+C,EAAO/C,EAAK,KAAK,KAAK,KAAK,KAC3B4D,EAAO5D,EAAK,KAAK,KAAK,KAAK,KAC3B6D,EAAO7D,EAAK,KAAK,KAAK,KAAK,KAC3B+D,EAAO/D,EAAK,KAAK,KAAK,KAAK,KAC3BgD,EAAQhD,EAAK,KAAK,KAAK,KAAK,MAC5B8D,EAAQ9D,EAAK,KAAK,KAAK,KAAK,MAE5BqE,EAA0B,GAC1BC,EAAiB,GACjBC,EAA0B,GAC1BC,EAAiB,GACjBC,EAAkB,EAClBC,EAAmB,EACnBC,EAAyB,EAEzB/E,EAAQ,iBAAiBI,EAAM,KAAMgD,EAAOc,CAAK,EAE7C,SAAOlB,EAAS,KAKpB,KAAK/P,EAAI,EAAGA,EAAI+P,EAAK,aAAa,OAAQ/P,IAAK,CAC9C,IAAI4M,EAAS,CAAE,EACfA,EAAO,OAAS5M,EAChB4M,EAAO,SAAWO,EAAK,KAAK,SAC5BP,EAAO,UAAYO,EAAK,KAAK,KAAK,UAClCP,EAAO,YAAc,EACrBO,EAAK,QAAQnN,CAAC,EAAI4M,EAElBA,EAAO,KAAOmD,EAAK,aAAa/P,CAAC,EACjCmN,EAAK,cAAgBP,EAAO,KAExB5M,IAAM,GACToR,EAAc,EACdD,EAAkB,EAClBvE,EAAO,YAAcwE,EACrBxE,EAAO,gBAAkBuE,EACzBI,EAAuBzB,EAAK,kBAAkBqB,CAAe,EAC7DG,EAAkB,EAGdH,EAAkB,EAAIrB,EAAK,YAAY,OAE1CuB,EAAoBvB,EAAK,YAAYqB,EAAgB,CAAC,EAAE,EAGxDE,EAAoB,KAGjBrR,EAAIuR,GAEP3E,EAAO,YAAcwE,EACrBxE,EAAO,gBAAkBuE,IAGzBC,IACAxE,EAAO,YAAcwE,EAErBE,EAAkB,EACdF,GAAeC,IAIlBF,IAEIA,EAAkB,EAAIrB,EAAK,YAAY,OAE1CuB,EAAoBvB,EAAK,YAAYqB,EAAgB,CAAC,EAAE,EAGxDE,EAAoB,KAItBzE,EAAO,gBAAkBuE,EACzBI,GAAwBzB,EAAK,kBAAkBqB,CAAe,GAIhEvE,EAAO,kBAAoBkD,EAAK,yBAAyBlD,EAAO,eAAe,EAAE,EACjFA,EAAO,YAAcmE,EAAK,QAAQnE,EAAO,iBAAiB,EAC1DA,EAAO,OAASiD,EAAK,cAAcjD,EAAO,YAAY,CAAC,EAAI0E,EAC3DA,GAAmB1E,EAAO,KAGtB5M,EAAIwR,IACPC,IACID,EAA0B,IAC7BA,EAA0B,GAE3BA,GAA2BxB,EAAK,cAAcyB,CAAc,GAEzDzR,EAAI,GACPmN,EAAK,QAAQnN,EAAE,CAAC,EAAE,SAAWgQ,EAAK,cAAcyB,CAAc,EAC9DtE,EAAK,kBAAoBA,EAAK,QAAQnN,EAAE,CAAC,EAAE,SAC3C4M,EAAO,IAAMO,EAAK,QAAQnN,EAAE,CAAC,EAAE,IAAMmN,EAAK,QAAQnN,EAAE,CAAC,EAAE,UAEvD4M,EAAO,IAAM,EAEVqD,GACCjQ,GAAK0R,IACRC,IACID,EAA0B,IAC7BA,EAA0B,GAE3BA,GAA2BzB,EAAK,cAAc0B,CAAc,GAE7D/E,EAAO,IAAMO,EAAK,QAAQnN,CAAC,EAAE,IAAMiQ,EAAK,eAAe0B,CAAc,GAErE/E,EAAO,IAAMA,EAAO,IAEjBsD,GACClQ,GAAKkQ,EAAK,eAAe0B,CAAe,EAAI,GAC/ChF,EAAO,QAAU,GACjBgF,MAEAhF,EAAO,QAAU,GACjBA,EAAO,qBAAuB,GAE3BoE,GACCA,EAAK,QAAQa,CAAgB,EAAE,aAAeC,GAA0B9R,EAAE,IAC7E4M,EAAO,WAAaoE,EAAK,QAAQa,CAAgB,EAAE,WACnDC,GAA0Bd,EAAK,QAAQa,CAAgB,EAAE,aACzDA,MAIFjF,EAAO,QAAU,GAElBG,EAAQ,aAAaI,EAAK,KAAK,KAAK,KAAK,KAAMP,EAAQA,EAAO,MAAM,EAChEsE,EACHtE,EAAO,qBAAuBsE,EAAK,SAASlR,CAAC,EAE7C4M,EAAO,qBAAuB,EAE3BoE,GACCA,EAAK,QAAQa,CAAgB,EAAE,aAAeC,GAA0B9R,IAC3E4M,EAAO,WAAaoE,EAAK,QAAQa,CAAgB,EAAE,WACnDC,GAA0Bd,EAAK,QAAQa,CAAgB,EAAE,eAGvD1B,EAAM,OAAS,GAAKc,EAAM,OAAS,IACtClE,EAAQ,yBAAyBI,EAAMP,EAAQ5M,EAAGmN,EAAK,kBAAkB,CAE5E,CACKnN,EAAE,IACLmN,EAAK,QAAQnN,EAAE,CAAC,EAAE,SAAW,KAAK,IAAImN,EAAK,KAAK,KAAK,SAAWA,EAAK,QAAQnN,EAAE,CAAC,EAAE,IAAK,CAAC,EACxFmN,EAAK,kBAAoBA,EAAK,QAAQnN,EAAE,CAAC,EAAE,UAE7C,EAGA+M,EAAQ,UAAU,kBAAoB,UAAW,CAChD,IAAI/O,EAAGgC,EAAGC,EACN8R,EAAkCC,EAAyBC,EAAqBC,EAChFC,EACA/N,EAAKsL,EAAME,EAAMzC,EAAMiF,EACvBxF,EACA+C,EAEJ,GAAI,KAAK,OAAS,QAIlB,KAAO,KAAK,cAAgB,KAAK,MAAM,QAGtC,GAFAvL,EAAM,KAAK,MAAM,KAAK,aAAa,EACnC,KAAK,gBACDA,EAAI,MAAQ,OAEf,IADAsL,EAAOtL,EACFpG,EAAI,EAAGA,EAAI0R,EAAK,MAAM,OAAQ1R,IAAK,CA6BvC,IA5BA4R,EAAOF,EAAK,MAAM1R,CAAC,EACnBmP,EAAO,KAAK,aAAayC,EAAK,KAAK,QAAQ,EAC3CwC,EAAO,KAAK,YAAYxC,EAAK,KAAK,QAAQ,EACtCA,EAAK,KAAK,MAAQzL,EAAU,sBAC/B4N,EAAmCnC,EAAK,KAAK,iCAE7CmC,EAAoCK,EAAOA,EAAK,iCAAkC,EAE/ExC,EAAK,KAAK,MAAQzL,EAAU,qBAC/B6N,EAA0BpC,EAAK,KAAK,wBAEpCoC,EAA2BI,EAAOA,EAAK,wBAA0B,EAE9DxC,EAAK,KAAK,MAAQzL,EAAU,sBAC/B8N,EAAsBrC,EAAK,KAAK,oBAEhCqC,EAAuBG,EAAOA,EAAK,oBAAsB,EAEtDxC,EAAK,KAAK,MAAQzL,EAAU,uBAC/B+N,EAAuBtC,EAAK,KAAK,qBAEjCsC,EAAwBE,EAAOA,EAAK,qBAAuB,EAE5DxC,EAAK,cAAgB,EAEjBA,EAAK,MAAM,OAAS,GACvB7C,EAAQ,iBAAiBI,EAAMyC,EAAMA,EAAK,MAAOzC,EAAK,KAAK,KAAK,KAAK,MAAOyC,EAAK,KAAK,EAElF5P,EAAI,EAAGA,EAAI4P,EAAK,MAAM,OAAQ5P,IAAK,CACvC,IAAIqS,EAAOzC,EAAK,MAAM5P,CAAC,EACvB,IAAKC,EAAI,EAAGA,EAAIoS,EAAK,aAAcpS,IAAK,CACvC2M,EAAS,CAAE,EACXA,EAAO,YAAc,KAAK,cAC1BA,EAAO,eAAiBgD,EAAK,cAC7BA,EAAK,gBACIhD,EAAO,OAASO,EAAK,QAAQ,OACtCyC,EAAK,mBAAqBzC,EAAK,QAAQ,OACvCA,EAAK,QAAQ,KAAKP,CAAM,EACxBA,EAAO,SAAWO,EAAK,KAAK,SAC5BP,EAAO,UAAYO,EAAK,KAAK,KAAK,UAClCP,EAAO,kBAAoBmF,EAAiC,EAC5DnF,EAAO,YAAcO,EAAK,KAAK,KAAK,KAAK,KAAK,QAAQP,EAAO,iBAAiB,EAC9EA,EAAO,KAAOqF,EACVI,EAAK,MAAQlO,EAAU,kBAC1ByI,EAAO,KAAOyF,EAAK,YAAYpS,CAAC,GAEjCkN,EAAK,cAAgBP,EAAO,KAC5BA,EAAO,SAAWoF,EACdK,EAAK,MAAQlO,EAAU,sBAC1ByI,EAAO,SAAWyF,EAAK,gBAAgBpS,CAAC,GAEzCkN,EAAK,kBAAoBP,EAAO,SAC5BO,EAAK,mBAAqBlN,EAAI,EACjC2M,EAAO,IAAMO,EAAK,QAAQA,EAAK,QAAQ,OAAO,CAAC,EAAE,IAAIA,EAAK,QAAQA,EAAK,QAAQ,OAAO,CAAC,EAAE,UAErFyC,EAAK,KACRhD,EAAO,IAAMgD,EAAK,KAAK,oBAEvBhD,EAAO,IAAM,EAEdO,EAAK,kBAAoB,IAE1BP,EAAO,IAAMA,EAAO,IAChByF,EAAK,MAAQlO,EAAU,wBAC1ByI,EAAO,IAAMA,EAAO,IAAMyF,EAAK,+BAA+BpS,CAAC,GAEhE0P,EAAeuC,EACXG,EAAK,MAAQlO,EAAU,iBAC1BwL,EAAe0C,EAAK,aAAapS,CAAC,EACxBA,IAAM,GAAMoS,EAAK,MAAQlO,EAAU,wBAC7CwL,EAAe0C,EAAK,oBAErBzF,EAAO,QAAY,EAAA+C,GAAgB,GAAK,GACxC/C,EAAO,WAAc+C,GAAgB,GAAK,EAC1C/C,EAAO,WAAc+C,GAAgB,GAAK,EAC1C/C,EAAO,eAAkB+C,GAAgB,GAAK,EAC9C/C,EAAO,eAAkB+C,GAAgB,GAAK,EAC9C/C,EAAO,qBAAwB+C,EAAe,MAE9C,IAAI2C,EAAQ,GAAA1C,EAAK,KAAK,MAAQzL,EAAU,4BACpCoO,EAAQ,GAAA3C,EAAK,KAAK,MAAQzL,EAAU,gCACpCqO,EAAO,GAAAH,EAAK,MAAQlO,EAAU,wBAC9BsO,EAAM,EACLH,EAWJG,EAAM7C,EAAK,KAAK,iBAVX2C,GACAvS,IAAM,EAMVyS,EAAM/C,EAAK,MAHV+C,EAAMN,EAQLnS,IAAM,GAAKC,IAAM,EAChBuS,EACH5F,EAAO,OAAS6F,EAAMJ,EAAK,YAE3BzF,EAAO,OAAS6F,EAGjB7F,EAAO,OAASuF,EAEjBA,EAAoBvF,EAAO,OAASA,EAAO,MACvCgD,EAAK,MAAM,OAAS,GAAKA,EAAK,MAAM,OAAS,GAChDzC,EAAK,KAAK,KAAK,KAAK,MAAM,OAAS,GAAKA,EAAK,KAAK,KAAK,KAAK,MAAM,OAAS,IAC3EJ,EAAQ,yBAAyBI,EAAMP,EAAQA,EAAO,eAAgBgD,EAAK,kBAAkB,CAEpG,CACA,CACI,GAAIA,EAAK,KAAM,CACdzC,EAAK,wBAA0B,GAC/B,IAAIuF,EAAe9C,EAAK,mBACxB,IAAK5P,EAAI,EAAGA,EAAI4P,EAAK,KAAK,QAAQ,OAAQ5P,IACzC0S,GAAgB9C,EAAK,KAAK,QAAQ5P,CAAC,EAAE,aACrC4M,EAASO,EAAK,QAAQuF,EAAa,CAAC,EACpC9F,EAAO,WAAagD,EAAK,KAAK,QAAQ5P,CAAC,EAAE,UAE/C,CACA,EAGA,EAMA+M,EAAQ,UAAU,UAAY,SAASI,EAAMe,EAAW,CACvD,IAAI5M,EACAsL,EAASO,EAAK,QAAQe,CAAS,EAEnC,GAAI,CAAC,KAAK,KACT,OAAO,KAGR,GAAI,CAACtB,EAAO,KAEXA,EAAO,KAAO,IAAI,WAAWA,EAAO,IAAI,EACxCA,EAAO,YAAc,EACrB,KAAK,iBAAmBA,EAAO,KAC/BrQ,EAAI,MAAM,UAAW,sBAAsB2R,EAAU,cAAcf,EAAK,KAAK,SAAS,YAAYP,EAAO,KAAK,YAAY,KAAK,gBAAgB,GAAG,UACxIA,EAAO,aAAeA,EAAO,KAEvC,OAAOA,EAIR,OAAY,CACX,IAAIhK,EAAQ,KAAK,OAAO,aAAa,GAAMgK,EAAO,OAASA,EAAO,YAAa,EAAK,EACpF,GAAIhK,EAAQ,GAAI,CACftB,EAAS,KAAK,OAAO,QAAQsB,CAAK,EAClC,IAAI+P,EAAmBrR,EAAO,YAAcsL,EAAO,OAASA,EAAO,YAActL,EAAO,WACxF,GAAIsL,EAAO,KAAOA,EAAO,aAAe+F,EAGvC,OAAApW,EAAI,MAAM,UAAU,mBAAmB2R,EAAU,uBAAuBtB,EAAO,YAAY,aACzFA,EAAO,OAAOA,EAAO,YAActL,EAAO,WAAW,gBAAgBsL,EAAO,KAAOA,EAAO,aAAa,eAAeA,EAAO,KAAK,GAAG,EAEvIhO,EAAW,OAAOgO,EAAO,KAAK,OAAQA,EAAO,YAC3BtL,EAAQsL,EAAO,OAAOA,EAAO,YAActL,EAAO,UAAWsL,EAAO,KAAOA,EAAO,WAAW,EAG/GtL,EAAO,WAAasL,EAAO,KAAOA,EAAO,YACzC,KAAK,OAAO,eAAgB,EAE5BA,EAAO,YAAcA,EAAO,KAErBA,EAIP,GAAI+F,IAAqB,EAAG,OAAO,KAEnCpW,EAAI,MAAM,UAAU,mBAAmB2R,EAAU,+BAA+BtB,EAAO,YAAY,aACjGA,EAAO,OAAOA,EAAO,YAActL,EAAO,WAAW,eAAeqR,EAAiB,eAAe/F,EAAO,KAAK,GAAG,EAErHhO,EAAW,OAAOgO,EAAO,KAAK,OAAQA,EAAO,YAC3BtL,EAAQsL,EAAO,OAAOA,EAAO,YAActL,EAAO,UAAWqR,CAAgB,EAC/F/F,EAAO,aAAe+F,EAGtBrR,EAAO,WAAaqR,EACpB,KAAK,OAAO,eAAgB,CAIhC,KACG,QAAO,IAEV,CACA,EAGA5F,EAAQ,UAAU,cAAgB,SAASI,EAAMe,EAAW,CAC3D,IAAItB,EAASO,EAAK,QAAQe,CAAS,EACnC,OAAItB,EAAO,MACV,KAAK,iBAAmBA,EAAO,KAC/BA,EAAO,KAAO,KACdA,EAAO,YAAc,EACdA,EAAO,MAEP,CAET,EAEAG,EAAQ,UAAU,2BAA6B,UAAW,CACzD,OAAO,KAAK,eACb,EAGAA,EAAQ,UAAU,UAAY,UAAW,CACxC,IAAI/O,EACA4U,EAAS,GACb,IAAK5U,EAAI,EAAGA,EAAI,KAAK,KAAK,MAAM,OAAQA,IAAK,CAC5C,IAAImP,EAAO,KAAK,KAAK,MAAMnP,CAAC,EACxBA,EAAE,IACL4U,GAAQ,KAETA,GAAUzF,EAAK,KAAK,KAAK,KAAK,KAAK,QAAQ,CAAC,EAAE,UAChD,CACC,OAAOyF,CACR,EAGA7F,EAAQ,UAAU,YAAc,SAASC,EAAI,CAC5C,IAAIhP,EACJ,GAAI,CAAC,KAAK,MAAQ,CAAC,KAAK,KAAK,KAAM,OAAO,KAC1C,IAAKA,EAAI,EAAGA,EAAI,KAAK,KAAK,KAAK,MAAM,OAAQA,IAAK,CACjD,IAAIoU,EAAO,KAAK,KAAK,KAAK,MAAMpU,CAAC,EACjC,GAAIoU,EAAK,UAAYpF,EAAI,OAAOoF,CAClC,CACC,OAAO,IACR,EAGArF,EAAQ,UAAU,aAAe,SAASC,EAAI,CAC7C,GAAI,KAAK,OAAS,OACjB,OAAO,KAER,QAAShN,EAAI,EAAGA,EAAI,KAAK,KAAK,MAAM,OAAQA,IAAK,CAChD,IAAImN,EAAO,KAAK,KAAK,MAAMnN,CAAC,EAC5B,GAAImN,EAAK,KAAK,UAAYH,EAAI,OAAOG,CACvC,CACC,OAAO,IACR,EAGAJ,EAAQ,UAAU,cAAgB,EAElCA,EAAQ,UAAU,gBAAkB,UAAW,CAC9C,IAAI8F,EAAQ,KAAK,MACbC,EAAgB,KAAK,cACrB9U,EAAGgC,EACH8H,EACAiL,EAAO,KAAK,KAChB,GAAIA,GAAS,MACTA,EAAK,OAAS,QACdA,EAAK,OAAS,OAClB,KAAK/U,EAAI,EAAGA,EAAI+U,EAAK,KAAK,WAAW,OAAQ/U,IAC5C8J,EAAO,CAAE,EACTA,EAAK,GAAKiL,EAAK,KAAK,WAAW/U,CAAC,EAAE,QAClC6U,EAAM/K,EAAK,EAAE,EAAIA,EACjBA,EAAK,OAAS,CAAE,EAChBA,EAAK,KAAOiL,EAAK,KAAK,WAAW/U,CAAC,EAAE,UAChC+U,EAAK,KAAK,WAAW/U,CAAC,EAAE,iBAAmB,IAC9C8J,EAAK,WAAaiL,EAAK,KAAK,YAAYA,EAAK,KAAK,WAAW/U,CAAC,EAAE,iBAAiB,CAAC,GAE/E+U,EAAK,KAAK,WAAW/U,CAAC,EAAE,UAC3B8J,EAAK,KAAOiL,EAAK,KAAK,WAAW/U,CAAC,EAAE,UAEpC8J,EAAK,KAAO,OAEbA,EAAK,aAAeiL,EAAK,KAAK,WAAW/U,CAAC,EAAE,aAC5C8J,EAAK,iBAAmBiL,EAAK,KAAK,WAAW/U,CAAC,EAAE,iBAChD8J,EAAK,cAAgBiL,EAAK,KAAK,WAAW/U,CAAC,EAAE,cAE9C,GAAI+U,EAAK,KACR,IAAK/U,EAAI,EAAGA,EAAI+U,EAAK,KAAK,MAAM,OAAQ/U,IACvC,aAAe,CAAE,EACjB,aAAa,GAAK+U,EAAK,KAAK,MAAM/U,CAAC,EAAE,SACrC,aAAa,WAAa+U,EAAK,KAAK,MAAM/U,CAAC,EAAE,WAC7C,aAAa,KAAO+U,EAAK,KAAK,MAAM/U,CAAC,EAAE,KACvC8U,EAAc,aAAa,EAAE,EAAI,aAGnC,GAAIC,EAAK,KACR,IAAI/U,EAAI,EAAGA,EAAI+U,EAAK,KAAK,MAAM,OAAQ/U,IAAK,CAE3C,IAAIgV,EAAUD,EAAK,KAAK,MAAM/U,CAAC,EAM/B,OALA8J,EAAO+K,EAAMG,EAAQ,OAAO,EACxBA,EAAQ,uBAAyB,IACpCzW,EAAI,KAAK,2DAA2D,EACpEuL,EAAK,OAASiL,EAAK,KAAK,MAAMC,EAAQ,qBAAqB,CAAC,GAEtDA,EAAQ,oBAAmB,CACjC,IAAK,GACL,MACA,IAAK,GACL,MACA,IAAK,GACLzW,EAAI,KAAK,uDAAuD,EAChE,KACJ,CAGG,IAFAuL,EAAK,QAAU,CAAE,EACjBA,EAAK,KAAO,EACP9H,EAAI,EAAGA,EAAIgT,EAAQ,QAAQ,OAAQhT,IACvC8H,EAAK,QAAQ9H,CAAC,EAAI,CAAE,EACpB8H,EAAK,QAAQ9H,CAAC,EAAE,OAASgT,EAAQ,QAAQhT,CAAC,EAAE,cAAgBgT,EAAQ,YAChEA,EAAQ,qBAAuB,IAClClL,EAAK,QAAQ9H,CAAC,EAAE,QAAU+S,EAAK,KAAK,MAAQA,EAAK,KAAK,UAEvDjL,EAAK,QAAQ9H,CAAC,EAAE,OAASgT,EAAQ,QAAQhT,CAAC,EAAE,cAC5C8H,EAAK,QAAQ9H,CAAC,EAAE,YAAc,EAC9B8H,EAAK,MAAQA,EAAK,QAAQ9H,CAAC,EAAE,MAEjC,CAKC,GAHI+S,EAAK,OACRF,EAAME,EAAK,KAAK,OAAO,EAAE,QAAU,IAEhCA,EAAK,KACR,IAAK/U,EAAE,EAAGA,EAAG+U,EAAK,KAAK,WAAW,OAAQ/U,IAAK,CAC9C,IAAIiL,EAAM8J,EAAK,KAAK,WAAW/U,CAAC,EAChC,IAAKgC,EAAE,EAAGA,EAAEiJ,EAAI,WAAW,OAAQjJ,IAClC6S,EAAM5J,EAAI,YAAY,EAAE,OAAO,KAAK,CAAC,KAAMA,EAAI,KAAM,GAAIA,EAAI,WAAWjJ,CAAC,CAAC,CAAC,CAE/E,CAEC,GAAI+S,EAAK,KACR,QAAS9S,EAAI,EAAGA,EAAI8S,EAAK,KAAK,MAAM,OAAQ9S,IAAK,CAChD,IAAIgT,EAAOF,EAAK,KAAK,MAAM9S,CAAC,EAC5B,IAAKjC,EAAI,EAAGA,EAAIiV,EAAK,aAAa,OAAQjV,IAAK,CAC9C,IAAIkV,EAAcD,EAAK,aAAajV,CAAC,EAKrC,GAJA8J,EAAO+K,EAAMK,EAAY,EAAE,EACtBpL,IACJA,EAAOgL,EAAcI,EAAY,EAAE,GAEhCpL,EAKH,IAJIA,EAAK,aAAe,SACvBA,EAAK,WAAa,CAAE,EACpBA,EAAK,WAAW,MAAQ,CAAE,GAEtB9H,EAAI,EAAGA,EAAIkT,EAAY,MAAM,OAAQlT,IAAK,CAC9C,IAAImT,EAAYD,EAAY,MAAMlT,CAAC,EACnC,GAAImT,EAAU,eAAiB,GAAKA,EAAU,eAAe,EAAIJ,EAAK,KAAK,KAAK,MAAM,OAAQ,CAC7F,IAAIK,EAAUL,EAAK,KAAK,KAAK,MAAMI,EAAU,eAAe,CAAC,EAC7DrL,EAAK,WAAWsL,EAAQ,IAAI,EAAIA,EAChCtL,EAAK,WAAW,MAAM,KAAKsL,CAAO,CACzC,CACA,CAEA,CACA,EAEA,EAEArG,EAAQ,UAAU,QAAU,SAASsG,EAAS,CAC7C,IAAI/R,EACAwG,EAEJ,GAAI,CAAC,KAAK,KACT,OAAO,KAIR,GADCA,EAAO,KAAK,MAAMuL,CAAO,EACtB,CAACvL,EAAK,MAAQA,EAAK,KAEtBA,EAAK,KAAO,IAAI,WAAWA,EAAK,IAAI,EACpCA,EAAK,YAAc,EACnB,KAAK,eAAiBA,EAAK,KAC3BvL,EAAI,MAAM,UAAW,oBAAoB8W,EAAQ,YAAYvL,EAAK,KAAK,YAAY,KAAK,cAAc,GAAG,UAC/FA,EAAK,cAAgBA,EAAK,KAEpC,OAAOA,EAKR,QAAS9J,EAAI,EAAGA,EAAI8J,EAAK,QAAQ,OAAQ9J,IAAK,CAC7C,IAAIgK,EAASF,EAAK,QAAQ9J,CAAC,EAC3B,GAAIgK,EAAO,cAAgBA,EAAO,OAE3B,CACN,IAAIpF,EAAQ,KAAK,OAAO,aAAa,GAAMoF,EAAO,OAASA,EAAO,YAAa,EAAK,EACpF,GAAIpF,EAAQ,GAAI,CACftB,EAAS,KAAK,OAAO,QAAQsB,CAAK,EAClC,IAAI+P,EAAmBrR,EAAO,YAAc0G,EAAO,OAASA,EAAO,YAAc1G,EAAO,WACxF,GAAI0G,EAAO,OAASA,EAAO,aAAe2K,EAGzCpW,EAAI,MAAM,UAAU,iBAAiB8W,EAAQ,YAAYrV,EAAE,uBAAuBgK,EAAO,YACxF,aAAaA,EAAO,OAAOA,EAAO,YAAc1G,EAAO,WAAW,gBAAgB0G,EAAO,OAASA,EAAO,aACzG,sBAAsBA,EAAO,OAAO,oBAAoBF,EAAK,KAAK,GAAG,EAEtElJ,EAAW,OAAOkJ,EAAK,KAAK,OAAQA,EAAK,YACvBxG,EAAQ0G,EAAO,OAAOA,EAAO,YAAc1G,EAAO,UAAW0G,EAAO,OAASA,EAAO,WAAW,EAGjH1G,EAAO,WAAa0G,EAAO,OAASA,EAAO,YAC3C,KAAK,OAAO,eAAgB,EAE5BF,EAAK,aAAgBE,EAAO,OAASA,EAAO,YAC5CA,EAAO,YAAcA,EAAO,WAI5B,QAAAzL,EAAI,MAAM,UAAU,iBAAiB8W,EAAQ,YAAYrV,EAAE,+BAA+BgK,EAAO,YAAY,aAC3GA,EAAO,OAAOA,EAAO,YAAc1G,EAAO,WAAW,eAAeqR,EACrE,sBAAsB3K,EAAO,OAAO,oBAAoBF,EAAK,KAAK,GAAG,EAEtElJ,EAAW,OAAOkJ,EAAK,KAAK,OAAQA,EAAK,YACvBxG,EAAQ0G,EAAO,OAAOA,EAAO,YAAc1G,EAAO,UAAWqR,CAAgB,EAC/F3K,EAAO,aAAe2K,EACtB7K,EAAK,aAAe6K,EAGpBrR,EAAO,WAAaqR,EACpB,KAAK,OAAO,eAAgB,EACrB,IAEZ,KACI,QAAO,IAEX,CACA,CACC,OAAI7K,EAAK,cAAgBA,EAAK,KAEtBA,EAEA,IAET,EAGAiF,EAAQ,UAAU,YAAc,SAASsG,EAAS,CACjD,IAAIvL,EAAO,KAAK,MAAMuL,CAAO,EAC7B,GAAIvL,EAAK,KAAM,CACd,KAAK,eAAiBA,EAAK,KAC3BA,EAAK,KAAO,KACZA,EAAK,YAAc,EACnB,QAAS9J,EAAI,EAAGA,EAAI8J,EAAK,QAAQ,OAAQ9J,IAAK,CAC7C,IAAIgK,EAASF,EAAK,QAAQ9J,CAAC,EAC3BgK,EAAO,YAAc,CACxB,CACE,OAAOF,EAAK,IACd,KACE,OAAO,EAET,EAGAiF,EAAQ,UAAU,aAAe,SAASuG,EAAU,CACnD,QAAQtV,KAAK,KAAK,MAAO,CACxB,IAAI8J,EAAO,KAAK,MAAM9J,CAAC,EACvB,KAAK,QAAQ8J,EAAK,EAAE,EAChBwL,GAAY,CAACxL,EAAK,OACrBwL,EAASxL,CAAI,EACbA,EAAK,KAAO,GACZA,EAAK,KAAO,KAEf,CACA,EAEAiF,EAAQ,UAAU,QAAU,SAASrI,EAAM,CAC1C,QAAQ1G,KAAK,KAAK,MAAO,CACxB,IAAI8J,EAAO,KAAK,MAAM9J,CAAC,EACvB,GAAI8J,EAAK,OAASpD,EACjB,OAAOoD,EAAK,EAEf,CACC,MAAO,EACR,EAEAiF,EAAQ,UAAU,eAAiB,UAAW,CAC7C,OAAK,KAAK,KAGF,KAAK,KAAK,KAAK,QAFf,IAIT,EAEAA,EAAQ,UAAU,eAAiB,UAAW,CAC7C,MAAI,CAAC,KAAK,MAAQ,CAAC,KAAK,KAAK,KACrB,KAEA,KAAK,QAAQ,KAAK,KAAK,KAAK,OAAO,CAE5C,EAEAA,EAAQ,UAAU,0BAA4B,SAASiC,EAAU,CAChE,IAAI9B,EAAU8B,GAAY,CAAE,EACxBlH,EAAO,KAMX,GALIoF,EAAQ,OACXpF,EAAO,KAAK,QAAQoF,EAAQ,MAAM,EAElCpF,EAAO,KAAK,eAAgB,EAEzBA,GAAQ,KAAM,OAAO,KAEzB,IAAIyL,EAAO,IAAIxG,EACfwG,EAAK,gBAAkB,GAEvB,IAAIC,EAAe,CAAE,KAAM1L,EAAK,KAAM,kBAAmBA,EAAK,WAAW,KAAK,EAC1EA,EAAK,WAAW,OACnB0L,EAAa,MAAQ1L,EAAK,WAAW,KAAK,YAC1C0L,EAAa,OAAS1L,EAAK,WAAW,KAAK,cAE5C,IAAI2L,EAAUF,EAAK,SAASC,CAAY,EACxC,OAAIC,GACHF,EAAK,UAAUE,EAAS3L,EAAK,IAAI,EAC1ByL,GAEA,IAET,EAIAxG,EAAQ,UAAU,MAAQ,SAAS2G,EAAW,CAC7C,QAAS1V,EAAE,EAAGA,EAAE,KAAK,MAAM,OAAQA,IAClC,KAAK,MAAMA,CAAC,EAAE,MAAM0V,CAAS,CAE/B,EAEA3G,EAAQ,UAAU,eAAiB,SAASkB,EAAU0F,EAAclE,EAAS,CAC5E,IAAItC,EAAO,KAAK,aAAac,CAAQ,EACjCrB,EAAS,KAAK,UAAUO,EAAMwG,CAAY,EAC9C,GAAI/G,GAAU,KACb,YAAK,8BAA8BO,EAAK,QAAQwG,CAAY,CAAC,EACtD,KAGR,IAAIjQ,EAAS+L,GAAW,IAAI7Q,EAC5B8E,EAAO,WAAa9E,EAAW,WAE/B,IAAI8Q,EAAO,KAAK,uBAAuB9C,CAAM,EAC7C8C,EAAK,MAAMhM,CAAM,EAGjBgM,EAAK,MAAM,CAAC,EAAE,MAAM,CAAC,EAAE,YAAcA,EAAK,KAAK,EAC/CnT,EAAI,MAAM,SAAU,wCAAwCmT,EAAK,MAAM,CAAC,EAAE,MAAM,CAAC,EAAE,WAAW,EAC9FhM,EAAO,aAAagM,EAAK,MAAM,CAAC,EAAE,MAAM,CAAC,EAAE,qBAAsBA,EAAK,MAAM,CAAC,EAAE,MAAM,CAAC,EAAE,WAAW,EAEnG,IAAIkE,EAAO,IAAIzP,EAAU,QACzB,OAAAyP,EAAK,KAAOhH,EAAO,KACnBgH,EAAK,MAAMlQ,CAAM,EACVA,CACR,EAGAqJ,EAAQ,2BAA6B,SAAS8G,EAAMrF,EAAMsF,EAAgBC,EAAiB,CAC1F,IAAI/V,EAKJzB,EAAI,MAAM,UAAW,mCAAmC,EAExD,IAAImH,EAAS,IAAI9E,EACjB8E,EAAO,WAAa9E,EAAW,WAC/BiV,EAAK,MAAMnQ,CAAM,EAGjB,IAAIsQ,EAAOxF,EAAK,IAAI,MAAM,EAI1B,IAHIsF,GACHE,EAAK,IAAI,MAAM,EAAE,IAAI,oBAAqBF,CAAc,EAEpD9V,EAAI,EAAGA,EAAIwQ,EAAK,MAAM,OAAQxQ,IAClCgW,EAAK,IAAI,MAAM,EAAE,IAAI,WAAYxF,EAAK,MAAMxQ,CAAC,EAAE,KAAK,QAAQ,EACvD,IAAI,mCAAoC,CAAC,EACzC,IAAI,0BAA2B+V,CAAe,EAC9C,IAAI,sBAAuB,CAAC,EAC5B,IAAI,uBAAwB,KAAK,EAEvC,OAAAvF,EAAK,MAAM9K,CAAM,EAEVA,EAAO,MAEf,EAEAqJ,EAAQ,UAAU,KAAO,SAASrI,EAAM,CACvC,IAAIhB,EAAS,IAAI9E,EACjB8E,EAAO,WAAa9E,EAAW,WAC/B,KAAK,MAAM8E,CAAM,EACjBA,EAAO,KAAKgB,CAAI,CACjB,EAEAqI,EAAQ,UAAU,UAAY,UAAW,CACxC,IAAIrJ,EAAS,IAAI9E,EACjB,OAAA8E,EAAO,WAAa9E,EAAW,WAC/B,KAAK,MAAM8E,CAAM,EACVA,EAAO,MACf,EAEAqJ,EAAQ,UAAU,uBAAyB,UAAW,CACrD,IAAI/O,EAGAiW,EACA9G,EACA+G,EAUJ,IATI,KAAK,YAAc,MACtB3X,EAAI,KAAK,SAAU,+BAA+B,EAE9C,KAAK,6BACT,KAAK,2BAA6B,GAClC,KAAK,eAAiB,EACtB,KAAK,YAAa,GAEnB0X,EAAW,CAAA,EACNjW,EAAI,EAAGA,EAAI,KAAK,iBAAiB,OAAQA,IAAK,CAClD,IAAIwQ,EAAO,IAAIrK,EAAU,QACzBqK,EAAK,KAAO,KAAK,KAAK,KACnBA,EAAK,MAAM,KAAKA,EAAK,IAAI,EAC5BrB,EAAO,KAAK,aAAa,KAAK,iBAAiBnP,CAAC,EAAE,EAAE,EACpDwQ,EAAK,MAAM,KAAKrB,CAAI,EACpBqB,EAAK,MAAM,KAAKrB,CAAI,EACpB+G,EAAM,CAAE,EACRA,EAAI,GAAK/G,EAAK,KAAK,SACnB+G,EAAI,KAAO,KAAK,iBAAiBlW,CAAC,EAAE,KACpCkW,EAAI,OAASnH,EAAQ,2BAA2B,KAAK,KAAMyB,EAAO,KAAK,KAAK,MAAQ,KAAK,KAAK,KAAK,KAAO,KAAK,KAAK,KAAK,KAAK,kBAAmB,OAAa,KAAK,KAAK,MAAMxQ,CAAC,EAAE,QAAQ,OAAO,EAAI,KAAK,KAAK,MAAMA,CAAC,EAAE,QAAQ,CAAC,EAAE,SAAU,CAAG,EAC/OiW,EAAS,KAAKC,CAAG,CACnB,CACC,OAAOD,CACR,EAOA9P,EAAU,IAAI,UAAU,YAAc,SAASgQ,EAAQ,CACtD,KAAK,MAAQ,EACT,KAAK,KAAO7T,IACf,KAAK,MAAQ,GAEV,KAAK,OAAS,SACjB,KAAK,MAAQ,IAEd6T,EAAO,IAAIA,EAAO,OAAO,QAAQ,KAAK,IAAI,EAC1CA,EAAO,IAAIA,EAAO,OAAO,QAAQ,KAAK,IAAI,CAC3C,EAEAhQ,EAAU,QAAQ,UAAU,YAAc,SAASgQ,EAAQ,CAC1D,KAAK,MAAQ,EACbhQ,EAAU,IAAI,UAAU,YAAY,KAAK,KAAMgQ,CAAM,EACrDA,EAAO,IAAIA,EAAO,OAAO,WAAW,KAAK,OAAO,EAChDA,EAAO,IAAIA,EAAO,OAAO,SAAS,KAAK,KAAK,CAC7C,EAEAhQ,EAAU,IAAI,UAAU,MAAQ,SAASgQ,EAAQ,CAChD,KAAK,YAAYA,CAAM,CACxB,EAEAhQ,EAAU,aAAa,UAAU,MAAQ,SAASgQ,EAAQ,CACzD,KAAK,YAAYA,CAAM,EACvB,QAASnW,EAAE,EAAGA,EAAE,KAAK,MAAM,OAAQA,IAClC,GAAI,KAAK,MAAMA,CAAC,EAAG,CAClB,IAAIoW,EAAcD,EAAO,OACzBA,EAAO,QAAU,IACjB,KAAK,MAAMnW,CAAC,EAAE,MAAMmW,CAAM,EAC1BA,EAAO,OAASC,CACnB,CAEA,EAEArH,EAAQ,UAAU,MAAQ,SAASoH,EAAQ,CAC1CA,EAAO,OAAS,GAChB,QAASnW,EAAE,EAAGA,EAAE,KAAK,MAAM,OAAQA,IAC9B,KAAK,MAAMA,CAAC,GACf,KAAK,MAAMA,CAAC,EAAE,MAAMmW,CAAM,CAG7B,EAEAhQ,EAAU,QAAQ,UAAU,MAAQ,SAASgQ,EAAQ,CACpDhQ,EAAU,QAAQ,UAAU,YAAY,KAAK,KAAMgQ,CAAM,EACzDA,EAAO,IAAIA,EAAO,OAAO,kBAAkB,KAAK,aAAa,EAC7DA,EAAO,IAAIA,EAAO,OAAO,sBAAsB,KAAK,iBAAiB,EACrEA,EAAO,IAAIA,EAAO,OAAO,cAAc,KAAK,SAAS,EACrDA,EAAO,IAAIA,EAAO,OAAO,aAAa,KAAK,QAAQ,EACnDA,EAAO,IAAIA,EAAO,OAAO,SAAS,KAAK,IAAI,EAC3CA,EAAO,IAAIA,EAAO,OAAO,YAAY,KAAK,QAAQ,EAAE,EACpDA,EAAO,IAAIA,EAAO,OAAO,WAAW,KAAK,OAAO,KAAK,IAAI,CAAC,EAC1DA,EAAO,IAAIA,EAAO,OAAO,kBAAkB,KAAK,aAAa,CAC9D,EAEAhQ,EAAU,QAAQ,UAAU,MAAQ,SAASgQ,EAAQ,CACpDhQ,EAAU,QAAQ,UAAU,YAAY,KAAK,KAAMgQ,CAAM,EACzDA,EAAO,IAAIA,EAAO,OAAO,kBAAkB,KAAK,aAAa,EAC7DA,EAAO,IAAIA,EAAO,OAAO,sBAAsB,KAAK,iBAAiB,EACrEA,EAAO,IAAIA,EAAO,OAAO,aAAa,KAAK,QAAQ,EACnDA,EAAO,IAAIA,EAAO,OAAO,aAAa,KAAK,QAAQ,EACnDA,EAAO,IAAIA,EAAO,OAAO,YAAY,KAAK,QAAQ,EAAE,EACpDA,EAAO,IAAIA,EAAO,OAAO,WAAW,KAAK,OAAO,KAAK,IAAI,CAAC,EAC1DA,EAAO,IAAIA,EAAO,OAAO,UAAU,KAAK,KAAK,EAC7CA,EAAO,IAAIA,EAAO,OAAO,oBAAoB,KAAK,eAAe,EACjEA,EAAO,IAAIA,EAAO,OAAO,UAAU,KAAK,KAAK,EAC7CA,EAAO,IAAIA,EAAO,OAAO,WAAW,KAAK,MAAM,CAC/C,EAKD,IAAIE,EAAS,CAAE,EAEfA,EAAO,WAAa,SAAUC,EAAeC,EAAS,CAErD,IAAIC,EAAgBF,IAAkB,OAAYA,EAAgB,GAC9Df,EAAO,IAAIxG,EAAQwH,CAAO,EAC9B,OAAAhB,EAAK,gBAAmB,CAAAiB,EACjBjB,CACR,EAGCtV,EAAA,WAAqBoW,EAAO,yCCziR7B,IAAII,EAAO,GAMJ,MAAMC,UAAwB,KAAM,CACvC,YAAYC,EAAS,CACjB,MAAMA,CAAO,EACb,KAAK,KAAO,iBACf,CACL,CAEO,SAASC,GAAU,CACtB,MAAO,kBACX,CAUO,eAAeC,EAAaC,EAAOC,EAAYC,EAAK,IAASC,EAAa,KAAM,CACnF,IAAIC,EAAIC,EAGR,GAAI,QAAQ,IAAI,WAAY,aAAa,GAAK,GAC1C,MAAM,IAAIT,EAAgB,0DAA0D,EAExF,MAAMU,EAAaf,EAAO,aAI1B,IAAI7H,EAAK,KACT,MAAM6I,EAAsB,IAAI,IAChC,IAAIpB,EACAqB,EAAqB,GAErBC,EAAeC,EACnB,MAAMC,EAAQ,IAAI,QAAQ,CAACC,EAASC,IAAW,CAC3CJ,EAAgBG,EAChBF,EAAeG,CACvB,CAAK,EAwBD,MAtBoB,eAAeC,GAAc,CAC7C,GAAI,CAAAA,EAAY,QAEhB,OAAAA,EAAY,QAAU,GAEf,MAAM,IAAI,QAAQ,CAACF,EAASC,IAAW,CAC1CnJ,EAAK,IAAI,YACTsI,EAAM,IAAM,IAAI,gBAAgBtI,CAAE,EAClCA,EAAG,iBAAiB,aAAc,IAAM,CAEpCkJ,IAEA,WAAW,IAAM,CACbE,EAAY,QAAU,EACzB,EAAE,GAAI,CACvB,EAAe,CAAE,KAAM,EAAI,CAAE,EACjBpJ,EAAG,iBAAiB,QAASmJ,CAAM,EAEnC,WAAWA,EAAQ,IAAO,IAAI,MAAM,gCAAgC,CAAC,CACjF,CAAS,CACJ,EAEgB,EAEjB,IAAIE,EAAgB,EAEpB,MAAMC,EAAY,SAAmBC,EAAU,CAC3C,IAAI9H,EAAW8H,EAAS,GACpBC,EAAQD,EAAS,MACjBE,EAAO,sBAAyBD,EAAQ,IACxCE,EACAC,EAAuB,OAAO,aAAiB,IAC/C,YAAY,gBAAgBF,CAAI,GAChCf,EAAK1I,EAAG,gBAAgByJ,CAAI,EAC5BZ,EAAoB,IAAIpH,EAAUiH,CAAE,EAChCiB,IACAjB,EAAG,cAAgB,IAAI,iBAAiB,CAACgB,CAAY,CAAC,GAE1DhB,EAAG,iBAAiB,QAAS,SAAU5V,EAAG,CAEtD,CAAa,EACD4V,EAAG,GAAK1I,EACR0I,EAAG,GAAKjH,EACRmH,EAAW,kBAAkBnH,EAAUiH,EAAI,CAAE,UAAW,EAAE,CAAE,EAC5DA,EAAG,eAAiB,GACpBK,KAGAC,EAAa,IAAId,EAAgB,6CAA6C,CAAC,CAEtF,EACK0B,EAAiB,SAASA,EAAe9W,EAAG,CAC9C,MAAM4V,EAAK5V,EAAE,OACT4V,EAAG,GAAG,aAAe,SACrBA,EAAG,UAAY,EACfA,EAAG,oBAAoB,YAAakB,CAAc,EAClDlB,EAAG,iBAAiB,YAAamB,EAAY,KAAKnB,EAAI,GAAM,EAAI,CAAC,EAGjEmB,EAAY,KAAKnB,EAAI,GAAO,EAAI,EAChCA,EAAG,GAAG,eAEb,EACKmB,EAAc,SAASA,EAAYC,EAAWC,EAAe,CAC/D,GAAIA,IAAkB,KAId,KAAK,YACLnB,EAAW,mBAAmB,KAAK,GAAI,KAAK,SAAS,EACrD,OAAO,KAAK,WAEZ,KAAK,SAAS,GAAI,CACd5I,EAAG,aAAe,SAClByI,IAAa,IAAMzI,EAAG,YAAW,CAAE,EAC/ByI,IAAYA,EAAa,MAGpC,MAAO,CAAE,CAEd,GAAI,KAAK,WAAa,IAAS,KAAK,eAAe,OAAS,EAAG,CAC3D,GAAI,KAAK,GAAG,aAAe,OACvB,OAEJ,IAAIuB,EAAM,KAAK,eAAe,MAAK,EACnC,KAAK,UAAYA,EAAI,UACrB,KAAK,QAAUA,EAAI,QACnB,GAAI,CAEA,KAAK,aAAaA,EAAI,MAAM,EACxBlB,IACAR,EAAM,KAAI,EACVQ,EAAqB,GAE5B,OACMhW,EAAG,CACFA,EAAE,OAAS,uBACX,KAAK,eAAe,OAAO,EAAG,EAAGkX,CAAG,EACpC,WAAW,IAAM,CACbH,EAAY,MAAM,KAAM,SAAS,CACpC,EAAE,GAAI,EAGd,CACJ,CACJ,EAEDjB,EAAW,YAAc,UAAY,CAEpC,EACDA,EAAW,QAAU,SAAUtT,EAAM,CAQjC,GAPA0K,EAAG,UAAY1K,EACXA,EAAK,aACL0K,EAAG,SAAWA,EAAG,kBAAoB1K,EAAK,kBAAoBA,EAAK,UAEnE0K,EAAG,SAAWA,EAAG,kBAAoB1K,EAAK,SAAWA,EAAK,UAG1DA,EAAM,CACN,UAAW4L,KAAS5L,EAAK,OAAQgU,EAAUpI,CAAK,EAChDuG,EAAWmB,EAAW,yBACtB,QAASpX,EAAI,EAAGA,EAAIiW,EAAS,OAAQjW,IAAK,CACtC,MAAMkX,EAAKjB,EAASjW,CAAC,EAAE,KACnBA,IAAM,IACNkX,EAAG,GAAG,aAAe,GAEzBA,EAAG,iBAAiB,YAAakB,CAAc,EAE/ClB,EAAG,aAAajB,EAASjW,CAAC,EAAE,MAAM,EAClCkX,EAAG,aAAe,EAClBA,EAAG,GAAG,cACT,CACJ,CACT,EACIE,EAAW,UAAY,SAAUpI,EAAIC,EAAM3L,EAAQ4M,EAAWuI,EAAS,CACnE,MAAMvB,EAAKjI,EACXiI,EAAG,eACHA,EAAG,eAAe,KAAK,CAAE,GAAIlI,EAAI,OAAQ1L,EAAQ,UAAW4M,EAAW,QAASuI,CAAS,CAAA,EACzFJ,EAAY,KAAKnB,EAAI,GAAM,EAAK,CACxC,EACIE,EAAW,QAAU,UAAY,CAC7BI,EAAa,IAAI,MAAM,sBAAuB,CAC1C,KAAM,SACT,CAAA,CAAC,CACV,EACIJ,EAAW,MAAK,EAGhB,SAASsB,GAAS,CAEd,MAAMvI,EAAO,IAAI,KAAM,EAAC,QAAO,EAC/B,GAAIA,EAAOuI,EAAO,QAAU,IAAK,OACjCA,EAAO,QAAUvI,EAGjB,IAAInQ,EAAGxB,EAAOma,EACd,IAAK3Y,EAAI,EAAGA,EAAI8W,EAAM,SAAS,OAAQ9W,IAGnC,GAFAxB,EAAQsY,EAAM,SAAS,MAAM9W,CAAC,EAC9B2Y,EAAM7B,EAAM,SAAS,IAAI9W,CAAC,EACtB8W,EAAM,aAAetY,GAASsY,EAAM,aAAgB6B,EAAM,KAAK,KAAK,GAAK7B,EAAM,YAAY,EAC3F,OAIR,MAAMpG,EAAY0G,EAAW,KAAKN,EAAM,YAAa,EAAI,EACnD8B,EAAIC,EAAYnI,EAAU,OAAQA,EAAU,OAASsG,CAAE,EAC7D,OAAAF,EAAM,aAAeA,EAAM,YACpB8B,CACV,CACDF,EAAO,QAAU,EACjB,SAASI,GAAW,CACZhC,EAAM,eAAiBA,EAAM,aAC7B4B,GAEP,CACD,IAAIK,EAAgB,GACpB,SAASC,GAAe,EAChB,MAAMA,EAAa,SAAS,GAAMlC,EAAM,YAAckC,EAAa,WAAgBlC,EAAM,YAAckC,EAAa,UAAa,KAAK,KAAK,GAAKlC,EAAM,YAAY,KAClK4B,IACAM,EAAa,UAAYlC,EAAM,YAC/BiC,EAAgB,GAEvB,CACDjC,EAAM,iBAAiB,SAAUgC,CAAQ,EACzChC,EAAM,iBAAiB,aAAckC,CAAY,EAGjD,SAASC,GAAY,CACbzK,EAAG,kBAAoBsI,EAAM,YAAc,IAE3CA,EAAM,MAAQiC,GACdjC,EAAM,YAAc,EACpB4B,IACApB,EAAqB,GACrByB,EAAgB,KAGhBjC,EAAM,MAAK,EACXiC,EAAgB,IAEvB,CACDjC,EAAM,iBAAiB,UAAWmC,CAAS,EAG3C,MAAMC,EAAU,IAAM,CAClB/B,EAAU,GAEVL,EAAM,oBAAoB,SAAUgC,CAAQ,EAC5ChC,EAAM,oBAAoB,aAAckC,CAAY,EACpDlC,EAAM,oBAAoB,UAAWmC,CAAS,EAG9C5B,EAAoB,QAAQ,CAACH,EAAIzB,IAAY,CACzC,GAAI,CACIyB,EAAG,UACHA,EAAG,MAAK,EAER1I,EAAG,aAAe,QAClBA,EAAG,mBAAmB0I,CAAE,EAE5BA,EAAG,oBAAoB,YAAamB,CAAW,EAC/CjB,EAAW,mBAAmB3B,EAASyB,EAAG,SAAS,CACtD,OAAQ5V,EAAG,CACR,QAAQ,KAAK,kCAAmCA,CAAC,CACpD,CACb,CAAS,EACD+V,EAAoB,MAAK,EAGrBD,IACAA,EAAW,MAAK,EAChBA,EAAW,UAAY,KACvBA,EAAW,QAAU,KACrBA,EAAW,YAAc,KACzBA,EAAW,KAAI,GAGnB,IAAI,gBAAgBN,EAAM,GAAG,EAC7BA,EAAM,IAAM,sBAEZ,GAAI,CAAE+B,EAAY,IAAI,QAAK,CAAK,MAAS,CAAG,CACpD,EAEI,eAAeA,EAAYra,EAAOma,EAAK3J,EAAK,KAAMmK,EAAQ,EAAG,CAEzD,GAAInK,GAAM,KACNA,EAAM,EAAE6I,EACRgB,EAAY,IAAI,UAChBA,EAAY,GAAK,aAEZ7J,IAAO6I,EAEZ,MAAO,GAEX,GAAIV,EAAS,MAAO,GACpB,GAAIgC,EAAQ,GAER,MAAO,GAGX,MAAMC,EAAa,IAAI,gBACvBP,EAAY,GAAKO,EACjB,GAAI,CACA,MAAM5W,EAAO,IAAI,KAAK,CAAC,MAAMuU,EAAWvY,EAAOma,EAAKS,CAAU,CAAC,CAAC,EAChE,GAAIpK,IAAO6I,EAEP,MAAO,GAEX,GAAI,CAACrV,EAAK,KAAM,CACZ,MAAMoB,EAAK,IAAI,YAAY,CAAC,EAC5B,OAAAA,EAAG,UAAYpF,EACf4Y,EAAW,aAAaxT,EAAI,EAAI,EAChCwT,EAAW,MAAK,EAET,CACV,CACD,MAAM9T,EAAS,MAAMd,EAAK,cAC1Bc,EAAO,UAAY9E,EACnB,MAAM6a,EAASjC,EAAW,aAAa9T,EAAQ,CAAC,CAACd,EAAK,GAAG,EAGzD,GAFA4U,EAAW,MAAK,EAEZiC,EAAQ,OAAO,MAAMR,EAAYQ,EAAQA,EAASrC,EAAIhI,EAAI,EAAEmK,CAAK,EAChE,GAAI3W,EAAK,IAAK,MAAO,EAGtC,MAAgB,CAEP,CACD,OAAO,IACV,CACD,eAAe,SAAY,CACb,MAAMqW,EAAY,EAAG7B,CAAE,CAEzC,CAAK,EAEDkC,EAAQ,eAAiB,IACd1K,EAEX,WAAW,IAAM,CACbgJ,EAAa,IAAI,MAAM,2BAA2B,CAAC,CACtD,EAAE,GAAK,EACR,GAAI,CACA,MAAMC,CACT,OAAQnW,EAAG,CACR,MAAA4X,IACM5X,CACT,CACD,OAAO4X,CACX","x_google_ignoreList":[0,1]}